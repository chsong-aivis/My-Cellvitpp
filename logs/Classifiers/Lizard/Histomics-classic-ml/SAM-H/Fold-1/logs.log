[37m2024-08-06 06:45:21,495 [INFO] - Loading train: /Lizard-CellViT-Histomics/cache/341eb0066a448ec101c89725e6c6a016f5e1d9fac6bba5840393fd8b45723b1c.h5
[37m2024-08-06 06:45:25,349 [INFO] - Loading val: /Lizard-CellViT-Histomics/cache/bf5577a531513671ce8f6a4b302fca930c62518ad192b1b3f41eaaebe4bdadf4.h5
[37m2024-08-06 06:45:27,889 [INFO] - Setup.....
[37m2024-08-06 06:45:27,893 [INFO] - PyCaret ClassificationExperiment
[37m2024-08-06 06:45:27,895 [INFO] - Logging name: clf-default-name
[37m2024-08-06 06:45:27,900 [INFO] - ML Usecase: MLUsecase.CLASSIFICATION
[37m2024-08-06 06:45:27,906 [INFO] - version 3.3.2
[37m2024-08-06 06:45:27,911 [INFO] - Initializing setup()
[37m2024-08-06 06:45:27,916 [INFO] - self.USI: 8bf0
[37m2024-08-06 06:45:27,920 [INFO] - self._variable_keys: {'n_jobs_param', 'logging_param', 'exp_name_log', 'X', 'target_param', 'y_train', 'idx', 'seed', 'USI', 'data', '_ml_usecase', 'y', 'y_test', 'X_train', 'fold_generator', 'is_multiclass', 'gpu_param', 'X_test', 'fold_groups_param', 'html_param', 'fix_imbalance', 'log_plots_param', '_available_plots', 'gpu_n_jobs_param', 'memory', 'pipeline', 'exp_id', 'fold_shuffle_param'}
[37m2024-08-06 06:45:27,925 [INFO] - Checking environment
[37m2024-08-06 06:45:27,930 [INFO] - python_version: 3.11.9
[37m2024-08-06 06:45:27,934 [INFO] - python_build: ('main', 'Apr 19 2024 18:36:13')
[37m2024-08-06 06:45:27,939 [INFO] - machine: x86_64
[37m2024-08-06 06:45:27,951 [INFO] - platform: Linux-5.15.131-0515131-generic-x86_64-with-glibc2.35
[37m2024-08-06 06:45:27,952 [INFO] - Memory: svmem(total=1081606041600, available=850433961984, percent=21.4, used=209013960704, free=591149490176, active=123771408384, inactive=339359690752, buffers=4256161792, cached=277186428928, shared=16176644096, slab=19137699840)
[37m2024-08-06 06:45:27,965 [INFO] - Physical Core: 64
[37m2024-08-06 06:45:27,966 [INFO] - Logical Core: 128
[37m2024-08-06 06:45:27,970 [INFO] - Checking libraries
[37m2024-08-06 06:45:27,975 [INFO] - System:
[37m2024-08-06 06:45:27,982 [INFO] -     python: 3.11.9 | packaged by conda-forge | (main, Apr 19 2024, 18:36:13) [GCC 12.3.0]
[37m2024-08-06 06:45:27,987 [INFO] - executable: /environment/pycaret/bin/python3
[37m2024-08-06 06:45:27,992 [INFO] -    machine: Linux-5.15.131-0515131-generic-x86_64-with-glibc2.35
[37m2024-08-06 06:45:27,997 [INFO] - PyCaret required dependencies:
[37m2024-08-06 06:45:29,179 [INFO] -                  pip: 24.2
[37m2024-08-06 06:45:29,179 [INFO] -           setuptools: 72.1.0
[37m2024-08-06 06:45:29,185 [INFO] -              pycaret: 3.3.2
[37m2024-08-06 06:45:29,190 [INFO] -              IPython: 8.26.0
[37m2024-08-06 06:45:29,195 [INFO] -           ipywidgets: 8.1.3
[37m2024-08-06 06:45:29,200 [INFO] -                 tqdm: 4.66.5
[37m2024-08-06 06:45:29,205 [INFO] -                numpy: 1.26.4
[37m2024-08-06 06:45:29,210 [INFO] -               pandas: 2.1.4
[37m2024-08-06 06:45:29,215 [INFO] -               jinja2: 3.1.4
[37m2024-08-06 06:45:29,220 [INFO] -                scipy: 1.11.4
[37m2024-08-06 06:45:29,225 [INFO] -               joblib: 1.3.2
[37m2024-08-06 06:45:29,230 [INFO] -              sklearn: 1.4.2
[37m2024-08-06 06:45:29,234 [INFO] -                 pyod: 2.0.1
[37m2024-08-06 06:45:29,239 [INFO] -             imblearn: 0.12.3
[37m2024-08-06 06:45:29,243 [INFO] -    category_encoders: 2.6.3
[37m2024-08-06 06:45:29,248 [INFO] -             lightgbm: 4.5.0
[37m2024-08-06 06:45:29,253 [INFO] -                numba: 0.60.0
[37m2024-08-06 06:45:29,258 [INFO] -             requests: 2.32.3
[37m2024-08-06 06:45:29,262 [INFO] -           matplotlib: 3.7.5
[37m2024-08-06 06:45:29,267 [INFO] -           scikitplot: 0.3.7
[37m2024-08-06 06:45:29,272 [INFO] -          yellowbrick: 1.5
[37m2024-08-06 06:45:29,277 [INFO] -               plotly: 5.23.0
[37m2024-08-06 06:45:29,281 [INFO] -     plotly-resampler: Not installed
[37m2024-08-06 06:45:29,286 [INFO] -              kaleido: 0.2.1
[37m2024-08-06 06:45:29,291 [INFO] -            schemdraw: 0.15
[37m2024-08-06 06:45:29,296 [INFO] -          statsmodels: 0.14.2
[37m2024-08-06 06:45:29,301 [INFO] -               sktime: 0.26.0
[37m2024-08-06 06:45:29,306 [INFO] -                tbats: 1.1.3
[37m2024-08-06 06:45:29,310 [INFO] -             pmdarima: 2.0.4
[37m2024-08-06 06:45:29,315 [INFO] -               psutil: 6.0.0
[37m2024-08-06 06:45:29,319 [INFO] -           markupsafe: 2.1.5
[37m2024-08-06 06:45:29,324 [INFO] -              pickle5: Not installed
[37m2024-08-06 06:45:29,329 [INFO] -          cloudpickle: 3.0.0
[37m2024-08-06 06:45:29,334 [INFO] -          deprecation: 2.1.0
[37m2024-08-06 06:45:29,338 [INFO] -               xxhash: 3.4.1
[37m2024-08-06 06:45:29,343 [INFO] -            wurlitzer: 3.1.1
[37m2024-08-06 06:45:29,347 [INFO] - PyCaret optional dependencies:
[37m2024-08-06 06:45:31,689 [INFO] -                 shap: 0.44.1
[37m2024-08-06 06:45:31,690 [INFO] -            interpret: 0.6.2
[37m2024-08-06 06:45:31,695 [INFO] -                 umap: 0.5.6
[37m2024-08-06 06:45:31,700 [INFO] -      ydata_profiling: 4.9.0
[37m2024-08-06 06:45:31,705 [INFO] -   explainerdashboard: 0.4.7
[37m2024-08-06 06:45:31,710 [INFO] -              autoviz: Not installed
[37m2024-08-06 06:45:31,716 [INFO] -            fairlearn: 0.7.0
[37m2024-08-06 06:45:31,721 [INFO] -           deepchecks: Not installed
[37m2024-08-06 06:45:31,726 [INFO] -              xgboost: 2.1.1
[37m2024-08-06 06:45:31,731 [INFO] -             catboost: 1.2.5
[37m2024-08-06 06:45:31,736 [INFO] -               kmodes: 0.12.2
[37m2024-08-06 06:45:31,740 [INFO] -              mlxtend: 0.23.1
[37m2024-08-06 06:45:31,745 [INFO] -        statsforecast: 1.5.0
[37m2024-08-06 06:45:31,751 [INFO] -         tune_sklearn: Not installed
[37m2024-08-06 06:45:31,756 [INFO] -                  ray: Not installed
[37m2024-08-06 06:45:31,761 [INFO] -             hyperopt: 0.2.7
[37m2024-08-06 06:45:31,766 [INFO] -               optuna: 3.6.1
[37m2024-08-06 06:45:31,771 [INFO] -                skopt: 0.10.2
[37m2024-08-06 06:45:31,776 [INFO] -               mlflow: 2.15.0
[37m2024-08-06 06:45:31,781 [INFO] -               gradio: 4.40.0
[37m2024-08-06 06:45:31,786 [INFO] -              fastapi: 0.112.0
[37m2024-08-06 06:45:31,792 [INFO] -              uvicorn: 0.30.5
[37m2024-08-06 06:45:31,797 [INFO] -               m2cgen: 0.10.0
[37m2024-08-06 06:45:31,802 [INFO] -            evidently: 0.4.33
[37m2024-08-06 06:45:31,806 [INFO] -                fugue: 0.8.7
[37m2024-08-06 06:45:31,811 [INFO] -            streamlit: Not installed
[37m2024-08-06 06:45:31,816 [INFO] -              prophet: Not installed
[37m2024-08-06 06:45:31,821 [INFO] - None
[37m2024-08-06 06:45:31,826 [INFO] - Set up GPU usage.
[93m2024-08-06 06:45:31,832 [WARNING] - cuML is outdated or not found. Required version is >=23.08.
                Please visit https://rapids.ai/install for installation instructions.
[37m2024-08-06 06:45:31,836 [INFO] - Set up data.
[37m2024-08-06 06:45:32,233 [INFO] - Set up folding strategy.
[37m2024-08-06 06:45:32,233 [INFO] - Set up train/test split.
[37m2024-08-06 06:45:32,239 [INFO] - Set up data.
[37m2024-08-06 06:45:32,521 [INFO] - Set up index.
[37m2024-08-06 06:45:32,529 [INFO] - Assigning column types.
[37m2024-08-06 06:45:33,073 [INFO] - Engine successfully changes for model 'lr' to 'sklearn'.
[37m2024-08-06 06:45:33,107 [INFO] - Engine for model 'knn' has not been set explicitly, hence returning None.
[37m2024-08-06 06:45:33,110 [INFO] - Engine for model 'rbfsvm' has not been set explicitly, hence returning None.
[37m2024-08-06 06:45:33,209 [INFO] - Engine for model 'knn' has not been set explicitly, hence returning None.
[37m2024-08-06 06:45:33,210 [INFO] - Engine for model 'rbfsvm' has not been set explicitly, hence returning None.
[37m2024-08-06 06:45:33,265 [INFO] - Engine successfully changes for model 'knn' to 'sklearn'.
[37m2024-08-06 06:45:33,308 [INFO] - Engine for model 'rbfsvm' has not been set explicitly, hence returning None.
[37m2024-08-06 06:45:33,384 [INFO] - Engine for model 'rbfsvm' has not been set explicitly, hence returning None.
[37m2024-08-06 06:45:33,422 [INFO] - Engine successfully changes for model 'rbfsvm' to 'sklearn'.
[37m2024-08-06 06:45:33,577 [INFO] - Preparing preprocessing pipeline...
[37m2024-08-06 06:45:33,642 [INFO] - Set up simple imputation.
[37m2024-08-06 06:45:33,694 [INFO] - Set up column name cleaning.
[37m2024-08-06 06:45:34,688 [INFO] - Finished creating preprocessing pipeline.
[37m2024-08-06 06:45:34,691 [INFO] - Pipeline: Pipeline(memory=FastMemory(location=/tmp/joblib),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color...
                ('categorical_imputer',
                 TransformerWrapper(exclude=None, include=[],
                                    transformer=SimpleImputer(add_indicator=False,
                                                              copy=True,
                                                              fill_value=None,
                                                              keep_empty_features=False,
                                                              missing_values=nan,
                                                              strategy='most_frequent'))),
                ('clean_column_names',
                 TransformerWrapper(exclude=None, include=None,
                                    transformer=CleanColumnNames(match='[\\]\\[\\,\\{\\}\\"\\:]+')))],
         verbose=False)
[37m2024-08-06 06:45:34,694 [INFO] - Creating final display dataframe.
[37m2024-08-06 06:45:36,977 [INFO] - Setup _display_container:                     Description             Value
0                    Session id               777
1                        Target            target
2                   Target type        Multiclass
3           Original data shape     (239688, 129)
4        Transformed data shape     (239688, 129)
5   Transformed train set shape     (140895, 129)
6    Transformed test set shape      (98793, 129)
7              Numeric features               128
8                    Preprocess              True
9               Imputation type            simple
10           Numeric imputation              mean
11       Categorical imputation              mode
12               Fold Generator   StratifiedKFold
13                  Fold Number                10
14                     CPU Jobs                16
15                      Use GPU              True
16               Log Experiment             False
17              Experiment Name  clf-default-name
18                          USI              8bf0
[37m2024-08-06 06:45:37,133 [INFO] - setup() successfully completed in 9.24s...............
[37m2024-08-06 06:45:37,133 [INFO] - Initializing set_config()
[37m2024-08-06 06:45:37,139 [INFO] - set_config(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, variable=seed, value=123, kwargs={})
[37m2024-08-06 06:45:37,143 [INFO] - Global variable: seed updated to 123
[37m2024-08-06 06:45:37,148 [INFO] - set_config() successfully completed......................................
[37m2024-08-06 06:45:37,152 [INFO] - Initializing create_model()
[37m2024-08-06 06:45:37,156 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=xgboost, fold=None, round=4, cross_validation=False, predict=True, fit_kwargs=None, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=True, system=True, add_to_model_list=True, metrics=None, display=None, model_only=True, return_train_score=False, error_score=0.0, kwargs={'n_jobs': 16})
[37m2024-08-06 06:45:37,161 [INFO] - Checking exceptions
[37m2024-08-06 06:45:37,169 [INFO] - Importing libraries
[37m2024-08-06 06:45:37,171 [INFO] - Copying training dataset
[37m2024-08-06 06:45:37,656 [INFO] - Defining folds
[37m2024-08-06 06:45:37,656 [INFO] - Declaring metric variables
[37m2024-08-06 06:45:37,662 [INFO] - Importing untrained model
[37m2024-08-06 06:45:37,667 [INFO] - Extreme Gradient Boosting Imported successfully
[37m2024-08-06 06:45:37,672 [INFO] - Cross validation set to False
[37m2024-08-06 06:45:37,676 [INFO] - Fitting Model
[37m2024-08-06 06:45:40,529 [INFO] - Initializing predict_model()
[37m2024-08-06 06:45:40,529 [INFO] - predict_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                               importance_type=None,
                               interaction_constraints=None, learning_rate=None,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=None, max_leaves=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=None, n_jobs=16,
                               num_parallel_tree=None,
                               objective='multi:softprob', ...))],
         verbose=False), probability_threshold=None, encoded_labels=False, raw_score=False, round=4, verbose=False, ml_usecase=None, preprocess=True, encode_labels=<function _SupervisedExperiment.predict_model.<locals>.encode_labels at 0x7f17d6358680>)
[37m2024-08-06 06:45:40,535 [INFO] - Checking exceptions
[37m2024-08-06 06:45:40,540 [INFO] - Preloading libraries
[37m2024-08-06 06:45:42,712 [INFO] - _display_container: 2
[37m2024-08-06 06:45:42,713 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:45:42,719 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:45:42,872 [INFO] - Scores on Val-set before tuning
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
Test    0.7641  0.9297  0.7641  0.7491  0.7509  0.6413  0.6426
[37m2024-08-06 06:45:42,873 [INFO] - Initializing tune_model()
[37m2024-08-06 06:45:42,878 [INFO] - tune_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fold=10, round=4, n_iter=10, custom_grid=None, optimize=Accuracy, custom_scorer=None, search_library=scikit-learn, search_algorithm=None, early_stopping=False, early_stopping_max_iters=10, choose_better=True, fit_kwargs=None, groups=None, return_tuner=False, verbose=True, tuner_verbose=True, return_train_score=False, kwargs={})
[37m2024-08-06 06:45:42,883 [INFO] - Checking exceptions
[37m2024-08-06 06:45:43,162 [INFO] - Copying training dataset
[37m2024-08-06 06:45:43,474 [INFO] - Checking base model
[37m2024-08-06 06:45:43,474 [INFO] - Base model : Extreme Gradient Boosting
[37m2024-08-06 06:45:43,480 [INFO] - Declaring metric variables
[37m2024-08-06 06:45:43,484 [INFO] - Defining Hyperparameters
[37m2024-08-06 06:45:43,648 [INFO] - Tuning with n_jobs=1
[37m2024-08-06 06:45:43,649 [INFO] - Initializing RandomizedSearchCV
[37m2024-08-06 06:56:00,308 [INFO] - best_params: {'actual_estimator__subsample': 0.2, 'actual_estimator__scale_pos_weight': 37.7, 'actual_estimator__reg_lambda': 0.2, 'actual_estimator__reg_alpha': 0.0001, 'actual_estimator__n_estimators': 220, 'actual_estimator__min_child_weight': 4, 'actual_estimator__max_depth': 10, 'actual_estimator__learning_rate': 0.05, 'actual_estimator__colsample_bytree': 0.9}
[37m2024-08-06 06:56:00,311 [INFO] - Hyperparameter search completed
[37m2024-08-06 06:56:00,316 [INFO] - SubProcess create_model() called ==================================
[37m2024-08-06 06:56:00,322 [INFO] - Initializing create_model()
[37m2024-08-06 06:56:00,326 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=True, system=False, add_to_model_list=True, metrics=None, display=<pycaret.internal.display.display.CommonDisplay object at 0x7f17d6ba5650>, model_only=True, return_train_score=False, error_score=0.0, kwargs={'subsample': 0.2, 'scale_pos_weight': 37.7, 'reg_lambda': 0.2, 'reg_alpha': 0.0001, 'n_estimators': 220, 'min_child_weight': 4, 'max_depth': 10, 'learning_rate': 0.05, 'colsample_bytree': 0.9})
[37m2024-08-06 06:56:00,332 [INFO] - Checking exceptions
[37m2024-08-06 06:56:00,338 [INFO] - Importing libraries
[37m2024-08-06 06:56:00,348 [INFO] - Copying training dataset
[37m2024-08-06 06:56:00,770 [INFO] - Defining folds
[37m2024-08-06 06:56:00,770 [INFO] - Declaring metric variables
[37m2024-08-06 06:56:00,776 [INFO] - Importing untrained model
[37m2024-08-06 06:56:00,781 [INFO] - Declaring custom model
[37m2024-08-06 06:56:00,788 [INFO] - Extreme Gradient Boosting Imported successfully
[37m2024-08-06 06:56:00,791 [INFO] - Starting cross validation
[37m2024-08-06 06:56:00,798 [INFO] - Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=1
[37m2024-08-06 06:57:57,887 [INFO] - Calculating mean and std
[37m2024-08-06 06:57:57,919 [INFO] - Creating metrics dataframe
[37m2024-08-06 06:57:58,110 [INFO] - Finalizing model
[37m2024-08-06 06:58:10,502 [INFO] - Uploading results into container
[37m2024-08-06 06:58:10,503 [INFO] - Uploading model into container now
[37m2024-08-06 06:58:10,533 [INFO] - _master_model_container: 1
[37m2024-08-06 06:58:10,583 [INFO] - _display_container: 3
[37m2024-08-06 06:58:10,623 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=10, max_leaves=None,
              min_child_weight=4, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=220, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:58:10,656 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:58:10,862 [INFO] - SubProcess create_model() end ==================================
[37m2024-08-06 06:58:10,862 [INFO] - choose_better activated
[37m2024-08-06 06:58:10,888 [INFO] - SubProcess create_model() called ==================================
[37m2024-08-06 06:58:10,915 [INFO] - Initializing create_model()
[37m2024-08-06 06:58:10,925 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=False, system=False, add_to_model_list=True, metrics=None, display=None, model_only=True, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 06:58:10,950 [INFO] - Checking exceptions
[37m2024-08-06 06:58:10,992 [INFO] - Importing libraries
[37m2024-08-06 06:58:11,027 [INFO] - Copying training dataset
[37m2024-08-06 06:58:11,499 [INFO] - Defining folds
[37m2024-08-06 06:58:11,499 [INFO] - Declaring metric variables
[37m2024-08-06 06:58:11,521 [INFO] - Importing untrained model
[37m2024-08-06 06:58:11,557 [INFO] - Declaring custom model
[37m2024-08-06 06:58:11,598 [INFO] - Extreme Gradient Boosting Imported successfully
[37m2024-08-06 06:58:11,612 [INFO] - Starting cross validation
[37m2024-08-06 06:58:11,649 [INFO] - Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=1
[37m2024-08-06 06:58:39,317 [INFO] - Calculating mean and std
[37m2024-08-06 06:58:39,319 [INFO] - Creating metrics dataframe
[37m2024-08-06 06:58:39,325 [INFO] - Finalizing model
[37m2024-08-06 06:58:41,900 [INFO] - Uploading results into container
[37m2024-08-06 06:58:41,901 [INFO] - Uploading model into container now
[37m2024-08-06 06:58:41,906 [INFO] - _master_model_container: 2
[37m2024-08-06 06:58:41,911 [INFO] - _display_container: 4
[37m2024-08-06 06:58:41,917 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:58:41,921 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:58:42,110 [INFO] - SubProcess create_model() end ==================================
[37m2024-08-06 06:58:42,111 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...) result for Accuracy is 0.7793
[37m2024-08-06 06:58:42,117 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=10, max_leaves=None,
              min_child_weight=4, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=220, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...) result for Accuracy is 0.7856
[37m2024-08-06 06:58:42,122 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=10, max_leaves=None,
              min_child_weight=4, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=220, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...) is best model
[37m2024-08-06 06:58:42,127 [INFO] - choose_better completed
[37m2024-08-06 06:58:42,143 [INFO] - _master_model_container: 2
[37m2024-08-06 06:58:42,143 [INFO] - _display_container: 3
[37m2024-08-06 06:58:42,148 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=10, max_leaves=None,
              min_child_weight=4, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=220, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:58:42,153 [INFO] - tune_model() successfully completed......................................
[37m2024-08-06 06:58:42,299 [INFO] - Initializing finalize_model()
[37m2024-08-06 06:58:42,299 [INFO] - finalize_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=10, max_leaves=None,
              min_child_weight=4, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=220, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fit_kwargs=None, groups=None, model_only=False, experiment_custom_tags=None)
[37m2024-08-06 06:58:42,304 [INFO] - Finalizing XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=10, max_leaves=None,
              min_child_weight=4, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=220, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:58:42,641 [INFO] - Initializing create_model()
[37m2024-08-06 06:58:42,641 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=10, max_leaves=None,
              min_child_weight=4, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=220, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fold=None, round=4, cross_validation=False, predict=False, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=False, system=False, add_to_model_list=False, metrics=None, display=None, model_only=False, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 06:58:42,645 [INFO] - Checking exceptions
[37m2024-08-06 06:58:42,655 [INFO] - Importing libraries
[37m2024-08-06 06:58:42,659 [INFO] - Copying training dataset
[37m2024-08-06 06:58:42,767 [INFO] - Defining folds
[37m2024-08-06 06:58:42,767 [INFO] - Declaring metric variables
[37m2024-08-06 06:58:42,773 [INFO] - Importing untrained model
[37m2024-08-06 06:58:42,777 [INFO] - Declaring custom model
[37m2024-08-06 06:58:42,784 [INFO] - Extreme Gradient Boosting Imported successfully
[37m2024-08-06 06:58:42,789 [INFO] - Cross validation set to False
[37m2024-08-06 06:58:42,793 [INFO] - Fitting Model
[37m2024-08-06 06:58:58,008 [INFO] - Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                               importance_type=None,
                               interaction_constraints=None, learning_rate=0.05,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=10, max_leaves=None,
                               min_child_weight=4, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=220, n_jobs=16,
                               num_parallel_tree=None,
                               objective='multi:softprob', ...))],
         verbose=False)
[37m2024-08-06 06:58:58,010 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:58:58,231 [INFO] - _master_model_container: 2
[37m2024-08-06 06:58:58,231 [INFO] - _display_container: 3
[37m2024-08-06 06:58:58,268 [INFO] - Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                               importance_type=None,
                               interaction_constraints=None, learning_rate=0.05,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=10, max_leaves=None,
                               min_child_weight=4, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=220, n_jobs=16,
                               num_parallel_tree=None,
                               objective='multi:softprob', ...))],
         verbose=False)
[37m2024-08-06 06:58:58,279 [INFO] - finalize_model() successfully completed......................................
[37m2024-08-06 06:58:58,942 [INFO] - Initializing predict_model()
[37m2024-08-06 06:58:58,943 [INFO] - predict_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.05, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=10, max_leaves=None,
              min_child_weight=4, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=220, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), probability_threshold=None, encoded_labels=False, raw_score=False, round=4, verbose=True, ml_usecase=None, preprocess=True, encode_labels=<function _SupervisedExperiment.predict_model.<locals>.encode_labels at 0x7f17d634f240>)
[37m2024-08-06 06:58:58,969 [INFO] - Checking exceptions
[37m2024-08-06 06:58:59,002 [INFO] - Preloading libraries
[37m2024-08-06 06:58:59,039 [INFO] - Set up data.
[37m2024-08-06 06:58:59,235 [INFO] - Set up index.
[37m2024-08-06 06:59:00,604 [INFO] - Scores on Val-set after tuning
                       Model  Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0  Extreme Gradient Boosting    0.7645  0.9299  0.7645  0.7503  0.7499  0.6416  0.6431
[37m2024-08-06 06:59:00,604 [INFO] - Shap.....
[37m2024-08-06 06:59:19,133 [INFO] - Shap: neutrophil
[37m2024-08-06 06:59:51,599 [INFO] - Shap: epithelial
[37m2024-08-06 07:00:22,877 [INFO] - Shap: lymphocyte
[37m2024-08-06 07:00:55,577 [INFO] - Shap: plasma
[37m2024-08-06 07:01:25,119 [INFO] - Shap: eosinophil
[37m2024-08-06 07:01:59,133 [INFO] - Shap: connective tissue
[37m2024-08-06 07:02:30,766 [INFO] - Initializing create_model()
[37m2024-08-06 07:02:30,766 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=catboost, fold=None, round=4, cross_validation=False, predict=True, fit_kwargs=None, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=True, system=True, add_to_model_list=True, metrics=None, display=None, model_only=True, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 07:02:30,772 [INFO] - Checking exceptions
[37m2024-08-06 07:02:30,781 [INFO] - Importing libraries
[37m2024-08-06 07:02:30,785 [INFO] - Copying training dataset
[37m2024-08-06 07:02:31,432 [INFO] - Defining folds
[37m2024-08-06 07:02:31,433 [INFO] - Declaring metric variables
[37m2024-08-06 07:02:31,438 [INFO] - Importing untrained model
[37m2024-08-06 07:02:31,443 [INFO] - CatBoost Classifier Imported successfully
[37m2024-08-06 07:02:31,449 [INFO] - Cross validation set to False
[37m2024-08-06 07:02:31,453 [INFO] - Fitting Model
[37m2024-08-06 07:02:38,590 [INFO] - Initializing predict_model()
[37m2024-08-06 07:02:38,591 [INFO] - predict_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                                    transformer=SimpleImputer(add_indicator=False,
                                                              copy=True,
                                                              fill_value=None,
                                                              keep_empty_features=False,
                                                              missing_values=nan,
                                                              strategy='most_frequent'))),
                ('clean_column_names',
                 TransformerWrapper(exclude=None, include=None,
                                    transformer=CleanColumnNames(match='[\\]\\[\\,\\{\\}\\"\\:]+'))),
                ('actual_estimator',
                 <catboost.core.CatBoostClassifier object at 0x7f17917d9bd0>)],
         verbose=False), probability_threshold=None, encoded_labels=False, raw_score=False, round=4, verbose=False, ml_usecase=None, preprocess=True, encode_labels=<function _SupervisedExperiment.predict_model.<locals>.encode_labels at 0x7f17d635ad40>)
[37m2024-08-06 07:02:38,597 [INFO] - Checking exceptions
[37m2024-08-06 07:02:38,603 [INFO] - Preloading libraries
[37m2024-08-06 07:02:41,155 [INFO] - _display_container: 5
[37m2024-08-06 07:02:41,155 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f17917d9bd0>
[37m2024-08-06 07:02:41,161 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 07:02:41,333 [INFO] - Scores on Val-set before tuning
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
Test    0.7747  0.9367  0.7747  0.7615  0.7624  0.6581  0.6593
[37m2024-08-06 07:02:41,333 [INFO] - Initializing tune_model()
[37m2024-08-06 07:02:41,338 [INFO] - tune_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=<catboost.core.CatBoostClassifier object at 0x7f17917d9bd0>, fold=10, round=4, n_iter=10, custom_grid=None, optimize=Accuracy, custom_scorer=None, search_library=scikit-learn, search_algorithm=None, early_stopping=False, early_stopping_max_iters=10, choose_better=True, fit_kwargs=None, groups=None, return_tuner=False, verbose=True, tuner_verbose=True, return_train_score=False, kwargs={})
[37m2024-08-06 07:02:41,343 [INFO] - Checking exceptions
[37m2024-08-06 07:02:41,536 [INFO] - Copying training dataset
[37m2024-08-06 07:02:41,860 [INFO] - Checking base model
[37m2024-08-06 07:02:41,860 [INFO] - Base model : CatBoost Classifier
[37m2024-08-06 07:02:41,877 [INFO] - Declaring metric variables
[37m2024-08-06 07:02:41,903 [INFO] - Defining Hyperparameters
[37m2024-08-06 07:02:42,096 [INFO] - Tuning with n_jobs=1
[37m2024-08-06 07:02:42,096 [INFO] - Initializing RandomizedSearchCV
[37m2024-08-06 07:08:01,932 [INFO] - best_params: {'actual_estimator__random_strength': 0.3, 'actual_estimator__n_estimators': 50, 'actual_estimator__l2_leaf_reg': 10, 'actual_estimator__eta': 0.4, 'actual_estimator__depth': 5}
[37m2024-08-06 07:08:01,935 [INFO] - Hyperparameter search completed
[37m2024-08-06 07:08:01,940 [INFO] - SubProcess create_model() called ==================================
[37m2024-08-06 07:08:01,946 [INFO] - Initializing create_model()
[37m2024-08-06 07:08:01,951 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=<catboost.core.CatBoostClassifier object at 0x7f17a82a7b50>, fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=True, system=False, add_to_model_list=True, metrics=None, display=<pycaret.internal.display.display.CommonDisplay object at 0x7f17a82a6690>, model_only=True, return_train_score=False, error_score=0.0, kwargs={'random_strength': 0.3, 'n_estimators': 50, 'l2_leaf_reg': 10, 'eta': 0.4, 'depth': 5})
[37m2024-08-06 07:08:01,956 [INFO] - Checking exceptions
[37m2024-08-06 07:08:01,963 [INFO] - Importing libraries
[37m2024-08-06 07:08:01,968 [INFO] - Copying training dataset
[37m2024-08-06 07:08:02,589 [INFO] - Defining folds
[37m2024-08-06 07:08:02,589 [INFO] - Declaring metric variables
[37m2024-08-06 07:08:02,596 [INFO] - Importing untrained model
[37m2024-08-06 07:08:02,600 [INFO] - Declaring custom model
[37m2024-08-06 07:08:02,606 [INFO] - CatBoost Classifier Imported successfully
[37m2024-08-06 07:08:02,610 [INFO] - Starting cross validation
[37m2024-08-06 07:08:02,617 [INFO] - Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=1
[37m2024-08-06 07:08:31,623 [INFO] - Calculating mean and std
[37m2024-08-06 07:08:31,668 [INFO] - Creating metrics dataframe
[37m2024-08-06 07:08:31,841 [INFO] - Finalizing model
[37m2024-08-06 07:08:39,872 [INFO] - Uploading results into container
[37m2024-08-06 07:08:39,874 [INFO] - Uploading model into container now
[37m2024-08-06 07:08:39,879 [INFO] - _master_model_container: 3
[37m2024-08-06 07:08:39,884 [INFO] - _display_container: 6
[37m2024-08-06 07:08:39,888 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f17b8116ed0>
[37m2024-08-06 07:08:39,894 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 07:08:40,290 [INFO] - SubProcess create_model() end ==================================
[37m2024-08-06 07:08:40,291 [INFO] - choose_better activated
[37m2024-08-06 07:08:40,295 [INFO] - SubProcess create_model() called ==================================
[37m2024-08-06 07:08:40,301 [INFO] - Initializing create_model()
[37m2024-08-06 07:08:40,305 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=<catboost.core.CatBoostClassifier object at 0x7f17917d9bd0>, fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=False, system=False, add_to_model_list=True, metrics=None, display=None, model_only=True, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 07:08:40,314 [INFO] - Checking exceptions
[37m2024-08-06 07:08:40,320 [INFO] - Importing libraries
[37m2024-08-06 07:08:40,324 [INFO] - Copying training dataset
[37m2024-08-06 07:08:41,074 [INFO] - Defining folds
[37m2024-08-06 07:08:41,074 [INFO] - Declaring metric variables
[37m2024-08-06 07:08:41,081 [INFO] - Importing untrained model
[37m2024-08-06 07:08:41,087 [INFO] - Declaring custom model
[37m2024-08-06 07:08:41,094 [INFO] - CatBoost Classifier Imported successfully
[37m2024-08-06 07:08:41,100 [INFO] - Starting cross validation
[37m2024-08-06 07:08:41,106 [INFO] - Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=1
[37m2024-08-06 07:10:10,189 [INFO] - Calculating mean and std
[37m2024-08-06 07:10:10,191 [INFO] - Creating metrics dataframe
[37m2024-08-06 07:10:10,198 [INFO] - Finalizing model
[37m2024-08-06 07:10:18,822 [INFO] - Uploading results into container
[37m2024-08-06 07:10:18,824 [INFO] - Uploading model into container now
[37m2024-08-06 07:10:18,829 [INFO] - _master_model_container: 4
[37m2024-08-06 07:10:18,834 [INFO] - _display_container: 7
[37m2024-08-06 07:10:18,838 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f17c7fb8e10>
[37m2024-08-06 07:10:18,844 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 07:10:19,138 [INFO] - SubProcess create_model() end ==================================
[37m2024-08-06 07:10:19,138 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f17c7fb8e10> result for Accuracy is 0.784
[37m2024-08-06 07:10:19,144 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f17b8116ed0> result for Accuracy is 0.7693
[37m2024-08-06 07:10:19,149 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f17c7fb8e10> is best model
[37m2024-08-06 07:10:19,155 [INFO] - choose_better completed
[37m2024-08-06 07:10:19,160 [INFO] - Original model was better than the tuned model, hence it will be returned. NOTE: The display metrics are for the tuned model (not the original one).
[37m2024-08-06 07:10:19,176 [INFO] - _master_model_container: 4
[37m2024-08-06 07:10:19,177 [INFO] - _display_container: 6
[37m2024-08-06 07:10:19,181 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f17c7fb8e10>
[37m2024-08-06 07:10:19,187 [INFO] - tune_model() successfully completed......................................
[37m2024-08-06 07:10:19,400 [INFO] - Initializing finalize_model()
[37m2024-08-06 07:10:19,401 [INFO] - finalize_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=<catboost.core.CatBoostClassifier object at 0x7f17c7fb8e10>, fit_kwargs=None, groups=None, model_only=False, experiment_custom_tags=None)
[37m2024-08-06 07:10:19,406 [INFO] - Finalizing <catboost.core.CatBoostClassifier object at 0x7f17c7fb8e10>
[37m2024-08-06 07:10:19,877 [INFO] - Initializing create_model()
[37m2024-08-06 07:10:19,877 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=<catboost.core.CatBoostClassifier object at 0x7f17c7fb8e10>, fold=None, round=4, cross_validation=False, predict=False, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=False, system=False, add_to_model_list=False, metrics=None, display=None, model_only=False, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 07:10:19,882 [INFO] - Checking exceptions
[37m2024-08-06 07:10:19,902 [INFO] - Importing libraries
[37m2024-08-06 07:10:19,906 [INFO] - Copying training dataset
[37m2024-08-06 07:10:20,018 [INFO] - Defining folds
[37m2024-08-06 07:10:20,018 [INFO] - Declaring metric variables
[37m2024-08-06 07:10:20,026 [INFO] - Importing untrained model
[37m2024-08-06 07:10:20,030 [INFO] - Declaring custom model
[37m2024-08-06 07:10:20,035 [INFO] - CatBoost Classifier Imported successfully
[37m2024-08-06 07:10:20,050 [INFO] - Cross validation set to False
[37m2024-08-06 07:10:20,053 [INFO] - Fitting Model
[37m2024-08-06 07:10:28,968 [INFO] - Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                                    transformer=SimpleImputer(add_indicator=False,
                                                              copy=True,
                                                              fill_value=None,
                                                              keep_empty_features=False,
                                                              missing_values=nan,
                                                              strategy='most_frequent'))),
                ('clean_column_names',
                 TransformerWrapper(exclude=None, include=None,
                                    transformer=CleanColumnNames(match='[\\]\\[\\,\\{\\}\\"\\:]+'))),
                ('actual_estimator',
                 <catboost.core.CatBoostClassifier object at 0x7f17c7f7d4d0>)],
         verbose=False)
[37m2024-08-06 07:10:28,968 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 07:10:29,341 [INFO] - _master_model_container: 4
[37m2024-08-06 07:10:29,341 [INFO] - _display_container: 6
[37m2024-08-06 07:10:29,378 [INFO] - Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                                    transformer=SimpleImputer(add_indicator=False,
                                                              copy=True,
                                                              fill_value=None,
                                                              keep_empty_features=False,
                                                              missing_values=nan,
                                                              strategy='most_frequent'))),
                ('clean_column_names',
                 TransformerWrapper(exclude=None, include=None,
                                    transformer=CleanColumnNames(match='[\\]\\[\\,\\{\\}\\"\\:]+'))),
                ('actual_estimator',
                 <catboost.core.CatBoostClassifier object at 0x7f17c7f7d4d0>)],
         verbose=False)
[37m2024-08-06 07:10:29,378 [INFO] - finalize_model() successfully completed......................................
[37m2024-08-06 07:10:29,924 [INFO] - Initializing predict_model()
[37m2024-08-06 07:10:29,925 [INFO] - predict_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f17eebe3150>, estimator=<catboost.core.CatBoostClassifier object at 0x7f17c7fb8e10>, probability_threshold=None, encoded_labels=False, raw_score=False, round=4, verbose=True, ml_usecase=None, preprocess=True, encode_labels=<function _SupervisedExperiment.predict_model.<locals>.encode_labels at 0x7f1788900f40>)
[37m2024-08-06 07:10:29,930 [INFO] - Checking exceptions
[37m2024-08-06 07:10:29,935 [INFO] - Preloading libraries
[37m2024-08-06 07:10:29,939 [INFO] - Set up data.
[37m2024-08-06 07:10:30,192 [INFO] - Set up index.
[37m2024-08-06 07:10:31,170 [INFO] - Scores on Val-set after tuning
                 Model  Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0  CatBoost Classifier    0.7747  0.9367  0.7747  0.7615  0.7624  0.6581  0.6593
[37m2024-08-06 07:10:31,170 [INFO] - Shap.....
[37m2024-08-06 07:10:44,017 [INFO] - Shap: neutrophil
[37m2024-08-06 07:11:09,260 [INFO] - Shap: epithelial
[37m2024-08-06 07:11:32,256 [INFO] - Shap: lymphocyte
[37m2024-08-06 07:11:57,930 [INFO] - Shap: plasma
[37m2024-08-06 07:12:22,044 [INFO] - Shap: eosinophil
[37m2024-08-06 07:12:45,493 [INFO] - Shap: connective tissue
