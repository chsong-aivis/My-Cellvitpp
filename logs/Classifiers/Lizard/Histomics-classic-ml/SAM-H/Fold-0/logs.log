[37m2024-08-06 06:15:19,144 [INFO] - Loading train: /Lizard-CellViT-Histomics/cache/a382a741184799a722841217ee99f982bf6a7656fa2011918f840cf78198d1b0.h5
[37m2024-08-06 06:15:22,547 [INFO] - Loading val: /Lizard-CellViT-Histomics/cache/f0228c42d947484ab9290303494057fe2158466bfcc9a501dae11ba49a8d5a26.h5
[37m2024-08-06 06:15:26,540 [INFO] - Setup.....
[37m2024-08-06 06:15:26,545 [INFO] - PyCaret ClassificationExperiment
[37m2024-08-06 06:15:26,546 [INFO] - Logging name: clf-default-name
[37m2024-08-06 06:15:26,551 [INFO] - ML Usecase: MLUsecase.CLASSIFICATION
[37m2024-08-06 06:15:26,556 [INFO] - version 3.3.2
[37m2024-08-06 06:15:26,560 [INFO] - Initializing setup()
[37m2024-08-06 06:15:26,565 [INFO] - self.USI: a30c
[37m2024-08-06 06:15:26,569 [INFO] - self._variable_keys: {'pipeline', 'n_jobs_param', '_available_plots', 'fold_generator', 'gpu_n_jobs_param', 'data', 'logging_param', 'html_param', 'fold_shuffle_param', 'y', 'is_multiclass', 'X', 'gpu_param', 'target_param', 'X_test', '_ml_usecase', 'log_plots_param', 'y_train', 'exp_name_log', 'idx', 'exp_id', 'fix_imbalance', 'USI', 'y_test', 'seed', 'X_train', 'memory', 'fold_groups_param'}
[37m2024-08-06 06:15:26,573 [INFO] - Checking environment
[37m2024-08-06 06:15:26,577 [INFO] - python_version: 3.11.9
[37m2024-08-06 06:15:26,582 [INFO] - python_build: ('main', 'Apr 19 2024 18:36:13')
[37m2024-08-06 06:15:26,587 [INFO] - machine: x86_64
[37m2024-08-06 06:15:26,599 [INFO] - platform: Linux-5.15.131-0515131-generic-x86_64-with-glibc2.35
[37m2024-08-06 06:15:26,600 [INFO] - Memory: svmem(total=1081606041600, available=851225063424, percent=21.3, used=208191352832, free=592684322816, active=123343544320, inactive=338360328192, buffers=4256141312, cached=276474224640, shared=16208072704, slab=19123621888)
[37m2024-08-06 06:15:26,612 [INFO] - Physical Core: 64
[37m2024-08-06 06:15:26,613 [INFO] - Logical Core: 128
[37m2024-08-06 06:15:26,617 [INFO] - Checking libraries
[37m2024-08-06 06:15:26,622 [INFO] - System:
[37m2024-08-06 06:15:26,626 [INFO] -     python: 3.11.9 | packaged by conda-forge | (main, Apr 19 2024, 18:36:13) [GCC 12.3.0]
[37m2024-08-06 06:15:26,631 [INFO] - executable: /environment/pycaret/bin/python3
[37m2024-08-06 06:15:26,636 [INFO] -    machine: Linux-5.15.131-0515131-generic-x86_64-with-glibc2.35
[37m2024-08-06 06:15:26,640 [INFO] - PyCaret required dependencies:
[37m2024-08-06 06:15:27,768 [INFO] -                  pip: 24.2
[37m2024-08-06 06:15:27,769 [INFO] -           setuptools: 72.1.0
[37m2024-08-06 06:15:27,774 [INFO] -              pycaret: 3.3.2
[37m2024-08-06 06:15:27,779 [INFO] -              IPython: 8.26.0
[37m2024-08-06 06:15:27,784 [INFO] -           ipywidgets: 8.1.3
[37m2024-08-06 06:15:27,788 [INFO] -                 tqdm: 4.66.5
[37m2024-08-06 06:15:27,793 [INFO] -                numpy: 1.26.4
[37m2024-08-06 06:15:27,798 [INFO] -               pandas: 2.1.4
[37m2024-08-06 06:15:27,803 [INFO] -               jinja2: 3.1.4
[37m2024-08-06 06:15:27,807 [INFO] -                scipy: 1.11.4
[37m2024-08-06 06:15:27,812 [INFO] -               joblib: 1.3.2
[37m2024-08-06 06:15:27,817 [INFO] -              sklearn: 1.4.2
[37m2024-08-06 06:15:27,823 [INFO] -                 pyod: 2.0.1
[37m2024-08-06 06:15:27,827 [INFO] -             imblearn: 0.12.3
[37m2024-08-06 06:15:27,832 [INFO] -    category_encoders: 2.6.3
[37m2024-08-06 06:15:27,836 [INFO] -             lightgbm: 4.5.0
[37m2024-08-06 06:15:27,841 [INFO] -                numba: 0.60.0
[37m2024-08-06 06:15:27,846 [INFO] -             requests: 2.32.3
[37m2024-08-06 06:15:27,851 [INFO] -           matplotlib: 3.7.5
[37m2024-08-06 06:15:27,855 [INFO] -           scikitplot: 0.3.7
[37m2024-08-06 06:15:27,860 [INFO] -          yellowbrick: 1.5
[37m2024-08-06 06:15:27,865 [INFO] -               plotly: 5.23.0
[37m2024-08-06 06:15:27,869 [INFO] -     plotly-resampler: Not installed
[37m2024-08-06 06:15:27,874 [INFO] -              kaleido: 0.2.1
[37m2024-08-06 06:15:27,880 [INFO] -            schemdraw: 0.15
[37m2024-08-06 06:15:27,884 [INFO] -          statsmodels: 0.14.2
[37m2024-08-06 06:15:27,890 [INFO] -               sktime: 0.26.0
[37m2024-08-06 06:15:27,894 [INFO] -                tbats: 1.1.3
[37m2024-08-06 06:15:27,902 [INFO] -             pmdarima: 2.0.4
[37m2024-08-06 06:15:27,911 [INFO] -               psutil: 6.0.0
[37m2024-08-06 06:15:27,916 [INFO] -           markupsafe: 2.1.5
[37m2024-08-06 06:15:27,921 [INFO] -              pickle5: Not installed
[37m2024-08-06 06:15:27,926 [INFO] -          cloudpickle: 3.0.0
[37m2024-08-06 06:15:27,931 [INFO] -          deprecation: 2.1.0
[37m2024-08-06 06:15:27,935 [INFO] -               xxhash: 3.4.1
[37m2024-08-06 06:15:27,940 [INFO] -            wurlitzer: 3.1.1
[37m2024-08-06 06:15:27,945 [INFO] - PyCaret optional dependencies:
[37m2024-08-06 06:15:30,277 [INFO] -                 shap: 0.44.1
[37m2024-08-06 06:15:30,277 [INFO] -            interpret: 0.6.2
[37m2024-08-06 06:15:30,290 [INFO] -                 umap: 0.5.6
[37m2024-08-06 06:15:30,295 [INFO] -      ydata_profiling: 4.9.0
[37m2024-08-06 06:15:30,300 [INFO] -   explainerdashboard: 0.4.7
[37m2024-08-06 06:15:30,305 [INFO] -              autoviz: Not installed
[37m2024-08-06 06:15:30,310 [INFO] -            fairlearn: 0.7.0
[37m2024-08-06 06:15:30,315 [INFO] -           deepchecks: Not installed
[37m2024-08-06 06:15:30,320 [INFO] -              xgboost: 2.1.1
[37m2024-08-06 06:15:30,324 [INFO] -             catboost: 1.2.5
[37m2024-08-06 06:15:30,329 [INFO] -               kmodes: 0.12.2
[37m2024-08-06 06:15:30,334 [INFO] -              mlxtend: 0.23.1
[37m2024-08-06 06:15:30,339 [INFO] -        statsforecast: 1.5.0
[37m2024-08-06 06:15:30,344 [INFO] -         tune_sklearn: Not installed
[37m2024-08-06 06:15:30,349 [INFO] -                  ray: Not installed
[37m2024-08-06 06:15:30,354 [INFO] -             hyperopt: 0.2.7
[37m2024-08-06 06:15:30,359 [INFO] -               optuna: 3.6.1
[37m2024-08-06 06:15:30,364 [INFO] -                skopt: 0.10.2
[37m2024-08-06 06:15:30,368 [INFO] -               mlflow: 2.15.0
[37m2024-08-06 06:15:30,373 [INFO] -               gradio: 4.40.0
[37m2024-08-06 06:15:30,378 [INFO] -              fastapi: 0.112.0
[37m2024-08-06 06:15:30,382 [INFO] -              uvicorn: 0.30.5
[37m2024-08-06 06:15:30,387 [INFO] -               m2cgen: 0.10.0
[37m2024-08-06 06:15:30,392 [INFO] -            evidently: 0.4.33
[37m2024-08-06 06:15:30,396 [INFO] -                fugue: 0.8.7
[37m2024-08-06 06:15:30,401 [INFO] -            streamlit: Not installed
[37m2024-08-06 06:15:30,405 [INFO] -              prophet: Not installed
[37m2024-08-06 06:15:30,410 [INFO] - None
[37m2024-08-06 06:15:30,415 [INFO] - Set up GPU usage.
[93m2024-08-06 06:15:30,420 [WARNING] - cuML is outdated or not found. Required version is >=23.08.
                Please visit https://rapids.ai/install for installation instructions.
[37m2024-08-06 06:15:30,424 [INFO] - Set up data.
[37m2024-08-06 06:15:30,756 [INFO] - Set up folding strategy.
[37m2024-08-06 06:15:30,756 [INFO] - Set up train/test split.
[37m2024-08-06 06:15:30,763 [INFO] - Set up data.
[37m2024-08-06 06:15:31,193 [INFO] - Set up index.
[37m2024-08-06 06:15:31,203 [INFO] - Assigning column types.
[37m2024-08-06 06:15:31,955 [INFO] - Engine successfully changes for model 'lr' to 'sklearn'.
[37m2024-08-06 06:15:31,997 [INFO] - Engine for model 'knn' has not been set explicitly, hence returning None.
[37m2024-08-06 06:15:32,002 [INFO] - Engine for model 'rbfsvm' has not been set explicitly, hence returning None.
[37m2024-08-06 06:15:32,122 [INFO] - Engine for model 'knn' has not been set explicitly, hence returning None.
[37m2024-08-06 06:15:32,123 [INFO] - Engine for model 'rbfsvm' has not been set explicitly, hence returning None.
[37m2024-08-06 06:15:32,168 [INFO] - Engine successfully changes for model 'knn' to 'sklearn'.
[37m2024-08-06 06:15:32,218 [INFO] - Engine for model 'rbfsvm' has not been set explicitly, hence returning None.
[37m2024-08-06 06:15:32,309 [INFO] - Engine for model 'rbfsvm' has not been set explicitly, hence returning None.
[37m2024-08-06 06:15:32,357 [INFO] - Engine successfully changes for model 'rbfsvm' to 'sklearn'.
[37m2024-08-06 06:15:32,541 [INFO] - Preparing preprocessing pipeline...
[37m2024-08-06 06:15:32,651 [INFO] - Set up simple imputation.
[37m2024-08-06 06:15:32,722 [INFO] - Set up column name cleaning.
[37m2024-08-06 06:15:33,816 [INFO] - Finished creating preprocessing pipeline.
[37m2024-08-06 06:15:33,823 [INFO] - Pipeline: Pipeline(memory=FastMemory(location=/tmp/joblib),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color...
                ('categorical_imputer',
                 TransformerWrapper(exclude=None, include=[],
                                    transformer=SimpleImputer(add_indicator=False,
                                                              copy=True,
                                                              fill_value=None,
                                                              keep_empty_features=False,
                                                              missing_values=nan,
                                                              strategy='most_frequent'))),
                ('clean_column_names',
                 TransformerWrapper(exclude=None, include=None,
                                    transformer=CleanColumnNames(match='[\\]\\[\\,\\{\\}\\"\\:]+')))],
         verbose=False)
[37m2024-08-06 06:15:33,824 [INFO] - Creating final display dataframe.
[37m2024-08-06 06:15:36,855 [INFO] - Setup _display_container:                     Description             Value
0                    Session id              3959
1                        Target            target
2                   Target type        Multiclass
3           Original data shape     (274559, 129)
4        Transformed data shape     (274559, 129)
5   Transformed train set shape     (133664, 129)
6    Transformed test set shape     (140895, 129)
7              Numeric features               128
8                    Preprocess              True
9               Imputation type            simple
10           Numeric imputation              mean
11       Categorical imputation              mode
12               Fold Generator   StratifiedKFold
13                  Fold Number                10
14                     CPU Jobs                16
15                      Use GPU              True
16               Log Experiment             False
17              Experiment Name  clf-default-name
18                          USI              a30c
[37m2024-08-06 06:15:37,040 [INFO] - setup() successfully completed in 10.5s...............
[37m2024-08-06 06:15:37,041 [INFO] - Initializing set_config()
[37m2024-08-06 06:15:37,046 [INFO] - set_config(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, variable=seed, value=123, kwargs={})
[37m2024-08-06 06:15:37,050 [INFO] - Global variable: seed updated to 123
[37m2024-08-06 06:15:37,055 [INFO] - set_config() successfully completed......................................
[37m2024-08-06 06:15:37,060 [INFO] - Initializing create_model()
[37m2024-08-06 06:15:37,064 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=xgboost, fold=None, round=4, cross_validation=False, predict=True, fit_kwargs=None, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=True, system=True, add_to_model_list=True, metrics=None, display=None, model_only=True, return_train_score=False, error_score=0.0, kwargs={'n_jobs': 16})
[37m2024-08-06 06:15:37,069 [INFO] - Checking exceptions
[37m2024-08-06 06:15:37,076 [INFO] - Importing libraries
[37m2024-08-06 06:15:37,079 [INFO] - Copying training dataset
[37m2024-08-06 06:15:37,628 [INFO] - Defining folds
[37m2024-08-06 06:15:37,628 [INFO] - Declaring metric variables
[37m2024-08-06 06:15:37,633 [INFO] - Importing untrained model
[37m2024-08-06 06:15:37,639 [INFO] - Extreme Gradient Boosting Imported successfully
[37m2024-08-06 06:15:37,644 [INFO] - Cross validation set to False
[37m2024-08-06 06:15:37,648 [INFO] - Fitting Model
[37m2024-08-06 06:15:40,501 [INFO] - Initializing predict_model()
[37m2024-08-06 06:15:40,501 [INFO] - predict_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                               importance_type=None,
                               interaction_constraints=None, learning_rate=None,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=None, max_leaves=None,
                               min_child_weight=None, missing=nan,
                               monotone_constraints=None, multi_strategy=None,
                               n_estimators=None, n_jobs=16,
                               num_parallel_tree=None,
                               objective='multi:softprob', ...))],
         verbose=False), probability_threshold=None, encoded_labels=False, raw_score=False, round=4, verbose=False, ml_usecase=None, preprocess=True, encode_labels=<function _SupervisedExperiment.predict_model.<locals>.encode_labels at 0x7f6bd7cd8720>)
[37m2024-08-06 06:15:40,507 [INFO] - Checking exceptions
[37m2024-08-06 06:15:40,512 [INFO] - Preloading libraries
[37m2024-08-06 06:15:43,445 [INFO] - _display_container: 2
[37m2024-08-06 06:15:43,446 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:15:43,452 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:15:43,629 [INFO] - Scores on Val-set before tuning
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
Test    0.7716  0.9359  0.7716  0.7563  0.7572  0.6521  0.6533
[37m2024-08-06 06:15:43,631 [INFO] - Initializing tune_model()
[37m2024-08-06 06:15:43,636 [INFO] - tune_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fold=10, round=4, n_iter=10, custom_grid=None, optimize=Accuracy, custom_scorer=None, search_library=scikit-learn, search_algorithm=None, early_stopping=False, early_stopping_max_iters=10, choose_better=True, fit_kwargs=None, groups=None, return_tuner=False, verbose=True, tuner_verbose=True, return_train_score=False, kwargs={})
[37m2024-08-06 06:15:43,647 [INFO] - Checking exceptions
[37m2024-08-06 06:15:44,061 [INFO] - Copying training dataset
[37m2024-08-06 06:15:44,474 [INFO] - Checking base model
[37m2024-08-06 06:15:44,474 [INFO] - Base model : Extreme Gradient Boosting
[37m2024-08-06 06:15:44,481 [INFO] - Declaring metric variables
[37m2024-08-06 06:15:44,485 [INFO] - Defining Hyperparameters
[37m2024-08-06 06:15:44,654 [INFO] - Tuning with n_jobs=1
[37m2024-08-06 06:15:44,654 [INFO] - Initializing RandomizedSearchCV
[37m2024-08-06 06:25:46,130 [INFO] - best_params: {'actual_estimator__subsample': 0.7, 'actual_estimator__scale_pos_weight': 37.1, 'actual_estimator__reg_lambda': 0.7, 'actual_estimator__reg_alpha': 2, 'actual_estimator__n_estimators': 290, 'actual_estimator__min_child_weight': 3, 'actual_estimator__max_depth': 7, 'actual_estimator__learning_rate': 0.15, 'actual_estimator__colsample_bytree': 0.9}
[37m2024-08-06 06:25:46,133 [INFO] - Hyperparameter search completed
[37m2024-08-06 06:25:46,138 [INFO] - SubProcess create_model() called ==================================
[37m2024-08-06 06:25:46,144 [INFO] - Initializing create_model()
[37m2024-08-06 06:25:46,148 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=True, system=False, add_to_model_list=True, metrics=None, display=<pycaret.internal.display.display.CommonDisplay object at 0x7f6c012c7dd0>, model_only=True, return_train_score=False, error_score=0.0, kwargs={'subsample': 0.7, 'scale_pos_weight': 37.1, 'reg_lambda': 0.7, 'reg_alpha': 2, 'n_estimators': 290, 'min_child_weight': 3, 'max_depth': 7, 'learning_rate': 0.15, 'colsample_bytree': 0.9})
[37m2024-08-06 06:25:46,153 [INFO] - Checking exceptions
[37m2024-08-06 06:25:46,159 [INFO] - Importing libraries
[37m2024-08-06 06:25:46,164 [INFO] - Copying training dataset
[37m2024-08-06 06:25:46,627 [INFO] - Defining folds
[37m2024-08-06 06:25:46,627 [INFO] - Declaring metric variables
[37m2024-08-06 06:25:46,634 [INFO] - Importing untrained model
[37m2024-08-06 06:25:46,639 [INFO] - Declaring custom model
[37m2024-08-06 06:25:46,645 [INFO] - Extreme Gradient Boosting Imported successfully
[37m2024-08-06 06:25:46,648 [INFO] - Starting cross validation
[37m2024-08-06 06:25:46,654 [INFO] - Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=1
[37m2024-08-06 06:27:11,662 [INFO] - Calculating mean and std
[37m2024-08-06 06:27:11,666 [INFO] - Creating metrics dataframe
[37m2024-08-06 06:27:11,673 [INFO] - Finalizing model
[37m2024-08-06 06:27:20,048 [INFO] - Uploading results into container
[37m2024-08-06 06:27:20,049 [INFO] - Uploading model into container now
[37m2024-08-06 06:27:20,055 [INFO] - _master_model_container: 1
[37m2024-08-06 06:27:20,061 [INFO] - _display_container: 3
[37m2024-08-06 06:27:20,066 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.15, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=7, max_leaves=None,
              min_child_weight=3, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=290, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:27:20,071 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:27:20,270 [INFO] - SubProcess create_model() end ==================================
[37m2024-08-06 06:27:20,270 [INFO] - choose_better activated
[37m2024-08-06 06:27:20,276 [INFO] - SubProcess create_model() called ==================================
[37m2024-08-06 06:27:20,281 [INFO] - Initializing create_model()
[37m2024-08-06 06:27:20,286 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=False, system=False, add_to_model_list=True, metrics=None, display=None, model_only=True, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 06:27:20,291 [INFO] - Checking exceptions
[37m2024-08-06 06:27:20,296 [INFO] - Importing libraries
[37m2024-08-06 06:27:20,300 [INFO] - Copying training dataset
[37m2024-08-06 06:27:20,715 [INFO] - Defining folds
[37m2024-08-06 06:27:20,715 [INFO] - Declaring metric variables
[37m2024-08-06 06:27:20,721 [INFO] - Importing untrained model
[37m2024-08-06 06:27:20,725 [INFO] - Declaring custom model
[37m2024-08-06 06:27:20,732 [INFO] - Extreme Gradient Boosting Imported successfully
[37m2024-08-06 06:27:20,736 [INFO] - Starting cross validation
[37m2024-08-06 06:27:20,741 [INFO] - Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=1
[37m2024-08-06 06:27:48,105 [INFO] - Calculating mean and std
[37m2024-08-06 06:27:48,107 [INFO] - Creating metrics dataframe
[37m2024-08-06 06:27:48,115 [INFO] - Finalizing model
[37m2024-08-06 06:27:50,772 [INFO] - Uploading results into container
[37m2024-08-06 06:27:50,774 [INFO] - Uploading model into container now
[37m2024-08-06 06:27:50,780 [INFO] - _master_model_container: 2
[37m2024-08-06 06:27:50,784 [INFO] - _display_container: 4
[37m2024-08-06 06:27:50,791 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:27:50,794 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:27:51,008 [INFO] - SubProcess create_model() end ==================================
[37m2024-08-06 06:27:51,009 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...) result for Accuracy is 0.7699
[37m2024-08-06 06:27:51,015 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.15, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=7, max_leaves=None,
              min_child_weight=3, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=290, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...) result for Accuracy is 0.7769
[37m2024-08-06 06:27:51,019 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.15, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=7, max_leaves=None,
              min_child_weight=3, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=290, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...) is best model
[37m2024-08-06 06:27:51,024 [INFO] - choose_better completed
[37m2024-08-06 06:27:51,041 [INFO] - _master_model_container: 2
[37m2024-08-06 06:27:51,041 [INFO] - _display_container: 3
[37m2024-08-06 06:27:51,046 [INFO] - XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.15, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=7, max_leaves=None,
              min_child_weight=3, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=290, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:27:51,051 [INFO] - tune_model() successfully completed......................................
[37m2024-08-06 06:27:51,200 [INFO] - Initializing finalize_model()
[37m2024-08-06 06:27:51,200 [INFO] - finalize_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.15, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=7, max_leaves=None,
              min_child_weight=3, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=290, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fit_kwargs=None, groups=None, model_only=False, experiment_custom_tags=None)
[37m2024-08-06 06:27:51,206 [INFO] - Finalizing XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.15, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=7, max_leaves=None,
              min_child_weight=3, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=290, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...)
[37m2024-08-06 06:27:51,628 [INFO] - Initializing create_model()
[37m2024-08-06 06:27:51,628 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.15, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=7, max_leaves=None,
              min_child_weight=3, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=290, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), fold=None, round=4, cross_validation=False, predict=False, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=False, system=False, add_to_model_list=False, metrics=None, display=None, model_only=False, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 06:27:51,634 [INFO] - Checking exceptions
[37m2024-08-06 06:27:51,641 [INFO] - Importing libraries
[37m2024-08-06 06:27:51,644 [INFO] - Copying training dataset
[37m2024-08-06 06:27:51,750 [INFO] - Defining folds
[37m2024-08-06 06:27:51,750 [INFO] - Declaring metric variables
[37m2024-08-06 06:27:51,755 [INFO] - Importing untrained model
[37m2024-08-06 06:27:51,760 [INFO] - Declaring custom model
[37m2024-08-06 06:27:51,765 [INFO] - Extreme Gradient Boosting Imported successfully
[37m2024-08-06 06:27:51,770 [INFO] - Cross validation set to False
[37m2024-08-06 06:27:51,773 [INFO] - Fitting Model
[37m2024-08-06 06:28:03,987 [INFO] - Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                               importance_type=None,
                               interaction_constraints=None, learning_rate=0.15,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=7, max_leaves=None, min_child_weight=3,
                               missing=nan, monotone_constraints=None,
                               multi_strategy=None, n_estimators=290, n_jobs=16,
                               num_parallel_tree=None,
                               objective='multi:softprob', ...))],
         verbose=False)
[37m2024-08-06 06:28:03,987 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:28:04,131 [INFO] - _master_model_container: 2
[37m2024-08-06 06:28:04,132 [INFO] - _display_container: 3
[37m2024-08-06 06:28:04,142 [INFO] - Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                               importance_type=None,
                               interaction_constraints=None, learning_rate=0.15,
                               max_bin=None, max_cat_threshold=None,
                               max_cat_to_onehot=None, max_delta_step=None,
                               max_depth=7, max_leaves=None, min_child_weight=3,
                               missing=nan, monotone_constraints=None,
                               multi_strategy=None, n_estimators=290, n_jobs=16,
                               num_parallel_tree=None,
                               objective='multi:softprob', ...))],
         verbose=False)
[37m2024-08-06 06:28:04,142 [INFO] - finalize_model() successfully completed......................................
[37m2024-08-06 06:28:04,634 [INFO] - Initializing predict_model()
[37m2024-08-06 06:28:04,634 [INFO] - predict_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=XGBClassifier(base_score=None, booster='gbtree', callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=0.9, device='gpu', early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.15, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=7, max_leaves=None,
              min_child_weight=3, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=290, n_jobs=16,
              num_parallel_tree=None, objective='multi:softprob', ...), probability_threshold=None, encoded_labels=False, raw_score=False, round=4, verbose=True, ml_usecase=None, preprocess=True, encode_labels=<function _SupervisedExperiment.predict_model.<locals>.encode_labels at 0x7f6bd7ccf2e0>)
[37m2024-08-06 06:28:04,639 [INFO] - Checking exceptions
[37m2024-08-06 06:28:04,644 [INFO] - Preloading libraries
[37m2024-08-06 06:28:04,648 [INFO] - Set up data.
[37m2024-08-06 06:28:04,929 [INFO] - Set up index.
[37m2024-08-06 06:28:07,037 [INFO] - Scores on Val-set after tuning
                       Model  Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0  Extreme Gradient Boosting     0.776  0.9388   0.776  0.7622  0.7621  0.6594  0.6606
[37m2024-08-06 06:28:07,037 [INFO] - Shap.....
[37m2024-08-06 06:28:20,502 [INFO] - Shap: neutrophil
[37m2024-08-06 06:29:07,210 [INFO] - Shap: epithelial
[37m2024-08-06 06:29:50,542 [INFO] - Shap: lymphocyte
[37m2024-08-06 06:30:37,176 [INFO] - Shap: plasma
[37m2024-08-06 06:31:23,091 [INFO] - Shap: eosinophil
[37m2024-08-06 06:32:07,037 [INFO] - Shap: connective tissue
[37m2024-08-06 06:32:53,613 [INFO] - Initializing create_model()
[37m2024-08-06 06:32:53,613 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=catboost, fold=None, round=4, cross_validation=False, predict=True, fit_kwargs=None, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=True, system=True, add_to_model_list=True, metrics=None, display=None, model_only=True, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 06:32:53,618 [INFO] - Checking exceptions
[37m2024-08-06 06:32:53,625 [INFO] - Importing libraries
[37m2024-08-06 06:32:53,627 [INFO] - Copying training dataset
[37m2024-08-06 06:32:54,429 [INFO] - Defining folds
[37m2024-08-06 06:32:54,429 [INFO] - Declaring metric variables
[37m2024-08-06 06:32:54,439 [INFO] - Importing untrained model
[37m2024-08-06 06:32:54,462 [INFO] - CatBoost Classifier Imported successfully
[37m2024-08-06 06:32:54,469 [INFO] - Cross validation set to False
[37m2024-08-06 06:32:54,471 [INFO] - Fitting Model
[37m2024-08-06 06:33:00,896 [INFO] - Initializing predict_model()
[37m2024-08-06 06:33:00,896 [INFO] - predict_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                                    transformer=SimpleImputer(add_indicator=False,
                                                              copy=True,
                                                              fill_value=None,
                                                              keep_empty_features=False,
                                                              missing_values=nan,
                                                              strategy='most_frequent'))),
                ('clean_column_names',
                 TransformerWrapper(exclude=None, include=None,
                                    transformer=CleanColumnNames(match='[\\]\\[\\,\\{\\}\\"\\:]+'))),
                ('actual_estimator',
                 <catboost.core.CatBoostClassifier object at 0x7f6b9c2aa350>)],
         verbose=False), probability_threshold=None, encoded_labels=False, raw_score=False, round=4, verbose=False, ml_usecase=None, preprocess=True, encode_labels=<function _SupervisedExperiment.predict_model.<locals>.encode_labels at 0x7f6b8c353100>)
[37m2024-08-06 06:33:00,902 [INFO] - Checking exceptions
[37m2024-08-06 06:33:00,908 [INFO] - Preloading libraries
[37m2024-08-06 06:33:03,944 [INFO] - _display_container: 5
[37m2024-08-06 06:33:03,944 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f6b9c2aa350>
[37m2024-08-06 06:33:03,949 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:33:04,108 [INFO] - Scores on Val-set before tuning
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
Test    0.7751  0.9389  0.7751  0.7626  0.7639  0.6592  0.6602
[37m2024-08-06 06:33:04,109 [INFO] - Initializing tune_model()
[37m2024-08-06 06:33:04,114 [INFO] - tune_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=<catboost.core.CatBoostClassifier object at 0x7f6b9c2aa350>, fold=10, round=4, n_iter=10, custom_grid=None, optimize=Accuracy, custom_scorer=None, search_library=scikit-learn, search_algorithm=None, early_stopping=False, early_stopping_max_iters=10, choose_better=True, fit_kwargs=None, groups=None, return_tuner=False, verbose=True, tuner_verbose=True, return_train_score=False, kwargs={})
[37m2024-08-06 06:33:04,119 [INFO] - Checking exceptions
[37m2024-08-06 06:33:04,302 [INFO] - Copying training dataset
[37m2024-08-06 06:33:04,613 [INFO] - Checking base model
[37m2024-08-06 06:33:04,613 [INFO] - Base model : CatBoost Classifier
[37m2024-08-06 06:33:04,621 [INFO] - Declaring metric variables
[37m2024-08-06 06:33:04,626 [INFO] - Defining Hyperparameters
[37m2024-08-06 06:33:04,777 [INFO] - Tuning with n_jobs=1
[37m2024-08-06 06:33:04,777 [INFO] - Initializing RandomizedSearchCV
[37m2024-08-06 06:37:59,600 [INFO] - best_params: {'actual_estimator__random_strength': 0.3, 'actual_estimator__n_estimators': 50, 'actual_estimator__l2_leaf_reg': 10, 'actual_estimator__eta': 0.4, 'actual_estimator__depth': 5}
[37m2024-08-06 06:37:59,602 [INFO] - Hyperparameter search completed
[37m2024-08-06 06:37:59,607 [INFO] - SubProcess create_model() called ==================================
[37m2024-08-06 06:37:59,612 [INFO] - Initializing create_model()
[37m2024-08-06 06:37:59,617 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=<catboost.core.CatBoostClassifier object at 0x7f6ba4154f10>, fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=True, system=False, add_to_model_list=True, metrics=None, display=<pycaret.internal.display.display.CommonDisplay object at 0x7f6b8c771e10>, model_only=True, return_train_score=False, error_score=0.0, kwargs={'random_strength': 0.3, 'n_estimators': 50, 'l2_leaf_reg': 10, 'eta': 0.4, 'depth': 5})
[37m2024-08-06 06:37:59,621 [INFO] - Checking exceptions
[37m2024-08-06 06:37:59,627 [INFO] - Importing libraries
[37m2024-08-06 06:37:59,632 [INFO] - Copying training dataset
[37m2024-08-06 06:38:00,265 [INFO] - Defining folds
[37m2024-08-06 06:38:00,265 [INFO] - Declaring metric variables
[37m2024-08-06 06:38:00,272 [INFO] - Importing untrained model
[37m2024-08-06 06:38:00,277 [INFO] - Declaring custom model
[37m2024-08-06 06:38:00,282 [INFO] - CatBoost Classifier Imported successfully
[37m2024-08-06 06:38:00,287 [INFO] - Starting cross validation
[37m2024-08-06 06:38:00,294 [INFO] - Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=1
[37m2024-08-06 06:38:25,287 [INFO] - Calculating mean and std
[37m2024-08-06 06:38:25,288 [INFO] - Creating metrics dataframe
[37m2024-08-06 06:38:25,298 [INFO] - Finalizing model
[37m2024-08-06 06:38:27,723 [INFO] - Uploading results into container
[37m2024-08-06 06:38:27,725 [INFO] - Uploading model into container now
[37m2024-08-06 06:38:27,730 [INFO] - _master_model_container: 3
[37m2024-08-06 06:38:27,734 [INFO] - _display_container: 6
[37m2024-08-06 06:38:27,739 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f6b9c2604d0>
[37m2024-08-06 06:38:27,743 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:38:27,986 [INFO] - SubProcess create_model() end ==================================
[37m2024-08-06 06:38:27,987 [INFO] - choose_better activated
[37m2024-08-06 06:38:27,993 [INFO] - SubProcess create_model() called ==================================
[37m2024-08-06 06:38:27,997 [INFO] - Initializing create_model()
[37m2024-08-06 06:38:28,003 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=<catboost.core.CatBoostClassifier object at 0x7f6b9c2aa350>, fold=StratifiedKFold(n_splits=10, random_state=None, shuffle=False), round=4, cross_validation=True, predict=True, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=False, system=False, add_to_model_list=True, metrics=None, display=None, model_only=True, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 06:38:28,008 [INFO] - Checking exceptions
[37m2024-08-06 06:38:28,013 [INFO] - Importing libraries
[37m2024-08-06 06:38:28,017 [INFO] - Copying training dataset
[37m2024-08-06 06:38:28,717 [INFO] - Defining folds
[37m2024-08-06 06:38:28,717 [INFO] - Declaring metric variables
[37m2024-08-06 06:38:28,724 [INFO] - Importing untrained model
[37m2024-08-06 06:38:28,729 [INFO] - Declaring custom model
[37m2024-08-06 06:38:28,734 [INFO] - CatBoost Classifier Imported successfully
[37m2024-08-06 06:38:28,739 [INFO] - Starting cross validation
[37m2024-08-06 06:38:28,747 [INFO] - Cross validating with StratifiedKFold(n_splits=10, random_state=None, shuffle=False), n_jobs=1
[37m2024-08-06 06:39:46,851 [INFO] - Calculating mean and std
[37m2024-08-06 06:39:46,854 [INFO] - Creating metrics dataframe
[37m2024-08-06 06:39:46,862 [INFO] - Finalizing model
[37m2024-08-06 06:39:55,441 [INFO] - Uploading results into container
[37m2024-08-06 06:39:55,443 [INFO] - Uploading model into container now
[37m2024-08-06 06:39:55,448 [INFO] - _master_model_container: 4
[37m2024-08-06 06:39:55,451 [INFO] - _display_container: 7
[37m2024-08-06 06:39:55,456 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f6b9c2914d0>
[37m2024-08-06 06:39:55,460 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:39:55,750 [INFO] - SubProcess create_model() end ==================================
[37m2024-08-06 06:39:55,750 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f6b9c2914d0> result for Accuracy is 0.7728
[37m2024-08-06 06:39:55,755 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f6b9c2604d0> result for Accuracy is 0.7502
[37m2024-08-06 06:39:55,759 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f6b9c2914d0> is best model
[37m2024-08-06 06:39:55,764 [INFO] - choose_better completed
[37m2024-08-06 06:39:55,769 [INFO] - Original model was better than the tuned model, hence it will be returned. NOTE: The display metrics are for the tuned model (not the original one).
[37m2024-08-06 06:39:55,788 [INFO] - _master_model_container: 4
[37m2024-08-06 06:39:55,788 [INFO] - _display_container: 6
[37m2024-08-06 06:39:55,793 [INFO] - <catboost.core.CatBoostClassifier object at 0x7f6b9c2914d0>
[37m2024-08-06 06:39:55,797 [INFO] - tune_model() successfully completed......................................
[37m2024-08-06 06:39:56,015 [INFO] - Initializing finalize_model()
[37m2024-08-06 06:39:56,015 [INFO] - finalize_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=<catboost.core.CatBoostClassifier object at 0x7f6b9c2914d0>, fit_kwargs=None, groups=None, model_only=False, experiment_custom_tags=None)
[37m2024-08-06 06:39:56,021 [INFO] - Finalizing <catboost.core.CatBoostClassifier object at 0x7f6b9c2914d0>
[37m2024-08-06 06:39:56,638 [INFO] - Initializing create_model()
[37m2024-08-06 06:39:56,638 [INFO] - create_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=<catboost.core.CatBoostClassifier object at 0x7f6b9c2914d0>, fold=None, round=4, cross_validation=False, predict=False, fit_kwargs={}, groups=None, refit=True, probability_threshold=None, experiment_custom_tags=None, verbose=False, system=False, add_to_model_list=False, metrics=None, display=None, model_only=False, return_train_score=False, error_score=0.0, kwargs={})
[37m2024-08-06 06:39:56,644 [INFO] - Checking exceptions
[37m2024-08-06 06:39:56,650 [INFO] - Importing libraries
[37m2024-08-06 06:39:56,654 [INFO] - Copying training dataset
[37m2024-08-06 06:39:56,766 [INFO] - Defining folds
[37m2024-08-06 06:39:56,766 [INFO] - Declaring metric variables
[37m2024-08-06 06:39:56,771 [INFO] - Importing untrained model
[37m2024-08-06 06:39:56,776 [INFO] - Declaring custom model
[37m2024-08-06 06:39:56,781 [INFO] - CatBoost Classifier Imported successfully
[37m2024-08-06 06:39:56,787 [INFO] - Cross validation set to False
[37m2024-08-06 06:39:56,791 [INFO] - Fitting Model
[37m2024-08-06 06:40:06,325 [INFO] - Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                                    transformer=SimpleImputer(add_indicator=False,
                                                              copy=True,
                                                              fill_value=None,
                                                              keep_empty_features=False,
                                                              missing_values=nan,
                                                              strategy='most_frequent'))),
                ('clean_column_names',
                 TransformerWrapper(exclude=None, include=None,
                                    transformer=CleanColumnNames(match='[\\]\\[\\,\\{\\}\\"\\:]+'))),
                ('actual_estimator',
                 <catboost.core.CatBoostClassifier object at 0x7f6b9c20f390>)],
         verbose=False)
[37m2024-08-06 06:40:06,325 [INFO] - create_model() successfully completed......................................
[37m2024-08-06 06:40:06,657 [INFO] - _master_model_container: 4
[37m2024-08-06 06:40:06,657 [INFO] - _display_container: 6
[37m2024-08-06 06:40:06,667 [INFO] - Pipeline(memory=Memory(location=None),
         steps=[('numerical_imputer',
                 TransformerWrapper(exclude=None,
                                    include=['Color - nuclei - Grey_mean',
                                             'Color - nuclei - Grey_std',
                                             'Color - nuclei - Grey_min',
                                             'Color - nuclei - Grey_max',
                                             'Color - nuclei - R_mean',
                                             'Color - nuclei - G_mean',
                                             'Color - nuclei - B_mean',
                                             'Color - nuclei - R_std',
                                             'Color - nuclei - G_std',
                                             'Color - nuclei - B_std',
                                             'Color - nuclei - R_m...
                                    transformer=SimpleImputer(add_indicator=False,
                                                              copy=True,
                                                              fill_value=None,
                                                              keep_empty_features=False,
                                                              missing_values=nan,
                                                              strategy='most_frequent'))),
                ('clean_column_names',
                 TransformerWrapper(exclude=None, include=None,
                                    transformer=CleanColumnNames(match='[\\]\\[\\,\\{\\}\\"\\:]+'))),
                ('actual_estimator',
                 <catboost.core.CatBoostClassifier object at 0x7f6b9c20f390>)],
         verbose=False)
[37m2024-08-06 06:40:06,668 [INFO] - finalize_model() successfully completed......................................
[37m2024-08-06 06:40:07,060 [INFO] - Initializing predict_model()
[37m2024-08-06 06:40:07,061 [INFO] - predict_model(self=<pycaret.classification.oop.ClassificationExperiment object at 0x7f6c00a50fd0>, estimator=<catboost.core.CatBoostClassifier object at 0x7f6b9c2914d0>, probability_threshold=None, encoded_labels=False, raw_score=False, round=4, verbose=True, ml_usecase=None, preprocess=True, encode_labels=<function _SupervisedExperiment.predict_model.<locals>.encode_labels at 0x7f6bb417cd60>)
[37m2024-08-06 06:40:07,067 [INFO] - Checking exceptions
[37m2024-08-06 06:40:07,072 [INFO] - Preloading libraries
[37m2024-08-06 06:40:07,077 [INFO] - Set up data.
[37m2024-08-06 06:40:07,427 [INFO] - Set up index.
[37m2024-08-06 06:40:08,531 [INFO] - Scores on Val-set after tuning
                 Model  Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0  CatBoost Classifier    0.7751  0.9389  0.7751  0.7626  0.7639  0.6592  0.6602
[37m2024-08-06 06:40:08,531 [INFO] - Shap.....
[37m2024-08-06 06:40:25,713 [INFO] - Shap: neutrophil
[37m2024-08-06 06:41:05,317 [INFO] - Shap: epithelial
[37m2024-08-06 06:41:42,948 [INFO] - Shap: lymphocyte
[37m2024-08-06 06:42:20,721 [INFO] - Shap: plasma
[37m2024-08-06 06:43:00,088 [INFO] - Shap: eosinophil
[37m2024-08-06 06:43:38,147 [INFO] - Shap: connective tissue
