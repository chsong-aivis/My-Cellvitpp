[37m2024-06-25 12:00:28,280 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 12:00:28,282 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/SAM-H/Amount/No-Aug/25/2024-06-25T120018_CellViT-SAM-H-25Percent
[37m2024-06-25 12:00:28,349 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f6a8e1b04f0>]
[37m2024-06-25 12:00:28,350 [INFO] - Using GPU: cuda:0
[37m2024-06-25 12:00:28,355 [INFO] - Using device: cuda:0
[37m2024-06-25 12:00:28,360 [INFO] - Loss function:
[37m2024-06-25 12:00:28,365 [INFO] - CrossEntropyLoss()
[37m2024-06-25 12:00:48,271 [INFO] - <All keys matched successfully>
[37m2024-06-25 12:00:49,609 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  327,936
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 328,450
Trainable params: 328,450
Non-trainable params: 0
Total mult-adds (M): 0.33
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 1.31
Estimated Total Size (MB): 1.32
==========================================================================================
[37m2024-06-25 12:00:49,611 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 12:00:49,614 [INFO] - {'lr': 0.000454128407501709, 'betas': [0.85, 0.9], 'weight_decay': 0.00021428574971482908}
[37m2024-06-25 12:00:49,619 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 12:00:49,642 [INFO] - Caching datasets
[37m2024-06-25 12:00:52,531 [INFO] - Instantiate Trainer
[37m2024-06-25 12:00:52,537 [INFO] - Calling Trainer Fit
[37m2024-06-25 12:00:52,538 [INFO] - Dataset is cached after first epoch
[37m2024-06-25 12:00:52,543 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 12:00:52,548 [INFO] - Epoch: 1/50
[37m2024-06-25 12:00:55,905 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/98aff16822274d728ede53dfaf5291aa3969ee77ecca39dba7efb4b5a443f002.h5
[37m2024-06-25 12:00:56,755 [INFO] - Training epoch stats:     Loss: 0.2801 - F1-Score: 0.9065 - Accuracy-Score: 0.8790 - AUROC: 0.9470 - AP: 0.9691
[37m2024-06-25 12:01:00,998 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/9ff11b1b2a6bd112bf58be22b2a4e8e5324b0fa345815c6cbebb312c75de3bfd.h5
[37m2024-06-25 12:01:01,442 [INFO] - Validation epoch stats:   Loss: 0.3747 - F1-Score: 0.8793 - Accuracy-Score: 0.8433 - AUROC: 0.9142 - AP: 0.9474
[37m2024-06-25 12:01:01,443 [INFO] - New best model - save checkpoint
[37m2024-06-25 12:01:01,855 [INFO] - Epoch: 2/50
[37m2024-06-25 12:01:02,450 [INFO] - Training epoch stats:     Loss: 0.1351 - F1-Score: 0.9583 - Accuracy-Score: 0.9462 - AUROC: 0.9881 - AP: 0.9932
[37m2024-06-25 12:01:02,904 [INFO] - Validation epoch stats:   Loss: 0.3921 - F1-Score: 0.8869 - Accuracy-Score: 0.8520 - AUROC: 0.9199 - AP: 0.9519
[37m2024-06-25 12:01:02,905 [INFO] - New best model - save checkpoint
[37m2024-06-25 12:01:03,340 [INFO] - Epoch: 3/50
[37m2024-06-25 12:01:03,927 [INFO] - Training epoch stats:     Loss: 0.0891 - F1-Score: 0.9738 - Accuracy-Score: 0.9663 - AUROC: 0.9951 - AP: 0.9972
[37m2024-06-25 12:01:04,376 [INFO] - Validation epoch stats:   Loss: 0.4199 - F1-Score: 0.8814 - Accuracy-Score: 0.8465 - AUROC: 0.9151 - AP: 0.9471
[37m2024-06-25 12:01:04,622 [INFO] - Epoch: 4/50
[37m2024-06-25 12:01:05,192 [INFO] - Training epoch stats:     Loss: 0.0621 - F1-Score: 0.9839 - Accuracy-Score: 0.9792 - AUROC: 0.9977 - AP: 0.9987
[37m2024-06-25 12:01:05,645 [INFO] - Validation epoch stats:   Loss: 0.4604 - F1-Score: 0.8732 - Accuracy-Score: 0.8395 - AUROC: 0.9163 - AP: 0.9494
[37m2024-06-25 12:01:05,824 [INFO] - Epoch: 5/50
[37m2024-06-25 12:01:06,407 [INFO] - Training epoch stats:     Loss: 0.0446 - F1-Score: 0.9895 - Accuracy-Score: 0.9866 - AUROC: 0.9990 - AP: 0.9994
[37m2024-06-25 12:01:06,834 [INFO] - Validation epoch stats:   Loss: 0.4834 - F1-Score: 0.8822 - Accuracy-Score: 0.8492 - AUROC: 0.9204 - AP: 0.9508
[37m2024-06-25 12:01:06,835 [INFO] - New best model - save checkpoint
[37m2024-06-25 12:01:07,359 [INFO] - Epoch: 6/50
[37m2024-06-25 12:01:07,937 [INFO] - Training epoch stats:     Loss: 0.0291 - F1-Score: 0.9937 - Accuracy-Score: 0.9919 - AUROC: 0.9997 - AP: 0.9998
[37m2024-06-25 12:01:08,364 [INFO] - Validation epoch stats:   Loss: 0.5392 - F1-Score: 0.8681 - Accuracy-Score: 0.8351 - AUROC: 0.9139 - AP: 0.9451
[37m2024-06-25 12:01:08,582 [INFO] - Epoch: 7/50
[37m2024-06-25 12:01:09,283 [INFO] - Training epoch stats:     Loss: 0.0215 - F1-Score: 0.9955 - Accuracy-Score: 0.9942 - AUROC: 0.9998 - AP: 0.9999
[37m2024-06-25 12:01:09,704 [INFO] - Validation epoch stats:   Loss: 0.6018 - F1-Score: 0.8679 - Accuracy-Score: 0.8339 - AUROC: 0.9108 - AP: 0.9431
[37m2024-06-25 12:01:09,924 [INFO] - Epoch: 8/50
[37m2024-06-25 12:01:10,528 [INFO] - Training epoch stats:     Loss: 0.0159 - F1-Score: 0.9969 - Accuracy-Score: 0.9960 - AUROC: 0.9999 - AP: 1.0000
[37m2024-06-25 12:01:10,949 [INFO] - Validation epoch stats:   Loss: 0.6326 - F1-Score: 0.8648 - Accuracy-Score: 0.8316 - AUROC: 0.9126 - AP: 0.9444
[37m2024-06-25 12:01:11,146 [INFO] - Epoch: 9/50
[37m2024-06-25 12:01:11,736 [INFO] - Training epoch stats:     Loss: 0.0110 - F1-Score: 0.9983 - Accuracy-Score: 0.9978 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-25 12:01:12,170 [INFO] - Validation epoch stats:   Loss: 0.6378 - F1-Score: 0.8679 - Accuracy-Score: 0.8335 - AUROC: 0.9103 - AP: 0.9417
[37m2024-06-25 12:01:12,346 [INFO] - Epoch: 10/50
[37m2024-06-25 12:01:13,293 [INFO] - Training epoch stats:     Loss: 0.0072 - F1-Score: 0.9991 - Accuracy-Score: 0.9989 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-25 12:01:13,730 [INFO] - Validation epoch stats:   Loss: 0.6834 - F1-Score: 0.8812 - Accuracy-Score: 0.8449 - AUROC: 0.9121 - AP: 0.9383
[37m2024-06-25 12:01:13,935 [INFO] - Epoch: 11/50
[37m2024-06-25 12:01:14,860 [INFO] - Training epoch stats:     Loss: 0.0063 - F1-Score: 0.9991 - Accuracy-Score: 0.9989 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-25 12:01:15,656 [INFO] - Validation epoch stats:   Loss: 0.7649 - F1-Score: 0.8550 - Accuracy-Score: 0.8224 - AUROC: 0.9081 - AP: 0.9398
[37m2024-06-25 12:01:15,918 [INFO] - Epoch: 12/50
[37m2024-06-25 12:01:17,022 [INFO] - Training epoch stats:     Loss: 0.0043 - F1-Score: 0.9997 - Accuracy-Score: 0.9996 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-25 12:01:17,459 [INFO] - Validation epoch stats:   Loss: 0.7382 - F1-Score: 0.8796 - Accuracy-Score: 0.8434 - AUROC: 0.9099 - AP: 0.9347
[37m2024-06-25 12:01:17,730 [INFO] - Epoch: 13/50
[37m2024-06-25 12:01:18,372 [INFO] - Training epoch stats:     Loss: 0.0035 - F1-Score: 0.9999 - Accuracy-Score: 0.9999 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-25 12:01:18,811 [INFO] - Validation epoch stats:   Loss: 0.7957 - F1-Score: 0.8722 - Accuracy-Score: 0.8370 - AUROC: 0.9042 - AP: 0.9303
[37m2024-06-25 12:01:19,007 [INFO] - Epoch: 14/50
[37m2024-06-25 12:01:20,022 [INFO] - Training epoch stats:     Loss: 0.0022 - F1-Score: 1.0000 - Accuracy-Score: 1.0000 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-25 12:01:20,620 [INFO] - Validation epoch stats:   Loss: 0.8428 - F1-Score: 0.8719 - Accuracy-Score: 0.8371 - AUROC: 0.9058 - AP: 0.9328
[37m2024-06-25 12:01:20,799 [INFO] - Epoch: 15/50
[37m2024-06-25 12:01:21,362 [INFO] - Training epoch stats:     Loss: 0.0021 - F1-Score: 0.9998 - Accuracy-Score: 0.9998 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-25 12:01:21,746 [INFO] - Validation epoch stats:   Loss: 0.8367 - F1-Score: 0.8702 - Accuracy-Score: 0.8366 - AUROC: 0.9100 - AP: 0.9378
[37m2024-06-25 12:01:21,747 [INFO] - Performing early stopping!
[37m2024-06-25 12:01:21,753 [INFO] - Finished run m1d2ft0g
