[37m2024-06-25 12:10:41,128 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 12:10:41,130 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/SAM-H/Amount/Aug/10/2024-06-25T121032_CellViT-SAM-H-10Percent
[37m2024-06-25 12:10:41,199 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fa7299906d0>]
[37m2024-06-25 12:10:41,201 [INFO] - Using GPU: cuda:0
[37m2024-06-25 12:10:41,206 [INFO] - Using device: cuda:0
[37m2024-06-25 12:10:41,211 [INFO] - Loss function:
[37m2024-06-25 12:10:41,216 [INFO] - CrossEntropyLoss()
[37m2024-06-25 12:11:02,958 [INFO] - <All keys matched successfully>
[37m2024-06-25 12:11:07,579 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  327,936
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 328,450
Trainable params: 328,450
Non-trainable params: 0
Total mult-adds (M): 0.33
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 1.31
Estimated Total Size (MB): 1.32
==========================================================================================
[37m2024-06-25 12:11:07,581 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 12:11:07,585 [INFO] - {'lr': 0.000454128407501709, 'betas': [0.85, 0.9], 'weight_decay': 0.00021428574971482908}
[37m2024-06-25 12:11:07,590 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 12:11:07,608 [INFO] - Caching datasets
[37m2024-06-25 12:11:10,541 [INFO] - Instantiate Trainer
[37m2024-06-25 12:11:10,551 [INFO] - Calling Trainer Fit
[37m2024-06-25 12:11:10,552 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 12:11:10,557 [INFO] - Epoch: 1/50
[37m2024-06-25 12:11:10,563 [INFO] - Extracting training cells
[37m2024-06-25 12:11:44,512 [INFO] - Extraction detection metrics - F1: 0.734, Precision: 0.742, Recall: 0.791, Detected-Cells: 5614
[37m2024-06-25 12:11:44,786 [INFO] - Training epoch stats:     Loss: 0.3202 - F1-Score: 0.8854 - Accuracy-Score: 0.8545 - AUROC: 0.9327 - AP: 0.9579
[37m2024-06-25 12:11:49,053 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/9ff11b1b2a6bd112bf58be22b2a4e8e5324b0fa345815c6cbebb312c75de3bfd.h5
[37m2024-06-25 12:11:49,632 [INFO] - Validation epoch stats:   Loss: 0.4448 - F1-Score: 0.8501 - Accuracy-Score: 0.8118 - AUROC: 0.8885 - AP: 0.9302
[37m2024-06-25 12:11:49,633 [INFO] - New best model - save checkpoint
[37m2024-06-25 12:11:49,860 [INFO] - Epoch: 2/50
[37m2024-06-25 12:11:49,861 [INFO] - Extracting training cells
[37m2024-06-25 12:12:16,411 [INFO] - Extraction detection metrics - F1: 0.712, Precision: 0.730, Recall: 0.760, Detected-Cells: 5478
[37m2024-06-25 12:12:16,739 [INFO] - Training epoch stats:     Loss: 0.1892 - F1-Score: 0.9421 - Accuracy-Score: 0.9255 - AUROC: 0.9759 - AP: 0.9829
[37m2024-06-25 12:12:17,329 [INFO] - Validation epoch stats:   Loss: 0.4488 - F1-Score: 0.8586 - Accuracy-Score: 0.8243 - AUROC: 0.9011 - AP: 0.9384
[37m2024-06-25 12:12:17,332 [INFO] - New best model - save checkpoint
[37m2024-06-25 12:12:17,508 [INFO] - Epoch: 3/50
[37m2024-06-25 12:12:17,509 [INFO] - Extracting training cells
[37m2024-06-25 12:12:40,753 [INFO] - Extraction detection metrics - F1: 0.727, Precision: 0.746, Recall: 0.777, Detected-Cells: 5472
[37m2024-06-25 12:12:40,958 [INFO] - Training epoch stats:     Loss: 0.1886 - F1-Score: 0.9404 - Accuracy-Score: 0.9238 - AUROC: 0.9748 - AP: 0.9825
[37m2024-06-25 12:12:41,345 [INFO] - Validation epoch stats:   Loss: 0.4149 - F1-Score: 0.8604 - Accuracy-Score: 0.8245 - AUROC: 0.9022 - AP: 0.9412
[37m2024-06-25 12:12:41,345 [INFO] - New best model - save checkpoint
[37m2024-06-25 12:12:41,546 [INFO] - Epoch: 4/50
[37m2024-06-25 12:12:41,547 [INFO] - Extracting training cells
[37m2024-06-25 12:13:11,232 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.721, Recall: 0.782, Detected-Cells: 5534
[37m2024-06-25 12:13:11,424 [INFO] - Training epoch stats:     Loss: 0.1541 - F1-Score: 0.9556 - Accuracy-Score: 0.9431 - AUROC: 0.9828 - AP: 0.9870
[37m2024-06-25 12:13:11,981 [INFO] - Validation epoch stats:   Loss: 0.5365 - F1-Score: 0.8311 - Accuracy-Score: 0.7997 - AUROC: 0.8959 - AP: 0.9362
[37m2024-06-25 12:13:12,070 [INFO] - Epoch: 5/50
[37m2024-06-25 12:13:12,071 [INFO] - Extracting training cells
[37m2024-06-25 12:13:36,940 [INFO] - Extraction detection metrics - F1: 0.731, Precision: 0.740, Recall: 0.788, Detected-Cells: 5752
[37m2024-06-25 12:13:37,276 [INFO] - Training epoch stats:     Loss: 0.1238 - F1-Score: 0.9621 - Accuracy-Score: 0.9520 - AUROC: 0.9900 - AP: 0.9940
[37m2024-06-25 12:13:37,695 [INFO] - Validation epoch stats:   Loss: 0.5292 - F1-Score: 0.8456 - Accuracy-Score: 0.8138 - AUROC: 0.8986 - AP: 0.9358
[37m2024-06-25 12:13:37,779 [INFO] - Epoch: 6/50
[37m2024-06-25 12:13:37,780 [INFO] - Extracting training cells
[37m2024-06-25 12:14:01,691 [INFO] - Extraction detection metrics - F1: 0.709, Precision: 0.726, Recall: 0.765, Detected-Cells: 5148
[37m2024-06-25 12:14:01,879 [INFO] - Training epoch stats:     Loss: 0.1351 - F1-Score: 0.9580 - Accuracy-Score: 0.9481 - AUROC: 0.9874 - AP: 0.9910
[37m2024-06-25 12:14:02,314 [INFO] - Validation epoch stats:   Loss: 0.5304 - F1-Score: 0.8354 - Accuracy-Score: 0.8018 - AUROC: 0.8915 - AP: 0.9337
[37m2024-06-25 12:14:02,383 [INFO] - Epoch: 7/50
[37m2024-06-25 12:14:02,384 [INFO] - Extracting training cells
[37m2024-06-25 12:14:27,211 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.726, Recall: 0.757, Detected-Cells: 5211
[37m2024-06-25 12:14:27,476 [INFO] - Training epoch stats:     Loss: 0.1308 - F1-Score: 0.9621 - Accuracy-Score: 0.9503 - AUROC: 0.9882 - AP: 0.9929
[37m2024-06-25 12:14:28,176 [INFO] - Validation epoch stats:   Loss: 0.5029 - F1-Score: 0.8463 - Accuracy-Score: 0.8106 - AUROC: 0.8859 - AP: 0.9288
[37m2024-06-25 12:14:28,295 [INFO] - Epoch: 8/50
[37m2024-06-25 12:14:28,297 [INFO] - Extracting training cells
[37m2024-06-25 12:14:53,686 [INFO] - Extraction detection metrics - F1: 0.713, Precision: 0.729, Recall: 0.762, Detected-Cells: 5247
[37m2024-06-25 12:14:53,869 [INFO] - Training epoch stats:     Loss: 0.1449 - F1-Score: 0.9555 - Accuracy-Score: 0.9413 - AUROC: 0.9854 - AP: 0.9922
[37m2024-06-25 12:14:54,312 [INFO] - Validation epoch stats:   Loss: 0.5231 - F1-Score: 0.8343 - Accuracy-Score: 0.8001 - AUROC: 0.8839 - AP: 0.9263
[37m2024-06-25 12:14:54,420 [INFO] - Epoch: 9/50
[37m2024-06-25 12:14:54,421 [INFO] - Extracting training cells
[37m2024-06-25 12:15:19,132 [INFO] - Extraction detection metrics - F1: 0.717, Precision: 0.723, Recall: 0.777, Detected-Cells: 5321
[37m2024-06-25 12:15:19,443 [INFO] - Training epoch stats:     Loss: 0.1077 - F1-Score: 0.9669 - Accuracy-Score: 0.9583 - AUROC: 0.9923 - AP: 0.9951
[37m2024-06-25 12:15:19,947 [INFO] - Validation epoch stats:   Loss: 0.6024 - F1-Score: 0.8256 - Accuracy-Score: 0.7966 - AUROC: 0.8967 - AP: 0.9341
[37m2024-06-25 12:15:20,027 [INFO] - Epoch: 10/50
[37m2024-06-25 12:15:20,027 [INFO] - Extracting training cells
[37m2024-06-25 12:15:43,576 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.731, Recall: 0.766, Detected-Cells: 5419
[37m2024-06-25 12:15:43,781 [INFO] - Training epoch stats:     Loss: 0.1336 - F1-Score: 0.9633 - Accuracy-Score: 0.9524 - AUROC: 0.9885 - AP: 0.9933
[37m2024-06-25 12:15:44,261 [INFO] - Validation epoch stats:   Loss: 0.6306 - F1-Score: 0.7948 - Accuracy-Score: 0.7662 - AUROC: 0.8792 - AP: 0.9231
[37m2024-06-25 12:15:44,339 [INFO] - Epoch: 11/50
[37m2024-06-25 12:15:44,339 [INFO] - Extracting training cells
[37m2024-06-25 12:16:08,876 [INFO] - Extraction detection metrics - F1: 0.721, Precision: 0.734, Recall: 0.773, Detected-Cells: 5618
[37m2024-06-25 12:16:09,221 [INFO] - Training epoch stats:     Loss: 0.0877 - F1-Score: 0.9735 - Accuracy-Score: 0.9662 - AUROC: 0.9955 - AP: 0.9975
[37m2024-06-25 12:16:10,156 [INFO] - Validation epoch stats:   Loss: 0.6144 - F1-Score: 0.8297 - Accuracy-Score: 0.7988 - AUROC: 0.8927 - AP: 0.9303
[37m2024-06-25 12:16:10,259 [INFO] - Epoch: 12/50
[37m2024-06-25 12:16:10,259 [INFO] - Extracting training cells
[37m2024-06-25 12:16:34,282 [INFO] - Extraction detection metrics - F1: 0.713, Precision: 0.724, Recall: 0.766, Detected-Cells: 5267
[37m2024-06-25 12:16:34,474 [INFO] - Training epoch stats:     Loss: 0.0900 - F1-Score: 0.9724 - Accuracy-Score: 0.9664 - AUROC: 0.9946 - AP: 0.9964
[37m2024-06-25 12:16:34,855 [INFO] - Validation epoch stats:   Loss: 0.5646 - F1-Score: 0.8377 - Accuracy-Score: 0.8070 - AUROC: 0.8993 - AP: 0.9337
[37m2024-06-25 12:16:34,930 [INFO] - Epoch: 13/50
[37m2024-06-25 12:16:34,930 [INFO] - Extracting training cells
[37m2024-06-25 12:17:00,110 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.735, Recall: 0.767, Detected-Cells: 5441
[37m2024-06-25 12:17:00,413 [INFO] - Training epoch stats:     Loss: 0.1073 - F1-Score: 0.9704 - Accuracy-Score: 0.9621 - AUROC: 0.9915 - AP: 0.9938
[37m2024-06-25 12:17:00,748 [INFO] - Validation epoch stats:   Loss: 0.5365 - F1-Score: 0.8482 - Accuracy-Score: 0.8144 - AUROC: 0.8956 - AP: 0.9334
[37m2024-06-25 12:17:00,749 [INFO] - Performing early stopping!
[37m2024-06-25 12:17:00,754 [INFO] - Finished run cwdcgt7b
