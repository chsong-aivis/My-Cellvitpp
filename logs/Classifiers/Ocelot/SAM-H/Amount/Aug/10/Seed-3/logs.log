[37m2024-06-24 15:36:22,022 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-24 15:36:22,023 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/SAM-H/Amount/Aug/10/2024-06-24T153612_CellViT-SAM-H-10Percent
[37m2024-06-24 15:36:22,087 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f848296c6a0>]
[37m2024-06-24 15:36:22,088 [INFO] - Using GPU: cuda:0
[37m2024-06-24 15:36:22,094 [INFO] - Using device: cuda:0
[37m2024-06-24 15:36:22,099 [INFO] - Loss function:
[37m2024-06-24 15:36:22,104 [INFO] - CrossEntropyLoss()
[37m2024-06-24 15:36:41,666 [INFO] - <All keys matched successfully>
[37m2024-06-24 15:36:43,615 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  327,936
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 328,450
Trainable params: 328,450
Non-trainable params: 0
Total mult-adds (M): 0.33
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 1.31
Estimated Total Size (MB): 1.32
==========================================================================================
[37m2024-06-24 15:36:43,618 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-24 15:36:43,622 [INFO] - {'lr': 0.000454128407501709, 'betas': [0.85, 0.9], 'weight_decay': 0.00021428574971482908}
[37m2024-06-24 15:36:43,627 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-24 15:36:43,645 [INFO] - Caching datasets
[37m2024-06-24 15:36:45,647 [INFO] - Instantiate Trainer
[37m2024-06-24 15:36:45,652 [INFO] - Calling Trainer Fit
[37m2024-06-24 15:36:45,653 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-24 15:36:45,658 [INFO] - Epoch: 1/50
[37m2024-06-24 15:36:45,663 [INFO] - Extracting training cells
[37m2024-06-24 15:37:17,628 [INFO] - Extraction detection metrics - F1: 0.721, Precision: 0.738, Recall: 0.770, Detected-Cells: 5613
[37m2024-06-24 15:37:17,899 [INFO] - Training epoch stats:     Loss: 0.3361 - F1-Score: 0.8797 - Accuracy-Score: 0.8475 - AUROC: 0.9254 - AP: 0.9530
[37m2024-06-24 15:37:22,190 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/9ff11b1b2a6bd112bf58be22b2a4e8e5324b0fa345815c6cbebb312c75de3bfd.h5
[37m2024-06-24 15:37:22,546 [INFO] - Validation epoch stats:   Loss: 0.4527 - F1-Score: 0.8494 - Accuracy-Score: 0.8090 - AUROC: 0.8845 - AP: 0.9361
[37m2024-06-24 15:37:22,547 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:37:22,803 [INFO] - Epoch: 2/50
[37m2024-06-24 15:37:22,804 [INFO] - Extracting training cells
[37m2024-06-24 15:37:45,047 [INFO] - Extraction detection metrics - F1: 0.722, Precision: 0.732, Recall: 0.774, Detected-Cells: 5406
[37m2024-06-24 15:37:45,242 [INFO] - Training epoch stats:     Loss: 0.1989 - F1-Score: 0.9328 - Accuracy-Score: 0.9173 - AUROC: 0.9734 - AP: 0.9812
[37m2024-06-24 15:37:45,630 [INFO] - Validation epoch stats:   Loss: 0.4482 - F1-Score: 0.8523 - Accuracy-Score: 0.8160 - AUROC: 0.8932 - AP: 0.9368
[37m2024-06-24 15:37:45,631 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:37:45,859 [INFO] - Epoch: 3/50
[37m2024-06-24 15:37:45,860 [INFO] - Extracting training cells
[37m2024-06-24 15:38:08,268 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.724, Recall: 0.764, Detected-Cells: 5466
[37m2024-06-24 15:38:08,471 [INFO] - Training epoch stats:     Loss: 0.1579 - F1-Score: 0.9487 - Accuracy-Score: 0.9351 - AUROC: 0.9836 - AP: 0.9886
[37m2024-06-24 15:38:08,857 [INFO] - Validation epoch stats:   Loss: 0.4665 - F1-Score: 0.8497 - Accuracy-Score: 0.8176 - AUROC: 0.9004 - AP: 0.9394
[37m2024-06-24 15:38:08,858 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:38:09,064 [INFO] - Epoch: 4/50
[37m2024-06-24 15:38:09,064 [INFO] - Extracting training cells
[37m2024-06-24 15:38:30,478 [INFO] - Extraction detection metrics - F1: 0.724, Precision: 0.740, Recall: 0.773, Detected-Cells: 5367
[37m2024-06-24 15:38:30,679 [INFO] - Training epoch stats:     Loss: 0.1421 - F1-Score: 0.9594 - Accuracy-Score: 0.9484 - AUROC: 0.9862 - AP: 0.9895
[37m2024-06-24 15:38:31,056 [INFO] - Validation epoch stats:   Loss: 0.4350 - F1-Score: 0.8679 - Accuracy-Score: 0.8349 - AUROC: 0.9057 - AP: 0.9419
[37m2024-06-24 15:38:31,057 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:38:31,275 [INFO] - Epoch: 5/50
[37m2024-06-24 15:38:31,276 [INFO] - Extracting training cells
[37m2024-06-24 15:38:52,484 [INFO] - Extraction detection metrics - F1: 0.730, Precision: 0.738, Recall: 0.787, Detected-Cells: 5699
[37m2024-06-24 15:38:52,714 [INFO] - Training epoch stats:     Loss: 0.1179 - F1-Score: 0.9620 - Accuracy-Score: 0.9521 - AUROC: 0.9909 - AP: 0.9948
[37m2024-06-24 15:38:53,089 [INFO] - Validation epoch stats:   Loss: 0.4877 - F1-Score: 0.8536 - Accuracy-Score: 0.8202 - AUROC: 0.8971 - AP: 0.9359
[37m2024-06-24 15:38:53,206 [INFO] - Epoch: 6/50
[37m2024-06-24 15:38:53,207 [INFO] - Extracting training cells
[37m2024-06-24 15:39:15,052 [INFO] - Extraction detection metrics - F1: 0.729, Precision: 0.742, Recall: 0.785, Detected-Cells: 5551
[37m2024-06-24 15:39:15,268 [INFO] - Training epoch stats:     Loss: 0.1345 - F1-Score: 0.9607 - Accuracy-Score: 0.9501 - AUROC: 0.9870 - AP: 0.9915
[37m2024-06-24 15:39:15,653 [INFO] - Validation epoch stats:   Loss: 0.4670 - F1-Score: 0.8416 - Accuracy-Score: 0.8067 - AUROC: 0.8921 - AP: 0.9342
[37m2024-06-24 15:39:15,747 [INFO] - Epoch: 7/50
[37m2024-06-24 15:39:15,748 [INFO] - Extracting training cells
[37m2024-06-24 15:39:40,648 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.735, Recall: 0.780, Detected-Cells: 5512
[37m2024-06-24 15:39:41,112 [INFO] - Training epoch stats:     Loss: 0.1169 - F1-Score: 0.9654 - Accuracy-Score: 0.9563 - AUROC: 0.9902 - AP: 0.9939
[37m2024-06-24 15:39:41,487 [INFO] - Validation epoch stats:   Loss: 0.4755 - F1-Score: 0.8558 - Accuracy-Score: 0.8207 - AUROC: 0.8981 - AP: 0.9382
[37m2024-06-24 15:39:41,584 [INFO] - Epoch: 8/50
[37m2024-06-24 15:39:41,585 [INFO] - Extracting training cells
[37m2024-06-24 15:40:03,396 [INFO] - Extraction detection metrics - F1: 0.726, Precision: 0.735, Recall: 0.784, Detected-Cells: 5203
[37m2024-06-24 15:40:03,584 [INFO] - Training epoch stats:     Loss: 0.1452 - F1-Score: 0.9591 - Accuracy-Score: 0.9495 - AUROC: 0.9837 - AP: 0.9870
[37m2024-06-24 15:40:03,966 [INFO] - Validation epoch stats:   Loss: 0.4778 - F1-Score: 0.8480 - Accuracy-Score: 0.8147 - AUROC: 0.8972 - AP: 0.9376
[37m2024-06-24 15:40:04,045 [INFO] - Epoch: 9/50
[37m2024-06-24 15:40:04,046 [INFO] - Extracting training cells
[37m2024-06-24 15:40:27,110 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.719, Recall: 0.768, Detected-Cells: 5460
[37m2024-06-24 15:40:27,313 [INFO] - Training epoch stats:     Loss: 0.1068 - F1-Score: 0.9676 - Accuracy-Score: 0.9588 - AUROC: 0.9925 - AP: 0.9957
[37m2024-06-24 15:40:27,906 [INFO] - Validation epoch stats:   Loss: 0.4950 - F1-Score: 0.8531 - Accuracy-Score: 0.8152 - AUROC: 0.8911 - AP: 0.9348
[37m2024-06-24 15:40:27,986 [INFO] - Epoch: 10/50
[37m2024-06-24 15:40:27,987 [INFO] - Extracting training cells
[37m2024-06-24 15:40:50,508 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.722, Recall: 0.757, Detected-Cells: 5227
[37m2024-06-24 15:40:50,695 [INFO] - Training epoch stats:     Loss: 0.0978 - F1-Score: 0.9721 - Accuracy-Score: 0.9642 - AUROC: 0.9932 - AP: 0.9960
[37m2024-06-24 15:40:51,076 [INFO] - Validation epoch stats:   Loss: 0.5329 - F1-Score: 0.8435 - Accuracy-Score: 0.8096 - AUROC: 0.8958 - AP: 0.9366
[37m2024-06-24 15:40:51,156 [INFO] - Epoch: 11/50
[37m2024-06-24 15:40:51,157 [INFO] - Extracting training cells
[37m2024-06-24 15:41:14,220 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.725, Recall: 0.772, Detected-Cells: 5541
[37m2024-06-24 15:41:14,432 [INFO] - Training epoch stats:     Loss: 0.0811 - F1-Score: 0.9751 - Accuracy-Score: 0.9688 - AUROC: 0.9956 - AP: 0.9973
[37m2024-06-24 15:41:14,827 [INFO] - Validation epoch stats:   Loss: 0.5877 - F1-Score: 0.8288 - Accuracy-Score: 0.7918 - AUROC: 0.8793 - AP: 0.9271
[37m2024-06-24 15:41:14,910 [INFO] - Epoch: 12/50
[37m2024-06-24 15:41:14,911 [INFO] - Extracting training cells
[37m2024-06-24 15:41:36,752 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.727, Recall: 0.763, Detected-Cells: 5266
[37m2024-06-24 15:41:36,961 [INFO] - Training epoch stats:     Loss: 0.0849 - F1-Score: 0.9778 - Accuracy-Score: 0.9715 - AUROC: 0.9943 - AP: 0.9959
[37m2024-06-24 15:41:37,280 [INFO] - Validation epoch stats:   Loss: 0.6066 - F1-Score: 0.8218 - Accuracy-Score: 0.7909 - AUROC: 0.8902 - AP: 0.9339
[37m2024-06-24 15:41:37,359 [INFO] - Epoch: 13/50
[37m2024-06-24 15:41:37,360 [INFO] - Extracting training cells
[37m2024-06-24 15:41:59,870 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.741, Recall: 0.777, Detected-Cells: 5625
[37m2024-06-24 15:42:00,098 [INFO] - Training epoch stats:     Loss: 0.0873 - F1-Score: 0.9742 - Accuracy-Score: 0.9676 - AUROC: 0.9948 - AP: 0.9969
[37m2024-06-24 15:42:00,485 [INFO] - Validation epoch stats:   Loss: 0.6128 - F1-Score: 0.8244 - Accuracy-Score: 0.7906 - AUROC: 0.8823 - AP: 0.9286
[37m2024-06-24 15:42:00,581 [INFO] - Epoch: 14/50
[37m2024-06-24 15:42:00,582 [INFO] - Extracting training cells
[37m2024-06-24 15:42:21,755 [INFO] - Extraction detection metrics - F1: 0.728, Precision: 0.750, Recall: 0.776, Detected-Cells: 5584
[37m2024-06-24 15:42:21,959 [INFO] - Training epoch stats:     Loss: 0.0696 - F1-Score: 0.9804 - Accuracy-Score: 0.9755 - AUROC: 0.9967 - AP: 0.9977
[37m2024-06-24 15:42:22,336 [INFO] - Validation epoch stats:   Loss: 0.6466 - F1-Score: 0.8295 - Accuracy-Score: 0.7950 - AUROC: 0.8824 - AP: 0.9282
[37m2024-06-24 15:42:22,337 [INFO] - Performing early stopping!
[37m2024-06-24 15:42:22,342 [INFO] - Finished run 8bb99wzf
