[37m2024-06-21 12:53:57,987 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-21 12:53:57,989 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/SAM-H/Amount/Aug/10/2024-06-21T125344_CellViT-SAM-H-10Percent
[37m2024-06-21 12:53:58,079 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f8d839545b0>]
[37m2024-06-21 12:53:58,084 [INFO] - Using GPU: cuda:0
[37m2024-06-21 12:53:58,088 [INFO] - Using device: cuda:0
[37m2024-06-21 12:53:58,093 [INFO] - Loss function:
[37m2024-06-21 12:53:58,097 [INFO] - CrossEntropyLoss()
[37m2024-06-21 12:54:21,577 [INFO] - <All keys matched successfully>
[37m2024-06-21 12:54:24,077 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  327,936
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 328,450
Trainable params: 328,450
Non-trainable params: 0
Total mult-adds (M): 0.33
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 1.31
Estimated Total Size (MB): 1.32
==========================================================================================
[37m2024-06-21 12:54:24,084 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-21 12:54:24,089 [INFO] - {'lr': 0.000454128407501709, 'betas': [0.85, 0.9], 'weight_decay': 0.00021428574971482908}
[37m2024-06-21 12:54:24,094 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-21 12:54:24,113 [INFO] - Caching datasets
[37m2024-06-21 12:54:26,482 [INFO] - Instantiate Trainer
[37m2024-06-21 12:54:26,496 [INFO] - Calling Trainer Fit
[37m2024-06-21 12:54:26,506 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-21 12:54:26,513 [INFO] - Epoch: 1/50
[37m2024-06-21 12:54:26,520 [INFO] - Extracting training cells
[37m2024-06-21 12:54:58,106 [INFO] - Extraction detection metrics - F1: 0.723, Precision: 0.733, Recall: 0.780, Detected-Cells: 5446
[37m2024-06-21 12:54:58,406 [INFO] - Training epoch stats:     Loss: 0.3021 - F1-Score: 0.8886 - Accuracy-Score: 0.8581 - AUROC: 0.9390 - AP: 0.9626
[37m2024-06-21 12:55:02,653 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/9ff11b1b2a6bd112bf58be22b2a4e8e5324b0fa345815c6cbebb312c75de3bfd.h5
[37m2024-06-21 12:55:03,041 [INFO] - Validation epoch stats:   Loss: 0.4368 - F1-Score: 0.8532 - Accuracy-Score: 0.8145 - AUROC: 0.8920 - AP: 0.9365
[37m2024-06-21 12:55:03,047 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:55:03,258 [INFO] - Epoch: 2/50
[37m2024-06-21 12:55:03,263 [INFO] - Extracting training cells
[37m2024-06-21 12:55:27,115 [INFO] - Extraction detection metrics - F1: 0.723, Precision: 0.736, Recall: 0.775, Detected-Cells: 5312
[37m2024-06-21 12:55:27,313 [INFO] - Training epoch stats:     Loss: 0.1956 - F1-Score: 0.9349 - Accuracy-Score: 0.9181 - AUROC: 0.9742 - AP: 0.9821
[37m2024-06-21 12:55:27,733 [INFO] - Validation epoch stats:   Loss: 0.4601 - F1-Score: 0.8525 - Accuracy-Score: 0.8089 - AUROC: 0.8828 - AP: 0.9291
[37m2024-06-21 12:55:27,837 [INFO] - Epoch: 3/50
[37m2024-06-21 12:55:27,842 [INFO] - Extracting training cells
[37m2024-06-21 12:55:53,221 [INFO] - Extraction detection metrics - F1: 0.714, Precision: 0.724, Recall: 0.768, Detected-Cells: 5334
[37m2024-06-21 12:55:53,432 [INFO] - Training epoch stats:     Loss: 0.1892 - F1-Score: 0.9390 - Accuracy-Score: 0.9250 - AUROC: 0.9760 - AP: 0.9827
[37m2024-06-21 12:55:53,854 [INFO] - Validation epoch stats:   Loss: 0.4732 - F1-Score: 0.8369 - Accuracy-Score: 0.8064 - AUROC: 0.9008 - AP: 0.9401
[37m2024-06-21 12:55:53,861 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:55:54,088 [INFO] - Epoch: 4/50
[37m2024-06-21 12:55:54,094 [INFO] - Extracting training cells
[37m2024-06-21 12:56:16,863 [INFO] - Extraction detection metrics - F1: 0.717, Precision: 0.736, Recall: 0.773, Detected-Cells: 5417
[37m2024-06-21 12:56:17,091 [INFO] - Training epoch stats:     Loss: 0.1821 - F1-Score: 0.9469 - Accuracy-Score: 0.9324 - AUROC: 0.9793 - AP: 0.9853
[37m2024-06-21 12:56:17,513 [INFO] - Validation epoch stats:   Loss: 0.4211 - F1-Score: 0.8675 - Accuracy-Score: 0.8291 - AUROC: 0.9013 - AP: 0.9392
[37m2024-06-21 12:56:17,519 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:56:17,733 [INFO] - Epoch: 5/50
[37m2024-06-21 12:56:17,740 [INFO] - Extracting training cells
[37m2024-06-21 12:56:43,064 [INFO] - Extraction detection metrics - F1: 0.698, Precision: 0.712, Recall: 0.768, Detected-Cells: 4978
[37m2024-06-21 12:56:43,275 [INFO] - Training epoch stats:     Loss: 0.1759 - F1-Score: 0.9441 - Accuracy-Score: 0.9261 - AUROC: 0.9776 - AP: 0.9849
[37m2024-06-21 12:56:43,726 [INFO] - Validation epoch stats:   Loss: 0.4419 - F1-Score: 0.8482 - Accuracy-Score: 0.8103 - AUROC: 0.8900 - AP: 0.9332
[37m2024-06-21 12:56:43,813 [INFO] - Epoch: 6/50
[37m2024-06-21 12:56:43,818 [INFO] - Extracting training cells
[37m2024-06-21 12:57:06,576 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.725, Recall: 0.772, Detected-Cells: 5509
[37m2024-06-21 12:57:06,787 [INFO] - Training epoch stats:     Loss: 0.1466 - F1-Score: 0.9576 - Accuracy-Score: 0.9454 - AUROC: 0.9857 - AP: 0.9922
[37m2024-06-21 12:57:07,189 [INFO] - Validation epoch stats:   Loss: 0.4441 - F1-Score: 0.8664 - Accuracy-Score: 0.8287 - AUROC: 0.9001 - AP: 0.9365
[37m2024-06-21 12:57:07,276 [INFO] - Epoch: 7/50
[37m2024-06-21 12:57:07,281 [INFO] - Extracting training cells
[37m2024-06-21 12:57:32,873 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.734, Recall: 0.765, Detected-Cells: 5635
[37m2024-06-21 12:57:33,123 [INFO] - Training epoch stats:     Loss: 0.1540 - F1-Score: 0.9621 - Accuracy-Score: 0.9514 - AUROC: 0.9908 - AP: 0.9949
[37m2024-06-21 12:57:34,177 [INFO] - Validation epoch stats:   Loss: 0.4988 - F1-Score: 0.8525 - Accuracy-Score: 0.8196 - AUROC: 0.8983 - AP: 0.9364
[37m2024-06-21 12:57:34,259 [INFO] - Epoch: 8/50
[37m2024-06-21 12:57:34,265 [INFO] - Extracting training cells
[37m2024-06-21 12:57:55,526 [INFO] - Extraction detection metrics - F1: 0.710, Precision: 0.720, Recall: 0.772, Detected-Cells: 5011
[37m2024-06-21 12:57:55,704 [INFO] - Training epoch stats:     Loss: 0.1324 - F1-Score: 0.9623 - Accuracy-Score: 0.9511 - AUROC: 0.9871 - AP: 0.9920
[37m2024-06-21 12:57:56,366 [INFO] - Validation epoch stats:   Loss: 0.5485 - F1-Score: 0.8308 - Accuracy-Score: 0.7960 - AUROC: 0.8838 - AP: 0.9284
[37m2024-06-21 12:57:56,451 [INFO] - Epoch: 9/50
[37m2024-06-21 12:57:56,457 [INFO] - Extracting training cells
[37m2024-06-21 12:58:18,179 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.725, Recall: 0.771, Detected-Cells: 5121
[37m2024-06-21 12:58:18,466 [INFO] - Training epoch stats:     Loss: 0.1691 - F1-Score: 0.9472 - Accuracy-Score: 0.9340 - AUROC: 0.9783 - AP: 0.9845
[37m2024-06-21 12:58:18,895 [INFO] - Validation epoch stats:   Loss: 0.4928 - F1-Score: 0.8517 - Accuracy-Score: 0.8143 - AUROC: 0.8923 - AP: 0.9341
[37m2024-06-21 12:58:18,964 [INFO] - Epoch: 10/50
[37m2024-06-21 12:58:18,970 [INFO] - Extracting training cells
[37m2024-06-21 12:58:42,055 [INFO] - Extraction detection metrics - F1: 0.708, Precision: 0.722, Recall: 0.764, Detected-Cells: 5181
[37m2024-06-21 12:58:42,223 [INFO] - Training epoch stats:     Loss: 0.1288 - F1-Score: 0.9643 - Accuracy-Score: 0.9541 - AUROC: 0.9878 - AP: 0.9918
[37m2024-06-21 12:58:42,548 [INFO] - Validation epoch stats:   Loss: 0.6019 - F1-Score: 0.8102 - Accuracy-Score: 0.7760 - AUROC: 0.8719 - AP: 0.9224
[37m2024-06-21 12:58:42,631 [INFO] - Epoch: 11/50
[37m2024-06-21 12:58:42,639 [INFO] - Extracting training cells
[37m2024-06-21 12:59:04,022 [INFO] - Extraction detection metrics - F1: 0.720, Precision: 0.732, Recall: 0.775, Detected-Cells: 5150
[37m2024-06-21 12:59:04,218 [INFO] - Training epoch stats:     Loss: 0.1442 - F1-Score: 0.9571 - Accuracy-Score: 0.9466 - AUROC: 0.9845 - AP: 0.9886
[37m2024-06-21 12:59:04,622 [INFO] - Validation epoch stats:   Loss: 0.5497 - F1-Score: 0.8132 - Accuracy-Score: 0.7778 - AUROC: 0.8745 - AP: 0.9246
[37m2024-06-21 12:59:04,695 [INFO] - Epoch: 12/50
[37m2024-06-21 12:59:04,700 [INFO] - Extracting training cells
[37m2024-06-21 12:59:28,559 [INFO] - Extraction detection metrics - F1: 0.734, Precision: 0.741, Recall: 0.792, Detected-Cells: 5388
[37m2024-06-21 12:59:28,743 [INFO] - Training epoch stats:     Loss: 0.1476 - F1-Score: 0.9550 - Accuracy-Score: 0.9414 - AUROC: 0.9825 - AP: 0.9889
[37m2024-06-21 12:59:29,207 [INFO] - Validation epoch stats:   Loss: 0.5107 - F1-Score: 0.8392 - Accuracy-Score: 0.8024 - AUROC: 0.8877 - AP: 0.9313
[37m2024-06-21 12:59:29,290 [INFO] - Epoch: 13/50
[37m2024-06-21 12:59:29,297 [INFO] - Extracting training cells
[37m2024-06-21 12:59:50,224 [INFO] - Extraction detection metrics - F1: 0.726, Precision: 0.738, Recall: 0.774, Detected-Cells: 5579
[37m2024-06-21 12:59:50,450 [INFO] - Training epoch stats:     Loss: 0.1074 - F1-Score: 0.9681 - Accuracy-Score: 0.9591 - AUROC: 0.9916 - AP: 0.9940
[37m2024-06-21 12:59:50,904 [INFO] - Validation epoch stats:   Loss: 0.5632 - F1-Score: 0.8219 - Accuracy-Score: 0.7853 - AUROC: 0.8748 - AP: 0.9246
[37m2024-06-21 12:59:50,988 [INFO] - Epoch: 14/50
[37m2024-06-21 12:59:50,994 [INFO] - Extracting training cells
[37m2024-06-21 13:00:21,966 [INFO] - Extraction detection metrics - F1: 0.733, Precision: 0.743, Recall: 0.785, Detected-Cells: 5492
[37m2024-06-21 13:00:22,150 [INFO] - Training epoch stats:     Loss: 0.1233 - F1-Score: 0.9653 - Accuracy-Score: 0.9556 - AUROC: 0.9883 - AP: 0.9921
[37m2024-06-21 13:00:22,493 [INFO] - Validation epoch stats:   Loss: 0.5533 - F1-Score: 0.8282 - Accuracy-Score: 0.7937 - AUROC: 0.8843 - AP: 0.9294
[37m2024-06-21 13:00:22,499 [INFO] - Performing early stopping!
[37m2024-06-21 13:00:22,505 [INFO] - Finished run mf5ny2i7
