[37m2024-06-25 14:02:55,524 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 14:02:55,526 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/SAM-H/Amount/Aug/100/2024-06-25T140246_CellViT-SAM-H-100Percent
[37m2024-06-25 14:02:55,588 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fc17b768610>]
[37m2024-06-25 14:02:55,588 [INFO] - Using GPU: cuda:0
[37m2024-06-25 14:02:55,593 [INFO] - Using device: cuda:0
[37m2024-06-25 14:02:55,598 [INFO] - Loss function:
[37m2024-06-25 14:02:55,601 [INFO] - CrossEntropyLoss()
[37m2024-06-25 14:03:14,264 [INFO] - <All keys matched successfully>
[37m2024-06-25 14:03:15,813 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  327,936
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 328,450
Trainable params: 328,450
Non-trainable params: 0
Total mult-adds (M): 0.33
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 1.31
Estimated Total Size (MB): 1.32
==========================================================================================
[37m2024-06-25 14:03:15,815 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 14:03:15,820 [INFO] - {'lr': 0.000454128407501709, 'betas': [0.85, 0.9], 'weight_decay': 0.00021428574971482908}
[37m2024-06-25 14:03:15,825 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 14:03:15,846 [INFO] - Caching datasets
[37m2024-06-25 14:03:22,720 [INFO] - Instantiate Trainer
[37m2024-06-25 14:03:22,726 [INFO] - Calling Trainer Fit
[37m2024-06-25 14:03:22,728 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 14:03:22,734 [INFO] - Epoch: 1/50
[37m2024-06-25 14:03:22,740 [INFO] - Extracting training cells
[37m2024-06-25 14:06:08,253 [INFO] - Extraction detection metrics - F1: 0.702, Precision: 0.719, Recall: 0.748, Detected-Cells: 46249
[37m2024-06-25 14:06:09,758 [INFO] - Training epoch stats:     Loss: 0.2619 - F1-Score: 0.9135 - Accuracy-Score: 0.8916 - AUROC: 0.9542 - AP: 0.9682
[37m2024-06-25 14:06:13,908 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/9ff11b1b2a6bd112bf58be22b2a4e8e5324b0fa345815c6cbebb312c75de3bfd.h5
[37m2024-06-25 14:06:14,278 [INFO] - Validation epoch stats:   Loss: 0.3473 - F1-Score: 0.8946 - Accuracy-Score: 0.8610 - AUROC: 0.9282 - AP: 0.9546
[37m2024-06-25 14:06:14,279 [INFO] - New best model - save checkpoint
[37m2024-06-25 14:06:14,557 [INFO] - Epoch: 2/50
[37m2024-06-25 14:06:14,559 [INFO] - Extracting training cells
[37m2024-06-25 14:08:54,640 [INFO] - Extraction detection metrics - F1: 0.705, Precision: 0.720, Recall: 0.750, Detected-Cells: 45961
[37m2024-06-25 14:08:56,373 [INFO] - Training epoch stats:     Loss: 0.1874 - F1-Score: 0.9395 - Accuracy-Score: 0.9245 - AUROC: 0.9766 - AP: 0.9842
[37m2024-06-25 14:08:56,925 [INFO] - Validation epoch stats:   Loss: 0.3687 - F1-Score: 0.8918 - Accuracy-Score: 0.8600 - AUROC: 0.9279 - AP: 0.9557
[37m2024-06-25 14:08:56,997 [INFO] - Epoch: 3/50
[37m2024-06-25 14:08:56,998 [INFO] - Extracting training cells
[37m2024-06-25 14:11:40,874 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.720, Recall: 0.748, Detected-Cells: 46113
[37m2024-06-25 14:11:42,355 [INFO] - Training epoch stats:     Loss: 0.1712 - F1-Score: 0.9446 - Accuracy-Score: 0.9310 - AUROC: 0.9805 - AP: 0.9871
[37m2024-06-25 14:11:42,717 [INFO] - Validation epoch stats:   Loss: 0.4176 - F1-Score: 0.8758 - Accuracy-Score: 0.8420 - AUROC: 0.9129 - AP: 0.9448
[37m2024-06-25 14:11:42,805 [INFO] - Epoch: 4/50
[37m2024-06-25 14:11:42,806 [INFO] - Extracting training cells
[37m2024-06-25 14:14:29,936 [INFO] - Extraction detection metrics - F1: 0.702, Precision: 0.717, Recall: 0.744, Detected-Cells: 45647
[37m2024-06-25 14:14:31,978 [INFO] - Training epoch stats:     Loss: 0.1633 - F1-Score: 0.9484 - Accuracy-Score: 0.9368 - AUROC: 0.9821 - AP: 0.9869
[37m2024-06-25 14:14:32,597 [INFO] - Validation epoch stats:   Loss: 0.3487 - F1-Score: 0.8993 - Accuracy-Score: 0.8710 - AUROC: 0.9392 - AP: 0.9639
[37m2024-06-25 14:14:32,598 [INFO] - New best model - save checkpoint
[37m2024-06-25 14:14:32,832 [INFO] - Epoch: 5/50
[37m2024-06-25 14:14:32,833 [INFO] - Extracting training cells
[37m2024-06-25 14:17:18,648 [INFO] - Extraction detection metrics - F1: 0.710, Precision: 0.723, Recall: 0.754, Detected-Cells: 47460
[37m2024-06-25 14:17:20,468 [INFO] - Training epoch stats:     Loss: 0.1497 - F1-Score: 0.9538 - Accuracy-Score: 0.9425 - AUROC: 0.9848 - AP: 0.9894
[37m2024-06-25 14:17:20,928 [INFO] - Validation epoch stats:   Loss: 0.3768 - F1-Score: 0.8967 - Accuracy-Score: 0.8671 - AUROC: 0.9329 - AP: 0.9576
[37m2024-06-25 14:17:21,018 [INFO] - Epoch: 6/50
[37m2024-06-25 14:17:21,018 [INFO] - Extracting training cells
[37m2024-06-25 14:20:11,042 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.714, Recall: 0.750, Detected-Cells: 46004
[37m2024-06-25 14:20:12,860 [INFO] - Training epoch stats:     Loss: 0.1365 - F1-Score: 0.9566 - Accuracy-Score: 0.9460 - AUROC: 0.9874 - AP: 0.9915
[37m2024-06-25 14:20:13,464 [INFO] - Validation epoch stats:   Loss: 0.4341 - F1-Score: 0.8826 - Accuracy-Score: 0.8519 - AUROC: 0.9242 - AP: 0.9522
[37m2024-06-25 14:20:13,531 [INFO] - Epoch: 7/50
[37m2024-06-25 14:20:13,531 [INFO] - Extracting training cells
[37m2024-06-25 14:23:20,324 [INFO] - Extraction detection metrics - F1: 0.700, Precision: 0.714, Recall: 0.746, Detected-Cells: 46331
[37m2024-06-25 14:23:22,071 [INFO] - Training epoch stats:     Loss: 0.1392 - F1-Score: 0.9568 - Accuracy-Score: 0.9465 - AUROC: 0.9867 - AP: 0.9908
[37m2024-06-25 14:23:22,477 [INFO] - Validation epoch stats:   Loss: 0.3924 - F1-Score: 0.8928 - Accuracy-Score: 0.8634 - AUROC: 0.9304 - AP: 0.9543
[37m2024-06-25 14:23:22,568 [INFO] - Epoch: 8/50
[37m2024-06-25 14:23:22,569 [INFO] - Extracting training cells
[37m2024-06-25 14:26:17,812 [INFO] - Extraction detection metrics - F1: 0.706, Precision: 0.721, Recall: 0.751, Detected-Cells: 46290
[37m2024-06-25 14:26:19,771 [INFO] - Training epoch stats:     Loss: 0.1306 - F1-Score: 0.9590 - Accuracy-Score: 0.9490 - AUROC: 0.9886 - AP: 0.9926
[37m2024-06-25 14:26:20,331 [INFO] - Validation epoch stats:   Loss: 0.4334 - F1-Score: 0.8841 - Accuracy-Score: 0.8521 - AUROC: 0.9225 - AP: 0.9508
[37m2024-06-25 14:26:20,405 [INFO] - Epoch: 9/50
[37m2024-06-25 14:26:20,406 [INFO] - Extracting training cells
[37m2024-06-25 14:29:20,957 [INFO] - Extraction detection metrics - F1: 0.699, Precision: 0.716, Recall: 0.744, Detected-Cells: 45620
[37m2024-06-25 14:29:22,670 [INFO] - Training epoch stats:     Loss: 0.1238 - F1-Score: 0.9625 - Accuracy-Score: 0.9529 - AUROC: 0.9896 - AP: 0.9935
[37m2024-06-25 14:29:23,088 [INFO] - Validation epoch stats:   Loss: 0.4235 - F1-Score: 0.8918 - Accuracy-Score: 0.8623 - AUROC: 0.9289 - AP: 0.9546
[37m2024-06-25 14:29:23,175 [INFO] - Epoch: 10/50
[37m2024-06-25 14:29:23,176 [INFO] - Extracting training cells
[37m2024-06-25 14:32:30,433 [INFO] - Extraction detection metrics - F1: 0.708, Precision: 0.721, Recall: 0.752, Detected-Cells: 46132
[37m2024-06-25 14:32:31,958 [INFO] - Training epoch stats:     Loss: 0.1193 - F1-Score: 0.9625 - Accuracy-Score: 0.9532 - AUROC: 0.9904 - AP: 0.9937
[37m2024-06-25 14:32:32,416 [INFO] - Validation epoch stats:   Loss: 0.4564 - F1-Score: 0.8793 - Accuracy-Score: 0.8504 - AUROC: 0.9261 - AP: 0.9530
[37m2024-06-25 14:32:32,490 [INFO] - Epoch: 11/50
[37m2024-06-25 14:32:32,491 [INFO] - Extracting training cells
[37m2024-06-25 14:35:39,529 [INFO] - Extraction detection metrics - F1: 0.710, Precision: 0.726, Recall: 0.751, Detected-Cells: 46473
[37m2024-06-25 14:35:41,666 [INFO] - Training epoch stats:     Loss: 0.1175 - F1-Score: 0.9632 - Accuracy-Score: 0.9542 - AUROC: 0.9906 - AP: 0.9937
[37m2024-06-25 14:35:42,084 [INFO] - Validation epoch stats:   Loss: 0.4656 - F1-Score: 0.8798 - Accuracy-Score: 0.8502 - AUROC: 0.9232 - AP: 0.9506
[37m2024-06-25 14:35:42,164 [INFO] - Epoch: 12/50
[37m2024-06-25 14:35:42,164 [INFO] - Extracting training cells
[37m2024-06-25 14:38:47,857 [INFO] - Extraction detection metrics - F1: 0.703, Precision: 0.722, Recall: 0.746, Detected-Cells: 45514
[37m2024-06-25 14:38:49,569 [INFO] - Training epoch stats:     Loss: 0.1272 - F1-Score: 0.9601 - Accuracy-Score: 0.9508 - AUROC: 0.9889 - AP: 0.9922
[37m2024-06-25 14:38:49,994 [INFO] - Validation epoch stats:   Loss: 0.4597 - F1-Score: 0.8772 - Accuracy-Score: 0.8462 - AUROC: 0.9218 - AP: 0.9512
[37m2024-06-25 14:38:50,074 [INFO] - Epoch: 13/50
[37m2024-06-25 14:38:50,074 [INFO] - Extracting training cells
[37m2024-06-25 14:41:53,220 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.716, Recall: 0.746, Detected-Cells: 46333
[37m2024-06-25 14:41:55,064 [INFO] - Training epoch stats:     Loss: 0.1122 - F1-Score: 0.9662 - Accuracy-Score: 0.9577 - AUROC: 0.9912 - AP: 0.9940
[37m2024-06-25 14:41:55,472 [INFO] - Validation epoch stats:   Loss: 0.4404 - F1-Score: 0.8907 - Accuracy-Score: 0.8593 - AUROC: 0.9269 - AP: 0.9531
[37m2024-06-25 14:41:55,546 [INFO] - Epoch: 14/50
[37m2024-06-25 14:41:55,547 [INFO] - Extracting training cells
[37m2024-06-25 14:44:58,453 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.718, Recall: 0.747, Detected-Cells: 46059
[37m2024-06-25 14:45:00,093 [INFO] - Training epoch stats:     Loss: 0.1106 - F1-Score: 0.9664 - Accuracy-Score: 0.9580 - AUROC: 0.9915 - AP: 0.9944
[37m2024-06-25 14:45:00,713 [INFO] - Validation epoch stats:   Loss: 0.4585 - F1-Score: 0.8837 - Accuracy-Score: 0.8524 - AUROC: 0.9220 - AP: 0.9475
[37m2024-06-25 14:45:00,713 [INFO] - Performing early stopping!
[37m2024-06-25 14:45:00,721 [INFO] - Finished run q87qjaqp
