[37m2024-06-25 06:08:53,175 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 06:08:53,175 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/50/2024-06-25T060845_CellViT-UNI-50Percent
[37m2024-06-25 06:08:53,235 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f7f70da86a0>]
[37m2024-06-25 06:08:53,239 [INFO] - Using GPU: cuda:0
[37m2024-06-25 06:08:53,243 [INFO] - Using device: cuda:0
[37m2024-06-25 06:08:53,247 [INFO] - Loss function:
[37m2024-06-25 06:08:53,251 [INFO] - CrossEntropyLoss()
[37m2024-06-25 06:09:05,375 [INFO] - <All keys matched successfully>
[37m2024-06-25 06:09:06,745 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 06:09:06,755 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 06:09:06,755 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 06:09:06,759 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 06:09:06,774 [INFO] - Caching datasets
[37m2024-06-25 06:09:09,503 [INFO] - Instantiate Trainer
[37m2024-06-25 06:09:09,509 [INFO] - Calling Trainer Fit
[37m2024-06-25 06:09:09,509 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 06:09:09,513 [INFO] - Epoch: 1/50
[37m2024-06-25 06:09:09,518 [INFO] - Extracting training cells
[37m2024-06-25 06:10:37,865 [INFO] - Extraction detection metrics - F1: 0.662, Precision: 0.633, Recall: 0.755, Detected-Cells: 22785
[37m2024-06-25 06:10:38,633 [INFO] - Training epoch stats:     Loss: 0.4857 - F1-Score: 0.8505 - Accuracy-Score: 0.7803 - AUROC: 0.8892 - AP: 0.9331
[37m2024-06-25 06:10:41,897 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 06:10:42,218 [INFO] - Validation epoch stats:   Loss: 0.3887 - F1-Score: 0.8962 - Accuracy-Score: 0.8610 - AUROC: 0.9328 - AP: 0.9587
[37m2024-06-25 06:10:42,219 [INFO] - New best model - save checkpoint
[37m2024-06-25 06:10:42,458 [INFO] - Epoch: 2/50
[37m2024-06-25 06:10:42,459 [INFO] - Extracting training cells
[37m2024-06-25 06:12:03,691 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.636, Recall: 0.757, Detected-Cells: 23780
[37m2024-06-25 06:12:04,409 [INFO] - Training epoch stats:     Loss: 0.2973 - F1-Score: 0.9144 - Accuracy-Score: 0.8864 - AUROC: 0.9510 - AP: 0.9708
[37m2024-06-25 06:12:04,745 [INFO] - Validation epoch stats:   Loss: 0.3241 - F1-Score: 0.9054 - Accuracy-Score: 0.8773 - AUROC: 0.9334 - AP: 0.9568
[37m2024-06-25 06:12:04,746 [INFO] - New best model - save checkpoint
[37m2024-06-25 06:12:04,952 [INFO] - Epoch: 3/50
[37m2024-06-25 06:12:04,953 [INFO] - Extracting training cells
[37m2024-06-25 06:13:28,832 [INFO] - Extraction detection metrics - F1: 0.658, Precision: 0.631, Recall: 0.750, Detected-Cells: 22907
[37m2024-06-25 06:13:29,640 [INFO] - Training epoch stats:     Loss: 0.2440 - F1-Score: 0.9274 - Accuracy-Score: 0.9050 - AUROC: 0.9623 - AP: 0.9774
[37m2024-06-25 06:13:30,062 [INFO] - Validation epoch stats:   Loss: 0.3290 - F1-Score: 0.9015 - Accuracy-Score: 0.8714 - AUROC: 0.9276 - AP: 0.9509
[37m2024-06-25 06:13:30,145 [INFO] - Epoch: 4/50
[37m2024-06-25 06:13:30,145 [INFO] - Extracting training cells
[37m2024-06-25 06:14:56,312 [INFO] - Extraction detection metrics - F1: 0.662, Precision: 0.636, Recall: 0.752, Detected-Cells: 24009
[37m2024-06-25 06:14:57,132 [INFO] - Training epoch stats:     Loss: 0.2102 - F1-Score: 0.9401 - Accuracy-Score: 0.9197 - AUROC: 0.9706 - AP: 0.9836
[37m2024-06-25 06:14:57,558 [INFO] - Validation epoch stats:   Loss: 0.3319 - F1-Score: 0.9012 - Accuracy-Score: 0.8700 - AUROC: 0.9281 - AP: 0.9515
[37m2024-06-25 06:14:57,626 [INFO] - Epoch: 5/50
[37m2024-06-25 06:14:57,627 [INFO] - Extracting training cells
[37m2024-06-25 06:16:23,581 [INFO] - Extraction detection metrics - F1: 0.664, Precision: 0.639, Recall: 0.754, Detected-Cells: 24168
[37m2024-06-25 06:16:24,314 [INFO] - Training epoch stats:     Loss: 0.1987 - F1-Score: 0.9418 - Accuracy-Score: 0.9230 - AUROC: 0.9728 - AP: 0.9838
[37m2024-06-25 06:16:24,658 [INFO] - Validation epoch stats:   Loss: 0.3325 - F1-Score: 0.8994 - Accuracy-Score: 0.8693 - AUROC: 0.9279 - AP: 0.9513
[37m2024-06-25 06:16:24,753 [INFO] - Epoch: 6/50
[37m2024-06-25 06:16:24,754 [INFO] - Extracting training cells
[37m2024-06-25 06:17:46,999 [INFO] - Extraction detection metrics - F1: 0.672, Precision: 0.645, Recall: 0.764, Detected-Cells: 23622
[37m2024-06-25 06:17:47,749 [INFO] - Training epoch stats:     Loss: 0.1965 - F1-Score: 0.9436 - Accuracy-Score: 0.9250 - AUROC: 0.9728 - AP: 0.9835
[37m2024-06-25 06:17:48,092 [INFO] - Validation epoch stats:   Loss: 0.3449 - F1-Score: 0.8945 - Accuracy-Score: 0.8628 - AUROC: 0.9227 - AP: 0.9470
[37m2024-06-25 06:17:48,186 [INFO] - Epoch: 7/50
[37m2024-06-25 06:17:48,187 [INFO] - Extracting training cells
[37m2024-06-25 06:19:10,767 [INFO] - Extraction detection metrics - F1: 0.667, Precision: 0.641, Recall: 0.762, Detected-Cells: 23957
[37m2024-06-25 06:19:11,861 [INFO] - Training epoch stats:     Loss: 0.1915 - F1-Score: 0.9438 - Accuracy-Score: 0.9262 - AUROC: 0.9740 - AP: 0.9836
[37m2024-06-25 06:19:12,295 [INFO] - Validation epoch stats:   Loss: 0.3533 - F1-Score: 0.8940 - Accuracy-Score: 0.8611 - AUROC: 0.9200 - AP: 0.9452
[37m2024-06-25 06:19:12,397 [INFO] - Epoch: 8/50
[37m2024-06-25 06:19:12,398 [INFO] - Extracting training cells
[37m2024-06-25 06:20:33,402 [INFO] - Extraction detection metrics - F1: 0.665, Precision: 0.637, Recall: 0.760, Detected-Cells: 23895
[37m2024-06-25 06:20:34,336 [INFO] - Training epoch stats:     Loss: 0.1769 - F1-Score: 0.9506 - Accuracy-Score: 0.9340 - AUROC: 0.9771 - AP: 0.9866
[37m2024-06-25 06:20:34,790 [INFO] - Validation epoch stats:   Loss: 0.3561 - F1-Score: 0.8933 - Accuracy-Score: 0.8603 - AUROC: 0.9201 - AP: 0.9445
[37m2024-06-25 06:20:34,878 [INFO] - Epoch: 9/50
[37m2024-06-25 06:20:34,879 [INFO] - Extracting training cells
[37m2024-06-25 06:21:57,326 [INFO] - Extraction detection metrics - F1: 0.671, Precision: 0.644, Recall: 0.765, Detected-Cells: 24332
[37m2024-06-25 06:21:58,206 [INFO] - Training epoch stats:     Loss: 0.1653 - F1-Score: 0.9518 - Accuracy-Score: 0.9363 - AUROC: 0.9813 - AP: 0.9893
[37m2024-06-25 06:21:58,630 [INFO] - Validation epoch stats:   Loss: 0.3614 - F1-Score: 0.8924 - Accuracy-Score: 0.8600 - AUROC: 0.9200 - AP: 0.9440
[37m2024-06-25 06:21:58,721 [INFO] - Epoch: 10/50
[37m2024-06-25 06:21:58,721 [INFO] - Extracting training cells
[37m2024-06-25 06:23:23,300 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.643, Recall: 0.761, Detected-Cells: 24420
[37m2024-06-25 06:23:24,059 [INFO] - Training epoch stats:     Loss: 0.1642 - F1-Score: 0.9516 - Accuracy-Score: 0.9367 - AUROC: 0.9812 - AP: 0.9887
[37m2024-06-25 06:23:24,406 [INFO] - Validation epoch stats:   Loss: 0.3662 - F1-Score: 0.8908 - Accuracy-Score: 0.8582 - AUROC: 0.9188 - AP: 0.9434
[37m2024-06-25 06:23:24,487 [INFO] - Epoch: 11/50
[37m2024-06-25 06:23:24,488 [INFO] - Extracting training cells
[37m2024-06-25 06:24:49,314 [INFO] - Extraction detection metrics - F1: 0.664, Precision: 0.638, Recall: 0.754, Detected-Cells: 23814
[37m2024-06-25 06:24:50,053 [INFO] - Training epoch stats:     Loss: 0.1595 - F1-Score: 0.9555 - Accuracy-Score: 0.9409 - AUROC: 0.9833 - AP: 0.9906
[37m2024-06-25 06:24:50,394 [INFO] - Validation epoch stats:   Loss: 0.3671 - F1-Score: 0.8922 - Accuracy-Score: 0.8598 - AUROC: 0.9190 - AP: 0.9429
[37m2024-06-25 06:24:50,465 [INFO] - Epoch: 12/50
[37m2024-06-25 06:24:50,466 [INFO] - Extracting training cells
[37m2024-06-25 06:26:12,255 [INFO] - Extraction detection metrics - F1: 0.671, Precision: 0.645, Recall: 0.763, Detected-Cells: 24625
[37m2024-06-25 06:26:13,221 [INFO] - Training epoch stats:     Loss: 0.1598 - F1-Score: 0.9555 - Accuracy-Score: 0.9413 - AUROC: 0.9819 - AP: 0.9890
[37m2024-06-25 06:26:13,558 [INFO] - Validation epoch stats:   Loss: 0.3700 - F1-Score: 0.8881 - Accuracy-Score: 0.8559 - AUROC: 0.9189 - AP: 0.9429
[37m2024-06-25 06:26:13,558 [INFO] - Performing early stopping!
[37m2024-06-25 06:26:13,566 [INFO] - Finished run jwjdsv16
