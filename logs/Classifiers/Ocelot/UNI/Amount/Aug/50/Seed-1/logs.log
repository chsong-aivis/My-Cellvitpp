[37m2024-06-21 13:19:12,078 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-21 13:19:12,079 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/50/2024-06-21T131859_CellViT-UNI-50Percent
[37m2024-06-21 13:19:12,146 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f782c790670>]
[37m2024-06-21 13:19:12,152 [INFO] - Using GPU: cuda:0
[37m2024-06-21 13:19:12,157 [INFO] - Using device: cuda:0
[37m2024-06-21 13:19:12,162 [INFO] - Loss function:
[37m2024-06-21 13:19:12,166 [INFO] - CrossEntropyLoss()
[37m2024-06-21 13:19:25,056 [INFO] - <All keys matched successfully>
[37m2024-06-21 13:19:26,247 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-21 13:19:26,254 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-21 13:19:26,259 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-21 13:19:26,263 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-21 13:19:26,285 [INFO] - Caching datasets
[37m2024-06-21 13:19:29,989 [INFO] - Instantiate Trainer
[37m2024-06-21 13:19:29,993 [INFO] - Calling Trainer Fit
[37m2024-06-21 13:19:29,998 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-21 13:19:30,002 [INFO] - Epoch: 1/50
[37m2024-06-21 13:19:30,006 [INFO] - Extracting training cells
[37m2024-06-21 13:21:08,819 [INFO] - Extraction detection metrics - F1: 0.672, Precision: 0.640, Recall: 0.765, Detected-Cells: 24067
[37m2024-06-21 13:21:09,775 [INFO] - Training epoch stats:     Loss: 0.4936 - F1-Score: 0.8467 - Accuracy-Score: 0.7786 - AUROC: 0.8713 - AP: 0.9251
[37m2024-06-21 13:21:13,089 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-21 13:21:13,453 [INFO] - Validation epoch stats:   Loss: 0.3825 - F1-Score: 0.9026 - Accuracy-Score: 0.8700 - AUROC: 0.9377 - AP: 0.9609
[37m2024-06-21 13:21:13,459 [INFO] - New best model - save checkpoint
[37m2024-06-21 13:21:13,638 [INFO] - Epoch: 2/50
[37m2024-06-21 13:21:13,644 [INFO] - Extracting training cells
[37m2024-06-21 13:22:43,121 [INFO] - Extraction detection metrics - F1: 0.661, Precision: 0.637, Recall: 0.755, Detected-Cells: 23699
[37m2024-06-21 13:22:43,852 [INFO] - Training epoch stats:     Loss: 0.2951 - F1-Score: 0.9162 - Accuracy-Score: 0.8878 - AUROC: 0.9500 - AP: 0.9700
[37m2024-06-21 13:22:44,278 [INFO] - Validation epoch stats:   Loss: 0.3183 - F1-Score: 0.9074 - Accuracy-Score: 0.8807 - AUROC: 0.9366 - AP: 0.9590
[37m2024-06-21 13:22:44,335 [INFO] - Epoch: 3/50
[37m2024-06-21 13:22:44,340 [INFO] - Extracting training cells
[37m2024-06-21 13:24:17,905 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.639, Recall: 0.748, Detected-Cells: 23818
[37m2024-06-21 13:24:18,756 [INFO] - Training epoch stats:     Loss: 0.2403 - F1-Score: 0.9290 - Accuracy-Score: 0.9065 - AUROC: 0.9633 - AP: 0.9777
[37m2024-06-21 13:24:19,187 [INFO] - Validation epoch stats:   Loss: 0.3128 - F1-Score: 0.9061 - Accuracy-Score: 0.8782 - AUROC: 0.9350 - AP: 0.9570
[37m2024-06-21 13:24:19,255 [INFO] - Epoch: 4/50
[37m2024-06-21 13:24:19,260 [INFO] - Extracting training cells
[37m2024-06-21 13:25:48,413 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.640, Recall: 0.753, Detected-Cells: 23102
[37m2024-06-21 13:25:49,593 [INFO] - Training epoch stats:     Loss: 0.2191 - F1-Score: 0.9359 - Accuracy-Score: 0.9147 - AUROC: 0.9684 - AP: 0.9820
[37m2024-06-21 13:25:50,226 [INFO] - Validation epoch stats:   Loss: 0.3208 - F1-Score: 0.9026 - Accuracy-Score: 0.8736 - AUROC: 0.9313 - AP: 0.9538
[37m2024-06-21 13:25:50,293 [INFO] - Epoch: 5/50
[37m2024-06-21 13:25:50,299 [INFO] - Extracting training cells
[37m2024-06-21 13:27:23,567 [INFO] - Extraction detection metrics - F1: 0.667, Precision: 0.644, Recall: 0.760, Detected-Cells: 23951
[37m2024-06-21 13:27:24,327 [INFO] - Training epoch stats:     Loss: 0.2138 - F1-Score: 0.9391 - Accuracy-Score: 0.9186 - AUROC: 0.9680 - AP: 0.9817
[37m2024-06-21 13:27:24,669 [INFO] - Validation epoch stats:   Loss: 0.3261 - F1-Score: 0.9000 - Accuracy-Score: 0.8701 - AUROC: 0.9298 - AP: 0.9536
[37m2024-06-21 13:27:24,751 [INFO] - Epoch: 6/50
[37m2024-06-21 13:27:24,756 [INFO] - Extracting training cells
[37m2024-06-21 13:28:52,400 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.636, Recall: 0.762, Detected-Cells: 24052
[37m2024-06-21 13:28:53,259 [INFO] - Training epoch stats:     Loss: 0.1928 - F1-Score: 0.9449 - Accuracy-Score: 0.9269 - AUROC: 0.9741 - AP: 0.9840
[37m2024-06-21 13:28:53,677 [INFO] - Validation epoch stats:   Loss: 0.3350 - F1-Score: 0.8970 - Accuracy-Score: 0.8662 - AUROC: 0.9271 - AP: 0.9517
[37m2024-06-21 13:28:53,741 [INFO] - Epoch: 7/50
[37m2024-06-21 13:28:53,745 [INFO] - Extracting training cells
[37m2024-06-21 13:30:20,121 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.641, Recall: 0.756, Detected-Cells: 24224
[37m2024-06-21 13:30:21,158 [INFO] - Training epoch stats:     Loss: 0.1854 - F1-Score: 0.9470 - Accuracy-Score: 0.9303 - AUROC: 0.9758 - AP: 0.9850
[37m2024-06-21 13:30:21,686 [INFO] - Validation epoch stats:   Loss: 0.3361 - F1-Score: 0.8986 - Accuracy-Score: 0.8675 - AUROC: 0.9269 - AP: 0.9512
[37m2024-06-21 13:30:21,776 [INFO] - Epoch: 8/50
[37m2024-06-21 13:30:21,781 [INFO] - Extracting training cells
[37m2024-06-21 13:31:49,233 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.645, Recall: 0.762, Detected-Cells: 24376
[37m2024-06-21 13:31:50,489 [INFO] - Training epoch stats:     Loss: 0.1826 - F1-Score: 0.9476 - Accuracy-Score: 0.9308 - AUROC: 0.9767 - AP: 0.9863
[37m2024-06-21 13:31:51,868 [INFO] - Validation epoch stats:   Loss: 0.3439 - F1-Score: 0.8966 - Accuracy-Score: 0.8653 - AUROC: 0.9250 - AP: 0.9497
[37m2024-06-21 13:31:51,932 [INFO] - Epoch: 9/50
[37m2024-06-21 13:31:51,955 [INFO] - Extracting training cells
[37m2024-06-21 13:33:24,147 [INFO] - Extraction detection metrics - F1: 0.658, Precision: 0.634, Recall: 0.750, Detected-Cells: 23370
[37m2024-06-21 13:33:25,268 [INFO] - Training epoch stats:     Loss: 0.1761 - F1-Score: 0.9491 - Accuracy-Score: 0.9325 - AUROC: 0.9779 - AP: 0.9872
[37m2024-06-21 13:33:26,358 [INFO] - Validation epoch stats:   Loss: 0.3482 - F1-Score: 0.8966 - Accuracy-Score: 0.8646 - AUROC: 0.9246 - AP: 0.9495
[37m2024-06-21 13:33:26,455 [INFO] - Epoch: 10/50
[37m2024-06-21 13:33:26,460 [INFO] - Extracting training cells
[37m2024-06-21 13:34:57,722 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.642, Recall: 0.762, Detected-Cells: 24384
[37m2024-06-21 13:34:59,364 [INFO] - Training epoch stats:     Loss: 0.1722 - F1-Score: 0.9503 - Accuracy-Score: 0.9350 - AUROC: 0.9790 - AP: 0.9863
[37m2024-06-21 13:35:00,877 [INFO] - Validation epoch stats:   Loss: 0.3561 - F1-Score: 0.8914 - Accuracy-Score: 0.8594 - AUROC: 0.9213 - AP: 0.9461
[37m2024-06-21 13:35:01,016 [INFO] - Epoch: 11/50
[37m2024-06-21 13:35:01,017 [INFO] - Extracting training cells
[37m2024-06-21 13:36:31,492 [INFO] - Extraction detection metrics - F1: 0.657, Precision: 0.631, Recall: 0.751, Detected-Cells: 23535
[37m2024-06-21 13:36:32,184 [INFO] - Training epoch stats:     Loss: 0.1667 - F1-Score: 0.9528 - Accuracy-Score: 0.9379 - AUROC: 0.9794 - AP: 0.9864
[37m2024-06-21 13:36:33,459 [INFO] - Validation epoch stats:   Loss: 0.3527 - F1-Score: 0.8935 - Accuracy-Score: 0.8620 - AUROC: 0.9231 - AP: 0.9480
[37m2024-06-21 13:36:33,460 [INFO] - Performing early stopping!
[37m2024-06-21 13:36:33,467 [INFO] - Finished run we92cwjw
