[37m2024-06-24 10:04:30,018 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-24 10:04:30,020 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/75/2024-06-24T100418_CellViT-UNI-75Percent
[37m2024-06-24 10:04:30,080 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fc1d158c6a0>]
[37m2024-06-24 10:04:30,080 [INFO] - Using GPU: cuda:0
[37m2024-06-24 10:04:30,085 [INFO] - Using device: cuda:0
[37m2024-06-24 10:04:30,089 [INFO] - Loss function:
[37m2024-06-24 10:04:30,093 [INFO] - CrossEntropyLoss()
[37m2024-06-24 10:04:42,777 [INFO] - <All keys matched successfully>
[37m2024-06-24 10:04:44,956 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-24 10:04:44,958 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-24 10:04:44,962 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-24 10:04:44,966 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-24 10:04:44,987 [INFO] - Caching datasets
[37m2024-06-24 10:04:48,380 [INFO] - Instantiate Trainer
[37m2024-06-24 10:04:48,385 [INFO] - Calling Trainer Fit
[37m2024-06-24 10:04:48,386 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-24 10:04:48,391 [INFO] - Epoch: 1/50
[37m2024-06-24 10:04:48,396 [INFO] - Extracting training cells
[37m2024-06-24 10:07:04,377 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.638, Recall: 0.771, Detected-Cells: 36633
[37m2024-06-24 10:07:05,562 [INFO] - Training epoch stats:     Loss: 0.4483 - F1-Score: 0.8578 - Accuracy-Score: 0.8060 - AUROC: 0.9052 - AP: 0.9346
[37m2024-06-24 10:07:08,833 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-24 10:07:09,363 [INFO] - Validation epoch stats:   Loss: 0.3347 - F1-Score: 0.9069 - Accuracy-Score: 0.8807 - AUROC: 0.9355 - AP: 0.9577
[37m2024-06-24 10:07:09,364 [INFO] - New best model - save checkpoint
[37m2024-06-24 10:07:09,556 [INFO] - Epoch: 2/50
[37m2024-06-24 10:07:09,557 [INFO] - Extracting training cells
[37m2024-06-24 10:09:22,336 [INFO] - Extraction detection metrics - F1: 0.667, Precision: 0.633, Recall: 0.767, Detected-Cells: 36486
[37m2024-06-24 10:09:23,484 [INFO] - Training epoch stats:     Loss: 0.2699 - F1-Score: 0.9138 - Accuracy-Score: 0.8933 - AUROC: 0.9567 - AP: 0.9702
[37m2024-06-24 10:09:23,929 [INFO] - Validation epoch stats:   Loss: 0.3268 - F1-Score: 0.8986 - Accuracy-Score: 0.8715 - AUROC: 0.9313 - AP: 0.9535
[37m2024-06-24 10:09:24,012 [INFO] - Epoch: 3/50
[37m2024-06-24 10:09:24,012 [INFO] - Extracting training cells
[37m2024-06-24 10:11:33,194 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.635, Recall: 0.766, Detected-Cells: 35649
[37m2024-06-24 10:11:34,309 [INFO] - Training epoch stats:     Loss: 0.2422 - F1-Score: 0.9249 - Accuracy-Score: 0.9058 - AUROC: 0.9620 - AP: 0.9735
[37m2024-06-24 10:11:34,798 [INFO] - Validation epoch stats:   Loss: 0.3390 - F1-Score: 0.8899 - Accuracy-Score: 0.8604 - AUROC: 0.9249 - AP: 0.9484
[37m2024-06-24 10:11:34,881 [INFO] - Epoch: 4/50
[37m2024-06-24 10:11:34,881 [INFO] - Extracting training cells
[37m2024-06-24 10:13:45,630 [INFO] - Extraction detection metrics - F1: 0.676, Precision: 0.642, Recall: 0.774, Detected-Cells: 37269
[37m2024-06-24 10:13:46,538 [INFO] - Training epoch stats:     Loss: 0.2089 - F1-Score: 0.9353 - Accuracy-Score: 0.9195 - AUROC: 0.9717 - AP: 0.9805
[37m2024-06-24 10:13:46,911 [INFO] - Validation epoch stats:   Loss: 0.3536 - F1-Score: 0.8838 - Accuracy-Score: 0.8542 - AUROC: 0.9216 - AP: 0.9451
[37m2024-06-24 10:13:46,984 [INFO] - Epoch: 5/50
[37m2024-06-24 10:13:46,985 [INFO] - Extracting training cells
[37m2024-06-24 10:15:56,945 [INFO] - Extraction detection metrics - F1: 0.669, Precision: 0.639, Recall: 0.767, Detected-Cells: 36501
[37m2024-06-24 10:15:58,462 [INFO] - Training epoch stats:     Loss: 0.2073 - F1-Score: 0.9358 - Accuracy-Score: 0.9207 - AUROC: 0.9713 - AP: 0.9787
[37m2024-06-24 10:15:58,911 [INFO] - Validation epoch stats:   Loss: 0.3677 - F1-Score: 0.8812 - Accuracy-Score: 0.8500 - AUROC: 0.9148 - AP: 0.9393
[37m2024-06-24 10:15:58,976 [INFO] - Epoch: 6/50
[37m2024-06-24 10:15:58,977 [INFO] - Extracting training cells
[37m2024-06-24 10:18:17,770 [INFO] - Extraction detection metrics - F1: 0.669, Precision: 0.641, Recall: 0.765, Detected-Cells: 36461
[37m2024-06-24 10:18:19,259 [INFO] - Training epoch stats:     Loss: 0.2014 - F1-Score: 0.9392 - Accuracy-Score: 0.9241 - AUROC: 0.9726 - AP: 0.9800
[37m2024-06-24 10:18:19,930 [INFO] - Validation epoch stats:   Loss: 0.3790 - F1-Score: 0.8760 - Accuracy-Score: 0.8451 - AUROC: 0.9133 - AP: 0.9377
[37m2024-06-24 10:18:20,004 [INFO] - Epoch: 7/50
[37m2024-06-24 10:18:20,005 [INFO] - Extracting training cells
[37m2024-06-24 10:20:34,306 [INFO] - Extraction detection metrics - F1: 0.664, Precision: 0.630, Recall: 0.765, Detected-Cells: 35631
[37m2024-06-24 10:20:35,866 [INFO] - Training epoch stats:     Loss: 0.1944 - F1-Score: 0.9411 - Accuracy-Score: 0.9263 - AUROC: 0.9744 - AP: 0.9797
[37m2024-06-24 10:20:36,258 [INFO] - Validation epoch stats:   Loss: 0.3895 - F1-Score: 0.8736 - Accuracy-Score: 0.8423 - AUROC: 0.9095 - AP: 0.9332
[37m2024-06-24 10:20:36,337 [INFO] - Epoch: 8/50
[37m2024-06-24 10:20:36,338 [INFO] - Extracting training cells
[37m2024-06-24 10:22:48,302 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.632, Recall: 0.767, Detected-Cells: 36569
[37m2024-06-24 10:22:49,670 [INFO] - Training epoch stats:     Loss: 0.1844 - F1-Score: 0.9439 - Accuracy-Score: 0.9308 - AUROC: 0.9772 - AP: 0.9834
[37m2024-06-24 10:22:50,529 [INFO] - Validation epoch stats:   Loss: 0.3940 - F1-Score: 0.8711 - Accuracy-Score: 0.8403 - AUROC: 0.9113 - AP: 0.9353
[37m2024-06-24 10:22:50,604 [INFO] - Epoch: 9/50
[37m2024-06-24 10:22:50,605 [INFO] - Extracting training cells
[37m2024-06-24 10:25:01,904 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.636, Recall: 0.768, Detected-Cells: 36331
[37m2024-06-24 10:25:03,170 [INFO] - Training epoch stats:     Loss: 0.1795 - F1-Score: 0.9450 - Accuracy-Score: 0.9320 - AUROC: 0.9783 - AP: 0.9837
[37m2024-06-24 10:25:03,673 [INFO] - Validation epoch stats:   Loss: 0.3875 - F1-Score: 0.8804 - Accuracy-Score: 0.8491 - AUROC: 0.9101 - AP: 0.9338
[37m2024-06-24 10:25:03,742 [INFO] - Epoch: 10/50
[37m2024-06-24 10:25:03,755 [INFO] - Extracting training cells
[37m2024-06-24 10:27:16,407 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.637, Recall: 0.771, Detected-Cells: 36554
[37m2024-06-24 10:27:17,669 [INFO] - Training epoch stats:     Loss: 0.1730 - F1-Score: 0.9475 - Accuracy-Score: 0.9347 - AUROC: 0.9803 - AP: 0.9866
[37m2024-06-24 10:27:18,163 [INFO] - Validation epoch stats:   Loss: 0.3986 - F1-Score: 0.8746 - Accuracy-Score: 0.8442 - AUROC: 0.9105 - AP: 0.9337
[37m2024-06-24 10:27:18,233 [INFO] - Epoch: 11/50
[37m2024-06-24 10:27:18,234 [INFO] - Extracting training cells
[37m2024-06-24 10:29:33,536 [INFO] - Extraction detection metrics - F1: 0.665, Precision: 0.634, Recall: 0.762, Detected-Cells: 36123
[37m2024-06-24 10:29:35,165 [INFO] - Training epoch stats:     Loss: 0.1663 - F1-Score: 0.9494 - Accuracy-Score: 0.9375 - AUROC: 0.9815 - AP: 0.9869
[37m2024-06-24 10:29:35,975 [INFO] - Validation epoch stats:   Loss: 0.4064 - F1-Score: 0.8727 - Accuracy-Score: 0.8414 - AUROC: 0.9075 - AP: 0.9317
[37m2024-06-24 10:29:35,976 [INFO] - Performing early stopping!
[37m2024-06-24 10:29:35,983 [INFO] - Finished run 14xrabl6
