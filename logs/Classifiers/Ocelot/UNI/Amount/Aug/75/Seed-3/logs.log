[37m2024-06-25 06:26:43,529 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 06:26:43,530 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/75/2024-06-25T062634_CellViT-UNI-75Percent
[37m2024-06-25 06:26:43,593 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f4fc614c640>]
[37m2024-06-25 06:26:43,593 [INFO] - Using GPU: cuda:0
[37m2024-06-25 06:26:43,598 [INFO] - Using device: cuda:0
[37m2024-06-25 06:26:43,603 [INFO] - Loss function:
[37m2024-06-25 06:26:43,608 [INFO] - CrossEntropyLoss()
[37m2024-06-25 06:26:56,169 [INFO] - <All keys matched successfully>
[37m2024-06-25 06:26:57,586 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 06:26:57,588 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 06:26:57,592 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 06:26:57,597 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 06:26:57,622 [INFO] - Caching datasets
[37m2024-06-25 06:27:03,116 [INFO] - Instantiate Trainer
[37m2024-06-25 06:27:03,162 [INFO] - Calling Trainer Fit
[37m2024-06-25 06:27:03,163 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 06:27:03,168 [INFO] - Epoch: 1/50
[37m2024-06-25 06:27:03,173 [INFO] - Extracting training cells
[37m2024-06-25 06:29:12,566 [INFO] - Extraction detection metrics - F1: 0.659, Precision: 0.626, Recall: 0.759, Detected-Cells: 35585
[37m2024-06-25 06:29:13,762 [INFO] - Training epoch stats:     Loss: 0.4573 - F1-Score: 0.8550 - Accuracy-Score: 0.8015 - AUROC: 0.9051 - AP: 0.9354
[37m2024-06-25 06:29:16,996 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 06:29:17,665 [INFO] - Validation epoch stats:   Loss: 0.3434 - F1-Score: 0.9089 - Accuracy-Score: 0.8823 - AUROC: 0.9342 - AP: 0.9568
[37m2024-06-25 06:29:17,665 [INFO] - New best model - save checkpoint
[37m2024-06-25 06:29:17,859 [INFO] - Epoch: 2/50
[37m2024-06-25 06:29:17,860 [INFO] - Extracting training cells
[37m2024-06-25 06:31:12,463 [INFO] - Extraction detection metrics - F1: 0.664, Precision: 0.634, Recall: 0.761, Detected-Cells: 35877
[37m2024-06-25 06:31:15,273 [INFO] - Training epoch stats:     Loss: 0.2773 - F1-Score: 0.9123 - Accuracy-Score: 0.8904 - AUROC: 0.9538 - AP: 0.9662
[37m2024-06-25 06:31:15,839 [INFO] - Validation epoch stats:   Loss: 0.3395 - F1-Score: 0.8938 - Accuracy-Score: 0.8660 - AUROC: 0.9260 - AP: 0.9489
[37m2024-06-25 06:31:15,927 [INFO] - Epoch: 3/50
[37m2024-06-25 06:31:15,928 [INFO] - Extracting training cells
[37m2024-06-25 06:33:18,486 [INFO] - Extraction detection metrics - F1: 0.665, Precision: 0.632, Recall: 0.763, Detected-Cells: 35917
[37m2024-06-25 06:33:19,755 [INFO] - Training epoch stats:     Loss: 0.2330 - F1-Score: 0.9267 - Accuracy-Score: 0.9097 - AUROC: 0.9655 - AP: 0.9742
[37m2024-06-25 06:33:20,184 [INFO] - Validation epoch stats:   Loss: 0.3512 - F1-Score: 0.8866 - Accuracy-Score: 0.8566 - AUROC: 0.9198 - AP: 0.9440
[37m2024-06-25 06:33:20,258 [INFO] - Epoch: 4/50
[37m2024-06-25 06:33:20,259 [INFO] - Extracting training cells
[37m2024-06-25 06:35:16,799 [INFO] - Extraction detection metrics - F1: 0.667, Precision: 0.634, Recall: 0.765, Detected-Cells: 36374
[37m2024-06-25 06:35:18,575 [INFO] - Training epoch stats:     Loss: 0.2136 - F1-Score: 0.9351 - Accuracy-Score: 0.9186 - AUROC: 0.9703 - AP: 0.9792
[37m2024-06-25 06:35:19,024 [INFO] - Validation epoch stats:   Loss: 0.3631 - F1-Score: 0.8795 - Accuracy-Score: 0.8493 - AUROC: 0.9175 - AP: 0.9421
[37m2024-06-25 06:35:19,117 [INFO] - Epoch: 5/50
[37m2024-06-25 06:35:19,118 [INFO] - Extracting training cells
[37m2024-06-25 06:37:19,288 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.636, Recall: 0.770, Detected-Cells: 36788
[37m2024-06-25 06:37:20,415 [INFO] - Training epoch stats:     Loss: 0.2070 - F1-Score: 0.9358 - Accuracy-Score: 0.9203 - AUROC: 0.9719 - AP: 0.9796
[37m2024-06-25 06:37:20,792 [INFO] - Validation epoch stats:   Loss: 0.3651 - F1-Score: 0.8831 - Accuracy-Score: 0.8521 - AUROC: 0.9151 - AP: 0.9409
[37m2024-06-25 06:37:20,886 [INFO] - Epoch: 6/50
[37m2024-06-25 06:37:20,886 [INFO] - Extracting training cells
[37m2024-06-25 06:39:18,165 [INFO] - Extraction detection metrics - F1: 0.672, Precision: 0.638, Recall: 0.773, Detected-Cells: 37077
[37m2024-06-25 06:39:19,556 [INFO] - Training epoch stats:     Loss: 0.1991 - F1-Score: 0.9392 - Accuracy-Score: 0.9236 - AUROC: 0.9733 - AP: 0.9806
[37m2024-06-25 06:39:20,180 [INFO] - Validation epoch stats:   Loss: 0.3744 - F1-Score: 0.8818 - Accuracy-Score: 0.8504 - AUROC: 0.9132 - AP: 0.9377
[37m2024-06-25 06:39:20,264 [INFO] - Epoch: 7/50
[37m2024-06-25 06:39:20,265 [INFO] - Extracting training cells
[37m2024-06-25 06:41:22,401 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.637, Recall: 0.765, Detected-Cells: 36714
[37m2024-06-25 06:41:23,656 [INFO] - Training epoch stats:     Loss: 0.1946 - F1-Score: 0.9404 - Accuracy-Score: 0.9255 - AUROC: 0.9740 - AP: 0.9804
[37m2024-06-25 06:41:24,319 [INFO] - Validation epoch stats:   Loss: 0.3931 - F1-Score: 0.8725 - Accuracy-Score: 0.8410 - AUROC: 0.9070 - AP: 0.9331
[37m2024-06-25 06:41:24,421 [INFO] - Epoch: 8/50
[37m2024-06-25 06:41:24,422 [INFO] - Extracting training cells
[37m2024-06-25 06:43:22,969 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.636, Recall: 0.772, Detected-Cells: 36837
[37m2024-06-25 06:43:24,173 [INFO] - Training epoch stats:     Loss: 0.1774 - F1-Score: 0.9454 - Accuracy-Score: 0.9328 - AUROC: 0.9799 - AP: 0.9858
[37m2024-06-25 06:43:24,829 [INFO] - Validation epoch stats:   Loss: 0.4004 - F1-Score: 0.8709 - Accuracy-Score: 0.8401 - AUROC: 0.9093 - AP: 0.9332
[37m2024-06-25 06:43:24,931 [INFO] - Epoch: 9/50
[37m2024-06-25 06:43:24,931 [INFO] - Extracting training cells
[37m2024-06-25 06:45:19,626 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.635, Recall: 0.772, Detected-Cells: 37138
[37m2024-06-25 06:45:20,972 [INFO] - Training epoch stats:     Loss: 0.1830 - F1-Score: 0.9447 - Accuracy-Score: 0.9309 - AUROC: 0.9777 - AP: 0.9841
[37m2024-06-25 06:45:21,687 [INFO] - Validation epoch stats:   Loss: 0.4081 - F1-Score: 0.8666 - Accuracy-Score: 0.8353 - AUROC: 0.9070 - AP: 0.9318
[37m2024-06-25 06:45:21,766 [INFO] - Epoch: 10/50
[37m2024-06-25 06:45:21,767 [INFO] - Extracting training cells
[37m2024-06-25 06:47:16,318 [INFO] - Extraction detection metrics - F1: 0.669, Precision: 0.637, Recall: 0.766, Detected-Cells: 36983
[37m2024-06-25 06:47:17,389 [INFO] - Training epoch stats:     Loss: 0.1725 - F1-Score: 0.9469 - Accuracy-Score: 0.9337 - AUROC: 0.9802 - AP: 0.9866
[37m2024-06-25 06:47:18,096 [INFO] - Validation epoch stats:   Loss: 0.4066 - F1-Score: 0.8725 - Accuracy-Score: 0.8409 - AUROC: 0.9059 - AP: 0.9303
[37m2024-06-25 06:47:18,170 [INFO] - Epoch: 11/50
[37m2024-06-25 06:47:18,170 [INFO] - Extracting training cells
[37m2024-06-25 06:49:20,057 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.629, Recall: 0.762, Detected-Cells: 35621
[37m2024-06-25 06:49:21,135 [INFO] - Training epoch stats:     Loss: 0.1659 - F1-Score: 0.9501 - Accuracy-Score: 0.9384 - AUROC: 0.9815 - AP: 0.9856
[37m2024-06-25 06:49:21,790 [INFO] - Validation epoch stats:   Loss: 0.4122 - F1-Score: 0.8697 - Accuracy-Score: 0.8372 - AUROC: 0.9047 - AP: 0.9284
[37m2024-06-25 06:49:21,791 [INFO] - Performing early stopping!
[37m2024-06-25 06:49:21,798 [INFO] - Finished run lta8zzgd
