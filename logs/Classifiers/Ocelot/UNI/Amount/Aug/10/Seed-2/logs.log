[37m2024-06-24 09:25:23,029 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-24 09:25:23,030 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/10/2024-06-24T092515_CellViT-UNI-10Percent
[37m2024-06-24 09:25:23,093 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f249436c640>]
[37m2024-06-24 09:25:23,098 [INFO] - Using GPU: cuda:0
[37m2024-06-24 09:25:23,102 [INFO] - Using device: cuda:0
[37m2024-06-24 09:25:23,106 [INFO] - Loss function:
[37m2024-06-24 09:25:23,110 [INFO] - CrossEntropyLoss()
[37m2024-06-24 09:25:35,171 [INFO] - <All keys matched successfully>
[37m2024-06-24 09:25:35,860 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-24 09:25:35,861 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-24 09:25:35,866 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-24 09:25:35,872 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-24 09:25:35,891 [INFO] - Caching datasets
[37m2024-06-24 09:25:37,924 [INFO] - Instantiate Trainer
[37m2024-06-24 09:25:37,931 [INFO] - Calling Trainer Fit
[37m2024-06-24 09:25:37,932 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-24 09:25:37,937 [INFO] - Epoch: 1/50
[37m2024-06-24 09:25:37,942 [INFO] - Extracting training cells
[37m2024-06-24 09:26:05,797 [INFO] - Extraction detection metrics - F1: 0.660, Precision: 0.634, Recall: 0.763, Detected-Cells: 5437
[37m2024-06-24 09:26:06,099 [INFO] - Training epoch stats:     Loss: 0.6169 - F1-Score: 0.7830 - Accuracy-Score: 0.6610 - AUROC: 0.7924 - AP: 0.8745
[37m2024-06-24 09:26:11,831 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-24 09:26:12,264 [INFO] - Validation epoch stats:   Loss: 0.5838 - F1-Score: 0.8128 - Accuracy-Score: 0.7089 - AUROC: 0.9015 - AP: 0.9346
[37m2024-06-24 09:26:12,265 [INFO] - New best model - save checkpoint
[37m2024-06-24 09:26:12,555 [INFO] - Epoch: 2/50
[37m2024-06-24 09:26:12,557 [INFO] - Extracting training cells
[37m2024-06-24 09:26:37,636 [INFO] - Extraction detection metrics - F1: 0.677, Precision: 0.637, Recall: 0.792, Detected-Cells: 5529
[37m2024-06-24 09:26:37,830 [INFO] - Training epoch stats:     Loss: 0.5294 - F1-Score: 0.8384 - Accuracy-Score: 0.7680 - AUROC: 0.9332 - AP: 0.9445
[37m2024-06-24 09:26:38,135 [INFO] - Validation epoch stats:   Loss: 0.5219 - F1-Score: 0.8713 - Accuracy-Score: 0.8196 - AUROC: 0.9207 - AP: 0.9489
[37m2024-06-24 09:26:38,136 [INFO] - New best model - save checkpoint
[37m2024-06-24 09:26:38,336 [INFO] - Epoch: 3/50
[37m2024-06-24 09:26:38,337 [INFO] - Extracting training cells
[37m2024-06-24 09:26:56,280 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.646, Recall: 0.774, Detected-Cells: 5562
[37m2024-06-24 09:26:56,483 [INFO] - Training epoch stats:     Loss: 0.4274 - F1-Score: 0.9069 - Accuracy-Score: 0.8774 - AUROC: 0.9527 - AP: 0.9710
[37m2024-06-24 09:26:57,066 [INFO] - Validation epoch stats:   Loss: 0.4612 - F1-Score: 0.8937 - Accuracy-Score: 0.8578 - AUROC: 0.9231 - AP: 0.9500
[37m2024-06-24 09:26:57,067 [INFO] - New best model - save checkpoint
[37m2024-06-24 09:26:57,255 [INFO] - Epoch: 4/50
[37m2024-06-24 09:26:57,256 [INFO] - Extracting training cells
[37m2024-06-24 09:27:18,922 [INFO] - Extraction detection metrics - F1: 0.686, Precision: 0.662, Recall: 0.786, Detected-Cells: 5844
[37m2024-06-24 09:27:19,144 [INFO] - Training epoch stats:     Loss: 0.3395 - F1-Score: 0.9308 - Accuracy-Score: 0.9110 - AUROC: 0.9685 - AP: 0.9801
[37m2024-06-24 09:27:19,629 [INFO] - Validation epoch stats:   Loss: 0.4110 - F1-Score: 0.8979 - Accuracy-Score: 0.8661 - AUROC: 0.9230 - AP: 0.9489
[37m2024-06-24 09:27:19,722 [INFO] - Epoch: 5/50
[37m2024-06-24 09:27:19,723 [INFO] - Extracting training cells
[37m2024-06-24 09:27:40,985 [INFO] - Extraction detection metrics - F1: 0.671, Precision: 0.635, Recall: 0.780, Detected-Cells: 5440
[37m2024-06-24 09:27:41,281 [INFO] - Training epoch stats:     Loss: 0.2948 - F1-Score: 0.9323 - Accuracy-Score: 0.9140 - AUROC: 0.9653 - AP: 0.9767
[37m2024-06-24 09:27:41,911 [INFO] - Validation epoch stats:   Loss: 0.3780 - F1-Score: 0.9006 - Accuracy-Score: 0.8702 - AUROC: 0.9245 - AP: 0.9484
[37m2024-06-24 09:27:41,911 [INFO] - New best model - save checkpoint
[37m2024-06-24 09:27:42,100 [INFO] - Epoch: 6/50
[37m2024-06-24 09:27:42,101 [INFO] - Extracting training cells
[37m2024-06-24 09:28:03,253 [INFO] - Extraction detection metrics - F1: 0.671, Precision: 0.649, Recall: 0.776, Detected-Cells: 5504
[37m2024-06-24 09:28:03,432 [INFO] - Training epoch stats:     Loss: 0.2542 - F1-Score: 0.9334 - Accuracy-Score: 0.9150 - AUROC: 0.9696 - AP: 0.9816
[37m2024-06-24 09:28:03,831 [INFO] - Validation epoch stats:   Loss: 0.3605 - F1-Score: 0.9035 - Accuracy-Score: 0.8745 - AUROC: 0.9247 - AP: 0.9473
[37m2024-06-24 09:28:03,832 [INFO] - New best model - save checkpoint
[37m2024-06-24 09:28:04,020 [INFO] - Epoch: 7/50
[37m2024-06-24 09:28:04,021 [INFO] - Extracting training cells
[37m2024-06-24 09:28:25,217 [INFO] - Extraction detection metrics - F1: 0.662, Precision: 0.637, Recall: 0.766, Detected-Cells: 5403
[37m2024-06-24 09:28:25,423 [INFO] - Training epoch stats:     Loss: 0.2237 - F1-Score: 0.9410 - Accuracy-Score: 0.9287 - AUROC: 0.9799 - AP: 0.9856
[37m2024-06-24 09:28:25,839 [INFO] - Validation epoch stats:   Loss: 0.3553 - F1-Score: 0.9027 - Accuracy-Score: 0.8754 - AUROC: 0.9228 - AP: 0.9447
[37m2024-06-24 09:28:25,907 [INFO] - Epoch: 8/50
[37m2024-06-24 09:28:25,907 [INFO] - Extracting training cells
[37m2024-06-24 09:28:46,766 [INFO] - Extraction detection metrics - F1: 0.671, Precision: 0.633, Recall: 0.783, Detected-Cells: 5551
[37m2024-06-24 09:28:47,559 [INFO] - Training epoch stats:     Loss: 0.2048 - F1-Score: 0.9394 - Accuracy-Score: 0.9269 - AUROC: 0.9781 - AP: 0.9835
[37m2024-06-24 09:28:48,109 [INFO] - Validation epoch stats:   Loss: 0.3463 - F1-Score: 0.9037 - Accuracy-Score: 0.8761 - AUROC: 0.9241 - AP: 0.9449
[37m2024-06-24 09:28:48,187 [INFO] - Epoch: 9/50
[37m2024-06-24 09:28:48,187 [INFO] - Extracting training cells
[37m2024-06-24 09:29:09,378 [INFO] - Extraction detection metrics - F1: 0.677, Precision: 0.649, Recall: 0.786, Detected-Cells: 5475
[37m2024-06-24 09:29:09,567 [INFO] - Training epoch stats:     Loss: 0.2191 - F1-Score: 0.9257 - Accuracy-Score: 0.9098 - AUROC: 0.9722 - AP: 0.9799
[37m2024-06-24 09:29:10,019 [INFO] - Validation epoch stats:   Loss: 0.3441 - F1-Score: 0.9040 - Accuracy-Score: 0.8757 - AUROC: 0.9242 - AP: 0.9431
[37m2024-06-24 09:29:10,088 [INFO] - Epoch: 10/50
[37m2024-06-24 09:29:10,088 [INFO] - Extracting training cells
[37m2024-06-24 09:29:32,120 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.644, Recall: 0.775, Detected-Cells: 5574
[37m2024-06-24 09:29:32,334 [INFO] - Training epoch stats:     Loss: 0.1744 - F1-Score: 0.9509 - Accuracy-Score: 0.9383 - AUROC: 0.9827 - AP: 0.9881
[37m2024-06-24 09:29:32,718 [INFO] - Validation epoch stats:   Loss: 0.3449 - F1-Score: 0.9034 - Accuracy-Score: 0.8756 - AUROC: 0.9232 - AP: 0.9411
[37m2024-06-24 09:29:32,790 [INFO] - Epoch: 11/50
[37m2024-06-24 09:29:32,791 [INFO] - Extracting training cells
[37m2024-06-24 09:29:55,114 [INFO] - Extraction detection metrics - F1: 0.671, Precision: 0.648, Recall: 0.773, Detected-Cells: 5754
[37m2024-06-24 09:29:55,326 [INFO] - Training epoch stats:     Loss: 0.1657 - F1-Score: 0.9512 - Accuracy-Score: 0.9399 - AUROC: 0.9854 - AP: 0.9906
[37m2024-06-24 09:29:55,715 [INFO] - Validation epoch stats:   Loss: 0.3427 - F1-Score: 0.9037 - Accuracy-Score: 0.8747 - AUROC: 0.9231 - AP: 0.9409
[37m2024-06-24 09:29:55,788 [INFO] - Epoch: 12/50
[37m2024-06-24 09:29:55,788 [INFO] - Extracting training cells
[37m2024-06-24 09:30:15,925 [INFO] - Extraction detection metrics - F1: 0.661, Precision: 0.632, Recall: 0.749, Detected-Cells: 5397
[37m2024-06-24 09:30:16,147 [INFO] - Training epoch stats:     Loss: 0.1888 - F1-Score: 0.9463 - Accuracy-Score: 0.9314 - AUROC: 0.9754 - AP: 0.9839
[37m2024-06-24 09:30:16,695 [INFO] - Validation epoch stats:   Loss: 0.3464 - F1-Score: 0.9015 - Accuracy-Score: 0.8719 - AUROC: 0.9217 - AP: 0.9392
[37m2024-06-24 09:30:16,760 [INFO] - Epoch: 13/50
[37m2024-06-24 09:30:16,760 [INFO] - Extracting training cells
[37m2024-06-24 09:30:39,142 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.636, Recall: 0.774, Detected-Cells: 5384
[37m2024-06-24 09:30:39,346 [INFO] - Training epoch stats:     Loss: 0.1815 - F1-Score: 0.9437 - Accuracy-Score: 0.9302 - AUROC: 0.9766 - AP: 0.9821
[37m2024-06-24 09:30:39,817 [INFO] - Validation epoch stats:   Loss: 0.3466 - F1-Score: 0.9015 - Accuracy-Score: 0.8722 - AUROC: 0.9215 - AP: 0.9382
[37m2024-06-24 09:30:39,889 [INFO] - Epoch: 14/50
[37m2024-06-24 09:30:39,889 [INFO] - Extracting training cells
[37m2024-06-24 09:31:00,262 [INFO] - Extraction detection metrics - F1: 0.664, Precision: 0.635, Recall: 0.764, Detected-Cells: 5574
[37m2024-06-24 09:31:00,444 [INFO] - Training epoch stats:     Loss: 0.1628 - F1-Score: 0.9563 - Accuracy-Score: 0.9444 - AUROC: 0.9825 - AP: 0.9880
[37m2024-06-24 09:31:01,159 [INFO] - Validation epoch stats:   Loss: 0.3470 - F1-Score: 0.9016 - Accuracy-Score: 0.8727 - AUROC: 0.9217 - AP: 0.9382
[37m2024-06-24 09:31:01,224 [INFO] - Epoch: 15/50
[37m2024-06-24 09:31:01,225 [INFO] - Extracting training cells
[37m2024-06-24 09:31:22,543 [INFO] - Extraction detection metrics - F1: 0.669, Precision: 0.637, Recall: 0.778, Detected-Cells: 5608
[37m2024-06-24 09:31:22,747 [INFO] - Training epoch stats:     Loss: 0.1637 - F1-Score: 0.9475 - Accuracy-Score: 0.9360 - AUROC: 0.9836 - AP: 0.9886
[37m2024-06-24 09:31:23,208 [INFO] - Validation epoch stats:   Loss: 0.3525 - F1-Score: 0.8987 - Accuracy-Score: 0.8702 - AUROC: 0.9205 - AP: 0.9377
[37m2024-06-24 09:31:23,280 [INFO] - Epoch: 16/50
[37m2024-06-24 09:31:23,280 [INFO] - Extracting training cells
[37m2024-06-24 09:31:45,096 [INFO] - Extraction detection metrics - F1: 0.660, Precision: 0.629, Recall: 0.772, Detected-Cells: 5459
[37m2024-06-24 09:31:45,297 [INFO] - Training epoch stats:     Loss: 0.1625 - F1-Score: 0.9540 - Accuracy-Score: 0.9423 - AUROC: 0.9822 - AP: 0.9875
[37m2024-06-24 09:31:45,678 [INFO] - Validation epoch stats:   Loss: 0.3523 - F1-Score: 0.8997 - Accuracy-Score: 0.8699 - AUROC: 0.9200 - AP: 0.9383
[37m2024-06-24 09:31:45,679 [INFO] - Performing early stopping!
[37m2024-06-24 09:31:45,685 [INFO] - Finished run oxiglkqb
