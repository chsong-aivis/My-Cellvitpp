[37m2024-06-21 12:59:55,111 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-21 12:59:55,113 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/10/2024-06-21T125945_CellViT-UNI-10Percent
[37m2024-06-21 12:59:55,182 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f846d94c6a0>]
[37m2024-06-21 12:59:55,188 [INFO] - Using GPU: cuda:0
[37m2024-06-21 12:59:55,193 [INFO] - Using device: cuda:0
[37m2024-06-21 12:59:55,198 [INFO] - Loss function:
[37m2024-06-21 12:59:55,203 [INFO] - CrossEntropyLoss()
[37m2024-06-21 13:00:08,958 [INFO] - <All keys matched successfully>
[37m2024-06-21 13:00:10,236 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-21 13:00:10,243 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-21 13:00:10,248 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-21 13:00:10,253 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-21 13:00:10,273 [INFO] - Caching datasets
[37m2024-06-21 13:00:12,598 [INFO] - Instantiate Trainer
[37m2024-06-21 13:00:12,605 [INFO] - Calling Trainer Fit
[37m2024-06-21 13:00:12,611 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-21 13:00:12,616 [INFO] - Epoch: 1/50
[37m2024-06-21 13:00:12,621 [INFO] - Extracting training cells
[37m2024-06-21 13:00:38,470 [INFO] - Extraction detection metrics - F1: 0.662, Precision: 0.634, Recall: 0.769, Detected-Cells: 5399
[37m2024-06-21 13:00:38,773 [INFO] - Training epoch stats:     Loss: 0.6354 - F1-Score: 0.7546 - Accuracy-Score: 0.6631 - AUROC: 0.7337 - AP: 0.8321
[37m2024-06-21 13:00:42,674 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-21 13:00:43,115 [INFO] - Validation epoch stats:   Loss: 0.6050 - F1-Score: 0.8309 - Accuracy-Score: 0.7442 - AUROC: 0.8641 - AP: 0.9139
[37m2024-06-21 13:00:43,121 [INFO] - New best model - save checkpoint
[37m2024-06-21 13:00:43,324 [INFO] - Epoch: 2/50
[37m2024-06-21 13:00:43,326 [INFO] - Extracting training cells
[37m2024-06-21 13:01:12,377 [INFO] - Extraction detection metrics - F1: 0.673, Precision: 0.648, Recall: 0.783, Detected-Cells: 5616
[37m2024-06-21 13:01:12,765 [INFO] - Training epoch stats:     Loss: 0.5202 - F1-Score: 0.8539 - Accuracy-Score: 0.7844 - AUROC: 0.9366 - AP: 0.9592
[37m2024-06-21 13:01:13,465 [INFO] - Validation epoch stats:   Loss: 0.5339 - F1-Score: 0.8669 - Accuracy-Score: 0.8106 - AUROC: 0.9156 - AP: 0.9462
[37m2024-06-21 13:01:13,473 [INFO] - New best model - save checkpoint
[37m2024-06-21 13:01:13,731 [INFO] - Epoch: 3/50
[37m2024-06-21 13:01:13,737 [INFO] - Extracting training cells
[37m2024-06-21 13:01:36,257 [INFO] - Extraction detection metrics - F1: 0.665, Precision: 0.635, Recall: 0.770, Detected-Cells: 5376
[37m2024-06-21 13:01:36,463 [INFO] - Training epoch stats:     Loss: 0.4386 - F1-Score: 0.8978 - Accuracy-Score: 0.8666 - AUROC: 0.9522 - AP: 0.9687
[37m2024-06-21 13:01:36,860 [INFO] - Validation epoch stats:   Loss: 0.4793 - F1-Score: 0.8926 - Accuracy-Score: 0.8582 - AUROC: 0.9226 - AP: 0.9507
[37m2024-06-21 13:01:36,867 [INFO] - New best model - save checkpoint
[37m2024-06-21 13:01:37,036 [INFO] - Epoch: 4/50
[37m2024-06-21 13:01:37,040 [INFO] - Extracting training cells
[37m2024-06-21 13:01:56,079 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.635, Recall: 0.772, Detected-Cells: 5545
[37m2024-06-21 13:01:56,386 [INFO] - Training epoch stats:     Loss: 0.3662 - F1-Score: 0.9227 - Accuracy-Score: 0.9010 - AUROC: 0.9585 - AP: 0.9697
[37m2024-06-21 13:01:57,000 [INFO] - Validation epoch stats:   Loss: 0.4279 - F1-Score: 0.8987 - Accuracy-Score: 0.8686 - AUROC: 0.9252 - AP: 0.9515
[37m2024-06-21 13:01:57,005 [INFO] - New best model - save checkpoint
[37m2024-06-21 13:01:57,168 [INFO] - Epoch: 5/50
[37m2024-06-21 13:01:57,172 [INFO] - Extracting training cells
[37m2024-06-21 13:02:21,078 [INFO] - Extraction detection metrics - F1: 0.673, Precision: 0.643, Recall: 0.781, Detected-Cells: 5497
[37m2024-06-21 13:02:21,286 [INFO] - Training epoch stats:     Loss: 0.2975 - F1-Score: 0.9314 - Accuracy-Score: 0.9136 - AUROC: 0.9683 - AP: 0.9792
[37m2024-06-21 13:02:21,643 [INFO] - Validation epoch stats:   Loss: 0.3924 - F1-Score: 0.9017 - Accuracy-Score: 0.8736 - AUROC: 0.9266 - AP: 0.9514
[37m2024-06-21 13:02:21,649 [INFO] - New best model - save checkpoint
[37m2024-06-21 13:02:21,827 [INFO] - Epoch: 6/50
[37m2024-06-21 13:02:21,832 [INFO] - Extracting training cells
[37m2024-06-21 13:02:42,861 [INFO] - Extraction detection metrics - F1: 0.676, Precision: 0.646, Recall: 0.784, Detected-Cells: 5710
[37m2024-06-21 13:02:43,068 [INFO] - Training epoch stats:     Loss: 0.2734 - F1-Score: 0.9369 - Accuracy-Score: 0.9205 - AUROC: 0.9619 - AP: 0.9693
[37m2024-06-21 13:02:43,586 [INFO] - Validation epoch stats:   Loss: 0.3712 - F1-Score: 0.9042 - Accuracy-Score: 0.8776 - AUROC: 0.9270 - AP: 0.9506
[37m2024-06-21 13:02:43,592 [INFO] - New best model - save checkpoint
[37m2024-06-21 13:02:43,770 [INFO] - Epoch: 7/50
[37m2024-06-21 13:02:43,775 [INFO] - Extracting training cells
[37m2024-06-21 13:03:03,764 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.637, Recall: 0.769, Detected-Cells: 5430
[37m2024-06-21 13:03:04,184 [INFO] - Training epoch stats:     Loss: 0.2303 - F1-Score: 0.9388 - Accuracy-Score: 0.9234 - AUROC: 0.9750 - AP: 0.9835
[37m2024-06-21 13:03:05,089 [INFO] - Validation epoch stats:   Loss: 0.3531 - F1-Score: 0.9056 - Accuracy-Score: 0.8783 - AUROC: 0.9274 - AP: 0.9503
[37m2024-06-21 13:03:05,094 [INFO] - New best model - save checkpoint
[37m2024-06-21 13:03:05,345 [INFO] - Epoch: 8/50
[37m2024-06-21 13:03:05,351 [INFO] - Extracting training cells
[37m2024-06-21 13:03:27,065 [INFO] - Extraction detection metrics - F1: 0.673, Precision: 0.651, Recall: 0.775, Detected-Cells: 5543
[37m2024-06-21 13:03:27,248 [INFO] - Training epoch stats:     Loss: 0.2148 - F1-Score: 0.9451 - Accuracy-Score: 0.9300 - AUROC: 0.9741 - AP: 0.9818
[37m2024-06-21 13:03:27,655 [INFO] - Validation epoch stats:   Loss: 0.3459 - F1-Score: 0.9054 - Accuracy-Score: 0.8780 - AUROC: 0.9267 - AP: 0.9487
[37m2024-06-21 13:03:27,722 [INFO] - Epoch: 9/50
[37m2024-06-21 13:03:27,728 [INFO] - Extracting training cells
[37m2024-06-21 13:03:49,504 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.640, Recall: 0.776, Detected-Cells: 5622
[37m2024-06-21 13:03:49,718 [INFO] - Training epoch stats:     Loss: 0.1883 - F1-Score: 0.9502 - Accuracy-Score: 0.9383 - AUROC: 0.9829 - AP: 0.9885
[37m2024-06-21 13:03:50,122 [INFO] - Validation epoch stats:   Loss: 0.3467 - F1-Score: 0.9025 - Accuracy-Score: 0.8756 - AUROC: 0.9250 - AP: 0.9464
[37m2024-06-21 13:03:50,187 [INFO] - Epoch: 10/50
[37m2024-06-21 13:03:50,192 [INFO] - Extracting training cells
[37m2024-06-21 13:04:11,596 [INFO] - Extraction detection metrics - F1: 0.685, Precision: 0.653, Recall: 0.790, Detected-Cells: 5579
[37m2024-06-21 13:04:11,800 [INFO] - Training epoch stats:     Loss: 0.1814 - F1-Score: 0.9505 - Accuracy-Score: 0.9385 - AUROC: 0.9800 - AP: 0.9867
[37m2024-06-21 13:04:12,207 [INFO] - Validation epoch stats:   Loss: 0.3390 - F1-Score: 0.9040 - Accuracy-Score: 0.8759 - AUROC: 0.9261 - AP: 0.9463
[37m2024-06-21 13:04:12,280 [INFO] - Epoch: 11/50
[37m2024-06-21 13:04:12,285 [INFO] - Extracting training cells
[37m2024-06-21 13:04:34,320 [INFO] - Extraction detection metrics - F1: 0.645, Precision: 0.616, Recall: 0.758, Detected-Cells: 5425
[37m2024-06-21 13:04:34,540 [INFO] - Training epoch stats:     Loss: 0.1781 - F1-Score: 0.9503 - Accuracy-Score: 0.9364 - AUROC: 0.9809 - AP: 0.9888
[37m2024-06-21 13:04:35,175 [INFO] - Validation epoch stats:   Loss: 0.3411 - F1-Score: 0.9022 - Accuracy-Score: 0.8744 - AUROC: 0.9251 - AP: 0.9448
[37m2024-06-21 13:04:35,254 [INFO] - Epoch: 12/50
[37m2024-06-21 13:04:35,258 [INFO] - Extracting training cells
[37m2024-06-21 13:04:57,033 [INFO] - Extraction detection metrics - F1: 0.667, Precision: 0.638, Recall: 0.773, Detected-Cells: 5191
[37m2024-06-21 13:04:57,226 [INFO] - Training epoch stats:     Loss: 0.2002 - F1-Score: 0.9367 - Accuracy-Score: 0.9243 - AUROC: 0.9732 - AP: 0.9778
[37m2024-06-21 13:04:57,664 [INFO] - Validation epoch stats:   Loss: 0.3412 - F1-Score: 0.9016 - Accuracy-Score: 0.8738 - AUROC: 0.9251 - AP: 0.9445
[37m2024-06-21 13:04:57,736 [INFO] - Epoch: 13/50
[37m2024-06-21 13:04:57,741 [INFO] - Extracting training cells
[37m2024-06-21 13:05:19,173 [INFO] - Extraction detection metrics - F1: 0.665, Precision: 0.645, Recall: 0.768, Detected-Cells: 5602
[37m2024-06-21 13:05:19,363 [INFO] - Training epoch stats:     Loss: 0.1623 - F1-Score: 0.9507 - Accuracy-Score: 0.9393 - AUROC: 0.9847 - AP: 0.9896
[37m2024-06-21 13:05:19,820 [INFO] - Validation epoch stats:   Loss: 0.3430 - F1-Score: 0.9004 - Accuracy-Score: 0.8719 - AUROC: 0.9237 - AP: 0.9436
[37m2024-06-21 13:05:19,878 [INFO] - Epoch: 14/50
[37m2024-06-21 13:05:19,883 [INFO] - Extracting training cells
[37m2024-06-21 13:05:41,303 [INFO] - Extraction detection metrics - F1: 0.658, Precision: 0.637, Recall: 0.764, Detected-Cells: 5402
[37m2024-06-21 13:05:41,785 [INFO] - Training epoch stats:     Loss: 0.1605 - F1-Score: 0.9535 - Accuracy-Score: 0.9391 - AUROC: 0.9824 - AP: 0.9902
[37m2024-06-21 13:05:43,458 [INFO] - Validation epoch stats:   Loss: 0.3445 - F1-Score: 0.9012 - Accuracy-Score: 0.8719 - AUROC: 0.9225 - AP: 0.9425
[37m2024-06-21 13:05:43,529 [INFO] - Epoch: 15/50
[37m2024-06-21 13:05:43,555 [INFO] - Extracting training cells
[37m2024-06-21 13:06:07,398 [INFO] - Extraction detection metrics - F1: 0.647, Precision: 0.628, Recall: 0.751, Detected-Cells: 5182
[37m2024-06-21 13:06:07,607 [INFO] - Training epoch stats:     Loss: 0.1630 - F1-Score: 0.9517 - Accuracy-Score: 0.9402 - AUROC: 0.9829 - AP: 0.9874
[37m2024-06-21 13:06:08,011 [INFO] - Validation epoch stats:   Loss: 0.3524 - F1-Score: 0.8975 - Accuracy-Score: 0.8692 - AUROC: 0.9210 - AP: 0.9404
[37m2024-06-21 13:06:08,088 [INFO] - Epoch: 16/50
[37m2024-06-21 13:06:08,093 [INFO] - Extracting training cells
[37m2024-06-21 13:06:27,613 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.646, Recall: 0.767, Detected-Cells: 5602
[37m2024-06-21 13:06:27,829 [INFO] - Training epoch stats:     Loss: 0.1530 - F1-Score: 0.9555 - Accuracy-Score: 0.9443 - AUROC: 0.9850 - AP: 0.9905
[37m2024-06-21 13:06:28,233 [INFO] - Validation epoch stats:   Loss: 0.3491 - F1-Score: 0.8994 - Accuracy-Score: 0.8704 - AUROC: 0.9213 - AP: 0.9407
[37m2024-06-21 13:06:28,306 [INFO] - Epoch: 17/50
[37m2024-06-21 13:06:28,311 [INFO] - Extracting training cells
[37m2024-06-21 13:06:54,117 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.646, Recall: 0.762, Detected-Cells: 5659
[37m2024-06-21 13:06:54,349 [INFO] - Training epoch stats:     Loss: 0.1416 - F1-Score: 0.9582 - Accuracy-Score: 0.9480 - AUROC: 0.9877 - AP: 0.9914
[37m2024-06-21 13:06:54,771 [INFO] - Validation epoch stats:   Loss: 0.3559 - F1-Score: 0.8964 - Accuracy-Score: 0.8679 - AUROC: 0.9203 - AP: 0.9399
[37m2024-06-21 13:06:54,776 [INFO] - Performing early stopping!
[37m2024-06-21 13:06:54,785 [INFO] - Finished run 49y3emze
