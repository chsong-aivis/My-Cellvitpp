[37m2024-06-25 08:52:11,185 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 08:52:11,187 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/100/2024-06-25T085202_CellViT-UNI-100Percent
[37m2024-06-25 08:52:11,248 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f9a1673c6d0>]
[37m2024-06-25 08:52:11,248 [INFO] - Using GPU: cuda:0
[37m2024-06-25 08:52:11,253 [INFO] - Using device: cuda:0
[37m2024-06-25 08:52:11,259 [INFO] - Loss function:
[37m2024-06-25 08:52:11,263 [INFO] - CrossEntropyLoss()
[37m2024-06-25 08:52:24,059 [INFO] - <All keys matched successfully>
[37m2024-06-25 08:52:24,792 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 08:52:24,794 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 08:52:24,798 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 08:52:24,803 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 08:52:24,825 [INFO] - Caching datasets
[37m2024-06-25 08:52:33,970 [INFO] - Instantiate Trainer
[37m2024-06-25 08:52:33,975 [INFO] - Calling Trainer Fit
[37m2024-06-25 08:52:33,977 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 08:52:33,982 [INFO] - Epoch: 1/50
[37m2024-06-25 08:52:33,987 [INFO] - Extracting training cells
[37m2024-06-25 08:55:09,487 [INFO] - Extraction detection metrics - F1: 0.672, Precision: 0.640, Recall: 0.771, Detected-Cells: 47479
[37m2024-06-25 08:55:11,069 [INFO] - Training epoch stats:     Loss: 0.4367 - F1-Score: 0.8536 - Accuracy-Score: 0.8030 - AUROC: 0.8978 - AP: 0.9308
[37m2024-06-25 08:55:14,963 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 08:55:15,440 [INFO] - Validation epoch stats:   Loss: 0.3211 - F1-Score: 0.9058 - Accuracy-Score: 0.8799 - AUROC: 0.9384 - AP: 0.9592
[37m2024-06-25 08:55:15,441 [INFO] - New best model - save checkpoint
[37m2024-06-25 08:55:15,686 [INFO] - Epoch: 2/50
[37m2024-06-25 08:55:15,688 [INFO] - Extracting training cells
[37m2024-06-25 08:57:51,718 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.635, Recall: 0.770, Detected-Cells: 47499
[37m2024-06-25 08:57:53,660 [INFO] - Training epoch stats:     Loss: 0.2772 - F1-Score: 0.9116 - Accuracy-Score: 0.8895 - AUROC: 0.9514 - AP: 0.9657
[37m2024-06-25 08:57:54,012 [INFO] - Validation epoch stats:   Loss: 0.3352 - F1-Score: 0.8885 - Accuracy-Score: 0.8607 - AUROC: 0.9309 - AP: 0.9533
[37m2024-06-25 08:57:54,101 [INFO] - Epoch: 3/50
[37m2024-06-25 08:57:54,102 [INFO] - Extracting training cells
[37m2024-06-25 09:00:25,386 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.638, Recall: 0.769, Detected-Cells: 47196
[37m2024-06-25 09:00:27,359 [INFO] - Training epoch stats:     Loss: 0.2459 - F1-Score: 0.9219 - Accuracy-Score: 0.9036 - AUROC: 0.9609 - AP: 0.9712
[37m2024-06-25 09:00:27,733 [INFO] - Validation epoch stats:   Loss: 0.3422 - F1-Score: 0.8837 - Accuracy-Score: 0.8558 - AUROC: 0.9301 - AP: 0.9524
[37m2024-06-25 09:00:27,840 [INFO] - Epoch: 4/50
[37m2024-06-25 09:00:27,841 [INFO] - Extracting training cells
[37m2024-06-25 09:03:10,063 [INFO] - Extraction detection metrics - F1: 0.671, Precision: 0.638, Recall: 0.771, Detected-Cells: 48248
[37m2024-06-25 09:03:11,774 [INFO] - Training epoch stats:     Loss: 0.2265 - F1-Score: 0.9296 - Accuracy-Score: 0.9118 - AUROC: 0.9668 - AP: 0.9776
[37m2024-06-25 09:03:12,272 [INFO] - Validation epoch stats:   Loss: 0.3431 - F1-Score: 0.8830 - Accuracy-Score: 0.8547 - AUROC: 0.9294 - AP: 0.9518
[37m2024-06-25 09:03:12,384 [INFO] - Epoch: 5/50
[37m2024-06-25 09:03:12,385 [INFO] - Extracting training cells
[37m2024-06-25 09:05:47,330 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.637, Recall: 0.763, Detected-Cells: 48100
[37m2024-06-25 09:05:49,769 [INFO] - Training epoch stats:     Loss: 0.2081 - F1-Score: 0.9351 - Accuracy-Score: 0.9196 - AUROC: 0.9717 - AP: 0.9798
[37m2024-06-25 09:05:50,293 [INFO] - Validation epoch stats:   Loss: 0.3524 - F1-Score: 0.8815 - Accuracy-Score: 0.8526 - AUROC: 0.9269 - AP: 0.9497
[37m2024-06-25 09:05:50,386 [INFO] - Epoch: 6/50
[37m2024-06-25 09:05:50,387 [INFO] - Extracting training cells
[37m2024-06-25 09:08:35,421 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.634, Recall: 0.774, Detected-Cells: 47595
[37m2024-06-25 09:08:37,780 [INFO] - Training epoch stats:     Loss: 0.2068 - F1-Score: 0.9353 - Accuracy-Score: 0.9202 - AUROC: 0.9721 - AP: 0.9799
[37m2024-06-25 09:08:38,506 [INFO] - Validation epoch stats:   Loss: 0.3731 - F1-Score: 0.8708 - Accuracy-Score: 0.8415 - AUROC: 0.9229 - AP: 0.9478
[37m2024-06-25 09:08:38,592 [INFO] - Epoch: 7/50
[37m2024-06-25 09:08:38,592 [INFO] - Extracting training cells
[37m2024-06-25 09:11:11,811 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.635, Recall: 0.765, Detected-Cells: 47523
[37m2024-06-25 09:11:13,261 [INFO] - Training epoch stats:     Loss: 0.1941 - F1-Score: 0.9400 - Accuracy-Score: 0.9256 - AUROC: 0.9749 - AP: 0.9809
[37m2024-06-25 09:11:13,620 [INFO] - Validation epoch stats:   Loss: 0.3830 - F1-Score: 0.8681 - Accuracy-Score: 0.8381 - AUROC: 0.9203 - AP: 0.9456
[37m2024-06-25 09:11:13,705 [INFO] - Epoch: 8/50
[37m2024-06-25 09:11:13,705 [INFO] - Extracting training cells
[37m2024-06-25 09:13:51,825 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.635, Recall: 0.769, Detected-Cells: 47067
[37m2024-06-25 09:13:53,877 [INFO] - Training epoch stats:     Loss: 0.1940 - F1-Score: 0.9402 - Accuracy-Score: 0.9263 - AUROC: 0.9752 - AP: 0.9812
[37m2024-06-25 09:13:54,513 [INFO] - Validation epoch stats:   Loss: 0.3881 - F1-Score: 0.8694 - Accuracy-Score: 0.8398 - AUROC: 0.9192 - AP: 0.9440
[37m2024-06-25 09:13:54,620 [INFO] - Epoch: 9/50
[37m2024-06-25 09:13:54,620 [INFO] - Extracting training cells
[37m2024-06-25 09:16:23,725 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.633, Recall: 0.766, Detected-Cells: 47667
[37m2024-06-25 09:16:25,569 [INFO] - Training epoch stats:     Loss: 0.1795 - F1-Score: 0.9459 - Accuracy-Score: 0.9332 - AUROC: 0.9783 - AP: 0.9835
[37m2024-06-25 09:16:25,989 [INFO] - Validation epoch stats:   Loss: 0.4066 - F1-Score: 0.8664 - Accuracy-Score: 0.8364 - AUROC: 0.9147 - AP: 0.9401
[37m2024-06-25 09:16:26,075 [INFO] - Epoch: 10/50
[37m2024-06-25 09:16:26,075 [INFO] - Extracting training cells
[37m2024-06-25 09:18:58,173 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.636, Recall: 0.768, Detected-Cells: 47072
[37m2024-06-25 09:18:59,969 [INFO] - Training epoch stats:     Loss: 0.1750 - F1-Score: 0.9474 - Accuracy-Score: 0.9337 - AUROC: 0.9795 - AP: 0.9861
[37m2024-06-25 09:19:00,469 [INFO] - Validation epoch stats:   Loss: 0.3875 - F1-Score: 0.8771 - Accuracy-Score: 0.8469 - AUROC: 0.9186 - AP: 0.9443
[37m2024-06-25 09:19:00,583 [INFO] - Epoch: 11/50
[37m2024-06-25 09:19:00,583 [INFO] - Extracting training cells
[37m2024-06-25 09:21:30,693 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.635, Recall: 0.770, Detected-Cells: 46969
[37m2024-06-25 09:21:32,957 [INFO] - Training epoch stats:     Loss: 0.1742 - F1-Score: 0.9463 - Accuracy-Score: 0.9344 - AUROC: 0.9794 - AP: 0.9839
[37m2024-06-25 09:21:33,378 [INFO] - Validation epoch stats:   Loss: 0.3947 - F1-Score: 0.8746 - Accuracy-Score: 0.8449 - AUROC: 0.9178 - AP: 0.9439
[37m2024-06-25 09:21:33,379 [INFO] - Performing early stopping!
[37m2024-06-25 09:21:33,387 [INFO] - Finished run 8kauepim
