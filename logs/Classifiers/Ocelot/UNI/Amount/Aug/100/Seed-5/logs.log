[37m2024-06-25 10:55:20,319 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 10:55:20,320 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/100/2024-06-25T105511_CellViT-UNI-100Percent
[37m2024-06-25 10:55:20,379 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f203eda4670>]
[37m2024-06-25 10:55:20,379 [INFO] - Using GPU: cuda:0
[37m2024-06-25 10:55:20,383 [INFO] - Using device: cuda:0
[37m2024-06-25 10:55:20,388 [INFO] - Loss function:
[37m2024-06-25 10:55:20,392 [INFO] - CrossEntropyLoss()
[37m2024-06-25 10:55:33,858 [INFO] - <All keys matched successfully>
[37m2024-06-25 10:55:34,590 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 10:55:34,592 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 10:55:34,596 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 10:55:34,601 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 10:55:34,618 [INFO] - Caching datasets
[37m2024-06-25 10:55:40,386 [INFO] - Instantiate Trainer
[37m2024-06-25 10:55:40,390 [INFO] - Calling Trainer Fit
[37m2024-06-25 10:55:40,392 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 10:55:40,395 [INFO] - Epoch: 1/50
[37m2024-06-25 10:55:40,399 [INFO] - Extracting training cells
[37m2024-06-25 10:58:25,822 [INFO] - Extraction detection metrics - F1: 0.669, Precision: 0.637, Recall: 0.774, Detected-Cells: 47714
[37m2024-06-25 10:58:27,668 [INFO] - Training epoch stats:     Loss: 0.4258 - F1-Score: 0.8629 - Accuracy-Score: 0.8173 - AUROC: 0.9094 - AP: 0.9360
[37m2024-06-25 10:58:31,314 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 10:58:31,722 [INFO] - Validation epoch stats:   Loss: 0.3182 - F1-Score: 0.9075 - Accuracy-Score: 0.8829 - AUROC: 0.9417 - AP: 0.9621
[37m2024-06-25 10:58:31,724 [INFO] - New best model - save checkpoint
[37m2024-06-25 10:58:32,006 [INFO] - Epoch: 2/50
[37m2024-06-25 10:58:32,007 [INFO] - Extracting training cells
[37m2024-06-25 11:01:08,323 [INFO] - Extraction detection metrics - F1: 0.662, Precision: 0.631, Recall: 0.765, Detected-Cells: 47064
[37m2024-06-25 11:01:10,159 [INFO] - Training epoch stats:     Loss: 0.2682 - F1-Score: 0.9147 - Accuracy-Score: 0.8930 - AUROC: 0.9544 - AP: 0.9687
[37m2024-06-25 11:01:10,879 [INFO] - Validation epoch stats:   Loss: 0.3169 - F1-Score: 0.8984 - Accuracy-Score: 0.8705 - AUROC: 0.9342 - AP: 0.9568
[37m2024-06-25 11:01:11,022 [INFO] - Epoch: 3/50
[37m2024-06-25 11:01:11,022 [INFO] - Extracting training cells
[37m2024-06-25 11:03:52,708 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.636, Recall: 0.770, Detected-Cells: 47683
[37m2024-06-25 11:03:54,178 [INFO] - Training epoch stats:     Loss: 0.2493 - F1-Score: 0.9181 - Accuracy-Score: 0.8994 - AUROC: 0.9601 - AP: 0.9705
[37m2024-06-25 11:03:54,617 [INFO] - Validation epoch stats:   Loss: 0.3639 - F1-Score: 0.8674 - Accuracy-Score: 0.8383 - AUROC: 0.9252 - AP: 0.9512
[37m2024-06-25 11:03:54,759 [INFO] - Epoch: 4/50
[37m2024-06-25 11:03:54,760 [INFO] - Extracting training cells
[37m2024-06-25 11:06:35,708 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.636, Recall: 0.774, Detected-Cells: 47433
[37m2024-06-25 11:06:37,655 [INFO] - Training epoch stats:     Loss: 0.2342 - F1-Score: 0.9249 - Accuracy-Score: 0.9075 - AUROC: 0.9638 - AP: 0.9698
[37m2024-06-25 11:06:38,015 [INFO] - Validation epoch stats:   Loss: 0.3597 - F1-Score: 0.8732 - Accuracy-Score: 0.8434 - AUROC: 0.9244 - AP: 0.9493
[37m2024-06-25 11:06:38,138 [INFO] - Epoch: 5/50
[37m2024-06-25 11:06:38,139 [INFO] - Extracting training cells
[37m2024-06-25 11:09:16,535 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.634, Recall: 0.768, Detected-Cells: 47178
[37m2024-06-25 11:09:18,465 [INFO] - Training epoch stats:     Loss: 0.2192 - F1-Score: 0.9298 - Accuracy-Score: 0.9138 - AUROC: 0.9685 - AP: 0.9768
[37m2024-06-25 11:09:18,901 [INFO] - Validation epoch stats:   Loss: 0.3760 - F1-Score: 0.8710 - Accuracy-Score: 0.8406 - AUROC: 0.9194 - AP: 0.9432
[37m2024-06-25 11:09:19,025 [INFO] - Epoch: 6/50
[37m2024-06-25 11:09:19,026 [INFO] - Extracting training cells
[37m2024-06-25 11:11:59,117 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.634, Recall: 0.762, Detected-Cells: 47376
[37m2024-06-25 11:12:01,071 [INFO] - Training epoch stats:     Loss: 0.2106 - F1-Score: 0.9335 - Accuracy-Score: 0.9178 - AUROC: 0.9708 - AP: 0.9787
[37m2024-06-25 11:12:01,737 [INFO] - Validation epoch stats:   Loss: 0.3731 - F1-Score: 0.8733 - Accuracy-Score: 0.8425 - AUROC: 0.9188 - AP: 0.9440
[37m2024-06-25 11:12:01,849 [INFO] - Epoch: 7/50
[37m2024-06-25 11:12:01,850 [INFO] - Extracting training cells
[37m2024-06-25 11:14:41,735 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.636, Recall: 0.771, Detected-Cells: 47823
[37m2024-06-25 11:14:43,558 [INFO] - Training epoch stats:     Loss: 0.1973 - F1-Score: 0.9375 - Accuracy-Score: 0.9234 - AUROC: 0.9746 - AP: 0.9799
[37m2024-06-25 11:14:44,014 [INFO] - Validation epoch stats:   Loss: 0.3780 - F1-Score: 0.8725 - Accuracy-Score: 0.8421 - AUROC: 0.9198 - AP: 0.9462
[37m2024-06-25 11:14:44,163 [INFO] - Epoch: 8/50
[37m2024-06-25 11:14:44,163 [INFO] - Extracting training cells
[37m2024-06-25 11:17:22,337 [INFO] - Extraction detection metrics - F1: 0.662, Precision: 0.632, Recall: 0.763, Detected-Cells: 45997
[37m2024-06-25 11:17:23,755 [INFO] - Training epoch stats:     Loss: 0.1982 - F1-Score: 0.9399 - Accuracy-Score: 0.9253 - AUROC: 0.9731 - AP: 0.9787
[37m2024-06-25 11:17:24,104 [INFO] - Validation epoch stats:   Loss: 0.3818 - F1-Score: 0.8718 - Accuracy-Score: 0.8413 - AUROC: 0.9183 - AP: 0.9447
[37m2024-06-25 11:17:24,236 [INFO] - Epoch: 9/50
[37m2024-06-25 11:17:24,237 [INFO] - Extracting training cells
[37m2024-06-25 11:20:00,789 [INFO] - Extraction detection metrics - F1: 0.663, Precision: 0.633, Recall: 0.761, Detected-Cells: 47639
[37m2024-06-25 11:20:02,366 [INFO] - Training epoch stats:     Loss: 0.1788 - F1-Score: 0.9438 - Accuracy-Score: 0.9304 - AUROC: 0.9790 - AP: 0.9854
[37m2024-06-25 11:20:03,086 [INFO] - Validation epoch stats:   Loss: 0.3959 - F1-Score: 0.8708 - Accuracy-Score: 0.8404 - AUROC: 0.9163 - AP: 0.9443
[37m2024-06-25 11:20:03,231 [INFO] - Epoch: 10/50
[37m2024-06-25 11:20:03,231 [INFO] - Extracting training cells
[37m2024-06-25 11:22:40,901 [INFO] - Extraction detection metrics - F1: 0.668, Precision: 0.639, Recall: 0.767, Detected-Cells: 47739
[37m2024-06-25 11:22:42,971 [INFO] - Training epoch stats:     Loss: 0.1779 - F1-Score: 0.9447 - Accuracy-Score: 0.9321 - AUROC: 0.9794 - AP: 0.9852
[37m2024-06-25 11:22:43,514 [INFO] - Validation epoch stats:   Loss: 0.4145 - F1-Score: 0.8652 - Accuracy-Score: 0.8349 - AUROC: 0.9133 - AP: 0.9427
[37m2024-06-25 11:22:43,648 [INFO] - Epoch: 11/50
[37m2024-06-25 11:22:43,682 [INFO] - Extracting training cells
[37m2024-06-25 11:25:17,836 [INFO] - Extraction detection metrics - F1: 0.670, Precision: 0.639, Recall: 0.769, Detected-Cells: 47704
[37m2024-06-25 11:25:19,874 [INFO] - Training epoch stats:     Loss: 0.1783 - F1-Score: 0.9466 - Accuracy-Score: 0.9337 - AUROC: 0.9782 - AP: 0.9834
[37m2024-06-25 11:25:20,536 [INFO] - Validation epoch stats:   Loss: 0.4183 - F1-Score: 0.8682 - Accuracy-Score: 0.8383 - AUROC: 0.9131 - AP: 0.9420
[37m2024-06-25 11:25:20,537 [INFO] - Performing early stopping!
[37m2024-06-25 11:25:20,547 [INFO] - Finished run 3leqpwzf
