[37m2024-06-25 09:50:13,043 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 09:50:13,044 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/5/2024-06-25T095003_CellViT-UNI-5Percent
[37m2024-06-25 09:50:13,107 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7ff898d906d0>]
[37m2024-06-25 09:50:13,108 [INFO] - Using GPU: cuda:0
[37m2024-06-25 09:50:13,113 [INFO] - Using device: cuda:0
[37m2024-06-25 09:50:13,117 [INFO] - Loss function:
[37m2024-06-25 09:50:13,123 [INFO] - CrossEntropyLoss()
[37m2024-06-25 09:50:25,376 [INFO] - <All keys matched successfully>
[37m2024-06-25 09:50:26,162 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 09:50:26,163 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 09:50:26,167 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 09:50:26,173 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 09:50:26,189 [INFO] - Caching datasets
[37m2024-06-25 09:50:27,899 [INFO] - Instantiate Trainer
[37m2024-06-25 09:50:27,904 [INFO] - Calling Trainer Fit
[37m2024-06-25 09:50:27,905 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 09:50:27,910 [INFO] - Epoch: 1/50
[37m2024-06-25 09:50:27,915 [INFO] - Extracting training cells
[37m2024-06-25 09:50:41,958 [INFO] - Extraction detection metrics - F1: 0.718, Precision: 0.673, Recall: 0.826, Detected-Cells: 2544
[37m2024-06-25 09:50:42,116 [INFO] - Training epoch stats:     Loss: 0.6533 - F1-Score: 0.7082 - Accuracy-Score: 0.7131 - AUROC: 0.7910 - AP: 0.7647
[37m2024-06-25 09:50:48,402 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 09:50:48,955 [INFO] - Validation epoch stats:   Loss: 0.6579 - F1-Score: 0.7287 - Accuracy-Score: 0.6970 - AUROC: 0.8028 - AP: 0.8569
[37m2024-06-25 09:50:48,956 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:50:49,286 [INFO] - Epoch: 2/50
[37m2024-06-25 09:50:49,287 [INFO] - Extracting training cells
[37m2024-06-25 09:50:58,859 [INFO] - Extraction detection metrics - F1: 0.680, Precision: 0.647, Recall: 0.779, Detected-Cells: 2185
[37m2024-06-25 09:50:58,942 [INFO] - Training epoch stats:     Loss: 0.5914 - F1-Score: 0.8211 - Accuracy-Score: 0.8403 - AUROC: 0.9208 - AP: 0.9238
[37m2024-06-25 09:50:59,312 [INFO] - Validation epoch stats:   Loss: 0.6440 - F1-Score: 0.7238 - Accuracy-Score: 0.7042 - AUROC: 0.8475 - AP: 0.8945
[37m2024-06-25 09:50:59,313 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:50:59,606 [INFO] - Epoch: 3/50
[37m2024-06-25 09:50:59,606 [INFO] - Extracting training cells
[37m2024-06-25 09:51:09,562 [INFO] - Extraction detection metrics - F1: 0.708, Precision: 0.674, Recall: 0.802, Detected-Cells: 2531
[37m2024-06-25 09:51:09,710 [INFO] - Training epoch stats:     Loss: 0.5386 - F1-Score: 0.8611 - Accuracy-Score: 0.8807 - AUROC: 0.9572 - AP: 0.9484
[37m2024-06-25 09:51:10,339 [INFO] - Validation epoch stats:   Loss: 0.6308 - F1-Score: 0.7046 - Accuracy-Score: 0.6939 - AUROC: 0.8661 - AP: 0.9089
[37m2024-06-25 09:51:10,340 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:51:10,607 [INFO] - Epoch: 4/50
[37m2024-06-25 09:51:10,608 [INFO] - Extracting training cells
[37m2024-06-25 09:51:20,236 [INFO] - Extraction detection metrics - F1: 0.693, Precision: 0.656, Recall: 0.795, Detected-Cells: 2427
[37m2024-06-25 09:51:20,333 [INFO] - Training epoch stats:     Loss: 0.4946 - F1-Score: 0.8577 - Accuracy-Score: 0.8809 - AUROC: 0.9617 - AP: 0.9492
[37m2024-06-25 09:51:20,705 [INFO] - Validation epoch stats:   Loss: 0.6142 - F1-Score: 0.7124 - Accuracy-Score: 0.7013 - AUROC: 0.8757 - AP: 0.9153
[37m2024-06-25 09:51:20,705 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:51:20,978 [INFO] - Epoch: 5/50
[37m2024-06-25 09:51:20,979 [INFO] - Extracting training cells
[37m2024-06-25 09:51:30,190 [INFO] - Extraction detection metrics - F1: 0.688, Precision: 0.650, Recall: 0.784, Detected-Cells: 2405
[37m2024-06-25 09:51:30,283 [INFO] - Training epoch stats:     Loss: 0.4407 - F1-Score: 0.8811 - Accuracy-Score: 0.8960 - AUROC: 0.9653 - AP: 0.9603
[37m2024-06-25 09:51:30,658 [INFO] - Validation epoch stats:   Loss: 0.5936 - F1-Score: 0.7390 - Accuracy-Score: 0.7225 - AUROC: 0.8810 - AP: 0.9185
[37m2024-06-25 09:51:30,659 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:51:30,916 [INFO] - Epoch: 6/50
[37m2024-06-25 09:51:30,917 [INFO] - Extracting training cells
[37m2024-06-25 09:51:40,930 [INFO] - Extraction detection metrics - F1: 0.709, Precision: 0.674, Recall: 0.809, Detected-Cells: 2477
[37m2024-06-25 09:51:41,020 [INFO] - Training epoch stats:     Loss: 0.4029 - F1-Score: 0.8725 - Accuracy-Score: 0.8910 - AUROC: 0.9581 - AP: 0.9485
[37m2024-06-25 09:51:41,396 [INFO] - Validation epoch stats:   Loss: 0.5767 - F1-Score: 0.7507 - Accuracy-Score: 0.7327 - AUROC: 0.8846 - AP: 0.9212
[37m2024-06-25 09:51:41,397 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:51:41,665 [INFO] - Epoch: 7/50
[37m2024-06-25 09:51:41,666 [INFO] - Extracting training cells
[37m2024-06-25 09:51:50,766 [INFO] - Extraction detection metrics - F1: 0.681, Precision: 0.646, Recall: 0.779, Detected-Cells: 2086
[37m2024-06-25 09:51:50,850 [INFO] - Training epoch stats:     Loss: 0.3757 - F1-Score: 0.8823 - Accuracy-Score: 0.9051 - AUROC: 0.9688 - AP: 0.9593
[37m2024-06-25 09:51:51,228 [INFO] - Validation epoch stats:   Loss: 0.5645 - F1-Score: 0.7554 - Accuracy-Score: 0.7370 - AUROC: 0.8872 - AP: 0.9232
[37m2024-06-25 09:51:51,229 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:51:51,500 [INFO] - Epoch: 8/50
[37m2024-06-25 09:51:51,501 [INFO] - Extracting training cells
[37m2024-06-25 09:52:01,044 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.669, Recall: 0.813, Detected-Cells: 2464
[37m2024-06-25 09:52:01,124 [INFO] - Training epoch stats:     Loss: 0.3389 - F1-Score: 0.8980 - Accuracy-Score: 0.9046 - AUROC: 0.9649 - AP: 0.9653
[37m2024-06-25 09:52:01,462 [INFO] - Validation epoch stats:   Loss: 0.5393 - F1-Score: 0.7886 - Accuracy-Score: 0.7647 - AUROC: 0.8907 - AP: 0.9253
[37m2024-06-25 09:52:01,463 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:52:01,756 [INFO] - Epoch: 9/50
[37m2024-06-25 09:52:01,757 [INFO] - Extracting training cells
[37m2024-06-25 09:52:16,495 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.665, Recall: 0.813, Detected-Cells: 2566
[37m2024-06-25 09:52:16,610 [INFO] - Training epoch stats:     Loss: 0.3064 - F1-Score: 0.9100 - Accuracy-Score: 0.9189 - AUROC: 0.9806 - AP: 0.9764
[37m2024-06-25 09:52:17,000 [INFO] - Validation epoch stats:   Loss: 0.5341 - F1-Score: 0.7806 - Accuracy-Score: 0.7581 - AUROC: 0.8902 - AP: 0.9247
[37m2024-06-25 09:52:17,128 [INFO] - Epoch: 10/50
[37m2024-06-25 09:52:17,129 [INFO] - Extracting training cells
[37m2024-06-25 09:52:27,966 [INFO] - Extraction detection metrics - F1: 0.674, Precision: 0.654, Recall: 0.756, Detected-Cells: 2354
[37m2024-06-25 09:52:28,099 [INFO] - Training epoch stats:     Loss: 0.2658 - F1-Score: 0.9121 - Accuracy-Score: 0.9214 - AUROC: 0.9806 - AP: 0.9766
[37m2024-06-25 09:52:28,710 [INFO] - Validation epoch stats:   Loss: 0.5306 - F1-Score: 0.7783 - Accuracy-Score: 0.7563 - AUROC: 0.8902 - AP: 0.9245
[37m2024-06-25 09:52:28,816 [INFO] - Epoch: 11/50
[37m2024-06-25 09:52:28,817 [INFO] - Extracting training cells
[37m2024-06-25 09:52:38,344 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.671, Recall: 0.815, Detected-Cells: 2579
[37m2024-06-25 09:52:38,509 [INFO] - Training epoch stats:     Loss: 0.2528 - F1-Score: 0.9125 - Accuracy-Score: 0.9221 - AUROC: 0.9822 - AP: 0.9778
[37m2024-06-25 09:52:39,141 [INFO] - Validation epoch stats:   Loss: 0.5230 - F1-Score: 0.7833 - Accuracy-Score: 0.7606 - AUROC: 0.8905 - AP: 0.9245
[37m2024-06-25 09:52:39,250 [INFO] - Epoch: 12/50
[37m2024-06-25 09:52:39,251 [INFO] - Extracting training cells
[37m2024-06-25 09:52:48,244 [INFO] - Extraction detection metrics - F1: 0.705, Precision: 0.669, Recall: 0.802, Detected-Cells: 2390
[37m2024-06-25 09:52:48,341 [INFO] - Training epoch stats:     Loss: 0.2426 - F1-Score: 0.9119 - Accuracy-Score: 0.9172 - AUROC: 0.9800 - AP: 0.9771
[37m2024-06-25 09:52:48,710 [INFO] - Validation epoch stats:   Loss: 0.5123 - F1-Score: 0.7944 - Accuracy-Score: 0.7700 - AUROC: 0.8906 - AP: 0.9246
[37m2024-06-25 09:52:48,816 [INFO] - Epoch: 13/50
[37m2024-06-25 09:52:48,817 [INFO] - Extracting training cells
[37m2024-06-25 09:52:57,455 [INFO] - Extraction detection metrics - F1: 0.671, Precision: 0.629, Recall: 0.790, Detected-Cells: 2104
[37m2024-06-25 09:52:57,545 [INFO] - Training epoch stats:     Loss: 0.3018 - F1-Score: 0.8746 - Accuracy-Score: 0.8959 - AUROC: 0.9459 - AP: 0.9338
[37m2024-06-25 09:52:57,920 [INFO] - Validation epoch stats:   Loss: 0.4952 - F1-Score: 0.8114 - Accuracy-Score: 0.7854 - AUROC: 0.8934 - AP: 0.9269
[37m2024-06-25 09:52:57,921 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:52:58,172 [INFO] - Epoch: 14/50
[37m2024-06-25 09:52:58,172 [INFO] - Extracting training cells
[37m2024-06-25 09:53:06,672 [INFO] - Extraction detection metrics - F1: 0.699, Precision: 0.658, Recall: 0.802, Detected-Cells: 2228
[37m2024-06-25 09:53:06,745 [INFO] - Training epoch stats:     Loss: 0.2420 - F1-Score: 0.8861 - Accuracy-Score: 0.9062 - AUROC: 0.9697 - AP: 0.9511
[37m2024-06-25 09:53:07,051 [INFO] - Validation epoch stats:   Loss: 0.4826 - F1-Score: 0.8228 - Accuracy-Score: 0.7961 - AUROC: 0.8963 - AP: 0.9291
[37m2024-06-25 09:53:07,052 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:53:07,313 [INFO] - Epoch: 15/50
[37m2024-06-25 09:53:07,313 [INFO] - Extracting training cells
[37m2024-06-25 09:53:17,728 [INFO] - Extraction detection metrics - F1: 0.691, Precision: 0.660, Recall: 0.781, Detected-Cells: 2401
[37m2024-06-25 09:53:17,836 [INFO] - Training epoch stats:     Loss: 0.2306 - F1-Score: 0.9089 - Accuracy-Score: 0.9121 - AUROC: 0.9750 - AP: 0.9723
[37m2024-06-25 09:53:18,450 [INFO] - Validation epoch stats:   Loss: 0.5037 - F1-Score: 0.7958 - Accuracy-Score: 0.7721 - AUROC: 0.8962 - AP: 0.9294
[37m2024-06-25 09:53:18,563 [INFO] - Epoch: 16/50
[37m2024-06-25 09:53:18,563 [INFO] - Extracting training cells
[37m2024-06-25 09:53:30,692 [INFO] - Extraction detection metrics - F1: 0.660, Precision: 0.626, Recall: 0.764, Detected-Cells: 2245
[37m2024-06-25 09:53:30,777 [INFO] - Training epoch stats:     Loss: 0.2308 - F1-Score: 0.9099 - Accuracy-Score: 0.9122 - AUROC: 0.9738 - AP: 0.9723
[37m2024-06-25 09:53:31,164 [INFO] - Validation epoch stats:   Loss: 0.4975 - F1-Score: 0.8012 - Accuracy-Score: 0.7767 - AUROC: 0.8960 - AP: 0.9293
[37m2024-06-25 09:53:31,279 [INFO] - Epoch: 17/50
[37m2024-06-25 09:53:31,281 [INFO] - Extracting training cells
[37m2024-06-25 09:53:41,647 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.627, Recall: 0.771, Detected-Cells: 2218
[37m2024-06-25 09:53:41,736 [INFO] - Training epoch stats:     Loss: 0.2245 - F1-Score: 0.9074 - Accuracy-Score: 0.9143 - AUROC: 0.9735 - AP: 0.9700
[37m2024-06-25 09:53:42,120 [INFO] - Validation epoch stats:   Loss: 0.4904 - F1-Score: 0.8095 - Accuracy-Score: 0.7838 - AUROC: 0.8952 - AP: 0.9291
[37m2024-06-25 09:53:42,227 [INFO] - Epoch: 18/50
[37m2024-06-25 09:53:42,227 [INFO] - Extracting training cells
[37m2024-06-25 09:53:51,213 [INFO] - Extraction detection metrics - F1: 0.706, Precision: 0.669, Recall: 0.808, Detected-Cells: 2421
[37m2024-06-25 09:53:51,314 [INFO] - Training epoch stats:     Loss: 0.2032 - F1-Score: 0.9243 - Accuracy-Score: 0.9257 - AUROC: 0.9805 - AP: 0.9792
[37m2024-06-25 09:53:51,703 [INFO] - Validation epoch stats:   Loss: 0.5082 - F1-Score: 0.7940 - Accuracy-Score: 0.7702 - AUROC: 0.8935 - AP: 0.9282
[37m2024-06-25 09:53:51,822 [INFO] - Epoch: 19/50
[37m2024-06-25 09:53:51,822 [INFO] - Extracting training cells
[37m2024-06-25 09:54:01,078 [INFO] - Extraction detection metrics - F1: 0.698, Precision: 0.658, Recall: 0.801, Detected-Cells: 2494
[37m2024-06-25 09:54:01,172 [INFO] - Training epoch stats:     Loss: 0.1988 - F1-Score: 0.9264 - Accuracy-Score: 0.9310 - AUROC: 0.9785 - AP: 0.9784
[37m2024-06-25 09:54:01,556 [INFO] - Validation epoch stats:   Loss: 0.5163 - F1-Score: 0.7890 - Accuracy-Score: 0.7659 - AUROC: 0.8927 - AP: 0.9277
[37m2024-06-25 09:54:01,644 [INFO] - Epoch: 20/50
[37m2024-06-25 09:54:01,645 [INFO] - Extracting training cells
[37m2024-06-25 09:54:10,198 [INFO] - Extraction detection metrics - F1: 0.703, Precision: 0.659, Recall: 0.815, Detected-Cells: 2529
[37m2024-06-25 09:54:10,291 [INFO] - Training epoch stats:     Loss: 0.1713 - F1-Score: 0.9298 - Accuracy-Score: 0.9340 - AUROC: 0.9869 - AP: 0.9849
[37m2024-06-25 09:54:10,662 [INFO] - Validation epoch stats:   Loss: 0.5176 - F1-Score: 0.7903 - Accuracy-Score: 0.7668 - AUROC: 0.8919 - AP: 0.9270
[37m2024-06-25 09:54:10,770 [INFO] - Epoch: 21/50
[37m2024-06-25 09:54:10,770 [INFO] - Extracting training cells
[37m2024-06-25 09:54:20,176 [INFO] - Extraction detection metrics - F1: 0.699, Precision: 0.659, Recall: 0.808, Detected-Cells: 2424
[37m2024-06-25 09:54:20,270 [INFO] - Training epoch stats:     Loss: 0.1716 - F1-Score: 0.9267 - Accuracy-Score: 0.9340 - AUROC: 0.9848 - AP: 0.9807
[37m2024-06-25 09:54:20,643 [INFO] - Validation epoch stats:   Loss: 0.5074 - F1-Score: 0.8015 - Accuracy-Score: 0.7764 - AUROC: 0.8921 - AP: 0.9270
[37m2024-06-25 09:54:20,749 [INFO] - Epoch: 22/50
[37m2024-06-25 09:54:20,749 [INFO] - Extracting training cells
[37m2024-06-25 09:54:29,962 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.670, Recall: 0.817, Detected-Cells: 2600
[37m2024-06-25 09:54:30,074 [INFO] - Training epoch stats:     Loss: 0.1503 - F1-Score: 0.9377 - Accuracy-Score: 0.9438 - AUROC: 0.9880 - AP: 0.9846
[37m2024-06-25 09:54:30,512 [INFO] - Validation epoch stats:   Loss: 0.5146 - F1-Score: 0.7984 - Accuracy-Score: 0.7735 - AUROC: 0.8913 - AP: 0.9267
[37m2024-06-25 09:54:30,621 [INFO] - Epoch: 23/50
[37m2024-06-25 09:54:30,622 [INFO] - Extracting training cells
[37m2024-06-25 09:54:41,585 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.662, Recall: 0.809, Detected-Cells: 2548
[37m2024-06-25 09:54:41,682 [INFO] - Training epoch stats:     Loss: 0.1506 - F1-Score: 0.9369 - Accuracy-Score: 0.9419 - AUROC: 0.9888 - AP: 0.9864
[37m2024-06-25 09:54:42,119 [INFO] - Validation epoch stats:   Loss: 0.5159 - F1-Score: 0.7996 - Accuracy-Score: 0.7748 - AUROC: 0.8912 - AP: 0.9265
[37m2024-06-25 09:54:42,229 [INFO] - Epoch: 24/50
[37m2024-06-25 09:54:42,230 [INFO] - Extracting training cells
[37m2024-06-25 09:54:54,567 [INFO] - Extraction detection metrics - F1: 0.693, Precision: 0.652, Recall: 0.800, Detected-Cells: 2443
[37m2024-06-25 09:54:54,661 [INFO] - Training epoch stats:     Loss: 0.1618 - F1-Score: 0.9358 - Accuracy-Score: 0.9386 - AUROC: 0.9857 - AP: 0.9843
[37m2024-06-25 09:54:55,292 [INFO] - Validation epoch stats:   Loss: 0.5002 - F1-Score: 0.8127 - Accuracy-Score: 0.7861 - AUROC: 0.8910 - AP: 0.9265
[37m2024-06-25 09:54:55,293 [INFO] - Performing early stopping!
[37m2024-06-25 09:54:55,300 [INFO] - Finished run 4hpvp7ck
