[37m2024-06-25 08:02:51,623 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 08:02:51,624 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/Aug/25/2024-06-25T080244_CellViT-UNI-25Percent
[37m2024-06-25 08:02:51,687 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f2a09d906a0>]
[37m2024-06-25 08:02:51,688 [INFO] - Using GPU: cuda:0
[37m2024-06-25 08:02:51,692 [INFO] - Using device: cuda:0
[37m2024-06-25 08:02:51,696 [INFO] - Loss function:
[37m2024-06-25 08:02:51,700 [INFO] - CrossEntropyLoss()
[37m2024-06-25 08:03:04,567 [INFO] - <All keys matched successfully>
[37m2024-06-25 08:03:05,353 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 08:03:05,355 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 08:03:05,359 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 08:03:05,364 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 08:03:05,383 [INFO] - Caching datasets
[37m2024-06-25 08:03:08,273 [INFO] - Instantiate Trainer
[37m2024-06-25 08:03:08,280 [INFO] - Calling Trainer Fit
[37m2024-06-25 08:03:08,282 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 08:03:08,287 [INFO] - Epoch: 1/50
[37m2024-06-25 08:03:08,293 [INFO] - Extracting training cells
[37m2024-06-25 08:03:57,191 [INFO] - Extraction detection metrics - F1: 0.665, Precision: 0.640, Recall: 0.762, Detected-Cells: 13540
[37m2024-06-25 08:03:57,925 [INFO] - Training epoch stats:     Loss: 0.5723 - F1-Score: 0.7944 - Accuracy-Score: 0.6829 - AUROC: 0.8009 - AP: 0.8936
[37m2024-06-25 08:04:00,695 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 08:04:01,049 [INFO] - Validation epoch stats:   Loss: 0.5045 - F1-Score: 0.8459 - Accuracy-Score: 0.7734 - AUROC: 0.9108 - AP: 0.9435
[37m2024-06-25 08:04:01,050 [INFO] - New best model - save checkpoint
[37m2024-06-25 08:04:01,264 [INFO] - Epoch: 2/50
[37m2024-06-25 08:04:01,265 [INFO] - Extracting training cells
[37m2024-06-25 08:04:44,273 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.632, Recall: 0.765, Detected-Cells: 13475
[37m2024-06-25 08:04:44,667 [INFO] - Training epoch stats:     Loss: 0.3863 - F1-Score: 0.8990 - Accuracy-Score: 0.8620 - AUROC: 0.9505 - AP: 0.9713
[37m2024-06-25 08:04:45,290 [INFO] - Validation epoch stats:   Loss: 0.3873 - F1-Score: 0.8916 - Accuracy-Score: 0.8576 - AUROC: 0.9211 - AP: 0.9502
[37m2024-06-25 08:04:45,290 [INFO] - New best model - save checkpoint
[37m2024-06-25 08:04:45,510 [INFO] - Epoch: 3/50
[37m2024-06-25 08:04:45,510 [INFO] - Extracting training cells
[37m2024-06-25 08:05:28,675 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.636, Recall: 0.765, Detected-Cells: 13007
[37m2024-06-25 08:05:29,189 [INFO] - Training epoch stats:     Loss: 0.2768 - F1-Score: 0.9256 - Accuracy-Score: 0.9008 - AUROC: 0.9627 - AP: 0.9780
[37m2024-06-25 08:05:29,801 [INFO] - Validation epoch stats:   Loss: 0.3420 - F1-Score: 0.8982 - Accuracy-Score: 0.8676 - AUROC: 0.9267 - AP: 0.9530
[37m2024-06-25 08:05:29,802 [INFO] - New best model - save checkpoint
[37m2024-06-25 08:05:30,053 [INFO] - Epoch: 4/50
[37m2024-06-25 08:05:30,054 [INFO] - Extracting training cells
[37m2024-06-25 08:06:13,939 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.644, Recall: 0.758, Detected-Cells: 13628
[37m2024-06-25 08:06:14,339 [INFO] - Training epoch stats:     Loss: 0.2188 - F1-Score: 0.9393 - Accuracy-Score: 0.9208 - AUROC: 0.9737 - AP: 0.9841
[37m2024-06-25 08:06:14,665 [INFO] - Validation epoch stats:   Loss: 0.3362 - F1-Score: 0.8978 - Accuracy-Score: 0.8686 - AUROC: 0.9256 - AP: 0.9509
[37m2024-06-25 08:06:14,744 [INFO] - Epoch: 5/50
[37m2024-06-25 08:06:14,744 [INFO] - Extracting training cells
[37m2024-06-25 08:06:59,221 [INFO] - Extraction detection metrics - F1: 0.662, Precision: 0.634, Recall: 0.759, Detected-Cells: 13460
[37m2024-06-25 08:06:59,718 [INFO] - Training epoch stats:     Loss: 0.1913 - F1-Score: 0.9469 - Accuracy-Score: 0.9315 - AUROC: 0.9781 - AP: 0.9862
[37m2024-06-25 08:07:00,111 [INFO] - Validation epoch stats:   Loss: 0.3425 - F1-Score: 0.8946 - Accuracy-Score: 0.8659 - AUROC: 0.9240 - AP: 0.9487
[37m2024-06-25 08:07:00,201 [INFO] - Epoch: 6/50
[37m2024-06-25 08:07:00,202 [INFO] - Extracting training cells
[37m2024-06-25 08:07:42,390 [INFO] - Extraction detection metrics - F1: 0.649, Precision: 0.623, Recall: 0.745, Detected-Cells: 12997
[37m2024-06-25 08:07:42,815 [INFO] - Training epoch stats:     Loss: 0.1820 - F1-Score: 0.9501 - Accuracy-Score: 0.9350 - AUROC: 0.9786 - AP: 0.9869
[37m2024-06-25 08:07:43,324 [INFO] - Validation epoch stats:   Loss: 0.3484 - F1-Score: 0.8927 - Accuracy-Score: 0.8642 - AUROC: 0.9233 - AP: 0.9480
[37m2024-06-25 08:07:43,412 [INFO] - Epoch: 7/50
[37m2024-06-25 08:07:43,412 [INFO] - Extracting training cells
[37m2024-06-25 08:08:33,011 [INFO] - Extraction detection metrics - F1: 0.656, Precision: 0.629, Recall: 0.752, Detected-Cells: 13018
[37m2024-06-25 08:08:33,465 [INFO] - Training epoch stats:     Loss: 0.1764 - F1-Score: 0.9476 - Accuracy-Score: 0.9331 - AUROC: 0.9803 - AP: 0.9874
[37m2024-06-25 08:08:33,966 [INFO] - Validation epoch stats:   Loss: 0.3442 - F1-Score: 0.8951 - Accuracy-Score: 0.8660 - AUROC: 0.9245 - AP: 0.9489
[37m2024-06-25 08:08:34,070 [INFO] - Epoch: 8/50
[37m2024-06-25 08:08:34,070 [INFO] - Extracting training cells
[37m2024-06-25 08:09:16,028 [INFO] - Extraction detection metrics - F1: 0.648, Precision: 0.625, Recall: 0.742, Detected-Cells: 12602
[37m2024-06-25 08:09:16,423 [INFO] - Training epoch stats:     Loss: 0.1764 - F1-Score: 0.9513 - Accuracy-Score: 0.9379 - AUROC: 0.9778 - AP: 0.9844
[37m2024-06-25 08:09:17,041 [INFO] - Validation epoch stats:   Loss: 0.3496 - F1-Score: 0.8941 - Accuracy-Score: 0.8651 - AUROC: 0.9229 - AP: 0.9468
[37m2024-06-25 08:09:17,116 [INFO] - Epoch: 9/50
[37m2024-06-25 08:09:17,117 [INFO] - Extracting training cells
[37m2024-06-25 08:10:00,095 [INFO] - Extraction detection metrics - F1: 0.666, Precision: 0.639, Recall: 0.761, Detected-Cells: 12814
[37m2024-06-25 08:10:00,484 [INFO] - Training epoch stats:     Loss: 0.1626 - F1-Score: 0.9549 - Accuracy-Score: 0.9422 - AUROC: 0.9825 - AP: 0.9887
[37m2024-06-25 08:10:00,818 [INFO] - Validation epoch stats:   Loss: 0.3499 - F1-Score: 0.8944 - Accuracy-Score: 0.8649 - AUROC: 0.9230 - AP: 0.9472
[37m2024-06-25 08:10:00,900 [INFO] - Epoch: 10/50
[37m2024-06-25 08:10:00,900 [INFO] - Extracting training cells
[37m2024-06-25 08:10:43,294 [INFO] - Extraction detection metrics - F1: 0.655, Precision: 0.634, Recall: 0.748, Detected-Cells: 13321
[37m2024-06-25 08:10:43,790 [INFO] - Training epoch stats:     Loss: 0.1491 - F1-Score: 0.9570 - Accuracy-Score: 0.9441 - AUROC: 0.9840 - AP: 0.9895
[37m2024-06-25 08:10:44,231 [INFO] - Validation epoch stats:   Loss: 0.3522 - F1-Score: 0.8949 - Accuracy-Score: 0.8652 - AUROC: 0.9225 - AP: 0.9468
[37m2024-06-25 08:10:44,309 [INFO] - Epoch: 11/50
[37m2024-06-25 08:10:44,310 [INFO] - Extracting training cells
[37m2024-06-25 08:11:33,462 [INFO] - Extraction detection metrics - F1: 0.656, Precision: 0.628, Recall: 0.753, Detected-Cells: 13235
[37m2024-06-25 08:11:33,855 [INFO] - Training epoch stats:     Loss: 0.1466 - F1-Score: 0.9588 - Accuracy-Score: 0.9467 - AUROC: 0.9850 - AP: 0.9907
[37m2024-06-25 08:11:34,354 [INFO] - Validation epoch stats:   Loss: 0.3585 - F1-Score: 0.8934 - Accuracy-Score: 0.8638 - AUROC: 0.9213 - AP: 0.9458
[37m2024-06-25 08:11:34,445 [INFO] - Epoch: 12/50
[37m2024-06-25 08:11:34,445 [INFO] - Extracting training cells
[37m2024-06-25 08:12:13,951 [INFO] - Extraction detection metrics - F1: 0.664, Precision: 0.633, Recall: 0.764, Detected-Cells: 12917
[37m2024-06-25 08:12:14,350 [INFO] - Training epoch stats:     Loss: 0.1446 - F1-Score: 0.9584 - Accuracy-Score: 0.9468 - AUROC: 0.9860 - AP: 0.9910
[37m2024-06-25 08:12:14,667 [INFO] - Validation epoch stats:   Loss: 0.3845 - F1-Score: 0.8824 - Accuracy-Score: 0.8530 - AUROC: 0.9169 - AP: 0.9419
[37m2024-06-25 08:12:14,762 [INFO] - Epoch: 13/50
[37m2024-06-25 08:12:14,763 [INFO] - Extracting training cells
[37m2024-06-25 08:12:56,068 [INFO] - Extraction detection metrics - F1: 0.676, Precision: 0.641, Recall: 0.774, Detected-Cells: 13668
[37m2024-06-25 08:12:56,463 [INFO] - Training epoch stats:     Loss: 0.1335 - F1-Score: 0.9630 - Accuracy-Score: 0.9521 - AUROC: 0.9877 - AP: 0.9922
[37m2024-06-25 08:12:56,781 [INFO] - Validation epoch stats:   Loss: 0.3827 - F1-Score: 0.8867 - Accuracy-Score: 0.8567 - AUROC: 0.9156 - AP: 0.9407
[37m2024-06-25 08:12:56,781 [INFO] - Performing early stopping!
[37m2024-06-25 08:12:56,787 [INFO] - Finished run bcmh0fw2
