[37m2024-06-25 09:45:54,826 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 09:45:54,828 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/No-Aug/50/2024-06-25T094545_CellViT-UNI-50Percent
[37m2024-06-25 09:45:54,893 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f8621588520>]
[37m2024-06-25 09:45:54,893 [INFO] - Using GPU: cuda:0
[37m2024-06-25 09:45:54,898 [INFO] - Using device: cuda:0
[37m2024-06-25 09:45:54,903 [INFO] - Loss function:
[37m2024-06-25 09:45:54,908 [INFO] - CrossEntropyLoss()
[37m2024-06-25 09:46:06,367 [INFO] - <All keys matched successfully>
[37m2024-06-25 09:46:07,108 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 09:46:07,111 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 09:46:07,114 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 09:46:07,118 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 09:46:07,134 [INFO] - Caching datasets
[37m2024-06-25 09:46:10,794 [INFO] - Instantiate Trainer
[37m2024-06-25 09:46:10,800 [INFO] - Calling Trainer Fit
[37m2024-06-25 09:46:10,800 [INFO] - Dataset is cached after first epoch
[37m2024-06-25 09:46:10,805 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 09:46:10,809 [INFO] - Epoch: 1/50
[37m2024-06-25 09:46:15,544 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/6170fb9965de5421df40ea168d1c4fea82c60f686dbf4fef1adf4de44243e3a6.h5
[37m2024-06-25 09:46:16,757 [INFO] - Training epoch stats:     Loss: 0.4759 - F1-Score: 0.8550 - Accuracy-Score: 0.7858 - AUROC: 0.8935 - AP: 0.9377
[37m2024-06-25 09:46:20,232 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 09:46:20,617 [INFO] - Validation epoch stats:   Loss: 0.3692 - F1-Score: 0.9010 - Accuracy-Score: 0.8679 - AUROC: 0.9340 - AP: 0.9578
[37m2024-06-25 09:46:20,618 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:46:20,854 [INFO] - Epoch: 2/50
[37m2024-06-25 09:46:22,152 [INFO] - Training epoch stats:     Loss: 0.2747 - F1-Score: 0.9211 - Accuracy-Score: 0.8948 - AUROC: 0.9575 - AP: 0.9749
[37m2024-06-25 09:46:22,523 [INFO] - Validation epoch stats:   Loss: 0.3169 - F1-Score: 0.9057 - Accuracy-Score: 0.8779 - AUROC: 0.9347 - AP: 0.9564
[37m2024-06-25 09:46:22,523 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:46:22,782 [INFO] - Epoch: 3/50
[37m2024-06-25 09:46:23,678 [INFO] - Training epoch stats:     Loss: 0.2196 - F1-Score: 0.9359 - Accuracy-Score: 0.9156 - AUROC: 0.9691 - AP: 0.9817
[37m2024-06-25 09:46:24,295 [INFO] - Validation epoch stats:   Loss: 0.3181 - F1-Score: 0.9044 - Accuracy-Score: 0.8752 - AUROC: 0.9325 - AP: 0.9539
[37m2024-06-25 09:46:24,382 [INFO] - Epoch: 4/50
[37m2024-06-25 09:46:25,553 [INFO] - Training epoch stats:     Loss: 0.1949 - F1-Score: 0.9426 - Accuracy-Score: 0.9246 - AUROC: 0.9748 - AP: 0.9851
[37m2024-06-25 09:46:26,170 [INFO] - Validation epoch stats:   Loss: 0.3273 - F1-Score: 0.9017 - Accuracy-Score: 0.8722 - AUROC: 0.9294 - AP: 0.9516
[37m2024-06-25 09:46:26,270 [INFO] - Epoch: 5/50
[37m2024-06-25 09:46:27,199 [INFO] - Training epoch stats:     Loss: 0.1788 - F1-Score: 0.9479 - Accuracy-Score: 0.9317 - AUROC: 0.9783 - AP: 0.9871
[37m2024-06-25 09:46:27,587 [INFO] - Validation epoch stats:   Loss: 0.3363 - F1-Score: 0.9003 - Accuracy-Score: 0.8695 - AUROC: 0.9265 - AP: 0.9491
[37m2024-06-25 09:46:27,679 [INFO] - Epoch: 6/50
[37m2024-06-25 09:46:28,616 [INFO] - Training epoch stats:     Loss: 0.1691 - F1-Score: 0.9510 - Accuracy-Score: 0.9358 - AUROC: 0.9806 - AP: 0.9885
[37m2024-06-25 09:46:29,214 [INFO] - Validation epoch stats:   Loss: 0.3454 - F1-Score: 0.8986 - Accuracy-Score: 0.8673 - AUROC: 0.9246 - AP: 0.9477
[37m2024-06-25 09:46:29,310 [INFO] - Epoch: 7/50
[37m2024-06-25 09:46:30,355 [INFO] - Training epoch stats:     Loss: 0.1604 - F1-Score: 0.9538 - Accuracy-Score: 0.9393 - AUROC: 0.9822 - AP: 0.9895
[37m2024-06-25 09:46:30,725 [INFO] - Validation epoch stats:   Loss: 0.3527 - F1-Score: 0.8957 - Accuracy-Score: 0.8645 - AUROC: 0.9226 - AP: 0.9462
[37m2024-06-25 09:46:30,844 [INFO] - Epoch: 8/50
[37m2024-06-25 09:46:31,731 [INFO] - Training epoch stats:     Loss: 0.1540 - F1-Score: 0.9559 - Accuracy-Score: 0.9423 - AUROC: 0.9835 - AP: 0.9902
[37m2024-06-25 09:46:32,172 [INFO] - Validation epoch stats:   Loss: 0.3601 - F1-Score: 0.8940 - Accuracy-Score: 0.8624 - AUROC: 0.9212 - AP: 0.9445
[37m2024-06-25 09:46:32,278 [INFO] - Epoch: 9/50
[37m2024-06-25 09:46:33,397 [INFO] - Training epoch stats:     Loss: 0.1492 - F1-Score: 0.9576 - Accuracy-Score: 0.9445 - AUROC: 0.9846 - AP: 0.9909
[37m2024-06-25 09:46:33,778 [INFO] - Validation epoch stats:   Loss: 0.3635 - F1-Score: 0.8927 - Accuracy-Score: 0.8607 - AUROC: 0.9208 - AP: 0.9443
[37m2024-06-25 09:46:33,905 [INFO] - Epoch: 10/50
[37m2024-06-25 09:46:34,796 [INFO] - Training epoch stats:     Loss: 0.1448 - F1-Score: 0.9589 - Accuracy-Score: 0.9462 - AUROC: 0.9855 - AP: 0.9914
[37m2024-06-25 09:46:35,183 [INFO] - Validation epoch stats:   Loss: 0.3704 - F1-Score: 0.8926 - Accuracy-Score: 0.8603 - AUROC: 0.9198 - AP: 0.9433
[37m2024-06-25 09:46:35,275 [INFO] - Epoch: 11/50
[37m2024-06-25 09:46:36,187 [INFO] - Training epoch stats:     Loss: 0.1390 - F1-Score: 0.9600 - Accuracy-Score: 0.9476 - AUROC: 0.9863 - AP: 0.9918
[37m2024-06-25 09:46:36,666 [INFO] - Validation epoch stats:   Loss: 0.3735 - F1-Score: 0.8930 - Accuracy-Score: 0.8604 - AUROC: 0.9194 - AP: 0.9424
[37m2024-06-25 09:46:36,844 [INFO] - Epoch: 12/50
[37m2024-06-25 09:46:37,774 [INFO] - Training epoch stats:     Loss: 0.1360 - F1-Score: 0.9607 - Accuracy-Score: 0.9486 - AUROC: 0.9869 - AP: 0.9923
[37m2024-06-25 09:46:38,572 [INFO] - Validation epoch stats:   Loss: 0.3755 - F1-Score: 0.8918 - Accuracy-Score: 0.8590 - AUROC: 0.9191 - AP: 0.9422
[37m2024-06-25 09:46:38,573 [INFO] - Performing early stopping!
[37m2024-06-25 09:46:38,656 [INFO] - Finished run 2dq9quv1
