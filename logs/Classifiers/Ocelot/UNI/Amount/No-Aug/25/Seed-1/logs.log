[37m2024-06-21 12:40:16,765 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-21 12:40:16,767 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/No-Aug/25/2024-06-21T124007_CellViT-UNI-25Percent
[37m2024-06-21 12:40:16,834 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f539cf8c520>]
[37m2024-06-21 12:40:16,839 [INFO] - Using GPU: cuda:0
[37m2024-06-21 12:40:16,844 [INFO] - Using device: cuda:0
[37m2024-06-21 12:40:16,849 [INFO] - Loss function:
[37m2024-06-21 12:40:16,853 [INFO] - CrossEntropyLoss()
[37m2024-06-21 12:40:28,975 [INFO] - <All keys matched successfully>
[37m2024-06-21 12:40:29,815 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-21 12:40:29,821 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-21 12:40:29,826 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-21 12:40:29,831 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-21 12:40:29,851 [INFO] - Caching datasets
[37m2024-06-21 12:40:33,162 [INFO] - Instantiate Trainer
[37m2024-06-21 12:40:33,172 [INFO] - Calling Trainer Fit
[37m2024-06-21 12:40:33,177 [INFO] - Dataset is cached after first epoch
[37m2024-06-21 12:40:33,187 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-21 12:40:33,194 [INFO] - Epoch: 1/50
[37m2024-06-21 12:40:33,208 [INFO] - Extracting training cells
[37m2024-06-21 12:41:14,354 [INFO] - Extraction detection metrics - F1: 0.679, Precision: 0.652, Recall: 0.773, Detected-Cells: 14056
[37m2024-06-21 12:41:14,359 [INFO] - Caching dataset 6ff1014e40c97dcb9e699849ac95178b5f5b1254d1507985674d1039458fccc3 to disk...
[37m2024-06-21 12:41:29,861 [INFO] - Training epoch stats:     Loss: 0.5609 - F1-Score: 0.8122 - Accuracy-Score: 0.7236 - AUROC: 0.8313 - AP: 0.9043
[37m2024-06-21 12:41:34,977 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-21 12:41:35,427 [INFO] - Validation epoch stats:   Loss: 0.4841 - F1-Score: 0.8774 - Accuracy-Score: 0.8282 - AUROC: 0.9296 - AP: 0.9554
[37m2024-06-21 12:41:35,433 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:41:35,670 [INFO] - Epoch: 2/50
[37m2024-06-21 12:41:36,297 [INFO] - Training epoch stats:     Loss: 0.3615 - F1-Score: 0.9143 - Accuracy-Score: 0.8839 - AUROC: 0.9563 - AP: 0.9736
[37m2024-06-21 12:41:36,798 [INFO] - Validation epoch stats:   Loss: 0.3699 - F1-Score: 0.9004 - Accuracy-Score: 0.8711 - AUROC: 0.9299 - AP: 0.9563
[37m2024-06-21 12:41:36,805 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:41:37,022 [INFO] - Epoch: 3/50
[37m2024-06-21 12:41:37,603 [INFO] - Training epoch stats:     Loss: 0.2549 - F1-Score: 0.9335 - Accuracy-Score: 0.9130 - AUROC: 0.9690 - AP: 0.9811
[37m2024-06-21 12:41:38,042 [INFO] - Validation epoch stats:   Loss: 0.3310 - F1-Score: 0.9006 - Accuracy-Score: 0.8719 - AUROC: 0.9307 - AP: 0.9559
[37m2024-06-21 12:41:38,049 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:41:38,249 [INFO] - Epoch: 4/50
[37m2024-06-21 12:41:38,823 [INFO] - Training epoch stats:     Loss: 0.2052 - F1-Score: 0.9450 - Accuracy-Score: 0.9286 - AUROC: 0.9766 - AP: 0.9857
[37m2024-06-21 12:41:39,263 [INFO] - Validation epoch stats:   Loss: 0.3284 - F1-Score: 0.8989 - Accuracy-Score: 0.8713 - AUROC: 0.9300 - AP: 0.9544
[37m2024-06-21 12:41:39,334 [INFO] - Epoch: 5/50
[37m2024-06-21 12:41:39,956 [INFO] - Training epoch stats:     Loss: 0.1774 - F1-Score: 0.9522 - Accuracy-Score: 0.9382 - AUROC: 0.9811 - AP: 0.9884
[37m2024-06-21 12:41:40,335 [INFO] - Validation epoch stats:   Loss: 0.3278 - F1-Score: 0.8996 - Accuracy-Score: 0.8716 - AUROC: 0.9295 - AP: 0.9532
[37m2024-06-21 12:41:40,413 [INFO] - Epoch: 6/50
[37m2024-06-21 12:41:40,911 [INFO] - Training epoch stats:     Loss: 0.1600 - F1-Score: 0.9552 - Accuracy-Score: 0.9421 - AUROC: 0.9843 - AP: 0.9904
[37m2024-06-21 12:41:41,369 [INFO] - Validation epoch stats:   Loss: 0.3334 - F1-Score: 0.8985 - Accuracy-Score: 0.8698 - AUROC: 0.9279 - AP: 0.9516
[37m2024-06-21 12:41:41,441 [INFO] - Epoch: 7/50
[37m2024-06-21 12:41:42,276 [INFO] - Training epoch stats:     Loss: 0.1494 - F1-Score: 0.9573 - Accuracy-Score: 0.9449 - AUROC: 0.9860 - AP: 0.9916
[37m2024-06-21 12:41:42,940 [INFO] - Validation epoch stats:   Loss: 0.3426 - F1-Score: 0.8948 - Accuracy-Score: 0.8663 - AUROC: 0.9262 - AP: 0.9498
[37m2024-06-21 12:41:43,030 [INFO] - Epoch: 8/50
[37m2024-06-21 12:41:43,745 [INFO] - Training epoch stats:     Loss: 0.1405 - F1-Score: 0.9597 - Accuracy-Score: 0.9479 - AUROC: 0.9875 - AP: 0.9925
[37m2024-06-21 12:41:44,346 [INFO] - Validation epoch stats:   Loss: 0.3448 - F1-Score: 0.8968 - Accuracy-Score: 0.8678 - AUROC: 0.9255 - AP: 0.9490
[37m2024-06-21 12:41:44,418 [INFO] - Epoch: 9/50
[37m2024-06-21 12:41:45,431 [INFO] - Training epoch stats:     Loss: 0.1343 - F1-Score: 0.9615 - Accuracy-Score: 0.9503 - AUROC: 0.9884 - AP: 0.9930
[37m2024-06-21 12:41:46,038 [INFO] - Validation epoch stats:   Loss: 0.3560 - F1-Score: 0.8917 - Accuracy-Score: 0.8629 - AUROC: 0.9238 - AP: 0.9476
[37m2024-06-21 12:41:46,122 [INFO] - Epoch: 10/50
[37m2024-06-21 12:41:46,851 [INFO] - Training epoch stats:     Loss: 0.1287 - F1-Score: 0.9637 - Accuracy-Score: 0.9530 - AUROC: 0.9893 - AP: 0.9937
[37m2024-06-21 12:41:47,348 [INFO] - Validation epoch stats:   Loss: 0.3595 - F1-Score: 0.8930 - Accuracy-Score: 0.8639 - AUROC: 0.9229 - AP: 0.9466
[37m2024-06-21 12:41:47,426 [INFO] - Epoch: 11/50
[37m2024-06-21 12:41:47,912 [INFO] - Training epoch stats:     Loss: 0.1246 - F1-Score: 0.9646 - Accuracy-Score: 0.9542 - AUROC: 0.9899 - AP: 0.9940
[37m2024-06-21 12:41:48,264 [INFO] - Validation epoch stats:   Loss: 0.3655 - F1-Score: 0.8921 - Accuracy-Score: 0.8629 - AUROC: 0.9222 - AP: 0.9461
[37m2024-06-21 12:41:48,332 [INFO] - Epoch: 12/50
[37m2024-06-21 12:41:48,820 [INFO] - Training epoch stats:     Loss: 0.1209 - F1-Score: 0.9658 - Accuracy-Score: 0.9558 - AUROC: 0.9904 - AP: 0.9944
[37m2024-06-21 12:41:49,184 [INFO] - Validation epoch stats:   Loss: 0.3701 - F1-Score: 0.8920 - Accuracy-Score: 0.8628 - AUROC: 0.9214 - AP: 0.9453
[37m2024-06-21 12:41:49,252 [INFO] - Epoch: 13/50
[37m2024-06-21 12:41:49,736 [INFO] - Training epoch stats:     Loss: 0.1173 - F1-Score: 0.9662 - Accuracy-Score: 0.9564 - AUROC: 0.9910 - AP: 0.9947
[37m2024-06-21 12:41:50,170 [INFO] - Validation epoch stats:   Loss: 0.3749 - F1-Score: 0.8927 - Accuracy-Score: 0.8629 - AUROC: 0.9204 - AP: 0.9442
[37m2024-06-21 12:41:50,176 [INFO] - Performing early stopping!
[37m2024-06-21 12:41:50,182 [INFO] - Finished run 4m8v9426
