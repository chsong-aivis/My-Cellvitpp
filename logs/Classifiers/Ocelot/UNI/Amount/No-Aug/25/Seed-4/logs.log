[37m2024-06-25 07:45:37,116 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 07:45:37,117 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/No-Aug/25/2024-06-25T074529_CellViT-UNI-25Percent
[37m2024-06-25 07:45:37,183 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fbc231ac520>]
[37m2024-06-25 07:45:37,184 [INFO] - Using GPU: cuda:0
[37m2024-06-25 07:45:37,189 [INFO] - Using device: cuda:0
[37m2024-06-25 07:45:37,194 [INFO] - Loss function:
[37m2024-06-25 07:45:37,198 [INFO] - CrossEntropyLoss()
[37m2024-06-25 07:45:50,477 [INFO] - <All keys matched successfully>
[37m2024-06-25 07:45:51,297 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 07:45:51,298 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 07:45:51,303 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 07:45:51,308 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 07:45:51,325 [INFO] - Caching datasets
[37m2024-06-25 07:45:54,225 [INFO] - Instantiate Trainer
[37m2024-06-25 07:45:54,230 [INFO] - Calling Trainer Fit
[37m2024-06-25 07:45:54,232 [INFO] - Dataset is cached after first epoch
[37m2024-06-25 07:45:54,237 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 07:45:54,243 [INFO] - Epoch: 1/50
[37m2024-06-25 07:45:56,999 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/6ff1014e40c97dcb9e699849ac95178b5f5b1254d1507985674d1039458fccc3.h5
[37m2024-06-25 07:45:57,777 [INFO] - Training epoch stats:     Loss: 0.5677 - F1-Score: 0.7990 - Accuracy-Score: 0.6932 - AUROC: 0.8183 - AP: 0.8999
[37m2024-06-25 07:46:00,746 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 07:46:01,147 [INFO] - Validation epoch stats:   Loss: 0.4958 - F1-Score: 0.8584 - Accuracy-Score: 0.7967 - AUROC: 0.9115 - AP: 0.9437
[37m2024-06-25 07:46:01,148 [INFO] - New best model - save checkpoint
[37m2024-06-25 07:46:01,373 [INFO] - Epoch: 2/50
[37m2024-06-25 07:46:01,916 [INFO] - Training epoch stats:     Loss: 0.3640 - F1-Score: 0.9109 - Accuracy-Score: 0.8788 - AUROC: 0.9576 - AP: 0.9746
[37m2024-06-25 07:46:02,561 [INFO] - Validation epoch stats:   Loss: 0.3778 - F1-Score: 0.8935 - Accuracy-Score: 0.8610 - AUROC: 0.9222 - AP: 0.9508
[37m2024-06-25 07:46:02,562 [INFO] - New best model - save checkpoint
[37m2024-06-25 07:46:02,776 [INFO] - Epoch: 3/50
[37m2024-06-25 07:46:03,388 [INFO] - Training epoch stats:     Loss: 0.2533 - F1-Score: 0.9327 - Accuracy-Score: 0.9118 - AUROC: 0.9696 - AP: 0.9819
[37m2024-06-25 07:46:03,773 [INFO] - Validation epoch stats:   Loss: 0.3422 - F1-Score: 0.8970 - Accuracy-Score: 0.8681 - AUROC: 0.9253 - AP: 0.9514
[37m2024-06-25 07:46:03,773 [INFO] - New best model - save checkpoint
[37m2024-06-25 07:46:03,992 [INFO] - Epoch: 4/50
[37m2024-06-25 07:46:04,517 [INFO] - Training epoch stats:     Loss: 0.2048 - F1-Score: 0.9445 - Accuracy-Score: 0.9281 - AUROC: 0.9764 - AP: 0.9857
[37m2024-06-25 07:46:04,910 [INFO] - Validation epoch stats:   Loss: 0.3352 - F1-Score: 0.8978 - Accuracy-Score: 0.8696 - AUROC: 0.9263 - AP: 0.9507
[37m2024-06-25 07:46:04,911 [INFO] - New best model - save checkpoint
[37m2024-06-25 07:46:05,116 [INFO] - Epoch: 5/50
[37m2024-06-25 07:46:05,615 [INFO] - Training epoch stats:     Loss: 0.1760 - F1-Score: 0.9518 - Accuracy-Score: 0.9375 - AUROC: 0.9818 - AP: 0.9889
[37m2024-06-25 07:46:05,994 [INFO] - Validation epoch stats:   Loss: 0.3360 - F1-Score: 0.8974 - Accuracy-Score: 0.8686 - AUROC: 0.9260 - AP: 0.9495
[37m2024-06-25 07:46:06,074 [INFO] - Epoch: 6/50
[37m2024-06-25 07:46:06,766 [INFO] - Training epoch stats:     Loss: 0.1592 - F1-Score: 0.9547 - Accuracy-Score: 0.9414 - AUROC: 0.9845 - AP: 0.9907
[37m2024-06-25 07:46:07,424 [INFO] - Validation epoch stats:   Loss: 0.3398 - F1-Score: 0.8967 - Accuracy-Score: 0.8674 - AUROC: 0.9252 - AP: 0.9485
[37m2024-06-25 07:46:07,509 [INFO] - Epoch: 7/50
[37m2024-06-25 07:46:08,142 [INFO] - Training epoch stats:     Loss: 0.1489 - F1-Score: 0.9574 - Accuracy-Score: 0.9449 - AUROC: 0.9860 - AP: 0.9916
[37m2024-06-25 07:46:08,521 [INFO] - Validation epoch stats:   Loss: 0.3471 - F1-Score: 0.8951 - Accuracy-Score: 0.8657 - AUROC: 0.9237 - AP: 0.9469
[37m2024-06-25 07:46:08,601 [INFO] - Epoch: 8/50
[37m2024-06-25 07:46:09,108 [INFO] - Training epoch stats:     Loss: 0.1397 - F1-Score: 0.9594 - Accuracy-Score: 0.9476 - AUROC: 0.9876 - AP: 0.9926
[37m2024-06-25 07:46:09,480 [INFO] - Validation epoch stats:   Loss: 0.3554 - F1-Score: 0.8927 - Accuracy-Score: 0.8634 - AUROC: 0.9221 - AP: 0.9454
[37m2024-06-25 07:46:09,560 [INFO] - Epoch: 9/50
[37m2024-06-25 07:46:10,300 [INFO] - Training epoch stats:     Loss: 0.1332 - F1-Score: 0.9624 - Accuracy-Score: 0.9515 - AUROC: 0.9887 - AP: 0.9933
[37m2024-06-25 07:46:10,874 [INFO] - Validation epoch stats:   Loss: 0.3579 - F1-Score: 0.8942 - Accuracy-Score: 0.8644 - AUROC: 0.9215 - AP: 0.9446
[37m2024-06-25 07:46:10,958 [INFO] - Epoch: 10/50
[37m2024-06-25 07:46:11,659 [INFO] - Training epoch stats:     Loss: 0.1280 - F1-Score: 0.9631 - Accuracy-Score: 0.9523 - AUROC: 0.9895 - AP: 0.9938
[37m2024-06-25 07:46:12,041 [INFO] - Validation epoch stats:   Loss: 0.3645 - F1-Score: 0.8935 - Accuracy-Score: 0.8635 - AUROC: 0.9206 - AP: 0.9438
[37m2024-06-25 07:46:12,118 [INFO] - Epoch: 11/50
[37m2024-06-25 07:46:12,887 [INFO] - Training epoch stats:     Loss: 0.1239 - F1-Score: 0.9641 - Accuracy-Score: 0.9535 - AUROC: 0.9900 - AP: 0.9941
[37m2024-06-25 07:46:13,270 [INFO] - Validation epoch stats:   Loss: 0.3800 - F1-Score: 0.8883 - Accuracy-Score: 0.8594 - AUROC: 0.9191 - AP: 0.9426
[37m2024-06-25 07:46:13,343 [INFO] - Epoch: 12/50
[37m2024-06-25 07:46:13,853 [INFO] - Training epoch stats:     Loss: 0.1206 - F1-Score: 0.9646 - Accuracy-Score: 0.9543 - AUROC: 0.9906 - AP: 0.9945
[37m2024-06-25 07:46:14,408 [INFO] - Validation epoch stats:   Loss: 0.3773 - F1-Score: 0.8914 - Accuracy-Score: 0.8614 - AUROC: 0.9185 - AP: 0.9419
[37m2024-06-25 07:46:14,485 [INFO] - Epoch: 13/50
[37m2024-06-25 07:46:15,198 [INFO] - Training epoch stats:     Loss: 0.1163 - F1-Score: 0.9667 - Accuracy-Score: 0.9570 - AUROC: 0.9912 - AP: 0.9948
[37m2024-06-25 07:46:15,565 [INFO] - Validation epoch stats:   Loss: 0.3846 - F1-Score: 0.8899 - Accuracy-Score: 0.8603 - AUROC: 0.9179 - AP: 0.9413
[37m2024-06-25 07:46:15,641 [INFO] - Epoch: 14/50
[37m2024-06-25 07:46:16,153 [INFO] - Training epoch stats:     Loss: 0.1134 - F1-Score: 0.9671 - Accuracy-Score: 0.9575 - AUROC: 0.9916 - AP: 0.9951
[37m2024-06-25 07:46:16,528 [INFO] - Validation epoch stats:   Loss: 0.3862 - F1-Score: 0.8906 - Accuracy-Score: 0.8606 - AUROC: 0.9175 - AP: 0.9406
[37m2024-06-25 07:46:16,529 [INFO] - Performing early stopping!
[37m2024-06-25 07:46:16,535 [INFO] - Finished run r6r9qpdx
