[37m2024-06-25 09:48:33,888 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 09:48:33,889 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/No-Aug/100/2024-06-25T094825_CellViT-UNI-100Percent
[37m2024-06-25 09:48:33,957 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f7206150580>]
[37m2024-06-25 09:48:33,958 [INFO] - Using GPU: cuda:0
[37m2024-06-25 09:48:33,963 [INFO] - Using device: cuda:0
[37m2024-06-25 09:48:33,967 [INFO] - Loss function:
[37m2024-06-25 09:48:33,972 [INFO] - CrossEntropyLoss()
[37m2024-06-25 09:48:46,166 [INFO] - <All keys matched successfully>
[37m2024-06-25 09:48:46,982 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 09:48:46,983 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 09:48:46,988 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 09:48:46,993 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 09:48:47,010 [INFO] - Caching datasets
[37m2024-06-25 09:48:53,586 [INFO] - Instantiate Trainer
[37m2024-06-25 09:48:53,591 [INFO] - Calling Trainer Fit
[37m2024-06-25 09:48:53,593 [INFO] - Dataset is cached after first epoch
[37m2024-06-25 09:48:53,597 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 09:48:53,602 [INFO] - Epoch: 1/50
[37m2024-06-25 09:49:02,849 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/f6098e4f8085ee14a1d66602742f253989316101ace520909583d2700f0a7344.h5
[37m2024-06-25 09:49:04,557 [INFO] - Training epoch stats:     Loss: 0.4125 - F1-Score: 0.8666 - Accuracy-Score: 0.8223 - AUROC: 0.9144 - AP: 0.9402
[37m2024-06-25 09:49:07,920 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 09:49:08,361 [INFO] - Validation epoch stats:   Loss: 0.3165 - F1-Score: 0.9073 - Accuracy-Score: 0.8822 - AUROC: 0.9391 - AP: 0.9596
[37m2024-06-25 09:49:08,363 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:49:08,647 [INFO] - Epoch: 2/50
[37m2024-06-25 09:49:10,968 [INFO] - Training epoch stats:     Loss: 0.2569 - F1-Score: 0.9169 - Accuracy-Score: 0.8969 - AUROC: 0.9586 - AP: 0.9715
[37m2024-06-25 09:49:11,354 [INFO] - Validation epoch stats:   Loss: 0.3372 - F1-Score: 0.8854 - Accuracy-Score: 0.8570 - AUROC: 0.9305 - AP: 0.9535
[37m2024-06-25 09:49:11,492 [INFO] - Epoch: 3/50
[37m2024-06-25 09:49:13,666 [INFO] - Training epoch stats:     Loss: 0.2258 - F1-Score: 0.9282 - Accuracy-Score: 0.9112 - AUROC: 0.9675 - AP: 0.9775
[37m2024-06-25 09:49:14,232 [INFO] - Validation epoch stats:   Loss: 0.3504 - F1-Score: 0.8788 - Accuracy-Score: 0.8485 - AUROC: 0.9249 - AP: 0.9496
[37m2024-06-25 09:49:14,346 [INFO] - Epoch: 4/50
[37m2024-06-25 09:49:16,059 [INFO] - Training epoch stats:     Loss: 0.2066 - F1-Score: 0.9341 - Accuracy-Score: 0.9186 - AUROC: 0.9726 - AP: 0.9809
[37m2024-06-25 09:49:16,565 [INFO] - Validation epoch stats:   Loss: 0.3757 - F1-Score: 0.8686 - Accuracy-Score: 0.8387 - AUROC: 0.9211 - AP: 0.9462
[37m2024-06-25 09:49:16,678 [INFO] - Epoch: 5/50
[37m2024-06-25 09:49:18,966 [INFO] - Training epoch stats:     Loss: 0.1930 - F1-Score: 0.9392 - Accuracy-Score: 0.9251 - AUROC: 0.9760 - AP: 0.9831
[37m2024-06-25 09:49:19,672 [INFO] - Validation epoch stats:   Loss: 0.3719 - F1-Score: 0.8743 - Accuracy-Score: 0.8426 - AUROC: 0.9184 - AP: 0.9447
[37m2024-06-25 09:49:19,859 [INFO] - Epoch: 6/50
[37m2024-06-25 09:49:25,781 [INFO] - Training epoch stats:     Loss: 0.1807 - F1-Score: 0.9434 - Accuracy-Score: 0.9303 - AUROC: 0.9789 - AP: 0.9852
[37m2024-06-25 09:49:26,933 [INFO] - Validation epoch stats:   Loss: 0.3948 - F1-Score: 0.8668 - Accuracy-Score: 0.8360 - AUROC: 0.9159 - AP: 0.9429
[37m2024-06-25 09:49:27,045 [INFO] - Epoch: 7/50
[37m2024-06-25 09:49:29,479 [INFO] - Training epoch stats:     Loss: 0.1715 - F1-Score: 0.9468 - Accuracy-Score: 0.9345 - AUROC: 0.9809 - AP: 0.9864
[37m2024-06-25 09:49:30,264 [INFO] - Validation epoch stats:   Loss: 0.3953 - F1-Score: 0.8696 - Accuracy-Score: 0.8381 - AUROC: 0.9150 - AP: 0.9427
[37m2024-06-25 09:49:30,391 [INFO] - Epoch: 8/50
[37m2024-06-25 09:49:32,672 [INFO] - Training epoch stats:     Loss: 0.1627 - F1-Score: 0.9497 - Accuracy-Score: 0.9382 - AUROC: 0.9828 - AP: 0.9878
[37m2024-06-25 09:49:33,145 [INFO] - Validation epoch stats:   Loss: 0.4062 - F1-Score: 0.8684 - Accuracy-Score: 0.8370 - AUROC: 0.9139 - AP: 0.9420
[37m2024-06-25 09:49:33,256 [INFO] - Epoch: 9/50
[37m2024-06-25 09:49:35,671 [INFO] - Training epoch stats:     Loss: 0.1554 - F1-Score: 0.9512 - Accuracy-Score: 0.9400 - AUROC: 0.9843 - AP: 0.9888
[37m2024-06-25 09:49:36,076 [INFO] - Validation epoch stats:   Loss: 0.4167 - F1-Score: 0.8665 - Accuracy-Score: 0.8359 - AUROC: 0.9138 - AP: 0.9423
[37m2024-06-25 09:49:36,197 [INFO] - Epoch: 10/50
[37m2024-06-25 09:49:38,477 [INFO] - Training epoch stats:     Loss: 0.1483 - F1-Score: 0.9545 - Accuracy-Score: 0.9441 - AUROC: 0.9856 - AP: 0.9898
[37m2024-06-25 09:49:39,016 [INFO] - Validation epoch stats:   Loss: 0.4256 - F1-Score: 0.8649 - Accuracy-Score: 0.8336 - AUROC: 0.9118 - AP: 0.9404
[37m2024-06-25 09:49:39,149 [INFO] - Epoch: 11/50
[37m2024-06-25 09:49:41,377 [INFO] - Training epoch stats:     Loss: 0.1421 - F1-Score: 0.9569 - Accuracy-Score: 0.9470 - AUROC: 0.9867 - AP: 0.9905
[37m2024-06-25 09:49:41,805 [INFO] - Validation epoch stats:   Loss: 0.4359 - F1-Score: 0.8624 - Accuracy-Score: 0.8314 - AUROC: 0.9117 - AP: 0.9404
[37m2024-06-25 09:49:41,805 [INFO] - Performing early stopping!
[37m2024-06-25 09:49:41,813 [INFO] - Finished run o2jr89vs
