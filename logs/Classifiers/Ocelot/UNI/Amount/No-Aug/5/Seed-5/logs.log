[37m2024-06-25 09:42:29,724 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 09:42:29,725 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/No-Aug/5/2024-06-25T094220_CellViT-UNI-5Percent
[37m2024-06-25 09:42:29,789 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f18a7794550>]
[37m2024-06-25 09:42:29,790 [INFO] - Using GPU: cuda:0
[37m2024-06-25 09:42:29,795 [INFO] - Using device: cuda:0
[37m2024-06-25 09:42:29,799 [INFO] - Loss function:
[37m2024-06-25 09:42:29,804 [INFO] - CrossEntropyLoss()
[37m2024-06-25 09:42:42,463 [INFO] - <All keys matched successfully>
[37m2024-06-25 09:42:43,488 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 09:42:43,490 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 09:42:43,495 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 09:42:43,500 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 09:42:43,516 [INFO] - Caching datasets
[37m2024-06-25 09:42:45,078 [INFO] - Instantiate Trainer
[37m2024-06-25 09:42:45,083 [INFO] - Calling Trainer Fit
[37m2024-06-25 09:42:45,085 [INFO] - Dataset is cached after first epoch
[37m2024-06-25 09:42:45,091 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 09:42:45,096 [INFO] - Epoch: 1/50
[37m2024-06-25 09:42:45,595 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/35f78a39f87c9afb0273d1c9b802f8e28bdc3ad57f1bd065d62969d8030cf21e.h5
[37m2024-06-25 09:42:46,082 [INFO] - Training epoch stats:     Loss: 0.6487 - F1-Score: 0.7063 - Accuracy-Score: 0.7220 - AUROC: 0.8043 - AP: 0.7632
[37m2024-06-25 09:42:49,700 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 09:42:50,305 [INFO] - Validation epoch stats:   Loss: 0.6624 - F1-Score: 0.6688 - Accuracy-Score: 0.6575 - AUROC: 0.8070 - AP: 0.8605
[37m2024-06-25 09:42:50,306 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:50,525 [INFO] - Epoch: 2/50
[37m2024-06-25 09:42:50,637 [INFO] - Training epoch stats:     Loss: 0.5780 - F1-Score: 0.8068 - Accuracy-Score: 0.8439 - AUROC: 0.9440 - AP: 0.9339
[37m2024-06-25 09:42:50,996 [INFO] - Validation epoch stats:   Loss: 0.6488 - F1-Score: 0.6474 - Accuracy-Score: 0.6528 - AUROC: 0.8516 - AP: 0.8969
[37m2024-06-25 09:42:50,997 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:51,237 [INFO] - Epoch: 3/50
[37m2024-06-25 09:42:51,337 [INFO] - Training epoch stats:     Loss: 0.5134 - F1-Score: 0.8540 - Accuracy-Score: 0.8792 - AUROC: 0.9665 - AP: 0.9594
[37m2024-06-25 09:42:51,734 [INFO] - Validation epoch stats:   Loss: 0.6302 - F1-Score: 0.6734 - Accuracy-Score: 0.6727 - AUROC: 0.8678 - AP: 0.9097
[37m2024-06-25 09:42:51,735 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:51,988 [INFO] - Epoch: 4/50
[37m2024-06-25 09:42:52,095 [INFO] - Training epoch stats:     Loss: 0.4555 - F1-Score: 0.8723 - Accuracy-Score: 0.8929 - AUROC: 0.9725 - AP: 0.9667
[37m2024-06-25 09:42:52,469 [INFO] - Validation epoch stats:   Loss: 0.6114 - F1-Score: 0.6951 - Accuracy-Score: 0.6893 - AUROC: 0.8753 - AP: 0.9150
[37m2024-06-25 09:42:52,470 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:52,715 [INFO] - Epoch: 5/50
[37m2024-06-25 09:42:52,820 [INFO] - Training epoch stats:     Loss: 0.4017 - F1-Score: 0.8878 - Accuracy-Score: 0.9039 - AUROC: 0.9767 - AP: 0.9716
[37m2024-06-25 09:42:53,223 [INFO] - Validation epoch stats:   Loss: 0.5878 - F1-Score: 0.7292 - Accuracy-Score: 0.7150 - AUROC: 0.8803 - AP: 0.9181
[37m2024-06-25 09:42:53,224 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:53,464 [INFO] - Epoch: 6/50
[37m2024-06-25 09:42:53,627 [INFO] - Training epoch stats:     Loss: 0.3544 - F1-Score: 0.9024 - Accuracy-Score: 0.9145 - AUROC: 0.9786 - AP: 0.9732
[37m2024-06-25 09:42:54,231 [INFO] - Validation epoch stats:   Loss: 0.5660 - F1-Score: 0.7537 - Accuracy-Score: 0.7348 - AUROC: 0.8836 - AP: 0.9203
[37m2024-06-25 09:42:54,232 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:54,476 [INFO] - Epoch: 7/50
[37m2024-06-25 09:42:54,583 [INFO] - Training epoch stats:     Loss: 0.3173 - F1-Score: 0.9012 - Accuracy-Score: 0.9134 - AUROC: 0.9796 - AP: 0.9745
[37m2024-06-25 09:42:54,944 [INFO] - Validation epoch stats:   Loss: 0.5543 - F1-Score: 0.7566 - Accuracy-Score: 0.7376 - AUROC: 0.8846 - AP: 0.9208
[37m2024-06-25 09:42:54,945 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:55,178 [INFO] - Epoch: 8/50
[37m2024-06-25 09:42:55,288 [INFO] - Training epoch stats:     Loss: 0.2840 - F1-Score: 0.9142 - Accuracy-Score: 0.9233 - AUROC: 0.9810 - AP: 0.9760
[37m2024-06-25 09:42:55,681 [INFO] - Validation epoch stats:   Loss: 0.5317 - F1-Score: 0.7853 - Accuracy-Score: 0.7616 - AUROC: 0.8862 - AP: 0.9218
[37m2024-06-25 09:42:55,681 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:55,927 [INFO] - Epoch: 9/50
[37m2024-06-25 09:42:56,035 [INFO] - Training epoch stats:     Loss: 0.2532 - F1-Score: 0.9194 - Accuracy-Score: 0.9278 - AUROC: 0.9827 - AP: 0.9786
[37m2024-06-25 09:42:56,399 [INFO] - Validation epoch stats:   Loss: 0.5298 - F1-Score: 0.7778 - Accuracy-Score: 0.7554 - AUROC: 0.8864 - AP: 0.9219
[37m2024-06-25 09:42:56,400 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:56,609 [INFO] - Epoch: 10/50
[37m2024-06-25 09:42:56,715 [INFO] - Training epoch stats:     Loss: 0.2312 - F1-Score: 0.9187 - Accuracy-Score: 0.9275 - AUROC: 0.9835 - AP: 0.9795
[37m2024-06-25 09:42:57,261 [INFO] - Validation epoch stats:   Loss: 0.5191 - F1-Score: 0.7868 - Accuracy-Score: 0.7631 - AUROC: 0.8871 - AP: 0.9223
[37m2024-06-25 09:42:57,261 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:57,502 [INFO] - Epoch: 11/50
[37m2024-06-25 09:42:57,617 [INFO] - Training epoch stats:     Loss: 0.2143 - F1-Score: 0.9258 - Accuracy-Score: 0.9328 - AUROC: 0.9841 - AP: 0.9799
[37m2024-06-25 09:42:57,981 [INFO] - Validation epoch stats:   Loss: 0.5065 - F1-Score: 0.7992 - Accuracy-Score: 0.7737 - AUROC: 0.8879 - AP: 0.9228
[37m2024-06-25 09:42:57,982 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:42:58,200 [INFO] - Epoch: 12/50
[37m2024-06-25 09:42:58,291 [INFO] - Training epoch stats:     Loss: 0.2005 - F1-Score: 0.9265 - Accuracy-Score: 0.9335 - AUROC: 0.9845 - AP: 0.9806
[37m2024-06-25 09:42:58,659 [INFO] - Validation epoch stats:   Loss: 0.5111 - F1-Score: 0.7935 - Accuracy-Score: 0.7690 - AUROC: 0.8878 - AP: 0.9227
[37m2024-06-25 09:42:58,751 [INFO] - Epoch: 13/50
[37m2024-06-25 09:42:58,839 [INFO] - Training epoch stats:     Loss: 0.1894 - F1-Score: 0.9297 - Accuracy-Score: 0.9366 - AUROC: 0.9855 - AP: 0.9819
[37m2024-06-25 09:42:59,208 [INFO] - Validation epoch stats:   Loss: 0.5047 - F1-Score: 0.8000 - Accuracy-Score: 0.7744 - AUROC: 0.8879 - AP: 0.9228
[37m2024-06-25 09:42:59,298 [INFO] - Epoch: 14/50
[37m2024-06-25 09:42:59,405 [INFO] - Training epoch stats:     Loss: 0.1782 - F1-Score: 0.9311 - Accuracy-Score: 0.9373 - AUROC: 0.9861 - AP: 0.9824
[37m2024-06-25 09:42:59,773 [INFO] - Validation epoch stats:   Loss: 0.5022 - F1-Score: 0.8034 - Accuracy-Score: 0.7775 - AUROC: 0.8884 - AP: 0.9233
[37m2024-06-25 09:42:59,774 [INFO] - New best model - save checkpoint
[37m2024-06-25 09:43:00,000 [INFO] - Epoch: 15/50
[37m2024-06-25 09:43:00,105 [INFO] - Training epoch stats:     Loss: 0.1729 - F1-Score: 0.9306 - Accuracy-Score: 0.9370 - AUROC: 0.9872 - AP: 0.9837
[37m2024-06-25 09:43:00,471 [INFO] - Validation epoch stats:   Loss: 0.5080 - F1-Score: 0.7997 - Accuracy-Score: 0.7741 - AUROC: 0.8879 - AP: 0.9230
[37m2024-06-25 09:43:00,586 [INFO] - Epoch: 16/50
[37m2024-06-25 09:43:00,697 [INFO] - Training epoch stats:     Loss: 0.1647 - F1-Score: 0.9334 - Accuracy-Score: 0.9396 - AUROC: 0.9877 - AP: 0.9845
[37m2024-06-25 09:43:01,114 [INFO] - Validation epoch stats:   Loss: 0.5123 - F1-Score: 0.7978 - Accuracy-Score: 0.7725 - AUROC: 0.8874 - AP: 0.9227
[37m2024-06-25 09:43:01,202 [INFO] - Epoch: 17/50
[37m2024-06-25 09:43:01,325 [INFO] - Training epoch stats:     Loss: 0.1563 - F1-Score: 0.9342 - Accuracy-Score: 0.9404 - AUROC: 0.9878 - AP: 0.9846
[37m2024-06-25 09:43:01,729 [INFO] - Validation epoch stats:   Loss: 0.5157 - F1-Score: 0.7977 - Accuracy-Score: 0.7725 - AUROC: 0.8875 - AP: 0.9228
[37m2024-06-25 09:43:01,841 [INFO] - Epoch: 18/50
[37m2024-06-25 09:43:01,960 [INFO] - Training epoch stats:     Loss: 0.1560 - F1-Score: 0.9336 - Accuracy-Score: 0.9400 - AUROC: 0.9882 - AP: 0.9849
[37m2024-06-25 09:43:02,369 [INFO] - Validation epoch stats:   Loss: 0.5131 - F1-Score: 0.8012 - Accuracy-Score: 0.7755 - AUROC: 0.8876 - AP: 0.9229
[37m2024-06-25 09:43:02,467 [INFO] - Epoch: 19/50
[37m2024-06-25 09:43:02,592 [INFO] - Training epoch stats:     Loss: 0.1507 - F1-Score: 0.9395 - Accuracy-Score: 0.9449 - AUROC: 0.9888 - AP: 0.9858
[37m2024-06-25 09:43:03,361 [INFO] - Validation epoch stats:   Loss: 0.5150 - F1-Score: 0.8020 - Accuracy-Score: 0.7761 - AUROC: 0.8874 - AP: 0.9229
[37m2024-06-25 09:43:03,479 [INFO] - Epoch: 20/50
[37m2024-06-25 09:43:03,604 [INFO] - Training epoch stats:     Loss: 0.1432 - F1-Score: 0.9390 - Accuracy-Score: 0.9445 - AUROC: 0.9895 - AP: 0.9868
[37m2024-06-25 09:43:04,037 [INFO] - Validation epoch stats:   Loss: 0.5158 - F1-Score: 0.8030 - Accuracy-Score: 0.7770 - AUROC: 0.8878 - AP: 0.9233
[37m2024-06-25 09:43:04,128 [INFO] - Epoch: 21/50
[37m2024-06-25 09:43:04,233 [INFO] - Training epoch stats:     Loss: 0.1427 - F1-Score: 0.9425 - Accuracy-Score: 0.9476 - AUROC: 0.9898 - AP: 0.9870
[37m2024-06-25 09:43:04,600 [INFO] - Validation epoch stats:   Loss: 0.5184 - F1-Score: 0.8018 - Accuracy-Score: 0.7760 - AUROC: 0.8882 - AP: 0.9235
[37m2024-06-25 09:43:04,685 [INFO] - Epoch: 22/50
[37m2024-06-25 09:43:04,792 [INFO] - Training epoch stats:     Loss: 0.1355 - F1-Score: 0.9430 - Accuracy-Score: 0.9483 - AUROC: 0.9903 - AP: 0.9877
[37m2024-06-25 09:43:05,213 [INFO] - Validation epoch stats:   Loss: 0.5214 - F1-Score: 0.8019 - Accuracy-Score: 0.7762 - AUROC: 0.8881 - AP: 0.9234
[37m2024-06-25 09:43:05,297 [INFO] - Epoch: 23/50
[37m2024-06-25 09:43:05,430 [INFO] - Training epoch stats:     Loss: 0.1389 - F1-Score: 0.9411 - Accuracy-Score: 0.9464 - AUROC: 0.9901 - AP: 0.9874
[37m2024-06-25 09:43:05,851 [INFO] - Validation epoch stats:   Loss: 0.5219 - F1-Score: 0.8033 - Accuracy-Score: 0.7774 - AUROC: 0.8880 - AP: 0.9234
[37m2024-06-25 09:43:05,966 [INFO] - Epoch: 24/50
[37m2024-06-25 09:43:06,162 [INFO] - Training epoch stats:     Loss: 0.1344 - F1-Score: 0.9423 - Accuracy-Score: 0.9476 - AUROC: 0.9908 - AP: 0.9883
[37m2024-06-25 09:43:06,585 [INFO] - Validation epoch stats:   Loss: 0.5316 - F1-Score: 0.7974 - Accuracy-Score: 0.7721 - AUROC: 0.8873 - AP: 0.9230
[37m2024-06-25 09:43:06,586 [INFO] - Performing early stopping!
[37m2024-06-25 09:43:06,591 [INFO] - Finished run p4vznh9z
