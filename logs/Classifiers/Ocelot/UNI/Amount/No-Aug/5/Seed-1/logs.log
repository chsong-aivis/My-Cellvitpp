[37m2024-06-21 12:35:44,694 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-21 12:35:44,696 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/No-Aug/5/2024-06-21T123533_CellViT-UNI-5Percent
[37m2024-06-21 12:35:44,782 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f6f2fd94490>]
[37m2024-06-21 12:35:44,787 [INFO] - Using GPU: cuda:0
[37m2024-06-21 12:35:44,793 [INFO] - Using device: cuda:0
[37m2024-06-21 12:35:44,798 [INFO] - Loss function:
[37m2024-06-21 12:35:44,803 [INFO] - CrossEntropyLoss()
[37m2024-06-21 12:36:18,465 [INFO] - <All keys matched successfully>
[37m2024-06-21 12:36:19,410 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-21 12:36:19,416 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-21 12:36:19,421 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-21 12:36:19,425 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-21 12:36:19,442 [INFO] - Caching datasets
[37m2024-06-21 12:36:21,316 [INFO] - Instantiate Trainer
[37m2024-06-21 12:36:21,326 [INFO] - Calling Trainer Fit
[37m2024-06-21 12:36:21,331 [INFO] - Dataset is cached after first epoch
[37m2024-06-21 12:36:21,336 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-21 12:36:21,340 [INFO] - Epoch: 1/50
[37m2024-06-21 12:36:21,346 [INFO] - Extracting training cells
[37m2024-06-21 12:36:38,729 [INFO] - Extraction detection metrics - F1: 0.730, Precision: 0.696, Recall: 0.828, Detected-Cells: 2629
[37m2024-06-21 12:36:38,731 [INFO] - Caching dataset 35f78a39f87c9afb0273d1c9b802f8e28bdc3ad57f1bd065d62969d8030cf21e to disk...
[37m2024-06-21 12:36:40,938 [INFO] - Training epoch stats:     Loss: 0.6521 - F1-Score: 0.5400 - Accuracy-Score: 0.6740 - AUROC: 0.7630 - AP: 0.7131
[37m2024-06-21 12:36:40,957 [INFO] - Extracting validation cells
[37m2024-06-21 12:37:34,074 [INFO] - Extraction detection metrics - F1: 0.723, Precision: 0.684, Recall: 0.810, Detected-Cells: 19612
[37m2024-06-21 12:37:34,077 [INFO] - Caching dataset bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62 to disk...
[37m2024-06-21 12:37:54,419 [INFO] - Validation epoch stats:   Loss: 0.6967 - F1-Score: 0.2442 - Accuracy-Score: 0.4458 - AUROC: 0.7459 - AP: 0.8309
[37m2024-06-21 12:37:54,421 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:37:54,632 [INFO] - Epoch: 2/50
[37m2024-06-21 12:37:54,836 [INFO] - Training epoch stats:     Loss: 0.5779 - F1-Score: 0.7806 - Accuracy-Score: 0.8296 - AUROC: 0.9344 - AP: 0.9269
[37m2024-06-21 12:37:55,447 [INFO] - Validation epoch stats:   Loss: 0.6769 - F1-Score: 0.3624 - Accuracy-Score: 0.4995 - AUROC: 0.8428 - AP: 0.8970
[37m2024-06-21 12:37:55,453 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:37:55,638 [INFO] - Epoch: 3/50
[37m2024-06-21 12:37:55,798 [INFO] - Training epoch stats:     Loss: 0.5135 - F1-Score: 0.8377 - Accuracy-Score: 0.8684 - AUROC: 0.9627 - AP: 0.9552
[37m2024-06-21 12:37:56,384 [INFO] - Validation epoch stats:   Loss: 0.6563 - F1-Score: 0.4577 - Accuracy-Score: 0.5457 - AUROC: 0.8717 - AP: 0.9152
[37m2024-06-21 12:37:56,390 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:37:56,563 [INFO] - Epoch: 4/50
[37m2024-06-21 12:37:56,732 [INFO] - Training epoch stats:     Loss: 0.4539 - F1-Score: 0.8525 - Accuracy-Score: 0.8790 - AUROC: 0.9722 - AP: 0.9659
[37m2024-06-21 12:37:57,236 [INFO] - Validation epoch stats:   Loss: 0.6377 - F1-Score: 0.5256 - Accuracy-Score: 0.5820 - AUROC: 0.8819 - AP: 0.9215
[37m2024-06-21 12:37:57,241 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:37:57,424 [INFO] - Epoch: 5/50
[37m2024-06-21 12:37:57,531 [INFO] - Training epoch stats:     Loss: 0.4026 - F1-Score: 0.8793 - Accuracy-Score: 0.8981 - AUROC: 0.9762 - AP: 0.9703
[37m2024-06-21 12:37:57,909 [INFO] - Validation epoch stats:   Loss: 0.6148 - F1-Score: 0.6085 - Accuracy-Score: 0.6323 - AUROC: 0.8870 - AP: 0.9246
[37m2024-06-21 12:37:57,915 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:37:58,095 [INFO] - Epoch: 6/50
[37m2024-06-21 12:37:58,206 [INFO] - Training epoch stats:     Loss: 0.3553 - F1-Score: 0.8988 - Accuracy-Score: 0.9125 - AUROC: 0.9787 - AP: 0.9731
[37m2024-06-21 12:37:58,576 [INFO] - Validation epoch stats:   Loss: 0.5913 - F1-Score: 0.6704 - Accuracy-Score: 0.6736 - AUROC: 0.8900 - AP: 0.9264
[37m2024-06-21 12:37:58,581 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:37:58,759 [INFO] - Epoch: 7/50
[37m2024-06-21 12:37:58,868 [INFO] - Training epoch stats:     Loss: 0.3144 - F1-Score: 0.9056 - Accuracy-Score: 0.9171 - AUROC: 0.9807 - AP: 0.9752
[37m2024-06-21 12:37:59,237 [INFO] - Validation epoch stats:   Loss: 0.5724 - F1-Score: 0.7055 - Accuracy-Score: 0.6986 - AUROC: 0.8909 - AP: 0.9268
[37m2024-06-21 12:37:59,242 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:37:59,425 [INFO] - Epoch: 8/50
[37m2024-06-21 12:37:59,533 [INFO] - Training epoch stats:     Loss: 0.2819 - F1-Score: 0.9132 - Accuracy-Score: 0.9232 - AUROC: 0.9818 - AP: 0.9767
[37m2024-06-21 12:37:59,978 [INFO] - Validation epoch stats:   Loss: 0.5600 - F1-Score: 0.7249 - Accuracy-Score: 0.7138 - AUROC: 0.8914 - AP: 0.9270
[37m2024-06-21 12:37:59,983 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:38:00,169 [INFO] - Epoch: 9/50
[37m2024-06-21 12:38:00,350 [INFO] - Training epoch stats:     Loss: 0.2573 - F1-Score: 0.9174 - Accuracy-Score: 0.9262 - AUROC: 0.9823 - AP: 0.9772
[37m2024-06-21 12:38:00,951 [INFO] - Validation epoch stats:   Loss: 0.5431 - F1-Score: 0.7519 - Accuracy-Score: 0.7351 - AUROC: 0.8920 - AP: 0.9272
[37m2024-06-21 12:38:00,958 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:38:01,131 [INFO] - Epoch: 10/50
[37m2024-06-21 12:38:01,293 [INFO] - Training epoch stats:     Loss: 0.2343 - F1-Score: 0.9216 - Accuracy-Score: 0.9296 - AUROC: 0.9838 - AP: 0.9790
[37m2024-06-21 12:38:01,905 [INFO] - Validation epoch stats:   Loss: 0.5330 - F1-Score: 0.7639 - Accuracy-Score: 0.7449 - AUROC: 0.8928 - AP: 0.9276
[37m2024-06-21 12:38:01,910 [INFO] - New best model - save checkpoint
[37m2024-06-21 12:38:02,086 [INFO] - Epoch: 11/50
[37m2024-06-21 12:38:02,190 [INFO] - Training epoch stats:     Loss: 0.2158 - F1-Score: 0.9246 - Accuracy-Score: 0.9319 - AUROC: 0.9843 - AP: 0.9798
[37m2024-06-21 12:38:02,553 [INFO] - Validation epoch stats:   Loss: 0.5320 - F1-Score: 0.7655 - Accuracy-Score: 0.7462 - AUROC: 0.8926 - AP: 0.9274
[37m2024-06-21 12:38:02,620 [INFO] - Epoch: 12/50
[37m2024-06-21 12:38:02,724 [INFO] - Training epoch stats:     Loss: 0.1980 - F1-Score: 0.9288 - Accuracy-Score: 0.9361 - AUROC: 0.9855 - AP: 0.9813
[37m2024-06-21 12:38:03,079 [INFO] - Validation epoch stats:   Loss: 0.5297 - F1-Score: 0.7687 - Accuracy-Score: 0.7489 - AUROC: 0.8925 - AP: 0.9274
[37m2024-06-21 12:38:03,147 [INFO] - Epoch: 13/50
[37m2024-06-21 12:38:03,255 [INFO] - Training epoch stats:     Loss: 0.1866 - F1-Score: 0.9280 - Accuracy-Score: 0.9350 - AUROC: 0.9858 - AP: 0.9819
[37m2024-06-21 12:38:03,609 [INFO] - Validation epoch stats:   Loss: 0.5242 - F1-Score: 0.7776 - Accuracy-Score: 0.7562 - AUROC: 0.8922 - AP: 0.9272
[37m2024-06-21 12:38:03,680 [INFO] - Epoch: 14/50
[37m2024-06-21 12:38:03,784 [INFO] - Training epoch stats:     Loss: 0.1722 - F1-Score: 0.9350 - Accuracy-Score: 0.9410 - AUROC: 0.9869 - AP: 0.9835
[37m2024-06-21 12:38:04,147 [INFO] - Validation epoch stats:   Loss: 0.5299 - F1-Score: 0.7745 - Accuracy-Score: 0.7535 - AUROC: 0.8913 - AP: 0.9267
[37m2024-06-21 12:38:04,216 [INFO] - Epoch: 15/50
[37m2024-06-21 12:38:04,323 [INFO] - Training epoch stats:     Loss: 0.1673 - F1-Score: 0.9324 - Accuracy-Score: 0.9388 - AUROC: 0.9872 - AP: 0.9837
[37m2024-06-21 12:38:04,691 [INFO] - Validation epoch stats:   Loss: 0.5258 - F1-Score: 0.7814 - Accuracy-Score: 0.7593 - AUROC: 0.8910 - AP: 0.9265
[37m2024-06-21 12:38:04,759 [INFO] - Epoch: 16/50
[37m2024-06-21 12:38:04,874 [INFO] - Training epoch stats:     Loss: 0.1564 - F1-Score: 0.9346 - Accuracy-Score: 0.9407 - AUROC: 0.9879 - AP: 0.9844
[37m2024-06-21 12:38:05,235 [INFO] - Validation epoch stats:   Loss: 0.5307 - F1-Score: 0.7805 - Accuracy-Score: 0.7585 - AUROC: 0.8904 - AP: 0.9261
[37m2024-06-21 12:38:05,310 [INFO] - Epoch: 17/50
[37m2024-06-21 12:38:05,415 [INFO] - Training epoch stats:     Loss: 0.1523 - F1-Score: 0.9355 - Accuracy-Score: 0.9418 - AUROC: 0.9885 - AP: 0.9853
[37m2024-06-21 12:38:05,791 [INFO] - Validation epoch stats:   Loss: 0.5347 - F1-Score: 0.7800 - Accuracy-Score: 0.7580 - AUROC: 0.8898 - AP: 0.9259
[37m2024-06-21 12:38:05,865 [INFO] - Epoch: 18/50
[37m2024-06-21 12:38:05,973 [INFO] - Training epoch stats:     Loss: 0.1497 - F1-Score: 0.9382 - Accuracy-Score: 0.9441 - AUROC: 0.9889 - AP: 0.9856
[37m2024-06-21 12:38:06,800 [INFO] - Validation epoch stats:   Loss: 0.5278 - F1-Score: 0.7884 - Accuracy-Score: 0.7651 - AUROC: 0.8899 - AP: 0.9258
[37m2024-06-21 12:38:06,871 [INFO] - Epoch: 19/50
[37m2024-06-21 12:38:07,034 [INFO] - Training epoch stats:     Loss: 0.1461 - F1-Score: 0.9371 - Accuracy-Score: 0.9429 - AUROC: 0.9892 - AP: 0.9860
[37m2024-06-21 12:38:07,635 [INFO] - Validation epoch stats:   Loss: 0.5351 - F1-Score: 0.7848 - Accuracy-Score: 0.7621 - AUROC: 0.8898 - AP: 0.9258
[37m2024-06-21 12:38:07,709 [INFO] - Epoch: 20/50
[37m2024-06-21 12:38:07,870 [INFO] - Training epoch stats:     Loss: 0.1434 - F1-Score: 0.9391 - Accuracy-Score: 0.9448 - AUROC: 0.9898 - AP: 0.9869
[37m2024-06-21 12:38:08,376 [INFO] - Validation epoch stats:   Loss: 0.5421 - F1-Score: 0.7813 - Accuracy-Score: 0.7592 - AUROC: 0.8899 - AP: 0.9261
[37m2024-06-21 12:38:08,380 [INFO] - Performing early stopping!
[37m2024-06-21 12:38:08,387 [INFO] - Finished run 3ehfs9o0
