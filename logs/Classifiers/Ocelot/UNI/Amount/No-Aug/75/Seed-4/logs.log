[37m2024-06-25 07:47:47,185 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 07:47:47,187 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/UNI/Amount/No-Aug/75/2024-06-25T074739_CellViT-UNI-75Percent
[37m2024-06-25 07:47:47,765 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fc65d34c4c0>]
[37m2024-06-25 07:47:47,767 [INFO] - Using GPU: cuda:0
[37m2024-06-25 07:47:47,773 [INFO] - Using device: cuda:0
[37m2024-06-25 07:47:47,779 [INFO] - Loss function:
[37m2024-06-25 07:47:47,785 [INFO] - CrossEntropyLoss()
[37m2024-06-25 07:48:03,081 [INFO] - <All keys matched successfully>
[37m2024-06-25 07:48:03,956 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  262,400
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 262,914
Trainable params: 262,914
Non-trainable params: 0
Total mult-adds (M): 0.26
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 1.05
Estimated Total Size (MB): 1.06
==========================================================================================
[37m2024-06-25 07:48:03,958 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 07:48:03,963 [INFO] - {'lr': 5e-05, 'betas': [0.85, 0.9], 'weight_decay': 0.00055}
[37m2024-06-25 07:48:03,969 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 07:48:03,990 [INFO] - Caching datasets
[37m2024-06-25 07:48:08,990 [INFO] - Instantiate Trainer
[37m2024-06-25 07:48:08,994 [INFO] - Calling Trainer Fit
[37m2024-06-25 07:48:08,996 [INFO] - Dataset is cached after first epoch
[37m2024-06-25 07:48:09,000 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 07:48:09,005 [INFO] - Epoch: 1/50
[37m2024-06-25 07:48:15,830 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/0981084deee7e67b60d28cf8292826f24b92e65912855fed23a4cbced8d08c06.h5
[37m2024-06-25 07:48:17,462 [INFO] - Training epoch stats:     Loss: 0.4461 - F1-Score: 0.8517 - Accuracy-Score: 0.7993 - AUROC: 0.9051 - AP: 0.9364
[37m2024-06-25 07:48:21,057 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/bfeb7101834d8ce2518bc9a605646d8528eb104e9be34cc187c069953e6c8b62.h5
[37m2024-06-25 07:48:21,451 [INFO] - Validation epoch stats:   Loss: 0.3395 - F1-Score: 0.9042 - Accuracy-Score: 0.8776 - AUROC: 0.9335 - AP: 0.9548
[37m2024-06-25 07:48:21,452 [INFO] - New best model - save checkpoint
[37m2024-06-25 07:48:21,665 [INFO] - Epoch: 2/50
[37m2024-06-25 07:48:23,562 [INFO] - Training epoch stats:     Loss: 0.2534 - F1-Score: 0.9206 - Accuracy-Score: 0.9015 - AUROC: 0.9617 - AP: 0.9735
[37m2024-06-25 07:48:23,959 [INFO] - Validation epoch stats:   Loss: 0.3327 - F1-Score: 0.8938 - Accuracy-Score: 0.8655 - AUROC: 0.9283 - AP: 0.9502
[37m2024-06-25 07:48:24,059 [INFO] - Epoch: 3/50
[37m2024-06-25 07:48:25,468 [INFO] - Training epoch stats:     Loss: 0.2145 - F1-Score: 0.9329 - Accuracy-Score: 0.9170 - AUROC: 0.9709 - AP: 0.9797
[37m2024-06-25 07:48:26,014 [INFO] - Validation epoch stats:   Loss: 0.3510 - F1-Score: 0.8843 - Accuracy-Score: 0.8545 - AUROC: 0.9215 - AP: 0.9446
[37m2024-06-25 07:48:26,096 [INFO] - Epoch: 4/50
[37m2024-06-25 07:48:27,866 [INFO] - Training epoch stats:     Loss: 0.1949 - F1-Score: 0.9397 - Accuracy-Score: 0.9255 - AUROC: 0.9755 - AP: 0.9828
[37m2024-06-25 07:48:28,261 [INFO] - Validation epoch stats:   Loss: 0.3667 - F1-Score: 0.8797 - Accuracy-Score: 0.8487 - AUROC: 0.9160 - AP: 0.9397
[37m2024-06-25 07:48:28,345 [INFO] - Epoch: 5/50
[37m2024-06-25 07:48:30,265 [INFO] - Training epoch stats:     Loss: 0.1808 - F1-Score: 0.9449 - Accuracy-Score: 0.9320 - AUROC: 0.9788 - AP: 0.9851
[37m2024-06-25 07:48:30,693 [INFO] - Validation epoch stats:   Loss: 0.3752 - F1-Score: 0.8798 - Accuracy-Score: 0.8485 - AUROC: 0.9130 - AP: 0.9366
[37m2024-06-25 07:48:30,795 [INFO] - Epoch: 6/50
[37m2024-06-25 07:48:31,966 [INFO] - Training epoch stats:     Loss: 0.1708 - F1-Score: 0.9472 - Accuracy-Score: 0.9349 - AUROC: 0.9810 - AP: 0.9866
[37m2024-06-25 07:48:32,337 [INFO] - Validation epoch stats:   Loss: 0.3938 - F1-Score: 0.8736 - Accuracy-Score: 0.8427 - AUROC: 0.9107 - AP: 0.9340
[37m2024-06-25 07:48:32,437 [INFO] - Epoch: 7/50
[37m2024-06-25 07:48:34,465 [INFO] - Training epoch stats:     Loss: 0.1625 - F1-Score: 0.9503 - Accuracy-Score: 0.9387 - AUROC: 0.9827 - AP: 0.9878
[37m2024-06-25 07:48:34,835 [INFO] - Validation epoch stats:   Loss: 0.3871 - F1-Score: 0.8805 - Accuracy-Score: 0.8491 - AUROC: 0.9114 - AP: 0.9345
[37m2024-06-25 07:48:34,913 [INFO] - Epoch: 8/50
[37m2024-06-25 07:48:36,268 [INFO] - Training epoch stats:     Loss: 0.1551 - F1-Score: 0.9522 - Accuracy-Score: 0.9411 - AUROC: 0.9841 - AP: 0.9888
[37m2024-06-25 07:48:36,646 [INFO] - Validation epoch stats:   Loss: 0.4097 - F1-Score: 0.8709 - Accuracy-Score: 0.8396 - AUROC: 0.9080 - AP: 0.9315
[37m2024-06-25 07:48:36,724 [INFO] - Epoch: 9/50
[37m2024-06-25 07:48:38,265 [INFO] - Training epoch stats:     Loss: 0.1492 - F1-Score: 0.9540 - Accuracy-Score: 0.9433 - AUROC: 0.9853 - AP: 0.9896
[37m2024-06-25 07:48:38,861 [INFO] - Validation epoch stats:   Loss: 0.4185 - F1-Score: 0.8683 - Accuracy-Score: 0.8370 - AUROC: 0.9068 - AP: 0.9302
[37m2024-06-25 07:48:38,931 [INFO] - Epoch: 10/50
[37m2024-06-25 07:48:40,564 [INFO] - Training epoch stats:     Loss: 0.1436 - F1-Score: 0.9557 - Accuracy-Score: 0.9453 - AUROC: 0.9863 - AP: 0.9903
[37m2024-06-25 07:48:40,944 [INFO] - Validation epoch stats:   Loss: 0.4220 - F1-Score: 0.8699 - Accuracy-Score: 0.8386 - AUROC: 0.9066 - AP: 0.9295
[37m2024-06-25 07:48:41,024 [INFO] - Epoch: 11/50
[37m2024-06-25 07:48:42,469 [INFO] - Training epoch stats:     Loss: 0.1386 - F1-Score: 0.9575 - Accuracy-Score: 0.9477 - AUROC: 0.9873 - AP: 0.9911
[37m2024-06-25 07:48:42,992 [INFO] - Validation epoch stats:   Loss: 0.4248 - F1-Score: 0.8718 - Accuracy-Score: 0.8404 - AUROC: 0.9062 - AP: 0.9292
[37m2024-06-25 07:48:42,994 [INFO] - Performing early stopping!
[37m2024-06-25 07:48:43,001 [INFO] - Finished run 0tr03q0p
