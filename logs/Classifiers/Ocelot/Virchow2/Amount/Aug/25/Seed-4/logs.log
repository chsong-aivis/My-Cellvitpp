[37m2024-08-15 18:25:20,145 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 18:25:20,146 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/Aug/25/Seed-4/2024-08-15T182512_CellViT-Virchow2-25Percent
[37m2024-08-15 18:25:20,206 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fbdf7038580>]
[37m2024-08-15 18:25:20,211 [INFO] - Using GPU: cuda:0
[37m2024-08-15 18:25:20,215 [INFO] - Using device: cuda:0
[37m2024-08-15 18:25:20,220 [INFO] - Loss function:
[37m2024-08-15 18:25:20,224 [INFO] - CrossEntropyLoss()
[37m2024-08-15 18:25:27,472 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 18:25:28,175 [INFO] - <All keys matched successfully>
[37m2024-08-15 18:25:29,413 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 18:25:29,420 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 18:25:29,425 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 18:25:29,430 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 18:25:29,450 [INFO] - Caching datasets
[37m2024-08-15 18:25:31,901 [INFO] - Instantiate Trainer
[37m2024-08-15 18:25:31,913 [INFO] - Calling Trainer Fit
[37m2024-08-15 18:25:31,918 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 18:25:31,924 [INFO] - Epoch: 1/50
[37m2024-08-15 18:25:31,928 [INFO] - Extracting training cells
[37m2024-08-15 18:26:41,075 [INFO] - Extraction detection metrics - F1: 0.612, Precision: 0.584, Recall: 0.716, Detected-Cells: 12445
[37m2024-08-15 18:26:41,620 [INFO] - Training epoch stats:     Loss: 0.2693 - F1-Score: 0.9177 - Accuracy-Score: 0.8963 - AUROC: 0.9543 - AP: 0.9640
[37m2024-08-15 18:26:45,655 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 18:26:46,024 [INFO] - Validation epoch stats:   Loss: 0.3770 - F1-Score: 0.8961 - Accuracy-Score: 0.8671 - AUROC: 0.9307 - AP: 0.9574
[37m2024-08-15 18:26:46,029 [INFO] - New best model - save checkpoint
[37m2024-08-15 18:26:46,193 [INFO] - Epoch: 2/50
[37m2024-08-15 18:26:46,199 [INFO] - Extracting training cells
[37m2024-08-15 18:27:49,378 [INFO] - Extraction detection metrics - F1: 0.628, Precision: 0.599, Recall: 0.725, Detected-Cells: 12326
[37m2024-08-15 18:27:49,856 [INFO] - Training epoch stats:     Loss: 0.1492 - F1-Score: 0.9547 - Accuracy-Score: 0.9427 - AUROC: 0.9847 - AP: 0.9902
[37m2024-08-15 18:27:50,264 [INFO] - Validation epoch stats:   Loss: 0.4086 - F1-Score: 0.8856 - Accuracy-Score: 0.8549 - AUROC: 0.9171 - AP: 0.9451
[37m2024-08-15 18:27:50,339 [INFO] - Epoch: 3/50
[37m2024-08-15 18:27:50,344 [INFO] - Extracting training cells
[37m2024-08-15 18:28:53,806 [INFO] - Extraction detection metrics - F1: 0.630, Precision: 0.599, Recall: 0.731, Detected-Cells: 12349
[37m2024-08-15 18:28:54,246 [INFO] - Training epoch stats:     Loss: 0.1328 - F1-Score: 0.9585 - Accuracy-Score: 0.9475 - AUROC: 0.9882 - AP: 0.9925
[37m2024-08-15 18:28:54,807 [INFO] - Validation epoch stats:   Loss: 0.3860 - F1-Score: 0.8918 - Accuracy-Score: 0.8630 - AUROC: 0.9251 - AP: 0.9502
[37m2024-08-15 18:28:54,878 [INFO] - Epoch: 4/50
[37m2024-08-15 18:28:54,884 [INFO] - Extracting training cells
[37m2024-08-15 18:29:58,491 [INFO] - Extraction detection metrics - F1: 0.609, Precision: 0.581, Recall: 0.715, Detected-Cells: 11488
[37m2024-08-15 18:29:58,955 [INFO] - Training epoch stats:     Loss: 0.1287 - F1-Score: 0.9606 - Accuracy-Score: 0.9503 - AUROC: 0.9886 - AP: 0.9924
[37m2024-08-15 18:29:59,362 [INFO] - Validation epoch stats:   Loss: 0.4275 - F1-Score: 0.8866 - Accuracy-Score: 0.8558 - AUROC: 0.9213 - AP: 0.9503
[37m2024-08-15 18:29:59,425 [INFO] - Epoch: 5/50
[37m2024-08-15 18:29:59,431 [INFO] - Extracting training cells
[37m2024-08-15 18:31:03,699 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.589, Recall: 0.723, Detected-Cells: 12393
[37m2024-08-15 18:31:04,234 [INFO] - Training epoch stats:     Loss: 0.1118 - F1-Score: 0.9662 - Accuracy-Score: 0.9570 - AUROC: 0.9914 - AP: 0.9947
[37m2024-08-15 18:31:04,636 [INFO] - Validation epoch stats:   Loss: 0.5065 - F1-Score: 0.8819 - Accuracy-Score: 0.8541 - AUROC: 0.9253 - AP: 0.9521
[37m2024-08-15 18:31:04,702 [INFO] - Epoch: 6/50
[37m2024-08-15 18:31:04,707 [INFO] - Extracting training cells
[37m2024-08-15 18:32:08,768 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.587, Recall: 0.719, Detected-Cells: 12334
[37m2024-08-15 18:32:09,190 [INFO] - Training epoch stats:     Loss: 0.1036 - F1-Score: 0.9684 - Accuracy-Score: 0.9597 - AUROC: 0.9924 - AP: 0.9951
[37m2024-08-15 18:32:09,528 [INFO] - Validation epoch stats:   Loss: 0.4609 - F1-Score: 0.8947 - Accuracy-Score: 0.8654 - AUROC: 0.9261 - AP: 0.9502
[37m2024-08-15 18:32:09,593 [INFO] - Epoch: 7/50
[37m2024-08-15 18:32:09,597 [INFO] - Extracting training cells
[37m2024-08-15 18:33:13,201 [INFO] - Extraction detection metrics - F1: 0.636, Precision: 0.604, Recall: 0.740, Detected-Cells: 12747
[37m2024-08-15 18:33:13,644 [INFO] - Training epoch stats:     Loss: 0.1127 - F1-Score: 0.9653 - Accuracy-Score: 0.9553 - AUROC: 0.9914 - AP: 0.9949
[37m2024-08-15 18:33:13,987 [INFO] - Validation epoch stats:   Loss: 0.4901 - F1-Score: 0.8855 - Accuracy-Score: 0.8557 - AUROC: 0.9207 - AP: 0.9470
[37m2024-08-15 18:33:14,073 [INFO] - Epoch: 8/50
[37m2024-08-15 18:33:14,079 [INFO] - Extracting training cells
[37m2024-08-15 18:34:18,332 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.595, Recall: 0.719, Detected-Cells: 12441
[37m2024-08-15 18:34:18,818 [INFO] - Training epoch stats:     Loss: 0.1110 - F1-Score: 0.9656 - Accuracy-Score: 0.9574 - AUROC: 0.9917 - AP: 0.9944
[37m2024-08-15 18:34:19,230 [INFO] - Validation epoch stats:   Loss: 0.4400 - F1-Score: 0.8794 - Accuracy-Score: 0.8484 - AUROC: 0.9162 - AP: 0.9430
[37m2024-08-15 18:34:19,296 [INFO] - Epoch: 9/50
[37m2024-08-15 18:34:19,301 [INFO] - Extracting training cells
[37m2024-08-15 18:35:24,704 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.597, Recall: 0.707, Detected-Cells: 12212
[37m2024-08-15 18:35:25,139 [INFO] - Training epoch stats:     Loss: 0.1011 - F1-Score: 0.9696 - Accuracy-Score: 0.9612 - AUROC: 0.9934 - AP: 0.9961
[37m2024-08-15 18:35:25,484 [INFO] - Validation epoch stats:   Loss: 0.4557 - F1-Score: 0.8826 - Accuracy-Score: 0.8516 - AUROC: 0.9201 - AP: 0.9471
[37m2024-08-15 18:35:25,550 [INFO] - Epoch: 10/50
[37m2024-08-15 18:35:25,555 [INFO] - Extracting training cells
[37m2024-08-15 18:36:28,487 [INFO] - Extraction detection metrics - F1: 0.628, Precision: 0.594, Recall: 0.730, Detected-Cells: 12617
[37m2024-08-15 18:36:28,964 [INFO] - Training epoch stats:     Loss: 0.1090 - F1-Score: 0.9671 - Accuracy-Score: 0.9574 - AUROC: 0.9920 - AP: 0.9952
[37m2024-08-15 18:36:29,354 [INFO] - Validation epoch stats:   Loss: 0.4906 - F1-Score: 0.8840 - Accuracy-Score: 0.8547 - AUROC: 0.9209 - AP: 0.9473
[37m2024-08-15 18:36:29,417 [INFO] - Epoch: 11/50
[37m2024-08-15 18:36:29,423 [INFO] - Extracting training cells
[37m2024-08-15 18:37:32,365 [INFO] - Extraction detection metrics - F1: 0.610, Precision: 0.581, Recall: 0.712, Detected-Cells: 12037
[37m2024-08-15 18:37:32,832 [INFO] - Training epoch stats:     Loss: 0.1135 - F1-Score: 0.9676 - Accuracy-Score: 0.9583 - AUROC: 0.9910 - AP: 0.9945
[37m2024-08-15 18:37:33,241 [INFO] - Validation epoch stats:   Loss: 0.4940 - F1-Score: 0.8590 - Accuracy-Score: 0.8269 - AUROC: 0.9048 - AP: 0.9356
[37m2024-08-15 18:37:33,321 [INFO] - Epoch: 12/50
[37m2024-08-15 18:37:33,326 [INFO] - Extracting training cells
[37m2024-08-15 18:38:37,816 [INFO] - Extraction detection metrics - F1: 0.631, Precision: 0.605, Recall: 0.731, Detected-Cells: 12430
[37m2024-08-15 18:38:38,299 [INFO] - Training epoch stats:     Loss: 0.0947 - F1-Score: 0.9713 - Accuracy-Score: 0.9640 - AUROC: 0.9937 - AP: 0.9956
[37m2024-08-15 18:38:38,631 [INFO] - Validation epoch stats:   Loss: 0.5624 - F1-Score: 0.8676 - Accuracy-Score: 0.8337 - AUROC: 0.9029 - AP: 0.9285
[37m2024-08-15 18:38:38,708 [INFO] - Epoch: 13/50
[37m2024-08-15 18:38:38,713 [INFO] - Extracting training cells
[37m2024-08-15 18:39:42,638 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.599, Recall: 0.722, Detected-Cells: 12285
[37m2024-08-15 18:39:43,068 [INFO] - Training epoch stats:     Loss: 0.0894 - F1-Score: 0.9716 - Accuracy-Score: 0.9638 - AUROC: 0.9945 - AP: 0.9965
[37m2024-08-15 18:39:43,416 [INFO] - Validation epoch stats:   Loss: 0.5984 - F1-Score: 0.8811 - Accuracy-Score: 0.8494 - AUROC: 0.9073 - AP: 0.9294
[37m2024-08-15 18:39:43,489 [INFO] - Epoch: 14/50
[37m2024-08-15 18:39:43,494 [INFO] - Extracting training cells
[37m2024-08-15 18:40:46,880 [INFO] - Extraction detection metrics - F1: 0.634, Precision: 0.602, Recall: 0.732, Detected-Cells: 12420
[37m2024-08-15 18:40:47,336 [INFO] - Training epoch stats:     Loss: 0.0977 - F1-Score: 0.9723 - Accuracy-Score: 0.9645 - AUROC: 0.9933 - AP: 0.9956
[37m2024-08-15 18:40:47,676 [INFO] - Validation epoch stats:   Loss: 0.5865 - F1-Score: 0.8681 - Accuracy-Score: 0.8377 - AUROC: 0.9076 - AP: 0.9318
[37m2024-08-15 18:40:47,756 [INFO] - Epoch: 15/50
[37m2024-08-15 18:40:47,761 [INFO] - Extracting training cells
[37m2024-08-15 18:41:51,404 [INFO] - Extraction detection metrics - F1: 0.627, Precision: 0.596, Recall: 0.728, Detected-Cells: 12219
[37m2024-08-15 18:41:51,917 [INFO] - Training epoch stats:     Loss: 0.1296 - F1-Score: 0.9657 - Accuracy-Score: 0.9563 - AUROC: 0.9901 - AP: 0.9934
[37m2024-08-15 18:41:52,332 [INFO] - Validation epoch stats:   Loss: 0.5013 - F1-Score: 0.8709 - Accuracy-Score: 0.8376 - AUROC: 0.8992 - AP: 0.9270
[37m2024-08-15 18:41:52,388 [INFO] - Epoch: 16/50
[37m2024-08-15 18:41:52,393 [INFO] - Extracting training cells
[37m2024-08-15 18:42:55,173 [INFO] - Extraction detection metrics - F1: 0.608, Precision: 0.580, Recall: 0.709, Detected-Cells: 12219
[37m2024-08-15 18:42:55,600 [INFO] - Training epoch stats:     Loss: 0.0947 - F1-Score: 0.9720 - Accuracy-Score: 0.9640 - AUROC: 0.9937 - AP: 0.9960
[37m2024-08-15 18:42:55,952 [INFO] - Validation epoch stats:   Loss: 0.5728 - F1-Score: 0.8766 - Accuracy-Score: 0.8446 - AUROC: 0.9002 - AP: 0.9238
[37m2024-08-15 18:42:56,022 [INFO] - Epoch: 17/50
[37m2024-08-15 18:42:56,028 [INFO] - Extracting training cells
[37m2024-08-15 18:43:59,297 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.581, Recall: 0.726, Detected-Cells: 12328
[37m2024-08-15 18:43:59,828 [INFO] - Training epoch stats:     Loss: 0.0784 - F1-Score: 0.9761 - Accuracy-Score: 0.9695 - AUROC: 0.9958 - AP: 0.9975
[37m2024-08-15 18:44:00,314 [INFO] - Validation epoch stats:   Loss: 0.6566 - F1-Score: 0.8806 - Accuracy-Score: 0.8496 - AUROC: 0.9012 - AP: 0.9229
[37m2024-08-15 18:44:00,400 [INFO] - Epoch: 18/50
[37m2024-08-15 18:44:00,410 [INFO] - Extracting training cells
[37m2024-08-15 18:45:04,600 [INFO] - Extraction detection metrics - F1: 0.633, Precision: 0.599, Recall: 0.735, Detected-Cells: 12512
[37m2024-08-15 18:45:05,097 [INFO] - Training epoch stats:     Loss: 0.1020 - F1-Score: 0.9711 - Accuracy-Score: 0.9632 - AUROC: 0.9933 - AP: 0.9956
[37m2024-08-15 18:45:05,510 [INFO] - Validation epoch stats:   Loss: 0.5740 - F1-Score: 0.8822 - Accuracy-Score: 0.8510 - AUROC: 0.9052 - AP: 0.9290
[37m2024-08-15 18:45:05,578 [INFO] - Epoch: 19/50
[37m2024-08-15 18:45:05,584 [INFO] - Extracting training cells
[37m2024-08-15 18:46:08,699 [INFO] - Extraction detection metrics - F1: 0.639, Precision: 0.613, Recall: 0.735, Detected-Cells: 12916
[37m2024-08-15 18:46:09,162 [INFO] - Training epoch stats:     Loss: 0.0890 - F1-Score: 0.9716 - Accuracy-Score: 0.9639 - AUROC: 0.9949 - AP: 0.9968
[37m2024-08-15 18:46:09,494 [INFO] - Validation epoch stats:   Loss: 0.5969 - F1-Score: 0.8742 - Accuracy-Score: 0.8439 - AUROC: 0.9078 - AP: 0.9324
[37m2024-08-15 18:46:09,567 [INFO] - Epoch: 20/50
[37m2024-08-15 18:46:09,572 [INFO] - Extracting training cells
[37m2024-08-15 18:47:12,975 [INFO] - Extraction detection metrics - F1: 0.638, Precision: 0.603, Recall: 0.743, Detected-Cells: 12562
[37m2024-08-15 18:47:13,446 [INFO] - Training epoch stats:     Loss: 0.0891 - F1-Score: 0.9742 - Accuracy-Score: 0.9677 - AUROC: 0.9948 - AP: 0.9962
[37m2024-08-15 18:47:13,858 [INFO] - Validation epoch stats:   Loss: 0.5835 - F1-Score: 0.8732 - Accuracy-Score: 0.8413 - AUROC: 0.9038 - AP: 0.9280
[37m2024-08-15 18:47:13,932 [INFO] - Epoch: 21/50
[37m2024-08-15 18:47:13,938 [INFO] - Extracting training cells
[37m2024-08-15 18:48:16,242 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.586, Recall: 0.715, Detected-Cells: 12193
[37m2024-08-15 18:48:16,745 [INFO] - Training epoch stats:     Loss: 0.0799 - F1-Score: 0.9747 - Accuracy-Score: 0.9676 - AUROC: 0.9958 - AP: 0.9975
[37m2024-08-15 18:48:17,146 [INFO] - Validation epoch stats:   Loss: 0.6178 - F1-Score: 0.8746 - Accuracy-Score: 0.8434 - AUROC: 0.9082 - AP: 0.9328
[37m2024-08-15 18:48:17,151 [INFO] - Performing early stopping!
[37m2024-08-15 18:48:17,156 [INFO] - Finished run zvh5x597
