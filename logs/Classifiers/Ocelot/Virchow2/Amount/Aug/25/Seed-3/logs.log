[37m2024-08-15 14:28:13,489 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 14:28:13,491 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/Aug/25/Seed-3/2024-08-15T142803_CellViT-Virchow2-25Percent
[37m2024-08-15 14:28:13,559 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f61c3fd0430>]
[37m2024-08-15 14:28:13,565 [INFO] - Using GPU: cuda:0
[37m2024-08-15 14:28:13,570 [INFO] - Using device: cuda:0
[37m2024-08-15 14:28:13,576 [INFO] - Loss function:
[37m2024-08-15 14:28:13,580 [INFO] - CrossEntropyLoss()
[37m2024-08-15 14:28:20,873 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 14:28:22,181 [INFO] - <All keys matched successfully>
[37m2024-08-15 14:28:23,404 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 14:28:23,411 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 14:28:23,417 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 14:28:23,422 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 14:28:23,444 [INFO] - Caching datasets
[37m2024-08-15 14:28:26,070 [INFO] - Instantiate Trainer
[37m2024-08-15 14:28:26,083 [INFO] - Calling Trainer Fit
[37m2024-08-15 14:28:26,089 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 14:28:26,094 [INFO] - Epoch: 1/50
[37m2024-08-15 14:28:26,099 [INFO] - Extracting training cells
[37m2024-08-15 14:29:36,053 [INFO] - Extraction detection metrics - F1: 0.612, Precision: 0.581, Recall: 0.715, Detected-Cells: 11690
[37m2024-08-15 14:29:36,628 [INFO] - Training epoch stats:     Loss: 0.2537 - F1-Score: 0.9187 - Accuracy-Score: 0.8988 - AUROC: 0.9582 - AP: 0.9682
[37m2024-08-15 14:29:40,363 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 14:29:40,751 [INFO] - Validation epoch stats:   Loss: 0.4010 - F1-Score: 0.8940 - Accuracy-Score: 0.8693 - AUROC: 0.9340 - AP: 0.9598
[37m2024-08-15 14:29:40,757 [INFO] - New best model - save checkpoint
[37m2024-08-15 14:29:40,947 [INFO] - Epoch: 2/50
[37m2024-08-15 14:29:40,952 [INFO] - Extracting training cells
[37m2024-08-15 14:30:44,526 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.597, Recall: 0.720, Detected-Cells: 12099
[37m2024-08-15 14:30:44,978 [INFO] - Training epoch stats:     Loss: 0.1466 - F1-Score: 0.9528 - Accuracy-Score: 0.9412 - AUROC: 0.9854 - AP: 0.9902
[37m2024-08-15 14:30:45,322 [INFO] - Validation epoch stats:   Loss: 0.3925 - F1-Score: 0.8943 - Accuracy-Score: 0.8607 - AUROC: 0.9322 - AP: 0.9570
[37m2024-08-15 14:30:45,401 [INFO] - Epoch: 3/50
[37m2024-08-15 14:30:45,407 [INFO] - Extracting training cells
[37m2024-08-15 14:31:49,946 [INFO] - Extraction detection metrics - F1: 0.630, Precision: 0.603, Recall: 0.727, Detected-Cells: 12347
[37m2024-08-15 14:31:50,462 [INFO] - Training epoch stats:     Loss: 0.1413 - F1-Score: 0.9587 - Accuracy-Score: 0.9475 - AUROC: 0.9857 - AP: 0.9897
[37m2024-08-15 14:31:51,111 [INFO] - Validation epoch stats:   Loss: 0.4282 - F1-Score: 0.8862 - Accuracy-Score: 0.8505 - AUROC: 0.9223 - AP: 0.9515
[37m2024-08-15 14:31:51,176 [INFO] - Epoch: 4/50
[37m2024-08-15 14:31:51,182 [INFO] - Extracting training cells
[37m2024-08-15 14:32:54,839 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.597, Recall: 0.717, Detected-Cells: 12191
[37m2024-08-15 14:32:55,308 [INFO] - Training epoch stats:     Loss: 0.1337 - F1-Score: 0.9606 - Accuracy-Score: 0.9495 - AUROC: 0.9877 - AP: 0.9919
[37m2024-08-15 14:32:55,723 [INFO] - Validation epoch stats:   Loss: 0.4289 - F1-Score: 0.8746 - Accuracy-Score: 0.8429 - AUROC: 0.9150 - AP: 0.9473
[37m2024-08-15 14:32:55,787 [INFO] - Epoch: 5/50
[37m2024-08-15 14:32:55,792 [INFO] - Extracting training cells
[37m2024-08-15 14:33:58,741 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.584, Recall: 0.722, Detected-Cells: 12079
[37m2024-08-15 14:33:59,214 [INFO] - Training epoch stats:     Loss: 0.1312 - F1-Score: 0.9595 - Accuracy-Score: 0.9492 - AUROC: 0.9886 - AP: 0.9923
[37m2024-08-15 14:33:59,634 [INFO] - Validation epoch stats:   Loss: 0.4383 - F1-Score: 0.8732 - Accuracy-Score: 0.8423 - AUROC: 0.9145 - AP: 0.9456
[37m2024-08-15 14:33:59,691 [INFO] - Epoch: 6/50
[37m2024-08-15 14:33:59,696 [INFO] - Extracting training cells
[37m2024-08-15 14:35:02,526 [INFO] - Extraction detection metrics - F1: 0.630, Precision: 0.602, Recall: 0.727, Detected-Cells: 12619
[37m2024-08-15 14:35:03,009 [INFO] - Training epoch stats:     Loss: 0.1122 - F1-Score: 0.9661 - Accuracy-Score: 0.9570 - AUROC: 0.9915 - AP: 0.9947
[37m2024-08-15 14:35:03,410 [INFO] - Validation epoch stats:   Loss: 0.5168 - F1-Score: 0.8818 - Accuracy-Score: 0.8498 - AUROC: 0.9144 - AP: 0.9425
[37m2024-08-15 14:35:03,484 [INFO] - Epoch: 7/50
[37m2024-08-15 14:35:03,489 [INFO] - Extracting training cells
[37m2024-08-15 14:36:07,480 [INFO] - Extraction detection metrics - F1: 0.628, Precision: 0.599, Recall: 0.725, Detected-Cells: 12198
[37m2024-08-15 14:36:07,929 [INFO] - Training epoch stats:     Loss: 0.1149 - F1-Score: 0.9655 - Accuracy-Score: 0.9559 - AUROC: 0.9915 - AP: 0.9947
[37m2024-08-15 14:36:08,337 [INFO] - Validation epoch stats:   Loss: 0.4520 - F1-Score: 0.8834 - Accuracy-Score: 0.8518 - AUROC: 0.9166 - AP: 0.9467
[37m2024-08-15 14:36:08,394 [INFO] - Epoch: 8/50
[37m2024-08-15 14:36:08,399 [INFO] - Extracting training cells
[37m2024-08-15 14:37:12,459 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.603, Recall: 0.712, Detected-Cells: 12506
[37m2024-08-15 14:37:12,926 [INFO] - Training epoch stats:     Loss: 0.1081 - F1-Score: 0.9684 - Accuracy-Score: 0.9597 - AUROC: 0.9921 - AP: 0.9949
[37m2024-08-15 14:37:13,348 [INFO] - Validation epoch stats:   Loss: 0.4842 - F1-Score: 0.8864 - Accuracy-Score: 0.8531 - AUROC: 0.9159 - AP: 0.9429
[37m2024-08-15 14:37:13,410 [INFO] - Epoch: 9/50
[37m2024-08-15 14:37:13,416 [INFO] - Extracting training cells
[37m2024-08-15 14:38:19,473 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.591, Recall: 0.710, Detected-Cells: 12097
[37m2024-08-15 14:38:19,936 [INFO] - Training epoch stats:     Loss: 0.1294 - F1-Score: 0.9645 - Accuracy-Score: 0.9550 - AUROC: 0.9886 - AP: 0.9916
[37m2024-08-15 14:38:20,360 [INFO] - Validation epoch stats:   Loss: 0.4604 - F1-Score: 0.8850 - Accuracy-Score: 0.8532 - AUROC: 0.9211 - AP: 0.9505
[37m2024-08-15 14:38:20,422 [INFO] - Epoch: 10/50
[37m2024-08-15 14:38:20,427 [INFO] - Extracting training cells
[37m2024-08-15 14:39:24,033 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.580, Recall: 0.721, Detected-Cells: 12467
[37m2024-08-15 14:39:24,467 [INFO] - Training epoch stats:     Loss: 0.1029 - F1-Score: 0.9696 - Accuracy-Score: 0.9611 - AUROC: 0.9929 - AP: 0.9954
[37m2024-08-15 14:39:24,813 [INFO] - Validation epoch stats:   Loss: 0.4685 - F1-Score: 0.8876 - Accuracy-Score: 0.8546 - AUROC: 0.9189 - AP: 0.9461
[37m2024-08-15 14:39:24,882 [INFO] - Epoch: 11/50
[37m2024-08-15 14:39:24,888 [INFO] - Extracting training cells
[37m2024-08-15 14:40:29,755 [INFO] - Extraction detection metrics - F1: 0.628, Precision: 0.598, Recall: 0.719, Detected-Cells: 12633
[37m2024-08-15 14:40:30,164 [INFO] - Training epoch stats:     Loss: 0.0872 - F1-Score: 0.9730 - Accuracy-Score: 0.9657 - AUROC: 0.9948 - AP: 0.9967
[37m2024-08-15 14:40:30,571 [INFO] - Validation epoch stats:   Loss: 0.4574 - F1-Score: 0.8836 - Accuracy-Score: 0.8522 - AUROC: 0.9189 - AP: 0.9476
[37m2024-08-15 14:40:30,638 [INFO] - Epoch: 12/50
[37m2024-08-15 14:40:30,643 [INFO] - Extracting training cells
[37m2024-08-15 14:41:33,761 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.588, Recall: 0.722, Detected-Cells: 12322
[37m2024-08-15 14:41:34,213 [INFO] - Training epoch stats:     Loss: 0.0829 - F1-Score: 0.9755 - Accuracy-Score: 0.9675 - AUROC: 0.9952 - AP: 0.9973
[37m2024-08-15 14:41:34,624 [INFO] - Validation epoch stats:   Loss: 0.5935 - F1-Score: 0.8797 - Accuracy-Score: 0.8490 - AUROC: 0.9159 - AP: 0.9414
[37m2024-08-15 14:41:34,696 [INFO] - Epoch: 13/50
[37m2024-08-15 14:41:34,701 [INFO] - Extracting training cells
[37m2024-08-15 14:42:39,497 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.584, Recall: 0.715, Detected-Cells: 11995
[37m2024-08-15 14:42:39,941 [INFO] - Training epoch stats:     Loss: 0.0916 - F1-Score: 0.9732 - Accuracy-Score: 0.9648 - AUROC: 0.9943 - AP: 0.9966
[37m2024-08-15 14:42:40,268 [INFO] - Validation epoch stats:   Loss: 0.5835 - F1-Score: 0.8755 - Accuracy-Score: 0.8423 - AUROC: 0.9061 - AP: 0.9349
[37m2024-08-15 14:42:40,348 [INFO] - Epoch: 14/50
[37m2024-08-15 14:42:40,355 [INFO] - Extracting training cells
[37m2024-08-15 14:43:43,649 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.587, Recall: 0.724, Detected-Cells: 12639
[37m2024-08-15 14:43:44,180 [INFO] - Training epoch stats:     Loss: 0.0888 - F1-Score: 0.9729 - Accuracy-Score: 0.9655 - AUROC: 0.9948 - AP: 0.9967
[37m2024-08-15 14:43:44,601 [INFO] - Validation epoch stats:   Loss: 0.5879 - F1-Score: 0.8793 - Accuracy-Score: 0.8462 - AUROC: 0.9093 - AP: 0.9387
[37m2024-08-15 14:43:44,689 [INFO] - Epoch: 15/50
[37m2024-08-15 14:43:44,695 [INFO] - Extracting training cells
[37m2024-08-15 14:44:48,977 [INFO] - Extraction detection metrics - F1: 0.610, Precision: 0.587, Recall: 0.710, Detected-Cells: 12461
[37m2024-08-15 14:44:49,430 [INFO] - Training epoch stats:     Loss: 0.0782 - F1-Score: 0.9768 - Accuracy-Score: 0.9701 - AUROC: 0.9960 - AP: 0.9976
[37m2024-08-15 14:44:49,834 [INFO] - Validation epoch stats:   Loss: 0.5308 - F1-Score: 0.8841 - Accuracy-Score: 0.8513 - AUROC: 0.9137 - AP: 0.9398
[37m2024-08-15 14:44:49,917 [INFO] - Epoch: 16/50
[37m2024-08-15 14:44:49,922 [INFO] - Extracting training cells
[37m2024-08-15 14:45:52,737 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.601, Recall: 0.716, Detected-Cells: 12541
[37m2024-08-15 14:45:53,188 [INFO] - Training epoch stats:     Loss: 0.0804 - F1-Score: 0.9749 - Accuracy-Score: 0.9675 - AUROC: 0.9957 - AP: 0.9974
[37m2024-08-15 14:45:53,770 [INFO] - Validation epoch stats:   Loss: 0.6226 - F1-Score: 0.8758 - Accuracy-Score: 0.8435 - AUROC: 0.9087 - AP: 0.9377
[37m2024-08-15 14:45:53,848 [INFO] - Epoch: 17/50
[37m2024-08-15 14:45:53,853 [INFO] - Extracting training cells
[37m2024-08-15 14:46:57,040 [INFO] - Extraction detection metrics - F1: 0.630, Precision: 0.598, Recall: 0.732, Detected-Cells: 12443
[37m2024-08-15 14:46:57,499 [INFO] - Training epoch stats:     Loss: 0.0929 - F1-Score: 0.9750 - Accuracy-Score: 0.9688 - AUROC: 0.9948 - AP: 0.9963
[37m2024-08-15 14:46:57,841 [INFO] - Validation epoch stats:   Loss: 0.6386 - F1-Score: 0.8866 - Accuracy-Score: 0.8543 - AUROC: 0.9137 - AP: 0.9395
[37m2024-08-15 14:46:57,914 [INFO] - Epoch: 18/50
[37m2024-08-15 14:46:57,919 [INFO] - Extracting training cells
[37m2024-08-15 14:48:01,273 [INFO] - Extraction detection metrics - F1: 0.631, Precision: 0.595, Recall: 0.740, Detected-Cells: 12473
[37m2024-08-15 14:48:01,753 [INFO] - Training epoch stats:     Loss: 0.1148 - F1-Score: 0.9710 - Accuracy-Score: 0.9637 - AUROC: 0.9919 - AP: 0.9939
[37m2024-08-15 14:48:02,152 [INFO] - Validation epoch stats:   Loss: 0.5604 - F1-Score: 0.8848 - Accuracy-Score: 0.8515 - AUROC: 0.9143 - AP: 0.9403
[37m2024-08-15 14:48:02,216 [INFO] - Epoch: 19/50
[37m2024-08-15 14:48:02,221 [INFO] - Extracting training cells
[37m2024-08-15 14:49:06,161 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.604, Recall: 0.717, Detected-Cells: 12800
[37m2024-08-15 14:49:06,631 [INFO] - Training epoch stats:     Loss: 0.0934 - F1-Score: 0.9714 - Accuracy-Score: 0.9642 - AUROC: 0.9943 - AP: 0.9958
[37m2024-08-15 14:49:06,971 [INFO] - Validation epoch stats:   Loss: 0.6181 - F1-Score: 0.8826 - Accuracy-Score: 0.8472 - AUROC: 0.9009 - AP: 0.9258
[37m2024-08-15 14:49:07,045 [INFO] - Epoch: 20/50
[37m2024-08-15 14:49:07,050 [INFO] - Extracting training cells
[37m2024-08-15 14:50:09,389 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.585, Recall: 0.730, Detected-Cells: 12524
[37m2024-08-15 14:50:09,868 [INFO] - Training epoch stats:     Loss: 0.0781 - F1-Score: 0.9765 - Accuracy-Score: 0.9692 - AUROC: 0.9957 - AP: 0.9974
[37m2024-08-15 14:50:10,257 [INFO] - Validation epoch stats:   Loss: 0.6463 - F1-Score: 0.8787 - Accuracy-Score: 0.8451 - AUROC: 0.9058 - AP: 0.9318
[37m2024-08-15 14:50:10,328 [INFO] - Epoch: 21/50
[37m2024-08-15 14:50:10,333 [INFO] - Extracting training cells
[37m2024-08-15 14:51:14,051 [INFO] - Extraction detection metrics - F1: 0.612, Precision: 0.595, Recall: 0.712, Detected-Cells: 12276
[37m2024-08-15 14:51:14,488 [INFO] - Training epoch stats:     Loss: 0.0820 - F1-Score: 0.9749 - Accuracy-Score: 0.9682 - AUROC: 0.9956 - AP: 0.9972
[37m2024-08-15 14:51:14,834 [INFO] - Validation epoch stats:   Loss: 0.6652 - F1-Score: 0.8851 - Accuracy-Score: 0.8577 - AUROC: 0.9206 - AP: 0.9462
[37m2024-08-15 14:51:14,841 [INFO] - Performing early stopping!
[37m2024-08-15 14:51:14,847 [INFO] - Finished run t5o7rx4r
