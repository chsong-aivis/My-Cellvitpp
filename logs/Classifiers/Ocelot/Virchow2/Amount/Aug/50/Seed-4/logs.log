[37m2024-08-15 18:48:44,875 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 18:48:44,876 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/Aug/50/Seed-4/2024-08-15T184835_CellViT-Virchow2-50Percent
[37m2024-08-15 18:48:44,916 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f6103758520>]
[37m2024-08-15 18:48:44,922 [INFO] - Using GPU: cuda:0
[37m2024-08-15 18:48:44,927 [INFO] - Using device: cuda:0
[37m2024-08-15 18:48:44,931 [INFO] - Loss function:
[37m2024-08-15 18:48:44,937 [INFO] - CrossEntropyLoss()
[37m2024-08-15 18:48:52,084 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 18:48:52,771 [INFO] - <All keys matched successfully>
[37m2024-08-15 18:48:53,971 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 18:48:53,977 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 18:48:53,982 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 18:48:53,988 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 18:48:54,008 [INFO] - Caching datasets
[37m2024-08-15 18:48:57,771 [INFO] - Instantiate Trainer
[37m2024-08-15 18:48:57,782 [INFO] - Calling Trainer Fit
[37m2024-08-15 18:48:57,787 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 18:48:57,793 [INFO] - Epoch: 1/50
[37m2024-08-15 18:48:57,798 [INFO] - Extracting training cells
[37m2024-08-15 18:51:03,043 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.599, Recall: 0.719, Detected-Cells: 22257
[37m2024-08-15 18:51:03,842 [INFO] - Training epoch stats:     Loss: 0.2549 - F1-Score: 0.9215 - Accuracy-Score: 0.8998 - AUROC: 0.9565 - AP: 0.9678
[37m2024-08-15 18:51:07,664 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 18:51:08,061 [INFO] - Validation epoch stats:   Loss: 0.3795 - F1-Score: 0.8919 - Accuracy-Score: 0.8626 - AUROC: 0.9291 - AP: 0.9572
[37m2024-08-15 18:51:08,068 [INFO] - New best model - save checkpoint
[37m2024-08-15 18:51:08,245 [INFO] - Epoch: 2/50
[37m2024-08-15 18:51:08,250 [INFO] - Extracting training cells
[37m2024-08-15 18:53:08,140 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.597, Recall: 0.721, Detected-Cells: 22600
[37m2024-08-15 18:53:08,880 [INFO] - Training epoch stats:     Loss: 0.1568 - F1-Score: 0.9527 - Accuracy-Score: 0.9389 - AUROC: 0.9831 - AP: 0.9898
[37m2024-08-15 18:53:09,212 [INFO] - Validation epoch stats:   Loss: 0.4101 - F1-Score: 0.8894 - Accuracy-Score: 0.8597 - AUROC: 0.9282 - AP: 0.9564
[37m2024-08-15 18:53:09,277 [INFO] - Epoch: 3/50
[37m2024-08-15 18:53:09,281 [INFO] - Extracting training cells
[37m2024-08-15 18:55:09,173 [INFO] - Extraction detection metrics - F1: 0.610, Precision: 0.586, Recall: 0.702, Detected-Cells: 22231
[37m2024-08-15 18:55:10,013 [INFO] - Training epoch stats:     Loss: 0.1476 - F1-Score: 0.9553 - Accuracy-Score: 0.9423 - AUROC: 0.9848 - AP: 0.9903
[37m2024-08-15 18:55:10,462 [INFO] - Validation epoch stats:   Loss: 0.3849 - F1-Score: 0.8856 - Accuracy-Score: 0.8536 - AUROC: 0.9183 - AP: 0.9453
[37m2024-08-15 18:55:10,533 [INFO] - Epoch: 4/50
[37m2024-08-15 18:55:10,538 [INFO] - Extracting training cells
[37m2024-08-15 18:57:10,090 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.590, Recall: 0.722, Detected-Cells: 22074
[37m2024-08-15 18:57:10,936 [INFO] - Training epoch stats:     Loss: 0.1366 - F1-Score: 0.9585 - Accuracy-Score: 0.9466 - AUROC: 0.9869 - AP: 0.9918
[37m2024-08-15 18:57:11,354 [INFO] - Validation epoch stats:   Loss: 0.4320 - F1-Score: 0.8902 - Accuracy-Score: 0.8567 - AUROC: 0.9196 - AP: 0.9443
[37m2024-08-15 18:57:11,416 [INFO] - Epoch: 5/50
[37m2024-08-15 18:57:11,422 [INFO] - Extracting training cells
[37m2024-08-15 18:59:11,756 [INFO] - Extraction detection metrics - F1: 0.607, Precision: 0.582, Recall: 0.703, Detected-Cells: 21445
[37m2024-08-15 18:59:12,516 [INFO] - Training epoch stats:     Loss: 0.1332 - F1-Score: 0.9595 - Accuracy-Score: 0.9484 - AUROC: 0.9878 - AP: 0.9917
[37m2024-08-15 18:59:12,858 [INFO] - Validation epoch stats:   Loss: 0.4200 - F1-Score: 0.8786 - Accuracy-Score: 0.8438 - AUROC: 0.9110 - AP: 0.9389
[37m2024-08-15 18:59:12,939 [INFO] - Epoch: 6/50
[37m2024-08-15 18:59:12,944 [INFO] - Extracting training cells
[37m2024-08-15 19:01:15,161 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.590, Recall: 0.712, Detected-Cells: 22101
[37m2024-08-15 19:01:15,995 [INFO] - Training epoch stats:     Loss: 0.1212 - F1-Score: 0.9648 - Accuracy-Score: 0.9535 - AUROC: 0.9897 - AP: 0.9940
[37m2024-08-15 19:01:16,343 [INFO] - Validation epoch stats:   Loss: 0.4681 - F1-Score: 0.8861 - Accuracy-Score: 0.8523 - AUROC: 0.9104 - AP: 0.9359
[37m2024-08-15 19:01:16,417 [INFO] - Epoch: 7/50
[37m2024-08-15 19:01:16,422 [INFO] - Extracting training cells
[37m2024-08-15 19:03:15,588 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.595, Recall: 0.723, Detected-Cells: 22345
[37m2024-08-15 19:03:16,408 [INFO] - Training epoch stats:     Loss: 0.1224 - F1-Score: 0.9630 - Accuracy-Score: 0.9523 - AUROC: 0.9898 - AP: 0.9938
[37m2024-08-15 19:03:16,914 [INFO] - Validation epoch stats:   Loss: 0.5095 - F1-Score: 0.8882 - Accuracy-Score: 0.8533 - AUROC: 0.9099 - AP: 0.9350
[37m2024-08-15 19:03:16,996 [INFO] - Epoch: 8/50
[37m2024-08-15 19:03:17,001 [INFO] - Extracting training cells
[37m2024-08-15 19:05:19,378 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.596, Recall: 0.717, Detected-Cells: 22154
[37m2024-08-15 19:05:20,207 [INFO] - Training epoch stats:     Loss: 0.1209 - F1-Score: 0.9651 - Accuracy-Score: 0.9548 - AUROC: 0.9899 - AP: 0.9934
[37m2024-08-15 19:05:20,618 [INFO] - Validation epoch stats:   Loss: 0.4713 - F1-Score: 0.8867 - Accuracy-Score: 0.8551 - AUROC: 0.9143 - AP: 0.9407
[37m2024-08-15 19:05:20,695 [INFO] - Epoch: 9/50
[37m2024-08-15 19:05:20,701 [INFO] - Extracting training cells
[37m2024-08-15 19:07:24,816 [INFO] - Extraction detection metrics - F1: 0.612, Precision: 0.585, Recall: 0.709, Detected-Cells: 21822
[37m2024-08-15 19:07:25,608 [INFO] - Training epoch stats:     Loss: 0.1159 - F1-Score: 0.9642 - Accuracy-Score: 0.9538 - AUROC: 0.9909 - AP: 0.9945
[37m2024-08-15 19:07:26,080 [INFO] - Validation epoch stats:   Loss: 0.4679 - F1-Score: 0.8936 - Accuracy-Score: 0.8619 - AUROC: 0.9189 - AP: 0.9428
[37m2024-08-15 19:07:26,156 [INFO] - Epoch: 10/50
[37m2024-08-15 19:07:26,161 [INFO] - Extracting training cells
[37m2024-08-15 19:09:27,330 [INFO] - Extraction detection metrics - F1: 0.628, Precision: 0.596, Recall: 0.728, Detected-Cells: 22175
[37m2024-08-15 19:09:28,339 [INFO] - Training epoch stats:     Loss: 0.1140 - F1-Score: 0.9655 - Accuracy-Score: 0.9553 - AUROC: 0.9908 - AP: 0.9944
[37m2024-08-15 19:09:28,672 [INFO] - Validation epoch stats:   Loss: 0.5281 - F1-Score: 0.8888 - Accuracy-Score: 0.8548 - AUROC: 0.9103 - AP: 0.9317
[37m2024-08-15 19:09:28,748 [INFO] - Epoch: 11/50
[37m2024-08-15 19:09:28,753 [INFO] - Extracting training cells
[37m2024-08-15 19:11:28,862 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.583, Recall: 0.713, Detected-Cells: 22111
[37m2024-08-15 19:11:29,825 [INFO] - Training epoch stats:     Loss: 0.1121 - F1-Score: 0.9665 - Accuracy-Score: 0.9557 - AUROC: 0.9914 - AP: 0.9950
[37m2024-08-15 19:11:30,251 [INFO] - Validation epoch stats:   Loss: 0.5230 - F1-Score: 0.8862 - Accuracy-Score: 0.8522 - AUROC: 0.9164 - AP: 0.9399
[37m2024-08-15 19:11:30,320 [INFO] - Epoch: 12/50
[37m2024-08-15 19:11:30,325 [INFO] - Extracting training cells
[37m2024-08-15 19:13:31,464 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.588, Recall: 0.713, Detected-Cells: 21690
[37m2024-08-15 19:13:32,259 [INFO] - Training epoch stats:     Loss: 0.1178 - F1-Score: 0.9665 - Accuracy-Score: 0.9571 - AUROC: 0.9904 - AP: 0.9935
[37m2024-08-15 19:13:32,617 [INFO] - Validation epoch stats:   Loss: 0.5587 - F1-Score: 0.8867 - Accuracy-Score: 0.8489 - AUROC: 0.9068 - AP: 0.9280
[37m2024-08-15 19:13:32,693 [INFO] - Epoch: 13/50
[37m2024-08-15 19:13:32,699 [INFO] - Extracting training cells
[37m2024-08-15 19:15:35,436 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.590, Recall: 0.716, Detected-Cells: 22667
[37m2024-08-15 19:15:36,363 [INFO] - Training epoch stats:     Loss: 0.1072 - F1-Score: 0.9682 - Accuracy-Score: 0.9588 - AUROC: 0.9923 - AP: 0.9952
[37m2024-08-15 19:15:36,777 [INFO] - Validation epoch stats:   Loss: 0.4888 - F1-Score: 0.8897 - Accuracy-Score: 0.8573 - AUROC: 0.9084 - AP: 0.9274
[37m2024-08-15 19:15:36,840 [INFO] - Epoch: 14/50
[37m2024-08-15 19:15:36,845 [INFO] - Extracting training cells
[37m2024-08-15 19:17:37,620 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.590, Recall: 0.721, Detected-Cells: 22361
[37m2024-08-15 19:17:38,392 [INFO] - Training epoch stats:     Loss: 0.1063 - F1-Score: 0.9686 - Accuracy-Score: 0.9595 - AUROC: 0.9920 - AP: 0.9947
[37m2024-08-15 19:17:38,719 [INFO] - Validation epoch stats:   Loss: 0.5581 - F1-Score: 0.8877 - Accuracy-Score: 0.8565 - AUROC: 0.9071 - AP: 0.9273
[37m2024-08-15 19:17:38,802 [INFO] - Epoch: 15/50
[37m2024-08-15 19:17:38,808 [INFO] - Extracting training cells
[37m2024-08-15 19:19:41,717 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.593, Recall: 0.715, Detected-Cells: 22518
[37m2024-08-15 19:19:42,482 [INFO] - Training epoch stats:     Loss: 0.1016 - F1-Score: 0.9704 - Accuracy-Score: 0.9615 - AUROC: 0.9930 - AP: 0.9956
[37m2024-08-15 19:19:42,830 [INFO] - Validation epoch stats:   Loss: 0.5663 - F1-Score: 0.8854 - Accuracy-Score: 0.8535 - AUROC: 0.9086 - AP: 0.9260
[37m2024-08-15 19:19:42,890 [INFO] - Epoch: 16/50
[37m2024-08-15 19:19:42,895 [INFO] - Extracting training cells
[37m2024-08-15 19:21:43,375 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.593, Recall: 0.709, Detected-Cells: 22228
[37m2024-08-15 19:21:44,185 [INFO] - Training epoch stats:     Loss: 0.0959 - F1-Score: 0.9721 - Accuracy-Score: 0.9638 - AUROC: 0.9936 - AP: 0.9960
[37m2024-08-15 19:21:44,588 [INFO] - Validation epoch stats:   Loss: 0.5763 - F1-Score: 0.8894 - Accuracy-Score: 0.8548 - AUROC: 0.9090 - AP: 0.9289
[37m2024-08-15 19:21:44,652 [INFO] - Epoch: 17/50
[37m2024-08-15 19:21:44,657 [INFO] - Extracting training cells
[37m2024-08-15 19:23:45,811 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.589, Recall: 0.715, Detected-Cells: 22131
[37m2024-08-15 19:23:46,736 [INFO] - Training epoch stats:     Loss: 0.0967 - F1-Score: 0.9708 - Accuracy-Score: 0.9628 - AUROC: 0.9938 - AP: 0.9960
[37m2024-08-15 19:23:47,165 [INFO] - Validation epoch stats:   Loss: 0.5855 - F1-Score: 0.8933 - Accuracy-Score: 0.8628 - AUROC: 0.9147 - AP: 0.9338
[37m2024-08-15 19:23:47,237 [INFO] - Epoch: 18/50
[37m2024-08-15 19:23:47,242 [INFO] - Extracting training cells
[37m2024-08-15 19:25:50,117 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.594, Recall: 0.720, Detected-Cells: 22411
[37m2024-08-15 19:25:50,906 [INFO] - Training epoch stats:     Loss: 0.1027 - F1-Score: 0.9668 - Accuracy-Score: 0.9573 - AUROC: 0.9929 - AP: 0.9955
[37m2024-08-15 19:25:51,275 [INFO] - Validation epoch stats:   Loss: 0.5605 - F1-Score: 0.8974 - Accuracy-Score: 0.8683 - AUROC: 0.9238 - AP: 0.9453
[37m2024-08-15 19:25:51,334 [INFO] - Epoch: 19/50
[37m2024-08-15 19:25:51,339 [INFO] - Extracting training cells
[37m2024-08-15 19:27:54,326 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.594, Recall: 0.721, Detected-Cells: 22259
[37m2024-08-15 19:27:55,174 [INFO] - Training epoch stats:     Loss: 0.1034 - F1-Score: 0.9710 - Accuracy-Score: 0.9629 - AUROC: 0.9928 - AP: 0.9949
[37m2024-08-15 19:27:55,579 [INFO] - Validation epoch stats:   Loss: 0.5349 - F1-Score: 0.8817 - Accuracy-Score: 0.8524 - AUROC: 0.9153 - AP: 0.9383
[37m2024-08-15 19:27:55,642 [INFO] - Epoch: 20/50
[37m2024-08-15 19:27:55,647 [INFO] - Extracting training cells
[37m2024-08-15 19:29:55,702 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.599, Recall: 0.722, Detected-Cells: 22515
[37m2024-08-15 19:29:56,599 [INFO] - Training epoch stats:     Loss: 0.0961 - F1-Score: 0.9707 - Accuracy-Score: 0.9621 - AUROC: 0.9937 - AP: 0.9959
[37m2024-08-15 19:29:57,013 [INFO] - Validation epoch stats:   Loss: 0.5714 - F1-Score: 0.8887 - Accuracy-Score: 0.8578 - AUROC: 0.9162 - AP: 0.9412
[37m2024-08-15 19:29:57,078 [INFO] - Epoch: 21/50
[37m2024-08-15 19:29:57,083 [INFO] - Extracting training cells
[37m2024-08-15 19:31:59,148 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.593, Recall: 0.714, Detected-Cells: 21946
[37m2024-08-15 19:31:59,891 [INFO] - Training epoch stats:     Loss: 0.0923 - F1-Score: 0.9716 - Accuracy-Score: 0.9634 - AUROC: 0.9943 - AP: 0.9964
[37m2024-08-15 19:32:00,232 [INFO] - Validation epoch stats:   Loss: 0.6208 - F1-Score: 0.8879 - Accuracy-Score: 0.8562 - AUROC: 0.9093 - AP: 0.9307
[37m2024-08-15 19:32:00,238 [INFO] - Performing early stopping!
[37m2024-08-15 19:32:00,245 [INFO] - Finished run 1ietd40z
