[37m2024-08-15 11:44:28,588 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 11:44:28,589 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/Aug/10/Seed-2/2024-08-15T114419_CellViT-Virchow2-10Percent
[37m2024-08-15 11:44:28,654 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f5a1abf4400>]
[37m2024-08-15 11:44:28,658 [INFO] - Using GPU: cuda:0
[37m2024-08-15 11:44:28,663 [INFO] - Using device: cuda:0
[37m2024-08-15 11:44:28,667 [INFO] - Loss function:
[37m2024-08-15 11:44:28,672 [INFO] - CrossEntropyLoss()
[37m2024-08-15 11:44:33,917 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 11:44:34,036 [INFO] - <All keys matched successfully>
[37m2024-08-15 11:44:34,869 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 11:44:34,875 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 11:44:34,879 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 11:44:34,883 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 11:44:34,897 [INFO] - Caching datasets
[37m2024-08-15 11:44:36,261 [INFO] - Instantiate Trainer
[37m2024-08-15 11:44:36,271 [INFO] - Calling Trainer Fit
[37m2024-08-15 11:44:36,275 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 11:44:36,279 [INFO] - Epoch: 1/50
[37m2024-08-15 11:44:36,283 [INFO] - Extracting training cells
[37m2024-08-15 11:45:23,147 [INFO] - Extraction detection metrics - F1: 0.592, Precision: 0.588, Recall: 0.690, Detected-Cells: 4696
[37m2024-08-15 11:45:23,384 [INFO] - Training epoch stats:     Loss: 0.2902 - F1-Score: 0.8990 - Accuracy-Score: 0.8716 - AUROC: 0.9428 - AP: 0.9595
[37m2024-08-15 11:45:27,347 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 11:45:27,700 [INFO] - Validation epoch stats:   Loss: 0.4112 - F1-Score: 0.8608 - Accuracy-Score: 0.8238 - AUROC: 0.8995 - AP: 0.9396
[37m2024-08-15 11:45:27,705 [INFO] - New best model - save checkpoint
[37m2024-08-15 11:45:27,873 [INFO] - Epoch: 2/50
[37m2024-08-15 11:45:27,879 [INFO] - Extracting training cells
[37m2024-08-15 11:46:07,249 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.604, Recall: 0.720, Detected-Cells: 5028
[37m2024-08-15 11:46:07,428 [INFO] - Training epoch stats:     Loss: 0.1470 - F1-Score: 0.9512 - Accuracy-Score: 0.9389 - AUROC: 0.9852 - AP: 0.9898
[37m2024-08-15 11:46:07,780 [INFO] - Validation epoch stats:   Loss: 0.5217 - F1-Score: 0.8430 - Accuracy-Score: 0.8101 - AUROC: 0.8856 - AP: 0.9257
[37m2024-08-15 11:46:07,847 [INFO] - Epoch: 3/50
[37m2024-08-15 11:46:07,851 [INFO] - Extracting training cells
[37m2024-08-15 11:46:46,988 [INFO] - Extraction detection metrics - F1: 0.595, Precision: 0.578, Recall: 0.709, Detected-Cells: 4796
[37m2024-08-15 11:46:47,173 [INFO] - Training epoch stats:     Loss: 0.1555 - F1-Score: 0.9500 - Accuracy-Score: 0.9389 - AUROC: 0.9850 - AP: 0.9903
[37m2024-08-15 11:46:47,566 [INFO] - Validation epoch stats:   Loss: 0.4967 - F1-Score: 0.8567 - Accuracy-Score: 0.8196 - AUROC: 0.8868 - AP: 0.9275
[37m2024-08-15 11:46:47,645 [INFO] - Epoch: 4/50
[37m2024-08-15 11:46:47,649 [INFO] - Extracting training cells
[37m2024-08-15 11:47:27,011 [INFO] - Extraction detection metrics - F1: 0.590, Precision: 0.588, Recall: 0.687, Detected-Cells: 4889
[37m2024-08-15 11:47:27,214 [INFO] - Training epoch stats:     Loss: 0.1273 - F1-Score: 0.9584 - Accuracy-Score: 0.9483 - AUROC: 0.9885 - AP: 0.9919
[37m2024-08-15 11:47:27,578 [INFO] - Validation epoch stats:   Loss: 0.5659 - F1-Score: 0.8311 - Accuracy-Score: 0.7893 - AUROC: 0.8542 - AP: 0.8980
[37m2024-08-15 11:47:27,636 [INFO] - Epoch: 5/50
[37m2024-08-15 11:47:27,641 [INFO] - Extracting training cells
[37m2024-08-15 11:48:07,443 [INFO] - Extraction detection metrics - F1: 0.629, Precision: 0.616, Recall: 0.729, Detected-Cells: 5224
[37m2024-08-15 11:48:07,644 [INFO] - Training epoch stats:     Loss: 0.1091 - F1-Score: 0.9641 - Accuracy-Score: 0.9569 - AUROC: 0.9921 - AP: 0.9945
[37m2024-08-15 11:48:08,015 [INFO] - Validation epoch stats:   Loss: 0.6195 - F1-Score: 0.8272 - Accuracy-Score: 0.7928 - AUROC: 0.8692 - AP: 0.9103
[37m2024-08-15 11:48:08,078 [INFO] - Epoch: 6/50
[37m2024-08-15 11:48:08,083 [INFO] - Extracting training cells
[37m2024-08-15 11:48:47,830 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.610, Recall: 0.721, Detected-Cells: 5035
[37m2024-08-15 11:48:48,022 [INFO] - Training epoch stats:     Loss: 0.1308 - F1-Score: 0.9624 - Accuracy-Score: 0.9543 - AUROC: 0.9892 - AP: 0.9917
[37m2024-08-15 11:48:48,339 [INFO] - Validation epoch stats:   Loss: 0.5576 - F1-Score: 0.8457 - Accuracy-Score: 0.8035 - AUROC: 0.8665 - AP: 0.9102
[37m2024-08-15 11:48:48,407 [INFO] - Epoch: 7/50
[37m2024-08-15 11:48:48,411 [INFO] - Extracting training cells
[37m2024-08-15 11:49:27,601 [INFO] - Extraction detection metrics - F1: 0.598, Precision: 0.591, Recall: 0.698, Detected-Cells: 4535
[37m2024-08-15 11:49:27,771 [INFO] - Training epoch stats:     Loss: 0.1362 - F1-Score: 0.9579 - Accuracy-Score: 0.9491 - AUROC: 0.9884 - AP: 0.9910
[37m2024-08-15 11:49:28,150 [INFO] - Validation epoch stats:   Loss: 0.5150 - F1-Score: 0.8552 - Accuracy-Score: 0.8160 - AUROC: 0.8673 - AP: 0.9041
[37m2024-08-15 11:49:28,212 [INFO] - Epoch: 8/50
[37m2024-08-15 11:49:28,217 [INFO] - Extracting training cells
[37m2024-08-15 11:50:08,465 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.610, Recall: 0.719, Detected-Cells: 5132
[37m2024-08-15 11:50:08,676 [INFO] - Training epoch stats:     Loss: 0.0995 - F1-Score: 0.9703 - Accuracy-Score: 0.9638 - AUROC: 0.9928 - AP: 0.9950
[37m2024-08-15 11:50:09,095 [INFO] - Validation epoch stats:   Loss: 0.5648 - F1-Score: 0.8504 - Accuracy-Score: 0.8058 - AUROC: 0.8679 - AP: 0.9078
[37m2024-08-15 11:50:09,151 [INFO] - Epoch: 9/50
[37m2024-08-15 11:50:09,156 [INFO] - Extracting training cells
[37m2024-08-15 11:50:48,917 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.603, Recall: 0.716, Detected-Cells: 5023
[37m2024-08-15 11:50:49,083 [INFO] - Training epoch stats:     Loss: 0.1003 - F1-Score: 0.9688 - Accuracy-Score: 0.9606 - AUROC: 0.9932 - AP: 0.9958
[37m2024-08-15 11:50:49,400 [INFO] - Validation epoch stats:   Loss: 0.5850 - F1-Score: 0.8491 - Accuracy-Score: 0.8035 - AUROC: 0.8620 - AP: 0.9033
[37m2024-08-15 11:50:49,466 [INFO] - Epoch: 10/50
[37m2024-08-15 11:50:49,470 [INFO] - Extracting training cells
[37m2024-08-15 11:51:29,109 [INFO] - Extraction detection metrics - F1: 0.608, Precision: 0.598, Recall: 0.714, Detected-Cells: 5105
[37m2024-08-15 11:51:29,279 [INFO] - Training epoch stats:     Loss: 0.1156 - F1-Score: 0.9671 - Accuracy-Score: 0.9595 - AUROC: 0.9910 - AP: 0.9933
[37m2024-08-15 11:51:29,584 [INFO] - Validation epoch stats:   Loss: 0.5569 - F1-Score: 0.8520 - Accuracy-Score: 0.8084 - AUROC: 0.8754 - AP: 0.9159
[37m2024-08-15 11:51:29,648 [INFO] - Epoch: 11/50
[37m2024-08-15 11:51:29,653 [INFO] - Extracting training cells
[37m2024-08-15 11:52:08,613 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.605, Recall: 0.715, Detected-Cells: 4869
[37m2024-08-15 11:52:08,793 [INFO] - Training epoch stats:     Loss: 0.1130 - F1-Score: 0.9648 - Accuracy-Score: 0.9587 - AUROC: 0.9911 - AP: 0.9923
[37m2024-08-15 11:52:09,098 [INFO] - Validation epoch stats:   Loss: 0.5886 - F1-Score: 0.8520 - Accuracy-Score: 0.8057 - AUROC: 0.8622 - AP: 0.9007
[37m2024-08-15 11:52:09,153 [INFO] - Epoch: 12/50
[37m2024-08-15 11:52:09,156 [INFO] - Extracting training cells
[37m2024-08-15 11:52:48,530 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.604, Recall: 0.713, Detected-Cells: 4988
[37m2024-08-15 11:52:48,712 [INFO] - Training epoch stats:     Loss: 0.1006 - F1-Score: 0.9690 - Accuracy-Score: 0.9613 - AUROC: 0.9930 - AP: 0.9953
[37m2024-08-15 11:52:49,076 [INFO] - Validation epoch stats:   Loss: 0.6440 - F1-Score: 0.8267 - Accuracy-Score: 0.7847 - AUROC: 0.8488 - AP: 0.8990
[37m2024-08-15 11:52:49,134 [INFO] - Epoch: 13/50
[37m2024-08-15 11:52:49,137 [INFO] - Extracting training cells
[37m2024-08-15 11:53:28,659 [INFO] - Extraction detection metrics - F1: 0.608, Precision: 0.601, Recall: 0.712, Detected-Cells: 4938
[37m2024-08-15 11:53:28,850 [INFO] - Training epoch stats:     Loss: 0.1007 - F1-Score: 0.9666 - Accuracy-Score: 0.9597 - AUROC: 0.9935 - AP: 0.9950
[37m2024-08-15 11:53:29,211 [INFO] - Validation epoch stats:   Loss: 0.6477 - F1-Score: 0.8573 - Accuracy-Score: 0.8149 - AUROC: 0.8706 - AP: 0.9114
[37m2024-08-15 11:53:29,281 [INFO] - Epoch: 14/50
[37m2024-08-15 11:53:29,286 [INFO] - Extracting training cells
[37m2024-08-15 11:54:07,744 [INFO] - Extraction detection metrics - F1: 0.586, Precision: 0.579, Recall: 0.689, Detected-Cells: 4734
[37m2024-08-15 11:54:07,895 [INFO] - Training epoch stats:     Loss: 0.1185 - F1-Score: 0.9648 - Accuracy-Score: 0.9578 - AUROC: 0.9912 - AP: 0.9925
[37m2024-08-15 11:54:08,296 [INFO] - Validation epoch stats:   Loss: 0.5828 - F1-Score: 0.8370 - Accuracy-Score: 0.7992 - AUROC: 0.8675 - AP: 0.9105
[37m2024-08-15 11:54:08,375 [INFO] - Epoch: 15/50
[37m2024-08-15 11:54:08,379 [INFO] - Extracting training cells
[37m2024-08-15 11:54:47,266 [INFO] - Extraction detection metrics - F1: 0.608, Precision: 0.608, Recall: 0.707, Detected-Cells: 5032
[37m2024-08-15 11:54:47,643 [INFO] - Training epoch stats:     Loss: 0.1122 - F1-Score: 0.9697 - Accuracy-Score: 0.9634 - AUROC: 0.9912 - AP: 0.9923
[37m2024-08-15 11:54:47,998 [INFO] - Validation epoch stats:   Loss: 0.5688 - F1-Score: 0.8376 - Accuracy-Score: 0.7881 - AUROC: 0.8543 - AP: 0.9038
[37m2024-08-15 11:54:48,077 [INFO] - Epoch: 16/50
[37m2024-08-15 11:54:48,082 [INFO] - Extracting training cells
[37m2024-08-15 11:55:27,167 [INFO] - Extraction detection metrics - F1: 0.601, Precision: 0.587, Recall: 0.702, Detected-Cells: 4709
[37m2024-08-15 11:55:27,313 [INFO] - Training epoch stats:     Loss: 0.0947 - F1-Score: 0.9687 - Accuracy-Score: 0.9628 - AUROC: 0.9942 - AP: 0.9955
[37m2024-08-15 11:55:27,608 [INFO] - Validation epoch stats:   Loss: 0.6113 - F1-Score: 0.8495 - Accuracy-Score: 0.8064 - AUROC: 0.8623 - AP: 0.9069
[37m2024-08-15 11:55:27,669 [INFO] - Epoch: 17/50
[37m2024-08-15 11:55:27,673 [INFO] - Extracting training cells
[37m2024-08-15 11:56:08,110 [INFO] - Extraction detection metrics - F1: 0.598, Precision: 0.574, Recall: 0.707, Detected-Cells: 4742
[37m2024-08-15 11:56:08,290 [INFO] - Training epoch stats:     Loss: 0.1029 - F1-Score: 0.9672 - Accuracy-Score: 0.9606 - AUROC: 0.9925 - AP: 0.9939
[37m2024-08-15 11:56:08,657 [INFO] - Validation epoch stats:   Loss: 0.6948 - F1-Score: 0.8352 - Accuracy-Score: 0.7994 - AUROC: 0.8716 - AP: 0.9136
[37m2024-08-15 11:56:08,727 [INFO] - Epoch: 18/50
[37m2024-08-15 11:56:08,731 [INFO] - Extracting training cells
[37m2024-08-15 11:56:48,272 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.608, Recall: 0.719, Detected-Cells: 5006
[37m2024-08-15 11:56:48,432 [INFO] - Training epoch stats:     Loss: 0.0993 - F1-Score: 0.9727 - Accuracy-Score: 0.9678 - AUROC: 0.9941 - AP: 0.9952
[37m2024-08-15 11:56:48,740 [INFO] - Validation epoch stats:   Loss: 0.5989 - F1-Score: 0.8399 - Accuracy-Score: 0.7960 - AUROC: 0.8543 - AP: 0.9002
[37m2024-08-15 11:56:48,816 [INFO] - Epoch: 19/50
[37m2024-08-15 11:56:48,820 [INFO] - Extracting training cells
[37m2024-08-15 11:57:28,042 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.620, Recall: 0.726, Detected-Cells: 5253
[37m2024-08-15 11:57:28,246 [INFO] - Training epoch stats:     Loss: 0.0706 - F1-Score: 0.9756 - Accuracy-Score: 0.9707 - AUROC: 0.9966 - AP: 0.9974
[37m2024-08-15 11:57:28,623 [INFO] - Validation epoch stats:   Loss: 0.6706 - F1-Score: 0.8415 - Accuracy-Score: 0.8016 - AUROC: 0.8669 - AP: 0.9094
[37m2024-08-15 11:57:28,688 [INFO] - Epoch: 20/50
[37m2024-08-15 11:57:28,692 [INFO] - Extracting training cells
[37m2024-08-15 11:58:07,273 [INFO] - Extraction detection metrics - F1: 0.593, Precision: 0.587, Recall: 0.690, Detected-Cells: 4665
[37m2024-08-15 11:58:07,447 [INFO] - Training epoch stats:     Loss: 0.1171 - F1-Score: 0.9699 - Accuracy-Score: 0.9638 - AUROC: 0.9908 - AP: 0.9923
[37m2024-08-15 11:58:07,806 [INFO] - Validation epoch stats:   Loss: 0.6380 - F1-Score: 0.8306 - Accuracy-Score: 0.7827 - AUROC: 0.8496 - AP: 0.9003
[37m2024-08-15 11:58:07,863 [INFO] - Epoch: 21/50
[37m2024-08-15 11:58:07,866 [INFO] - Extracting training cells
[37m2024-08-15 11:58:47,095 [INFO] - Extraction detection metrics - F1: 0.606, Precision: 0.596, Recall: 0.705, Detected-Cells: 4760
[37m2024-08-15 11:58:47,265 [INFO] - Training epoch stats:     Loss: 0.1178 - F1-Score: 0.9662 - Accuracy-Score: 0.9586 - AUROC: 0.9911 - AP: 0.9928
[37m2024-08-15 11:58:47,666 [INFO] - Validation epoch stats:   Loss: 0.6692 - F1-Score: 0.8340 - Accuracy-Score: 0.7848 - AUROC: 0.8513 - AP: 0.9016
[37m2024-08-15 11:58:47,701 [INFO] - Performing early stopping!
[37m2024-08-15 11:58:47,708 [INFO] - Finished run nqsmzmpm
