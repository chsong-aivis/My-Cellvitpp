[37m2024-08-15 09:44:39,077 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 09:44:39,078 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/Aug/10/Seed-1/2024-08-15T094429_CellViT-Virchow2-10Percent
[37m2024-08-15 09:44:39,149 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f313cc444f0>]
[37m2024-08-15 09:44:39,154 [INFO] - Using GPU: cuda:0
[37m2024-08-15 09:44:39,158 [INFO] - Using device: cuda:0
[37m2024-08-15 09:44:39,162 [INFO] - Loss function:
[37m2024-08-15 09:44:39,165 [INFO] - CrossEntropyLoss()
[37m2024-08-15 09:44:46,973 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 09:44:47,980 [INFO] - <All keys matched successfully>
[37m2024-08-15 09:44:50,039 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 09:44:50,049 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 09:44:50,054 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 09:44:50,058 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 09:44:50,075 [INFO] - Caching datasets
[37m2024-08-15 09:44:51,999 [INFO] - Instantiate Trainer
[37m2024-08-15 09:44:52,009 [INFO] - Calling Trainer Fit
[37m2024-08-15 09:44:52,013 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 09:44:52,017 [INFO] - Epoch: 1/50
[37m2024-08-15 09:44:52,021 [INFO] - Extracting training cells
[37m2024-08-15 09:45:36,626 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.608, Recall: 0.724, Detected-Cells: 5056
[37m2024-08-15 09:45:37,139 [INFO] - Training epoch stats:     Loss: 0.3869 - F1-Score: 0.8702 - Accuracy-Score: 0.8420 - AUROC: 0.9186 - AP: 0.9299
[37m2024-08-15 09:45:41,398 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 09:45:41,903 [INFO] - Validation epoch stats:   Loss: 0.5197 - F1-Score: 0.8651 - Accuracy-Score: 0.8257 - AUROC: 0.8945 - AP: 0.9322
[37m2024-08-15 09:45:41,908 [INFO] - New best model - save checkpoint
[37m2024-08-15 09:45:42,076 [INFO] - Epoch: 2/50
[37m2024-08-15 09:45:42,082 [INFO] - Extracting training cells
[37m2024-08-15 09:46:11,856 [INFO] - Extraction detection metrics - F1: 0.604, Precision: 0.594, Recall: 0.698, Detected-Cells: 4770
[37m2024-08-15 09:46:12,095 [INFO] - Training epoch stats:     Loss: 0.1857 - F1-Score: 0.9399 - Accuracy-Score: 0.9239 - AUROC: 0.9774 - AP: 0.9850
[37m2024-08-15 09:46:12,532 [INFO] - Validation epoch stats:   Loss: 0.4198 - F1-Score: 0.8721 - Accuracy-Score: 0.8323 - AUROC: 0.8981 - AP: 0.9342
[37m2024-08-15 09:46:12,538 [INFO] - New best model - save checkpoint
[37m2024-08-15 09:46:12,729 [INFO] - Epoch: 3/50
[37m2024-08-15 09:46:12,734 [INFO] - Extracting training cells
[37m2024-08-15 09:46:48,545 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.603, Recall: 0.738, Detected-Cells: 5349
[37m2024-08-15 09:46:48,710 [INFO] - Training epoch stats:     Loss: 0.1445 - F1-Score: 0.9486 - Accuracy-Score: 0.9377 - AUROC: 0.9869 - AP: 0.9904
[37m2024-08-15 09:46:49,044 [INFO] - Validation epoch stats:   Loss: 0.4730 - F1-Score: 0.8615 - Accuracy-Score: 0.8217 - AUROC: 0.8902 - AP: 0.9293
[37m2024-08-15 09:46:49,124 [INFO] - Epoch: 4/50
[37m2024-08-15 09:46:49,129 [INFO] - Extracting training cells
[37m2024-08-15 09:47:20,474 [INFO] - Extraction detection metrics - F1: 0.607, Precision: 0.598, Recall: 0.706, Detected-Cells: 4895
[37m2024-08-15 09:47:20,699 [INFO] - Training epoch stats:     Loss: 0.1368 - F1-Score: 0.9560 - Accuracy-Score: 0.9463 - AUROC: 0.9882 - AP: 0.9915
[37m2024-08-15 09:47:21,102 [INFO] - Validation epoch stats:   Loss: 0.5340 - F1-Score: 0.8366 - Accuracy-Score: 0.7971 - AUROC: 0.8760 - AP: 0.9223
[37m2024-08-15 09:47:21,170 [INFO] - Epoch: 5/50
[37m2024-08-15 09:47:21,173 [INFO] - Extracting training cells
[37m2024-08-15 09:47:52,848 [INFO] - Extraction detection metrics - F1: 0.603, Precision: 0.583, Recall: 0.710, Detected-Cells: 4844
[37m2024-08-15 09:47:53,063 [INFO] - Training epoch stats:     Loss: 0.1378 - F1-Score: 0.9608 - Accuracy-Score: 0.9507 - AUROC: 0.9875 - AP: 0.9919
[37m2024-08-15 09:47:53,469 [INFO] - Validation epoch stats:   Loss: 0.5371 - F1-Score: 0.8588 - Accuracy-Score: 0.8211 - AUROC: 0.8880 - AP: 0.9290
[37m2024-08-15 09:47:53,525 [INFO] - Epoch: 6/50
[37m2024-08-15 09:47:53,529 [INFO] - Extracting training cells
[37m2024-08-15 09:48:23,274 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.617, Recall: 0.712, Detected-Cells: 5156
[37m2024-08-15 09:48:23,501 [INFO] - Training epoch stats:     Loss: 0.1148 - F1-Score: 0.9637 - Accuracy-Score: 0.9571 - AUROC: 0.9909 - AP: 0.9927
[37m2024-08-15 09:48:24,134 [INFO] - Validation epoch stats:   Loss: 0.5759 - F1-Score: 0.8331 - Accuracy-Score: 0.7964 - AUROC: 0.8769 - AP: 0.9191
[37m2024-08-15 09:48:24,194 [INFO] - Epoch: 7/50
[37m2024-08-15 09:48:24,197 [INFO] - Extracting training cells
[37m2024-08-15 09:48:56,754 [INFO] - Extraction detection metrics - F1: 0.602, Precision: 0.598, Recall: 0.703, Detected-Cells: 4640
[37m2024-08-15 09:48:57,170 [INFO] - Training epoch stats:     Loss: 0.1242 - F1-Score: 0.9571 - Accuracy-Score: 0.9498 - AUROC: 0.9893 - AP: 0.9916
[37m2024-08-15 09:48:57,557 [INFO] - Validation epoch stats:   Loss: 0.5351 - F1-Score: 0.8418 - Accuracy-Score: 0.8056 - AUROC: 0.8838 - AP: 0.9209
[37m2024-08-15 09:48:57,628 [INFO] - Epoch: 8/50
[37m2024-08-15 09:48:57,632 [INFO] - Extracting training cells
[37m2024-08-15 09:49:29,329 [INFO] - Extraction detection metrics - F1: 0.589, Precision: 0.588, Recall: 0.682, Detected-Cells: 4692
[37m2024-08-15 09:49:29,565 [INFO] - Training epoch stats:     Loss: 0.1072 - F1-Score: 0.9619 - Accuracy-Score: 0.9544 - AUROC: 0.9928 - AP: 0.9952
[37m2024-08-15 09:49:30,290 [INFO] - Validation epoch stats:   Loss: 0.7162 - F1-Score: 0.8492 - Accuracy-Score: 0.8034 - AUROC: 0.8733 - AP: 0.9130
[37m2024-08-15 09:49:30,365 [INFO] - Epoch: 9/50
[37m2024-08-15 09:49:30,371 [INFO] - Extracting training cells
[37m2024-08-15 09:50:01,896 [INFO] - Extraction detection metrics - F1: 0.641, Precision: 0.624, Recall: 0.744, Detected-Cells: 5379
[37m2024-08-15 09:50:02,131 [INFO] - Training epoch stats:     Loss: 0.1010 - F1-Score: 0.9655 - Accuracy-Score: 0.9582 - AUROC: 0.9929 - AP: 0.9951
[37m2024-08-15 09:50:02,538 [INFO] - Validation epoch stats:   Loss: 0.5297 - F1-Score: 0.8557 - Accuracy-Score: 0.8180 - AUROC: 0.8900 - AP: 0.9257
[37m2024-08-15 09:50:02,592 [INFO] - Epoch: 10/50
[37m2024-08-15 09:50:02,596 [INFO] - Extracting training cells
[37m2024-08-15 09:50:32,961 [INFO] - Extraction detection metrics - F1: 0.630, Precision: 0.619, Recall: 0.729, Detected-Cells: 5219
[37m2024-08-15 09:50:33,175 [INFO] - Training epoch stats:     Loss: 0.0886 - F1-Score: 0.9714 - Accuracy-Score: 0.9649 - AUROC: 0.9947 - AP: 0.9964
[37m2024-08-15 09:50:33,768 [INFO] - Validation epoch stats:   Loss: 0.6048 - F1-Score: 0.8422 - Accuracy-Score: 0.8026 - AUROC: 0.8757 - AP: 0.9152
[37m2024-08-15 09:50:33,840 [INFO] - Epoch: 11/50
[37m2024-08-15 09:50:33,844 [INFO] - Extracting training cells
[37m2024-08-15 09:51:06,349 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.606, Recall: 0.724, Detected-Cells: 5226
[37m2024-08-15 09:51:06,567 [INFO] - Training epoch stats:     Loss: 0.1068 - F1-Score: 0.9706 - Accuracy-Score: 0.9636 - AUROC: 0.9934 - AP: 0.9955
[37m2024-08-15 09:51:06,968 [INFO] - Validation epoch stats:   Loss: 0.6544 - F1-Score: 0.8192 - Accuracy-Score: 0.7827 - AUROC: 0.8640 - AP: 0.9074
[37m2024-08-15 09:51:07,040 [INFO] - Epoch: 12/50
[37m2024-08-15 09:51:07,046 [INFO] - Extracting training cells
[37m2024-08-15 09:51:39,613 [INFO] - Extraction detection metrics - F1: 0.627, Precision: 0.620, Recall: 0.710, Detected-Cells: 5160
[37m2024-08-15 09:51:39,840 [INFO] - Training epoch stats:     Loss: 0.0802 - F1-Score: 0.9726 - Accuracy-Score: 0.9672 - AUROC: 0.9958 - AP: 0.9972
[37m2024-08-15 09:51:40,255 [INFO] - Validation epoch stats:   Loss: 0.6869 - F1-Score: 0.8493 - Accuracy-Score: 0.8065 - AUROC: 0.8697 - AP: 0.9078
[37m2024-08-15 09:51:40,328 [INFO] - Epoch: 13/50
[37m2024-08-15 09:51:40,333 [INFO] - Extracting training cells
[37m2024-08-15 09:52:09,550 [INFO] - Extraction detection metrics - F1: 0.594, Precision: 0.582, Recall: 0.691, Detected-Cells: 4640
[37m2024-08-15 09:52:09,765 [INFO] - Training epoch stats:     Loss: 0.1295 - F1-Score: 0.9662 - Accuracy-Score: 0.9597 - AUROC: 0.9903 - AP: 0.9917
[37m2024-08-15 09:52:10,164 [INFO] - Validation epoch stats:   Loss: 0.6023 - F1-Score: 0.8354 - Accuracy-Score: 0.7933 - AUROC: 0.8675 - AP: 0.9098
[37m2024-08-15 09:52:10,225 [INFO] - Epoch: 14/50
[37m2024-08-15 09:52:10,229 [INFO] - Extracting training cells
[37m2024-08-15 09:52:41,883 [INFO] - Extraction detection metrics - F1: 0.609, Precision: 0.597, Recall: 0.709, Detected-Cells: 4780
[37m2024-08-15 09:52:42,067 [INFO] - Training epoch stats:     Loss: 0.0955 - F1-Score: 0.9702 - Accuracy-Score: 0.9655 - AUROC: 0.9945 - AP: 0.9956
[37m2024-08-15 09:52:42,548 [INFO] - Validation epoch stats:   Loss: 0.6655 - F1-Score: 0.8336 - Accuracy-Score: 0.7947 - AUROC: 0.8688 - AP: 0.9103
[37m2024-08-15 09:52:42,615 [INFO] - Epoch: 15/50
[37m2024-08-15 09:52:42,620 [INFO] - Extracting training cells
[37m2024-08-15 09:53:15,360 [INFO] - Extraction detection metrics - F1: 0.596, Precision: 0.589, Recall: 0.706, Detected-Cells: 4754
[37m2024-08-15 09:53:15,591 [INFO] - Training epoch stats:     Loss: 0.1028 - F1-Score: 0.9695 - Accuracy-Score: 0.9609 - AUROC: 0.9937 - AP: 0.9961
[37m2024-08-15 09:53:16,405 [INFO] - Validation epoch stats:   Loss: 0.7100 - F1-Score: 0.8207 - Accuracy-Score: 0.7795 - AUROC: 0.8545 - AP: 0.8978
[37m2024-08-15 09:53:16,456 [INFO] - Epoch: 16/50
[37m2024-08-15 09:53:16,461 [INFO] - Extracting training cells
[37m2024-08-15 09:53:48,646 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.630, Recall: 0.719, Detected-Cells: 5163
[37m2024-08-15 09:53:48,874 [INFO] - Training epoch stats:     Loss: 0.0806 - F1-Score: 0.9763 - Accuracy-Score: 0.9713 - AUROC: 0.9951 - AP: 0.9961
[37m2024-08-15 09:53:49,288 [INFO] - Validation epoch stats:   Loss: 0.6763 - F1-Score: 0.8479 - Accuracy-Score: 0.8068 - AUROC: 0.8722 - AP: 0.9092
[37m2024-08-15 09:53:49,359 [INFO] - Epoch: 17/50
[37m2024-08-15 09:53:49,364 [INFO] - Extracting training cells
[37m2024-08-15 09:54:18,355 [INFO] - Extraction detection metrics - F1: 0.577, Precision: 0.571, Recall: 0.673, Detected-Cells: 4757
[37m2024-08-15 09:54:18,542 [INFO] - Training epoch stats:     Loss: 0.1121 - F1-Score: 0.9683 - Accuracy-Score: 0.9617 - AUROC: 0.9921 - AP: 0.9940
[37m2024-08-15 09:54:18,941 [INFO] - Validation epoch stats:   Loss: 0.6489 - F1-Score: 0.8303 - Accuracy-Score: 0.7869 - AUROC: 0.8530 - AP: 0.8952
[37m2024-08-15 09:54:19,000 [INFO] - Epoch: 18/50
[37m2024-08-15 09:54:19,004 [INFO] - Extracting training cells
[37m2024-08-15 09:54:51,877 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.611, Recall: 0.721, Detected-Cells: 5052
[37m2024-08-15 09:54:52,071 [INFO] - Training epoch stats:     Loss: 0.1035 - F1-Score: 0.9680 - Accuracy-Score: 0.9610 - AUROC: 0.9927 - AP: 0.9944
[37m2024-08-15 09:54:52,810 [INFO] - Validation epoch stats:   Loss: 0.6249 - F1-Score: 0.8151 - Accuracy-Score: 0.7729 - AUROC: 0.8505 - AP: 0.8930
[37m2024-08-15 09:54:52,870 [INFO] - Epoch: 19/50
[37m2024-08-15 09:54:52,875 [INFO] - Extracting training cells
[37m2024-08-15 09:55:23,919 [INFO] - Extraction detection metrics - F1: 0.600, Precision: 0.580, Recall: 0.700, Detected-Cells: 4693
[37m2024-08-15 09:55:24,077 [INFO] - Training epoch stats:     Loss: 0.0968 - F1-Score: 0.9710 - Accuracy-Score: 0.9646 - AUROC: 0.9938 - AP: 0.9956
[37m2024-08-15 09:55:24,425 [INFO] - Validation epoch stats:   Loss: 0.6939 - F1-Score: 0.8181 - Accuracy-Score: 0.7763 - AUROC: 0.8453 - AP: 0.8891
[37m2024-08-15 09:55:24,500 [INFO] - Epoch: 20/50
[37m2024-08-15 09:55:24,506 [INFO] - Extracting training cells
[37m2024-08-15 09:55:55,053 [INFO] - Extraction detection metrics - F1: 0.607, Precision: 0.594, Recall: 0.703, Detected-Cells: 4685
[37m2024-08-15 09:55:55,233 [INFO] - Training epoch stats:     Loss: 0.0947 - F1-Score: 0.9736 - Accuracy-Score: 0.9691 - AUROC: 0.9935 - AP: 0.9932
[37m2024-08-15 09:55:55,635 [INFO] - Validation epoch stats:   Loss: 0.7172 - F1-Score: 0.8402 - Accuracy-Score: 0.8007 - AUROC: 0.8693 - AP: 0.9084
[37m2024-08-15 09:55:55,695 [INFO] - Epoch: 21/50
[37m2024-08-15 09:55:55,700 [INFO] - Extracting training cells
[37m2024-08-15 09:56:24,625 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.628, Recall: 0.716, Detected-Cells: 5145
[37m2024-08-15 09:56:24,831 [INFO] - Training epoch stats:     Loss: 0.0736 - F1-Score: 0.9763 - Accuracy-Score: 0.9710 - AUROC: 0.9959 - AP: 0.9969
[37m2024-08-15 09:56:25,232 [INFO] - Validation epoch stats:   Loss: 0.6788 - F1-Score: 0.8384 - Accuracy-Score: 0.7954 - AUROC: 0.8599 - AP: 0.9001
[37m2024-08-15 09:56:25,307 [INFO] - Epoch: 22/50
[37m2024-08-15 09:56:25,312 [INFO] - Extracting training cells
[37m2024-08-15 09:56:57,655 [INFO] - Extraction detection metrics - F1: 0.625, Precision: 0.606, Recall: 0.726, Detected-Cells: 5216
[37m2024-08-15 09:56:57,881 [INFO] - Training epoch stats:     Loss: 0.0625 - F1-Score: 0.9814 - Accuracy-Score: 0.9772 - AUROC: 0.9976 - AP: 0.9985
[37m2024-08-15 09:56:58,291 [INFO] - Validation epoch stats:   Loss: 0.8895 - F1-Score: 0.8418 - Accuracy-Score: 0.7999 - AUROC: 0.8648 - AP: 0.9020
[37m2024-08-15 09:56:58,297 [INFO] - Performing early stopping!
[37m2024-08-15 09:56:58,302 [INFO] - Finished run lcgc0aux
