[37m2024-08-15 14:17:15,711 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 14:17:15,713 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/Aug/10/Seed-3/2024-08-15T141706_CellViT-Virchow2-10Percent
[37m2024-08-15 14:17:15,782 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fa0c0d0c460>]
[37m2024-08-15 14:17:15,789 [INFO] - Using GPU: cuda:0
[37m2024-08-15 14:17:15,794 [INFO] - Using device: cuda:0
[37m2024-08-15 14:17:15,799 [INFO] - Loss function:
[37m2024-08-15 14:17:15,804 [INFO] - CrossEntropyLoss()
[37m2024-08-15 14:17:22,869 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 14:17:23,962 [INFO] - <All keys matched successfully>
[37m2024-08-15 14:17:25,234 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 14:17:25,241 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 14:17:25,246 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 14:17:25,251 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 14:17:25,270 [INFO] - Caching datasets
[37m2024-08-15 14:17:27,237 [INFO] - Instantiate Trainer
[37m2024-08-15 14:17:27,243 [INFO] - Calling Trainer Fit
[37m2024-08-15 14:17:27,249 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 14:17:27,254 [INFO] - Epoch: 1/50
[37m2024-08-15 14:17:27,259 [INFO] - Extracting training cells
[37m2024-08-15 14:18:00,354 [INFO] - Extraction detection metrics - F1: 0.598, Precision: 0.579, Recall: 0.705, Detected-Cells: 4938
[37m2024-08-15 14:18:00,636 [INFO] - Training epoch stats:     Loss: 0.3164 - F1-Score: 0.8908 - Accuracy-Score: 0.8690 - AUROC: 0.9391 - AP: 0.9497
[37m2024-08-15 14:18:04,775 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 14:18:05,161 [INFO] - Validation epoch stats:   Loss: 0.4453 - F1-Score: 0.8646 - Accuracy-Score: 0.8272 - AUROC: 0.8863 - AP: 0.9239
[37m2024-08-15 14:18:05,166 [INFO] - New best model - save checkpoint
[37m2024-08-15 14:18:05,322 [INFO] - Epoch: 2/50
[37m2024-08-15 14:18:05,327 [INFO] - Extracting training cells
[37m2024-08-15 14:18:34,164 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.602, Recall: 0.720, Detected-Cells: 4909
[37m2024-08-15 14:18:34,379 [INFO] - Training epoch stats:     Loss: 0.1539 - F1-Score: 0.9492 - Accuracy-Score: 0.9407 - AUROC: 0.9841 - AP: 0.9875
[37m2024-08-15 14:18:34,800 [INFO] - Validation epoch stats:   Loss: 0.4677 - F1-Score: 0.8439 - Accuracy-Score: 0.8071 - AUROC: 0.8798 - AP: 0.9204
[37m2024-08-15 14:18:34,874 [INFO] - Epoch: 3/50
[37m2024-08-15 14:18:34,880 [INFO] - Extracting training cells
[37m2024-08-15 14:19:03,164 [INFO] - Extraction detection metrics - F1: 0.607, Precision: 0.596, Recall: 0.712, Detected-Cells: 4883
[37m2024-08-15 14:19:03,354 [INFO] - Training epoch stats:     Loss: 0.1788 - F1-Score: 0.9481 - Accuracy-Score: 0.9400 - AUROC: 0.9846 - AP: 0.9856
[37m2024-08-15 14:19:03,696 [INFO] - Validation epoch stats:   Loss: 0.5032 - F1-Score: 0.8461 - Accuracy-Score: 0.8082 - AUROC: 0.8788 - AP: 0.9187
[37m2024-08-15 14:19:03,766 [INFO] - Epoch: 4/50
[37m2024-08-15 14:19:03,772 [INFO] - Extracting training cells
[37m2024-08-15 14:19:32,527 [INFO] - Extraction detection metrics - F1: 0.641, Precision: 0.626, Recall: 0.746, Detected-Cells: 5107
[37m2024-08-15 14:19:32,709 [INFO] - Training epoch stats:     Loss: 0.1321 - F1-Score: 0.9565 - Accuracy-Score: 0.9473 - AUROC: 0.9885 - AP: 0.9916
[37m2024-08-15 14:19:33,057 [INFO] - Validation epoch stats:   Loss: 0.4772 - F1-Score: 0.8622 - Accuracy-Score: 0.8221 - AUROC: 0.8844 - AP: 0.9242
[37m2024-08-15 14:19:33,118 [INFO] - Epoch: 5/50
[37m2024-08-15 14:19:33,123 [INFO] - Extracting training cells
[37m2024-08-15 14:20:01,465 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.604, Recall: 0.714, Detected-Cells: 4805
[37m2024-08-15 14:20:01,669 [INFO] - Training epoch stats:     Loss: 0.1548 - F1-Score: 0.9545 - Accuracy-Score: 0.9426 - AUROC: 0.9837 - AP: 0.9878
[37m2024-08-15 14:20:02,081 [INFO] - Validation epoch stats:   Loss: 0.5533 - F1-Score: 0.8544 - Accuracy-Score: 0.8148 - AUROC: 0.8765 - AP: 0.9183
[37m2024-08-15 14:20:02,138 [INFO] - Epoch: 6/50
[37m2024-08-15 14:20:02,143 [INFO] - Extracting training cells
[37m2024-08-15 14:20:31,795 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.610, Recall: 0.718, Detected-Cells: 5127
[37m2024-08-15 14:20:32,030 [INFO] - Training epoch stats:     Loss: 0.1416 - F1-Score: 0.9612 - Accuracy-Score: 0.9532 - AUROC: 0.9893 - AP: 0.9921
[37m2024-08-15 14:20:32,451 [INFO] - Validation epoch stats:   Loss: 0.5243 - F1-Score: 0.8394 - Accuracy-Score: 0.8026 - AUROC: 0.8734 - AP: 0.9119
[37m2024-08-15 14:20:32,515 [INFO] - Epoch: 7/50
[37m2024-08-15 14:20:32,521 [INFO] - Extracting training cells
[37m2024-08-15 14:21:01,294 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.619, Recall: 0.715, Detected-Cells: 5144
[37m2024-08-15 14:21:01,685 [INFO] - Training epoch stats:     Loss: 0.1134 - F1-Score: 0.9647 - Accuracy-Score: 0.9574 - AUROC: 0.9905 - AP: 0.9925
[37m2024-08-15 14:21:02,148 [INFO] - Validation epoch stats:   Loss: 0.5721 - F1-Score: 0.8527 - Accuracy-Score: 0.8117 - AUROC: 0.8701 - AP: 0.9120
[37m2024-08-15 14:21:02,225 [INFO] - Epoch: 8/50
[37m2024-08-15 14:21:02,231 [INFO] - Extracting training cells
[37m2024-08-15 14:21:31,163 [INFO] - Extraction detection metrics - F1: 0.608, Precision: 0.604, Recall: 0.709, Detected-Cells: 5111
[37m2024-08-15 14:21:31,342 [INFO] - Training epoch stats:     Loss: 0.1148 - F1-Score: 0.9655 - Accuracy-Score: 0.9581 - AUROC: 0.9911 - AP: 0.9932
[37m2024-08-15 14:21:31,677 [INFO] - Validation epoch stats:   Loss: 0.5299 - F1-Score: 0.8608 - Accuracy-Score: 0.8206 - AUROC: 0.8810 - AP: 0.9203
[37m2024-08-15 14:21:31,737 [INFO] - Epoch: 9/50
[37m2024-08-15 14:21:31,742 [INFO] - Extracting training cells
[37m2024-08-15 14:21:59,832 [INFO] - Extraction detection metrics - F1: 0.593, Precision: 0.582, Recall: 0.693, Detected-Cells: 4895
[37m2024-08-15 14:22:00,129 [INFO] - Training epoch stats:     Loss: 0.0927 - F1-Score: 0.9682 - Accuracy-Score: 0.9616 - AUROC: 0.9945 - AP: 0.9965
[37m2024-08-15 14:22:00,606 [INFO] - Validation epoch stats:   Loss: 0.5342 - F1-Score: 0.8560 - Accuracy-Score: 0.8147 - AUROC: 0.8731 - AP: 0.9119
[37m2024-08-15 14:22:00,675 [INFO] - Epoch: 10/50
[37m2024-08-15 14:22:00,680 [INFO] - Extracting training cells
[37m2024-08-15 14:22:28,392 [INFO] - Extraction detection metrics - F1: 0.601, Precision: 0.587, Recall: 0.708, Detected-Cells: 4654
[37m2024-08-15 14:22:28,609 [INFO] - Training epoch stats:     Loss: 0.1105 - F1-Score: 0.9679 - Accuracy-Score: 0.9585 - AUROC: 0.9920 - AP: 0.9956
[37m2024-08-15 14:22:29,022 [INFO] - Validation epoch stats:   Loss: 0.6208 - F1-Score: 0.8452 - Accuracy-Score: 0.7986 - AUROC: 0.8566 - AP: 0.8978
[37m2024-08-15 14:22:29,096 [INFO] - Epoch: 11/50
[37m2024-08-15 14:22:29,101 [INFO] - Extracting training cells
[37m2024-08-15 14:22:58,456 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.610, Recall: 0.722, Detected-Cells: 4917
[37m2024-08-15 14:22:58,678 [INFO] - Training epoch stats:     Loss: 0.0849 - F1-Score: 0.9717 - Accuracy-Score: 0.9662 - AUROC: 0.9949 - AP: 0.9962
[37m2024-08-15 14:22:59,075 [INFO] - Validation epoch stats:   Loss: 0.5776 - F1-Score: 0.8412 - Accuracy-Score: 0.8029 - AUROC: 0.8762 - AP: 0.9140
[37m2024-08-15 14:22:59,148 [INFO] - Epoch: 12/50
[37m2024-08-15 14:22:59,154 [INFO] - Extracting training cells
[37m2024-08-15 14:23:26,533 [INFO] - Extraction detection metrics - F1: 0.604, Precision: 0.602, Recall: 0.701, Detected-Cells: 4963
[37m2024-08-15 14:23:26,724 [INFO] - Training epoch stats:     Loss: 0.0855 - F1-Score: 0.9748 - Accuracy-Score: 0.9704 - AUROC: 0.9951 - AP: 0.9957
[37m2024-08-15 14:23:27,126 [INFO] - Validation epoch stats:   Loss: 0.6397 - F1-Score: 0.8235 - Accuracy-Score: 0.7873 - AUROC: 0.8697 - AP: 0.9109
[37m2024-08-15 14:23:27,187 [INFO] - Epoch: 13/50
[37m2024-08-15 14:23:27,192 [INFO] - Extracting training cells
[37m2024-08-15 14:23:54,595 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.607, Recall: 0.711, Detected-Cells: 4935
[37m2024-08-15 14:23:54,783 [INFO] - Training epoch stats:     Loss: 0.0798 - F1-Score: 0.9760 - Accuracy-Score: 0.9718 - AUROC: 0.9955 - AP: 0.9958
[37m2024-08-15 14:23:55,194 [INFO] - Validation epoch stats:   Loss: 0.6978 - F1-Score: 0.8362 - Accuracy-Score: 0.8005 - AUROC: 0.8728 - AP: 0.9074
[37m2024-08-15 14:23:55,258 [INFO] - Epoch: 14/50
[37m2024-08-15 14:23:55,263 [INFO] - Extracting training cells
[37m2024-08-15 14:24:22,845 [INFO] - Extraction detection metrics - F1: 0.599, Precision: 0.593, Recall: 0.689, Detected-Cells: 4861
[37m2024-08-15 14:24:23,038 [INFO] - Training epoch stats:     Loss: 0.1026 - F1-Score: 0.9684 - Accuracy-Score: 0.9613 - AUROC: 0.9930 - AP: 0.9949
[37m2024-08-15 14:24:23,429 [INFO] - Validation epoch stats:   Loss: 0.6642 - F1-Score: 0.8561 - Accuracy-Score: 0.8097 - AUROC: 0.8609 - AP: 0.8958
[37m2024-08-15 14:24:23,510 [INFO] - Epoch: 15/50
[37m2024-08-15 14:24:23,516 [INFO] - Extracting training cells
[37m2024-08-15 14:24:52,093 [INFO] - Extraction detection metrics - F1: 0.627, Precision: 0.619, Recall: 0.721, Detected-Cells: 5222
[37m2024-08-15 14:24:52,267 [INFO] - Training epoch stats:     Loss: 0.1179 - F1-Score: 0.9687 - Accuracy-Score: 0.9621 - AUROC: 0.9923 - AP: 0.9936
[37m2024-08-15 14:24:52,734 [INFO] - Validation epoch stats:   Loss: 0.6771 - F1-Score: 0.8218 - Accuracy-Score: 0.7835 - AUROC: 0.8677 - AP: 0.9097
[37m2024-08-15 14:24:52,805 [INFO] - Epoch: 16/50
[37m2024-08-15 14:24:52,810 [INFO] - Extracting training cells
[37m2024-08-15 14:25:20,909 [INFO] - Extraction detection metrics - F1: 0.632, Precision: 0.618, Recall: 0.731, Detected-Cells: 5171
[37m2024-08-15 14:25:21,091 [INFO] - Training epoch stats:     Loss: 0.0974 - F1-Score: 0.9668 - Accuracy-Score: 0.9592 - AUROC: 0.9938 - AP: 0.9957
[37m2024-08-15 14:25:21,422 [INFO] - Validation epoch stats:   Loss: 0.6315 - F1-Score: 0.8456 - Accuracy-Score: 0.8038 - AUROC: 0.8610 - AP: 0.8973
[37m2024-08-15 14:25:21,495 [INFO] - Epoch: 17/50
[37m2024-08-15 14:25:21,500 [INFO] - Extracting training cells
[37m2024-08-15 14:25:49,626 [INFO] - Extraction detection metrics - F1: 0.602, Precision: 0.594, Recall: 0.699, Detected-Cells: 4880
[37m2024-08-15 14:25:49,813 [INFO] - Training epoch stats:     Loss: 0.1188 - F1-Score: 0.9620 - Accuracy-Score: 0.9539 - AUROC: 0.9905 - AP: 0.9925
[37m2024-08-15 14:25:50,208 [INFO] - Validation epoch stats:   Loss: 0.6583 - F1-Score: 0.8431 - Accuracy-Score: 0.8001 - AUROC: 0.8501 - AP: 0.8805
[37m2024-08-15 14:25:50,280 [INFO] - Epoch: 18/50
[37m2024-08-15 14:25:50,285 [INFO] - Extracting training cells
[37m2024-08-15 14:26:18,289 [INFO] - Extraction detection metrics - F1: 0.611, Precision: 0.597, Recall: 0.717, Detected-Cells: 5015
[37m2024-08-15 14:26:18,510 [INFO] - Training epoch stats:     Loss: 0.1167 - F1-Score: 0.9698 - Accuracy-Score: 0.9623 - AUROC: 0.9912 - AP: 0.9929
[37m2024-08-15 14:26:18,847 [INFO] - Validation epoch stats:   Loss: 0.6758 - F1-Score: 0.8414 - Accuracy-Score: 0.7996 - AUROC: 0.8704 - AP: 0.9106
[37m2024-08-15 14:26:18,927 [INFO] - Epoch: 19/50
[37m2024-08-15 14:26:18,933 [INFO] - Extracting training cells
[37m2024-08-15 14:26:46,758 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.608, Recall: 0.718, Detected-Cells: 5005
[37m2024-08-15 14:26:46,978 [INFO] - Training epoch stats:     Loss: 0.1093 - F1-Score: 0.9690 - Accuracy-Score: 0.9628 - AUROC: 0.9924 - AP: 0.9936
[37m2024-08-15 14:26:47,385 [INFO] - Validation epoch stats:   Loss: 0.6046 - F1-Score: 0.8313 - Accuracy-Score: 0.7894 - AUROC: 0.8606 - AP: 0.9029
[37m2024-08-15 14:26:47,455 [INFO] - Epoch: 20/50
[37m2024-08-15 14:26:47,460 [INFO] - Extracting training cells
[37m2024-08-15 14:27:16,032 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.603, Recall: 0.712, Detected-Cells: 4932
[37m2024-08-15 14:27:16,255 [INFO] - Training epoch stats:     Loss: 0.0921 - F1-Score: 0.9707 - Accuracy-Score: 0.9655 - AUROC: 0.9946 - AP: 0.9960
[37m2024-08-15 14:27:16,672 [INFO] - Validation epoch stats:   Loss: 0.6928 - F1-Score: 0.8406 - Accuracy-Score: 0.7945 - AUROC: 0.8556 - AP: 0.9009
[37m2024-08-15 14:27:16,749 [INFO] - Epoch: 21/50
[37m2024-08-15 14:27:16,756 [INFO] - Extracting training cells
[37m2024-08-15 14:27:44,893 [INFO] - Extraction detection metrics - F1: 0.608, Precision: 0.606, Recall: 0.699, Detected-Cells: 4919
[37m2024-08-15 14:27:45,126 [INFO] - Training epoch stats:     Loss: 0.0687 - F1-Score: 0.9771 - Accuracy-Score: 0.9721 - AUROC: 0.9971 - AP: 0.9982
[37m2024-08-15 14:27:45,529 [INFO] - Validation epoch stats:   Loss: 0.7601 - F1-Score: 0.8423 - Accuracy-Score: 0.8073 - AUROC: 0.8718 - AP: 0.9099
[37m2024-08-15 14:27:45,535 [INFO] - Performing early stopping!
[37m2024-08-15 14:27:45,541 [INFO] - Finished run xako4rvm
