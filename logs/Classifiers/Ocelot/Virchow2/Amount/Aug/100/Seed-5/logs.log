[37m2024-08-15 21:37:48,850 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 21:37:48,852 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/Aug/100/Seed-5/2024-08-15T213736_CellViT-Virchow2-100Percent
[37m2024-08-15 21:37:48,918 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f39db2e83d0>]
[37m2024-08-15 21:37:48,924 [INFO] - Using GPU: cuda:0
[37m2024-08-15 21:37:48,930 [INFO] - Using device: cuda:0
[37m2024-08-15 21:37:48,936 [INFO] - Loss function:
[37m2024-08-15 21:37:48,942 [INFO] - CrossEntropyLoss()
[37m2024-08-15 21:37:54,696 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 21:37:54,815 [INFO] - <All keys matched successfully>
[37m2024-08-15 21:37:55,726 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 21:37:55,732 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 21:37:55,737 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 21:37:55,742 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 21:37:55,759 [INFO] - Caching datasets
[37m2024-08-15 21:38:03,348 [INFO] - Instantiate Trainer
[37m2024-08-15 21:38:03,359 [INFO] - Calling Trainer Fit
[37m2024-08-15 21:38:03,366 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 21:38:03,372 [INFO] - Epoch: 1/50
[37m2024-08-15 21:38:03,378 [INFO] - Extracting training cells
[37m2024-08-15 21:43:55,245 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.590, Recall: 0.720, Detected-Cells: 44240
[37m2024-08-15 21:43:56,692 [INFO] - Training epoch stats:     Loss: 0.2222 - F1-Score: 0.9281 - Accuracy-Score: 0.9120 - AUROC: 0.9683 - AP: 0.9762
[37m2024-08-15 21:44:00,795 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 21:44:01,214 [INFO] - Validation epoch stats:   Loss: 0.3647 - F1-Score: 0.9086 - Accuracy-Score: 0.8853 - AUROC: 0.9403 - AP: 0.9565
[37m2024-08-15 21:44:01,221 [INFO] - New best model - save checkpoint
[37m2024-08-15 21:44:01,413 [INFO] - Epoch: 2/50
[37m2024-08-15 21:44:01,419 [INFO] - Extracting training cells
[37m2024-08-15 21:49:49,197 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.593, Recall: 0.727, Detected-Cells: 44053
[37m2024-08-15 21:49:50,561 [INFO] - Training epoch stats:     Loss: 0.1553 - F1-Score: 0.9520 - Accuracy-Score: 0.9416 - AUROC: 0.9838 - AP: 0.9882
[37m2024-08-15 21:49:50,903 [INFO] - Validation epoch stats:   Loss: 0.3966 - F1-Score: 0.9046 - Accuracy-Score: 0.8787 - AUROC: 0.9331 - AP: 0.9522
[37m2024-08-15 21:49:50,973 [INFO] - Epoch: 3/50
[37m2024-08-15 21:49:50,978 [INFO] - Extracting training cells
[37m2024-08-15 21:55:37,697 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.584, Recall: 0.724, Detected-Cells: 44965
[37m2024-08-15 21:55:39,585 [INFO] - Training epoch stats:     Loss: 0.1476 - F1-Score: 0.9532 - Accuracy-Score: 0.9429 - AUROC: 0.9857 - AP: 0.9897
[37m2024-08-15 21:55:40,089 [INFO] - Validation epoch stats:   Loss: 0.4103 - F1-Score: 0.9042 - Accuracy-Score: 0.8767 - AUROC: 0.9319 - AP: 0.9523
[37m2024-08-15 21:55:40,148 [INFO] - Epoch: 4/50
[37m2024-08-15 21:55:40,154 [INFO] - Extracting training cells
[37m2024-08-15 22:01:26,066 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.587, Recall: 0.729, Detected-Cells: 44798
[37m2024-08-15 22:01:27,467 [INFO] - Training epoch stats:     Loss: 0.1381 - F1-Score: 0.9572 - Accuracy-Score: 0.9478 - AUROC: 0.9873 - AP: 0.9900
[37m2024-08-15 22:01:27,819 [INFO] - Validation epoch stats:   Loss: 0.4265 - F1-Score: 0.8954 - Accuracy-Score: 0.8665 - AUROC: 0.9242 - AP: 0.9475
[37m2024-08-15 22:01:27,885 [INFO] - Epoch: 5/50
[37m2024-08-15 22:01:27,891 [INFO] - Extracting training cells
[37m2024-08-15 22:07:12,481 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.588, Recall: 0.725, Detected-Cells: 44748
[37m2024-08-15 22:07:13,939 [INFO] - Training epoch stats:     Loss: 0.1334 - F1-Score: 0.9585 - Accuracy-Score: 0.9489 - AUROC: 0.9886 - AP: 0.9919
[37m2024-08-15 22:07:14,473 [INFO] - Validation epoch stats:   Loss: 0.4021 - F1-Score: 0.8985 - Accuracy-Score: 0.8692 - AUROC: 0.9269 - AP: 0.9486
[37m2024-08-15 22:07:14,554 [INFO] - Epoch: 6/50
[37m2024-08-15 22:07:14,561 [INFO] - Extracting training cells
[37m2024-08-15 22:13:04,870 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.591, Recall: 0.718, Detected-Cells: 44486
[37m2024-08-15 22:13:06,491 [INFO] - Training epoch stats:     Loss: 0.1271 - F1-Score: 0.9600 - Accuracy-Score: 0.9514 - AUROC: 0.9895 - AP: 0.9923
[37m2024-08-15 22:13:06,849 [INFO] - Validation epoch stats:   Loss: 0.4657 - F1-Score: 0.8932 - Accuracy-Score: 0.8668 - AUROC: 0.9338 - AP: 0.9566
[37m2024-08-15 22:13:06,927 [INFO] - Epoch: 7/50
[37m2024-08-15 22:13:06,932 [INFO] - Extracting training cells
[37m2024-08-15 22:18:50,791 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.591, Recall: 0.733, Detected-Cells: 45171
[37m2024-08-15 22:18:52,705 [INFO] - Training epoch stats:     Loss: 0.1258 - F1-Score: 0.9605 - Accuracy-Score: 0.9518 - AUROC: 0.9896 - AP: 0.9923
[37m2024-08-15 22:18:53,239 [INFO] - Validation epoch stats:   Loss: 0.4940 - F1-Score: 0.8942 - Accuracy-Score: 0.8648 - AUROC: 0.9208 - AP: 0.9409
[37m2024-08-15 22:18:53,313 [INFO] - Epoch: 8/50
[37m2024-08-15 22:18:53,319 [INFO] - Extracting training cells
[37m2024-08-15 22:24:38,684 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.592, Recall: 0.722, Detected-Cells: 44356
[37m2024-08-15 22:24:40,511 [INFO] - Training epoch stats:     Loss: 0.1244 - F1-Score: 0.9623 - Accuracy-Score: 0.9536 - AUROC: 0.9899 - AP: 0.9926
[37m2024-08-15 22:24:40,867 [INFO] - Validation epoch stats:   Loss: 0.5581 - F1-Score: 0.8939 - Accuracy-Score: 0.8615 - AUROC: 0.9130 - AP: 0.9346
[37m2024-08-15 22:24:40,950 [INFO] - Epoch: 9/50
[37m2024-08-15 22:24:40,955 [INFO] - Extracting training cells
[37m2024-08-15 22:30:26,068 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.589, Recall: 0.726, Detected-Cells: 44406
[37m2024-08-15 22:30:27,905 [INFO] - Training epoch stats:     Loss: 0.1192 - F1-Score: 0.9622 - Accuracy-Score: 0.9538 - AUROC: 0.9907 - AP: 0.9931
[37m2024-08-15 22:30:28,328 [INFO] - Validation epoch stats:   Loss: 0.5188 - F1-Score: 0.8903 - Accuracy-Score: 0.8612 - AUROC: 0.9212 - AP: 0.9446
[37m2024-08-15 22:30:28,414 [INFO] - Epoch: 10/50
[37m2024-08-15 22:30:28,419 [INFO] - Extracting training cells
[37m2024-08-15 22:36:11,304 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.580, Recall: 0.719, Detected-Cells: 43520
[37m2024-08-15 22:36:12,883 [INFO] - Training epoch stats:     Loss: 0.1155 - F1-Score: 0.9621 - Accuracy-Score: 0.9539 - AUROC: 0.9914 - AP: 0.9936
[37m2024-08-15 22:36:13,227 [INFO] - Validation epoch stats:   Loss: 0.6551 - F1-Score: 0.8889 - Accuracy-Score: 0.8596 - AUROC: 0.9134 - AP: 0.9317
[37m2024-08-15 22:36:13,304 [INFO] - Epoch: 11/50
[37m2024-08-15 22:36:13,310 [INFO] - Extracting training cells
[37m2024-08-15 22:42:00,977 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.591, Recall: 0.724, Detected-Cells: 44349
[37m2024-08-15 22:42:02,881 [INFO] - Training epoch stats:     Loss: 0.1115 - F1-Score: 0.9652 - Accuracy-Score: 0.9575 - AUROC: 0.9919 - AP: 0.9941
[37m2024-08-15 22:42:03,422 [INFO] - Validation epoch stats:   Loss: 0.5890 - F1-Score: 0.8940 - Accuracy-Score: 0.8639 - AUROC: 0.9113 - AP: 0.9262
[37m2024-08-15 22:42:03,504 [INFO] - Epoch: 12/50
[37m2024-08-15 22:42:03,510 [INFO] - Extracting training cells
[37m2024-08-15 22:47:48,246 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.592, Recall: 0.720, Detected-Cells: 44083
[37m2024-08-15 22:47:49,579 [INFO] - Training epoch stats:     Loss: 0.1149 - F1-Score: 0.9645 - Accuracy-Score: 0.9565 - AUROC: 0.9914 - AP: 0.9935
[37m2024-08-15 22:47:49,921 [INFO] - Validation epoch stats:   Loss: 0.6190 - F1-Score: 0.8932 - Accuracy-Score: 0.8658 - AUROC: 0.9112 - AP: 0.9240
[37m2024-08-15 22:47:50,003 [INFO] - Epoch: 13/50
[37m2024-08-15 22:47:50,009 [INFO] - Extracting training cells
[37m2024-08-15 22:53:37,489 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.587, Recall: 0.725, Detected-Cells: 44113
[37m2024-08-15 22:53:38,981 [INFO] - Training epoch stats:     Loss: 0.1037 - F1-Score: 0.9684 - Accuracy-Score: 0.9613 - AUROC: 0.9928 - AP: 0.9946
[37m2024-08-15 22:53:39,330 [INFO] - Validation epoch stats:   Loss: 0.8504 - F1-Score: 0.8857 - Accuracy-Score: 0.8555 - AUROC: 0.9020 - AP: 0.9145
[37m2024-08-15 22:53:39,401 [INFO] - Epoch: 14/50
[37m2024-08-15 22:53:39,406 [INFO] - Extracting training cells
[37m2024-08-15 22:59:26,052 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.597, Recall: 0.728, Detected-Cells: 44433
[37m2024-08-15 22:59:27,421 [INFO] - Training epoch stats:     Loss: 0.1129 - F1-Score: 0.9660 - Accuracy-Score: 0.9582 - AUROC: 0.9917 - AP: 0.9939
[37m2024-08-15 22:59:27,766 [INFO] - Validation epoch stats:   Loss: 0.6080 - F1-Score: 0.8895 - Accuracy-Score: 0.8615 - AUROC: 0.9263 - AP: 0.9470
[37m2024-08-15 22:59:27,835 [INFO] - Epoch: 15/50
[37m2024-08-15 22:59:27,841 [INFO] - Extracting training cells
[37m2024-08-15 23:05:12,923 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.595, Recall: 0.724, Detected-Cells: 44542
[37m2024-08-15 23:05:14,281 [INFO] - Training epoch stats:     Loss: 0.1104 - F1-Score: 0.9649 - Accuracy-Score: 0.9572 - AUROC: 0.9923 - AP: 0.9942
[37m2024-08-15 23:05:14,619 [INFO] - Validation epoch stats:   Loss: 0.5971 - F1-Score: 0.8879 - Accuracy-Score: 0.8593 - AUROC: 0.9218 - AP: 0.9465
[37m2024-08-15 23:05:14,696 [INFO] - Epoch: 16/50
[37m2024-08-15 23:05:14,702 [INFO] - Extracting training cells
[37m2024-08-15 23:11:01,498 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.589, Recall: 0.723, Detected-Cells: 44440
[37m2024-08-15 23:11:02,851 [INFO] - Training epoch stats:     Loss: 0.1095 - F1-Score: 0.9661 - Accuracy-Score: 0.9585 - AUROC: 0.9923 - AP: 0.9943
[37m2024-08-15 23:11:03,193 [INFO] - Validation epoch stats:   Loss: 0.6977 - F1-Score: 0.8913 - Accuracy-Score: 0.8615 - AUROC: 0.9137 - AP: 0.9329
[37m2024-08-15 23:11:03,272 [INFO] - Epoch: 17/50
[37m2024-08-15 23:11:03,277 [INFO] - Extracting training cells
[37m2024-08-15 23:16:50,719 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.595, Recall: 0.723, Detected-Cells: 44680
[37m2024-08-15 23:16:52,127 [INFO] - Training epoch stats:     Loss: 0.1018 - F1-Score: 0.9679 - Accuracy-Score: 0.9609 - AUROC: 0.9934 - AP: 0.9952
[37m2024-08-15 23:16:52,479 [INFO] - Validation epoch stats:   Loss: 0.7073 - F1-Score: 0.8861 - Accuracy-Score: 0.8579 - AUROC: 0.9181 - AP: 0.9365
[37m2024-08-15 23:16:52,554 [INFO] - Epoch: 18/50
[37m2024-08-15 23:16:52,560 [INFO] - Extracting training cells
[37m2024-08-15 23:22:39,730 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.589, Recall: 0.710, Detected-Cells: 43364
[37m2024-08-15 23:22:41,057 [INFO] - Training epoch stats:     Loss: 0.1090 - F1-Score: 0.9664 - Accuracy-Score: 0.9593 - AUROC: 0.9927 - AP: 0.9943
[37m2024-08-15 23:22:41,399 [INFO] - Validation epoch stats:   Loss: 0.7087 - F1-Score: 0.8832 - Accuracy-Score: 0.8540 - AUROC: 0.9113 - AP: 0.9291
[37m2024-08-15 23:22:41,475 [INFO] - Epoch: 19/50
[37m2024-08-15 23:22:41,480 [INFO] - Extracting training cells
[37m2024-08-15 23:28:27,648 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.586, Recall: 0.720, Detected-Cells: 44232
[37m2024-08-15 23:28:29,008 [INFO] - Training epoch stats:     Loss: 0.1031 - F1-Score: 0.9686 - Accuracy-Score: 0.9615 - AUROC: 0.9933 - AP: 0.9950
[37m2024-08-15 23:28:29,355 [INFO] - Validation epoch stats:   Loss: 0.5942 - F1-Score: 0.8940 - Accuracy-Score: 0.8666 - AUROC: 0.9234 - AP: 0.9441
[37m2024-08-15 23:28:29,443 [INFO] - Epoch: 20/50
[37m2024-08-15 23:28:29,449 [INFO] - Extracting training cells
[37m2024-08-15 23:34:15,077 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.593, Recall: 0.730, Detected-Cells: 44998
[37m2024-08-15 23:34:16,475 [INFO] - Training epoch stats:     Loss: 0.1049 - F1-Score: 0.9680 - Accuracy-Score: 0.9610 - AUROC: 0.9930 - AP: 0.9947
[37m2024-08-15 23:34:16,821 [INFO] - Validation epoch stats:   Loss: 0.7075 - F1-Score: 0.8885 - Accuracy-Score: 0.8595 - AUROC: 0.9145 - AP: 0.9333
[37m2024-08-15 23:34:16,885 [INFO] - Epoch: 21/50
[37m2024-08-15 23:34:16,890 [INFO] - Extracting training cells
[37m2024-08-15 23:40:02,372 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.593, Recall: 0.731, Detected-Cells: 45096
[37m2024-08-15 23:40:03,778 [INFO] - Training epoch stats:     Loss: 0.1063 - F1-Score: 0.9682 - Accuracy-Score: 0.9611 - AUROC: 0.9932 - AP: 0.9950
[37m2024-08-15 23:40:04,119 [INFO] - Validation epoch stats:   Loss: 0.5995 - F1-Score: 0.8902 - Accuracy-Score: 0.8608 - AUROC: 0.9222 - AP: 0.9438
[37m2024-08-15 23:40:04,125 [INFO] - Performing early stopping!
[37m2024-08-15 23:40:04,134 [INFO] - Finished run txz5lydg
