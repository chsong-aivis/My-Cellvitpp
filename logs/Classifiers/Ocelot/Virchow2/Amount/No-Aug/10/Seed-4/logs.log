[37m2024-08-15 08:49:39,987 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 08:49:39,990 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/No-Aug/10/Seed-4/2024-08-15T084923_CellViT-Virchow2-10Percent
[37m2024-08-15 08:49:40,096 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f77803eb280>]
[37m2024-08-15 08:49:40,106 [INFO] - Using GPU: cuda:0
[37m2024-08-15 08:49:40,115 [INFO] - Using device: cuda:0
[37m2024-08-15 08:49:40,125 [INFO] - Loss function:
[37m2024-08-15 08:49:40,133 [INFO] - CrossEntropyLoss()
[37m2024-08-15 08:49:53,477 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 08:49:57,871 [INFO] - <All keys matched successfully>
[37m2024-08-15 08:50:00,724 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 08:50:00,911 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 08:50:01,055 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 08:50:01,428 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 08:50:01,677 [INFO] - Caching datasets
[37m2024-08-15 08:50:03,821 [INFO] - Instantiate Trainer
[37m2024-08-15 08:50:03,852 [INFO] - Calling Trainer Fit
[37m2024-08-15 08:50:03,857 [INFO] - Dataset is cached after first epoch
[37m2024-08-15 08:50:03,862 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 08:50:03,867 [INFO] - Epoch: 1/50
[37m2024-08-15 08:50:05,129 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/4e5433cfdd862d9ab36c33bb848decde6ff3dd52bc397414c4f1d2ea253aff6d.h5
[37m2024-08-15 08:50:05,684 [INFO] - Training epoch stats:     Loss: 0.2858 - F1-Score: 0.9002 - Accuracy-Score: 0.8799 - AUROC: 0.9493 - AP: 0.9588
[37m2024-08-15 08:50:09,989 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 08:50:10,563 [INFO] - Validation epoch stats:   Loss: 0.4360 - F1-Score: 0.8697 - Accuracy-Score: 0.8302 - AUROC: 0.8964 - AP: 0.9343
[37m2024-08-15 08:50:10,568 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:50:10,713 [INFO] - Epoch: 2/50
[37m2024-08-15 08:50:10,952 [INFO] - Training epoch stats:     Loss: 0.1204 - F1-Score: 0.9599 - Accuracy-Score: 0.9512 - AUROC: 0.9906 - AP: 0.9937
[37m2024-08-15 08:50:11,457 [INFO] - Validation epoch stats:   Loss: 0.5206 - F1-Score: 0.8575 - Accuracy-Score: 0.8196 - AUROC: 0.8877 - AP: 0.9251
[37m2024-08-15 08:50:11,522 [INFO] - Epoch: 3/50
[37m2024-08-15 08:50:11,741 [INFO] - Training epoch stats:     Loss: 0.1072 - F1-Score: 0.9653 - Accuracy-Score: 0.9581 - AUROC: 0.9929 - AP: 0.9954
[37m2024-08-15 08:50:12,188 [INFO] - Validation epoch stats:   Loss: 0.5326 - F1-Score: 0.8530 - Accuracy-Score: 0.8180 - AUROC: 0.8951 - AP: 0.9315
[37m2024-08-15 08:50:12,263 [INFO] - Epoch: 4/50
[37m2024-08-15 08:50:12,518 [INFO] - Training epoch stats:     Loss: 0.0836 - F1-Score: 0.9730 - Accuracy-Score: 0.9673 - AUROC: 0.9954 - AP: 0.9969
[37m2024-08-15 08:50:12,927 [INFO] - Validation epoch stats:   Loss: 0.6070 - F1-Score: 0.8619 - Accuracy-Score: 0.8213 - AUROC: 0.8867 - AP: 0.9235
[37m2024-08-15 08:50:13,004 [INFO] - Epoch: 5/50
[37m2024-08-15 08:50:13,254 [INFO] - Training epoch stats:     Loss: 0.0746 - F1-Score: 0.9764 - Accuracy-Score: 0.9714 - AUROC: 0.9964 - AP: 0.9976
[37m2024-08-15 08:50:13,649 [INFO] - Validation epoch stats:   Loss: 0.7052 - F1-Score: 0.8504 - Accuracy-Score: 0.8158 - AUROC: 0.8818 - AP: 0.9176
[37m2024-08-15 08:50:13,726 [INFO] - Epoch: 6/50
[37m2024-08-15 08:50:13,962 [INFO] - Training epoch stats:     Loss: 0.0703 - F1-Score: 0.9777 - Accuracy-Score: 0.9730 - AUROC: 0.9968 - AP: 0.9979
[37m2024-08-15 08:50:14,395 [INFO] - Validation epoch stats:   Loss: 0.8422 - F1-Score: 0.8403 - Accuracy-Score: 0.7953 - AUROC: 0.8565 - AP: 0.8991
[37m2024-08-15 08:50:14,480 [INFO] - Epoch: 7/50
[37m2024-08-15 08:50:14,722 [INFO] - Training epoch stats:     Loss: 0.0666 - F1-Score: 0.9791 - Accuracy-Score: 0.9747 - AUROC: 0.9971 - AP: 0.9979
[37m2024-08-15 08:50:15,135 [INFO] - Validation epoch stats:   Loss: 0.7867 - F1-Score: 0.8418 - Accuracy-Score: 0.8014 - AUROC: 0.8637 - AP: 0.9049
[37m2024-08-15 08:50:15,218 [INFO] - Epoch: 8/50
[37m2024-08-15 08:50:15,461 [INFO] - Training epoch stats:     Loss: 0.0516 - F1-Score: 0.9829 - Accuracy-Score: 0.9793 - AUROC: 0.9979 - AP: 0.9982
[37m2024-08-15 08:50:16,068 [INFO] - Validation epoch stats:   Loss: 0.9305 - F1-Score: 0.8432 - Accuracy-Score: 0.8046 - AUROC: 0.8656 - AP: 0.9033
[37m2024-08-15 08:50:16,128 [INFO] - Epoch: 9/50
[37m2024-08-15 08:50:16,356 [INFO] - Training epoch stats:     Loss: 0.0565 - F1-Score: 0.9861 - Accuracy-Score: 0.9832 - AUROC: 0.9982 - AP: 0.9986
[37m2024-08-15 08:50:16,891 [INFO] - Validation epoch stats:   Loss: 1.0310 - F1-Score: 0.8315 - Accuracy-Score: 0.7948 - AUROC: 0.8641 - AP: 0.8992
[37m2024-08-15 08:50:16,966 [INFO] - Epoch: 10/50
[37m2024-08-15 08:50:17,208 [INFO] - Training epoch stats:     Loss: 0.0455 - F1-Score: 0.9855 - Accuracy-Score: 0.9824 - AUROC: 0.9985 - AP: 0.9990
[37m2024-08-15 08:50:17,609 [INFO] - Validation epoch stats:   Loss: 1.0506 - F1-Score: 0.8431 - Accuracy-Score: 0.8045 - AUROC: 0.8646 - AP: 0.9029
[37m2024-08-15 08:50:17,671 [INFO] - Epoch: 11/50
[37m2024-08-15 08:50:17,910 [INFO] - Training epoch stats:     Loss: 0.0477 - F1-Score: 0.9860 - Accuracy-Score: 0.9830 - AUROC: 0.9982 - AP: 0.9985
[37m2024-08-15 08:50:18,430 [INFO] - Validation epoch stats:   Loss: 1.0790 - F1-Score: 0.8396 - Accuracy-Score: 0.8019 - AUROC: 0.8708 - AP: 0.9074
[37m2024-08-15 08:50:18,489 [INFO] - Epoch: 12/50
[37m2024-08-15 08:50:18,725 [INFO] - Training epoch stats:     Loss: 0.0495 - F1-Score: 0.9858 - Accuracy-Score: 0.9828 - AUROC: 0.9983 - AP: 0.9987
[37m2024-08-15 08:50:19,460 [INFO] - Validation epoch stats:   Loss: 1.1204 - F1-Score: 0.8336 - Accuracy-Score: 0.7977 - AUROC: 0.8689 - AP: 0.9083
[37m2024-08-15 08:50:19,608 [INFO] - Epoch: 13/50
[37m2024-08-15 08:50:19,900 [INFO] - Training epoch stats:     Loss: 0.0367 - F1-Score: 0.9887 - Accuracy-Score: 0.9863 - AUROC: 0.9991 - AP: 0.9994
[37m2024-08-15 08:50:20,323 [INFO] - Validation epoch stats:   Loss: 1.2875 - F1-Score: 0.8313 - Accuracy-Score: 0.7949 - AUROC: 0.8672 - AP: 0.9059
[37m2024-08-15 08:50:20,374 [INFO] - Epoch: 14/50
[37m2024-08-15 08:50:20,586 [INFO] - Training epoch stats:     Loss: 0.0322 - F1-Score: 0.9884 - Accuracy-Score: 0.9860 - AUROC: 0.9993 - AP: 0.9996
[37m2024-08-15 08:50:20,988 [INFO] - Validation epoch stats:   Loss: 1.2593 - F1-Score: 0.8434 - Accuracy-Score: 0.8084 - AUROC: 0.8733 - AP: 0.9065
[37m2024-08-15 08:50:21,051 [INFO] - Epoch: 15/50
[37m2024-08-15 08:50:21,292 [INFO] - Training epoch stats:     Loss: 0.0366 - F1-Score: 0.9887 - Accuracy-Score: 0.9863 - AUROC: 0.9990 - AP: 0.9991
[37m2024-08-15 08:50:21,986 [INFO] - Validation epoch stats:   Loss: 1.2621 - F1-Score: 0.8283 - Accuracy-Score: 0.7892 - AUROC: 0.8539 - AP: 0.8919
[37m2024-08-15 08:50:22,046 [INFO] - Epoch: 16/50
[37m2024-08-15 08:50:22,273 [INFO] - Training epoch stats:     Loss: 0.0333 - F1-Score: 0.9913 - Accuracy-Score: 0.9895 - AUROC: 0.9994 - AP: 0.9996
[37m2024-08-15 08:50:22,690 [INFO] - Validation epoch stats:   Loss: 1.3363 - F1-Score: 0.8403 - Accuracy-Score: 0.8016 - AUROC: 0.8622 - AP: 0.8956
[37m2024-08-15 08:50:22,753 [INFO] - Epoch: 17/50
[37m2024-08-15 08:50:22,995 [INFO] - Training epoch stats:     Loss: 0.0230 - F1-Score: 0.9930 - Accuracy-Score: 0.9915 - AUROC: 0.9996 - AP: 0.9998
[37m2024-08-15 08:50:23,411 [INFO] - Validation epoch stats:   Loss: 1.4086 - F1-Score: 0.8384 - Accuracy-Score: 0.7989 - AUROC: 0.8578 - AP: 0.8907
[37m2024-08-15 08:50:23,473 [INFO] - Epoch: 18/50
[37m2024-08-15 08:50:23,777 [INFO] - Training epoch stats:     Loss: 0.0238 - F1-Score: 0.9913 - Accuracy-Score: 0.9895 - AUROC: 0.9997 - AP: 0.9998
[37m2024-08-15 08:50:24,192 [INFO] - Validation epoch stats:   Loss: 1.4272 - F1-Score: 0.8410 - Accuracy-Score: 0.8016 - AUROC: 0.8614 - AP: 0.8920
[37m2024-08-15 08:50:24,256 [INFO] - Epoch: 19/50
[37m2024-08-15 08:50:24,487 [INFO] - Training epoch stats:     Loss: 0.0312 - F1-Score: 0.9925 - Accuracy-Score: 0.9909 - AUROC: 0.9992 - AP: 0.9993
[37m2024-08-15 08:50:24,897 [INFO] - Validation epoch stats:   Loss: 1.6554 - F1-Score: 0.8345 - Accuracy-Score: 0.7949 - AUROC: 0.8580 - AP: 0.8915
[37m2024-08-15 08:50:24,961 [INFO] - Epoch: 20/50
[37m2024-08-15 08:50:25,174 [INFO] - Training epoch stats:     Loss: 0.0277 - F1-Score: 0.9930 - Accuracy-Score: 0.9915 - AUROC: 0.9993 - AP: 0.9994
[37m2024-08-15 08:50:25,560 [INFO] - Validation epoch stats:   Loss: 1.6170 - F1-Score: 0.8446 - Accuracy-Score: 0.8050 - AUROC: 0.8594 - AP: 0.8876
[37m2024-08-15 08:50:25,624 [INFO] - Epoch: 21/50
[37m2024-08-15 08:50:25,875 [INFO] - Training epoch stats:     Loss: 0.0273 - F1-Score: 0.9937 - Accuracy-Score: 0.9924 - AUROC: 0.9994 - AP: 0.9994
[37m2024-08-15 08:50:26,275 [INFO] - Validation epoch stats:   Loss: 1.6576 - F1-Score: 0.8542 - Accuracy-Score: 0.8157 - AUROC: 0.8639 - AP: 0.8892
[37m2024-08-15 08:50:26,276 [INFO] - Performing early stopping!
[37m2024-08-15 08:50:26,283 [INFO] - Finished run apcmz62p
