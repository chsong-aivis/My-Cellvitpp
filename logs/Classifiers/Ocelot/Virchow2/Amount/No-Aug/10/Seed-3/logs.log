[37m2024-08-15 08:48:46,833 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 08:48:46,834 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/No-Aug/10/Seed-3/2024-08-15T084837_CellViT-Virchow2-10Percent
[37m2024-08-15 08:48:46,911 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7feb99eeb220>]
[37m2024-08-15 08:48:46,917 [INFO] - Using GPU: cuda:0
[37m2024-08-15 08:48:46,921 [INFO] - Using device: cuda:0
[37m2024-08-15 08:48:46,925 [INFO] - Loss function:
[37m2024-08-15 08:48:46,929 [INFO] - CrossEntropyLoss()
[37m2024-08-15 08:49:04,972 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 08:49:20,667 [INFO] - <All keys matched successfully>
[37m2024-08-15 08:49:25,285 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 08:49:25,289 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 08:49:25,294 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 08:49:25,298 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 08:49:25,317 [INFO] - Caching datasets
[37m2024-08-15 08:49:28,577 [INFO] - Instantiate Trainer
[37m2024-08-15 08:49:28,665 [INFO] - Calling Trainer Fit
[37m2024-08-15 08:49:28,674 [INFO] - Dataset is cached after first epoch
[37m2024-08-15 08:49:28,680 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 08:49:28,686 [INFO] - Epoch: 1/50
[37m2024-08-15 08:49:31,012 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/4e5433cfdd862d9ab36c33bb848decde6ff3dd52bc397414c4f1d2ea253aff6d.h5
[37m2024-08-15 08:49:31,668 [INFO] - Training epoch stats:     Loss: 0.2406 - F1-Score: 0.9159 - Accuracy-Score: 0.8976 - AUROC: 0.9632 - AP: 0.9730
[37m2024-08-15 08:49:36,889 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 08:49:37,302 [INFO] - Validation epoch stats:   Loss: 0.4651 - F1-Score: 0.8544 - Accuracy-Score: 0.8192 - AUROC: 0.8918 - AP: 0.9309
[37m2024-08-15 08:49:37,308 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:49:37,557 [INFO] - Epoch: 2/50
[37m2024-08-15 08:49:37,818 [INFO] - Training epoch stats:     Loss: 0.1225 - F1-Score: 0.9624 - Accuracy-Score: 0.9544 - AUROC: 0.9909 - AP: 0.9938
[37m2024-08-15 08:49:38,255 [INFO] - Validation epoch stats:   Loss: 0.4597 - F1-Score: 0.8689 - Accuracy-Score: 0.8306 - AUROC: 0.8914 - AP: 0.9250
[37m2024-08-15 08:49:38,369 [INFO] - Epoch: 3/50
[37m2024-08-15 08:49:38,589 [INFO] - Training epoch stats:     Loss: 0.0978 - F1-Score: 0.9667 - Accuracy-Score: 0.9595 - AUROC: 0.9934 - AP: 0.9953
[37m2024-08-15 08:49:38,989 [INFO] - Validation epoch stats:   Loss: 0.5910 - F1-Score: 0.8561 - Accuracy-Score: 0.8155 - AUROC: 0.8792 - AP: 0.9167
[37m2024-08-15 08:49:39,071 [INFO] - Epoch: 4/50
[37m2024-08-15 08:49:39,314 [INFO] - Training epoch stats:     Loss: 0.0835 - F1-Score: 0.9738 - Accuracy-Score: 0.9682 - AUROC: 0.9955 - AP: 0.9970
[37m2024-08-15 08:49:39,720 [INFO] - Validation epoch stats:   Loss: 0.5946 - F1-Score: 0.8466 - Accuracy-Score: 0.8115 - AUROC: 0.8855 - AP: 0.9215
[37m2024-08-15 08:49:39,798 [INFO] - Epoch: 5/50
[37m2024-08-15 08:49:40,082 [INFO] - Training epoch stats:     Loss: 0.0855 - F1-Score: 0.9719 - Accuracy-Score: 0.9660 - AUROC: 0.9952 - AP: 0.9965
[37m2024-08-15 08:49:40,544 [INFO] - Validation epoch stats:   Loss: 0.6281 - F1-Score: 0.8511 - Accuracy-Score: 0.8135 - AUROC: 0.8833 - AP: 0.9181
[37m2024-08-15 08:49:40,623 [INFO] - Epoch: 6/50
[37m2024-08-15 08:49:40,860 [INFO] - Training epoch stats:     Loss: 0.0669 - F1-Score: 0.9813 - Accuracy-Score: 0.9773 - AUROC: 0.9974 - AP: 0.9983
[37m2024-08-15 08:49:41,255 [INFO] - Validation epoch stats:   Loss: 0.7808 - F1-Score: 0.8386 - Accuracy-Score: 0.8038 - AUROC: 0.8791 - AP: 0.9112
[37m2024-08-15 08:49:41,317 [INFO] - Epoch: 7/50
[37m2024-08-15 08:49:41,562 [INFO] - Training epoch stats:     Loss: 0.0701 - F1-Score: 0.9787 - Accuracy-Score: 0.9741 - AUROC: 0.9969 - AP: 0.9976
[37m2024-08-15 08:49:42,166 [INFO] - Validation epoch stats:   Loss: 0.7154 - F1-Score: 0.8369 - Accuracy-Score: 0.7974 - AUROC: 0.8666 - AP: 0.9028
[37m2024-08-15 08:49:42,235 [INFO] - Epoch: 8/50
[37m2024-08-15 08:49:42,757 [INFO] - Training epoch stats:     Loss: 0.0503 - F1-Score: 0.9834 - Accuracy-Score: 0.9799 - AUROC: 0.9984 - AP: 0.9990
[37m2024-08-15 08:49:43,565 [INFO] - Validation epoch stats:   Loss: 0.8245 - F1-Score: 0.8611 - Accuracy-Score: 0.8188 - AUROC: 0.8738 - AP: 0.9020
[37m2024-08-15 08:49:43,631 [INFO] - Epoch: 9/50
[37m2024-08-15 08:49:44,079 [INFO] - Training epoch stats:     Loss: 0.0524 - F1-Score: 0.9863 - Accuracy-Score: 0.9834 - AUROC: 0.9984 - AP: 0.9989
[37m2024-08-15 08:49:44,894 [INFO] - Validation epoch stats:   Loss: 0.8487 - F1-Score: 0.8425 - Accuracy-Score: 0.8057 - AUROC: 0.8804 - AP: 0.9147
[37m2024-08-15 08:49:44,957 [INFO] - Epoch: 10/50
[37m2024-08-15 08:49:45,478 [INFO] - Training epoch stats:     Loss: 0.0497 - F1-Score: 0.9858 - Accuracy-Score: 0.9828 - AUROC: 0.9984 - AP: 0.9990
[37m2024-08-15 08:49:46,658 [INFO] - Validation epoch stats:   Loss: 0.9132 - F1-Score: 0.8409 - Accuracy-Score: 0.7992 - AUROC: 0.8607 - AP: 0.8914
[37m2024-08-15 08:49:46,754 [INFO] - Epoch: 11/50
[37m2024-08-15 08:49:47,563 [INFO] - Training epoch stats:     Loss: 0.0482 - F1-Score: 0.9887 - Accuracy-Score: 0.9863 - AUROC: 0.9989 - AP: 0.9993
[37m2024-08-15 08:49:48,369 [INFO] - Validation epoch stats:   Loss: 0.9588 - F1-Score: 0.8526 - Accuracy-Score: 0.8115 - AUROC: 0.8670 - AP: 0.8948
[37m2024-08-15 08:49:48,424 [INFO] - Epoch: 12/50
[37m2024-08-15 08:49:48,865 [INFO] - Training epoch stats:     Loss: 0.0341 - F1-Score: 0.9884 - Accuracy-Score: 0.9860 - AUROC: 0.9993 - AP: 0.9996
[37m2024-08-15 08:49:49,775 [INFO] - Validation epoch stats:   Loss: 1.0842 - F1-Score: 0.8405 - Accuracy-Score: 0.8009 - AUROC: 0.8637 - AP: 0.8977
[37m2024-08-15 08:49:49,831 [INFO] - Epoch: 13/50
[37m2024-08-15 08:49:50,462 [INFO] - Training epoch stats:     Loss: 0.0345 - F1-Score: 0.9893 - Accuracy-Score: 0.9871 - AUROC: 0.9990 - AP: 0.9992
[37m2024-08-15 08:49:51,654 [INFO] - Validation epoch stats:   Loss: 1.2193 - F1-Score: 0.8202 - Accuracy-Score: 0.7855 - AUROC: 0.8678 - AP: 0.8990
[37m2024-08-15 08:49:51,755 [INFO] - Epoch: 14/50
[37m2024-08-15 08:49:52,857 [INFO] - Training epoch stats:     Loss: 0.0362 - F1-Score: 0.9887 - Accuracy-Score: 0.9863 - AUROC: 0.9991 - AP: 0.9992
[37m2024-08-15 08:49:56,454 [INFO] - Validation epoch stats:   Loss: 1.2282 - F1-Score: 0.8469 - Accuracy-Score: 0.8070 - AUROC: 0.8632 - AP: 0.8944
[37m2024-08-15 08:49:56,555 [INFO] - Epoch: 15/50
[37m2024-08-15 08:49:57,961 [INFO] - Training epoch stats:     Loss: 0.0413 - F1-Score: 0.9887 - Accuracy-Score: 0.9863 - AUROC: 0.9989 - AP: 0.9991
[37m2024-08-15 08:49:59,170 [INFO] - Validation epoch stats:   Loss: 1.2339 - F1-Score: 0.8329 - Accuracy-Score: 0.7941 - AUROC: 0.8601 - AP: 0.8907
[37m2024-08-15 08:49:59,232 [INFO] - Epoch: 16/50
[37m2024-08-15 08:49:59,500 [INFO] - Training epoch stats:     Loss: 0.0237 - F1-Score: 0.9931 - Accuracy-Score: 0.9917 - AUROC: 0.9996 - AP: 0.9997
[37m2024-08-15 08:49:59,910 [INFO] - Validation epoch stats:   Loss: 1.2480 - F1-Score: 0.8357 - Accuracy-Score: 0.7954 - AUROC: 0.8595 - AP: 0.8928
[37m2024-08-15 08:50:00,024 [INFO] - Epoch: 17/50
[37m2024-08-15 08:50:00,264 [INFO] - Training epoch stats:     Loss: 0.0235 - F1-Score: 0.9930 - Accuracy-Score: 0.9915 - AUROC: 0.9994 - AP: 0.9994
[37m2024-08-15 08:50:00,672 [INFO] - Validation epoch stats:   Loss: 1.5198 - F1-Score: 0.8225 - Accuracy-Score: 0.7887 - AUROC: 0.8667 - AP: 0.8975
[37m2024-08-15 08:50:01,491 [INFO] - Epoch: 18/50
[37m2024-08-15 08:50:01,881 [INFO] - Training epoch stats:     Loss: 0.0343 - F1-Score: 0.9918 - Accuracy-Score: 0.9900 - AUROC: 0.9992 - AP: 0.9993
[37m2024-08-15 08:50:02,319 [INFO] - Validation epoch stats:   Loss: 1.3484 - F1-Score: 0.8465 - Accuracy-Score: 0.8045 - AUROC: 0.8600 - AP: 0.8917
[37m2024-08-15 08:50:02,383 [INFO] - Epoch: 19/50
[37m2024-08-15 08:50:02,627 [INFO] - Training epoch stats:     Loss: 0.0211 - F1-Score: 0.9937 - Accuracy-Score: 0.9924 - AUROC: 0.9997 - AP: 0.9998
[37m2024-08-15 08:50:03,039 [INFO] - Validation epoch stats:   Loss: 1.3576 - F1-Score: 0.8385 - Accuracy-Score: 0.8014 - AUROC: 0.8660 - AP: 0.8959
[37m2024-08-15 08:50:03,098 [INFO] - Epoch: 20/50
[37m2024-08-15 08:50:03,395 [INFO] - Training epoch stats:     Loss: 0.0274 - F1-Score: 0.9921 - Accuracy-Score: 0.9904 - AUROC: 0.9991 - AP: 0.9991
[37m2024-08-15 08:50:03,793 [INFO] - Validation epoch stats:   Loss: 1.5544 - F1-Score: 0.8499 - Accuracy-Score: 0.8054 - AUROC: 0.8535 - AP: 0.8817
[37m2024-08-15 08:50:03,860 [INFO] - Epoch: 21/50
[37m2024-08-15 08:50:04,105 [INFO] - Training epoch stats:     Loss: 0.0332 - F1-Score: 0.9910 - Accuracy-Score: 0.9891 - AUROC: 0.9989 - AP: 0.9988
[37m2024-08-15 08:50:04,539 [INFO] - Validation epoch stats:   Loss: 1.6246 - F1-Score: 0.8322 - Accuracy-Score: 0.7928 - AUROC: 0.8533 - AP: 0.8864
[37m2024-08-15 08:50:04,548 [INFO] - Performing early stopping!
[37m2024-08-15 08:50:04,558 [INFO] - Finished run 9fy8ck7v
