[37m2024-08-15 08:51:46,756 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 08:51:46,765 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/No-Aug/25/Seed-4/2024-08-15T085054_CellViT-Virchow2-25Percent
[37m2024-08-15 08:51:47,268 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fdad4128430>]
[37m2024-08-15 08:51:47,373 [INFO] - Using GPU: cuda:0
[37m2024-08-15 08:51:47,454 [INFO] - Using device: cuda:0
[37m2024-08-15 08:51:47,470 [INFO] - Loss function:
[37m2024-08-15 08:51:47,555 [INFO] - CrossEntropyLoss()
[37m2024-08-15 08:52:00,063 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 08:52:03,572 [INFO] - <All keys matched successfully>
[37m2024-08-15 08:52:06,123 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 08:52:06,132 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 08:52:06,149 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 08:52:06,165 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 08:52:06,226 [INFO] - Caching datasets
[37m2024-08-15 08:52:11,495 [INFO] - Instantiate Trainer
[37m2024-08-15 08:52:11,504 [INFO] - Calling Trainer Fit
[37m2024-08-15 08:52:11,513 [INFO] - Dataset is cached after first epoch
[37m2024-08-15 08:52:11,520 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 08:52:11,529 [INFO] - Epoch: 1/50
[37m2024-08-15 08:52:15,151 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/05782f13efcce1532786b709db2d138494906ec9cec3e65866da7023fab5fbc6.h5
[37m2024-08-15 08:52:16,175 [INFO] - Training epoch stats:     Loss: 0.2576 - F1-Score: 0.9173 - Accuracy-Score: 0.8959 - AUROC: 0.9570 - AP: 0.9653
[37m2024-08-15 08:52:21,918 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 08:52:22,645 [INFO] - Validation epoch stats:   Loss: 0.4592 - F1-Score: 0.8786 - Accuracy-Score: 0.8507 - AUROC: 0.9260 - AP: 0.9546
[37m2024-08-15 08:52:22,650 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:52:22,805 [INFO] - Epoch: 2/50
[37m2024-08-15 08:52:23,745 [INFO] - Training epoch stats:     Loss: 0.1244 - F1-Score: 0.9602 - Accuracy-Score: 0.9494 - AUROC: 0.9894 - AP: 0.9933
[37m2024-08-15 08:52:25,265 [INFO] - Validation epoch stats:   Loss: 0.3874 - F1-Score: 0.8963 - Accuracy-Score: 0.8674 - AUROC: 0.9322 - AP: 0.9568
[37m2024-08-15 08:52:25,272 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:52:25,617 [INFO] - Epoch: 3/50
[37m2024-08-15 08:52:26,302 [INFO] - Training epoch stats:     Loss: 0.1100 - F1-Score: 0.9654 - Accuracy-Score: 0.9561 - AUROC: 0.9918 - AP: 0.9949
[37m2024-08-15 08:52:26,730 [INFO] - Validation epoch stats:   Loss: 0.4223 - F1-Score: 0.8833 - Accuracy-Score: 0.8532 - AUROC: 0.9248 - AP: 0.9523
[37m2024-08-15 08:52:26,805 [INFO] - Epoch: 4/50
[37m2024-08-15 08:52:27,381 [INFO] - Training epoch stats:     Loss: 0.0931 - F1-Score: 0.9701 - Accuracy-Score: 0.9621 - AUROC: 0.9942 - AP: 0.9965
[37m2024-08-15 08:52:27,799 [INFO] - Validation epoch stats:   Loss: 0.4906 - F1-Score: 0.8910 - Accuracy-Score: 0.8618 - AUROC: 0.9263 - AP: 0.9521
[37m2024-08-15 08:52:27,860 [INFO] - Epoch: 5/50
[37m2024-08-15 08:52:28,463 [INFO] - Training epoch stats:     Loss: 0.0869 - F1-Score: 0.9730 - Accuracy-Score: 0.9658 - AUROC: 0.9949 - AP: 0.9968
[37m2024-08-15 08:52:28,906 [INFO] - Validation epoch stats:   Loss: 0.4993 - F1-Score: 0.8867 - Accuracy-Score: 0.8550 - AUROC: 0.9205 - AP: 0.9449
[37m2024-08-15 08:52:28,965 [INFO] - Epoch: 6/50
[37m2024-08-15 08:52:29,513 [INFO] - Training epoch stats:     Loss: 0.0776 - F1-Score: 0.9761 - Accuracy-Score: 0.9698 - AUROC: 0.9958 - AP: 0.9973
[37m2024-08-15 08:52:30,004 [INFO] - Validation epoch stats:   Loss: 0.5763 - F1-Score: 0.8874 - Accuracy-Score: 0.8522 - AUROC: 0.9181 - AP: 0.9407
[37m2024-08-15 08:52:30,063 [INFO] - Epoch: 7/50
[37m2024-08-15 08:52:30,656 [INFO] - Training epoch stats:     Loss: 0.0730 - F1-Score: 0.9776 - Accuracy-Score: 0.9716 - AUROC: 0.9965 - AP: 0.9979
[37m2024-08-15 08:52:31,114 [INFO] - Validation epoch stats:   Loss: 0.5676 - F1-Score: 0.8897 - Accuracy-Score: 0.8596 - AUROC: 0.9219 - AP: 0.9453
[37m2024-08-15 08:52:31,174 [INFO] - Epoch: 8/50
[37m2024-08-15 08:52:31,784 [INFO] - Training epoch stats:     Loss: 0.0650 - F1-Score: 0.9799 - Accuracy-Score: 0.9746 - AUROC: 0.9972 - AP: 0.9984
[37m2024-08-15 08:52:32,958 [INFO] - Validation epoch stats:   Loss: 0.5674 - F1-Score: 0.8919 - Accuracy-Score: 0.8616 - AUROC: 0.9266 - AP: 0.9496
[37m2024-08-15 08:52:33,108 [INFO] - Epoch: 9/50
[37m2024-08-15 08:52:33,886 [INFO] - Training epoch stats:     Loss: 0.0593 - F1-Score: 0.9820 - Accuracy-Score: 0.9773 - AUROC: 0.9974 - AP: 0.9982
[37m2024-08-15 08:52:34,467 [INFO] - Validation epoch stats:   Loss: 0.6587 - F1-Score: 0.8889 - Accuracy-Score: 0.8582 - AUROC: 0.9218 - AP: 0.9446
[37m2024-08-15 08:52:34,555 [INFO] - Epoch: 10/50
[37m2024-08-15 08:52:35,157 [INFO] - Training epoch stats:     Loss: 0.0588 - F1-Score: 0.9820 - Accuracy-Score: 0.9772 - AUROC: 0.9978 - AP: 0.9987
[37m2024-08-15 08:52:35,657 [INFO] - Validation epoch stats:   Loss: 0.7067 - F1-Score: 0.8865 - Accuracy-Score: 0.8572 - AUROC: 0.9213 - AP: 0.9440
[37m2024-08-15 08:52:35,721 [INFO] - Epoch: 11/50
[37m2024-08-15 08:52:36,363 [INFO] - Training epoch stats:     Loss: 0.0487 - F1-Score: 0.9840 - Accuracy-Score: 0.9798 - AUROC: 0.9985 - AP: 0.9991
[37m2024-08-15 08:52:36,806 [INFO] - Validation epoch stats:   Loss: 0.7402 - F1-Score: 0.8878 - Accuracy-Score: 0.8554 - AUROC: 0.9194 - AP: 0.9401
[37m2024-08-15 08:52:36,923 [INFO] - Epoch: 12/50
[37m2024-08-15 08:52:37,479 [INFO] - Training epoch stats:     Loss: 0.0445 - F1-Score: 0.9853 - Accuracy-Score: 0.9815 - AUROC: 0.9985 - AP: 0.9990
[37m2024-08-15 08:52:37,946 [INFO] - Validation epoch stats:   Loss: 0.9183 - F1-Score: 0.8854 - Accuracy-Score: 0.8518 - AUROC: 0.9105 - AP: 0.9283
[37m2024-08-15 08:52:38,005 [INFO] - Epoch: 13/50
[37m2024-08-15 08:52:38,599 [INFO] - Training epoch stats:     Loss: 0.0446 - F1-Score: 0.9856 - Accuracy-Score: 0.9818 - AUROC: 0.9987 - AP: 0.9991
[37m2024-08-15 08:52:39,028 [INFO] - Validation epoch stats:   Loss: 0.8845 - F1-Score: 0.8817 - Accuracy-Score: 0.8514 - AUROC: 0.9144 - AP: 0.9350
[37m2024-08-15 08:52:39,089 [INFO] - Epoch: 14/50
[37m2024-08-15 08:52:39,715 [INFO] - Training epoch stats:     Loss: 0.0420 - F1-Score: 0.9874 - Accuracy-Score: 0.9841 - AUROC: 0.9987 - AP: 0.9991
[37m2024-08-15 08:52:40,158 [INFO] - Validation epoch stats:   Loss: 0.9688 - F1-Score: 0.8798 - Accuracy-Score: 0.8483 - AUROC: 0.9116 - AP: 0.9333
[37m2024-08-15 08:52:40,214 [INFO] - Epoch: 15/50
[37m2024-08-15 08:52:40,781 [INFO] - Training epoch stats:     Loss: 0.0439 - F1-Score: 0.9878 - Accuracy-Score: 0.9846 - AUROC: 0.9986 - AP: 0.9990
[37m2024-08-15 08:52:41,257 [INFO] - Validation epoch stats:   Loss: 0.9482 - F1-Score: 0.8765 - Accuracy-Score: 0.8458 - AUROC: 0.9123 - AP: 0.9361
[37m2024-08-15 08:52:41,313 [INFO] - Epoch: 16/50
[37m2024-08-15 08:52:41,852 [INFO] - Training epoch stats:     Loss: 0.0396 - F1-Score: 0.9872 - Accuracy-Score: 0.9838 - AUROC: 0.9989 - AP: 0.9993
[37m2024-08-15 08:52:42,245 [INFO] - Validation epoch stats:   Loss: 1.0236 - F1-Score: 0.8761 - Accuracy-Score: 0.8445 - AUROC: 0.9074 - AP: 0.9294
[37m2024-08-15 08:52:42,304 [INFO] - Epoch: 17/50
[37m2024-08-15 08:52:42,856 [INFO] - Training epoch stats:     Loss: 0.0368 - F1-Score: 0.9875 - Accuracy-Score: 0.9842 - AUROC: 0.9991 - AP: 0.9995
[37m2024-08-15 08:52:43,366 [INFO] - Validation epoch stats:   Loss: 0.9894 - F1-Score: 0.8785 - Accuracy-Score: 0.8467 - AUROC: 0.9096 - AP: 0.9293
[37m2024-08-15 08:52:43,420 [INFO] - Epoch: 18/50
[37m2024-08-15 08:52:44,008 [INFO] - Training epoch stats:     Loss: 0.0388 - F1-Score: 0.9881 - Accuracy-Score: 0.9850 - AUROC: 0.9989 - AP: 0.9992
[37m2024-08-15 08:52:44,399 [INFO] - Validation epoch stats:   Loss: 1.0929 - F1-Score: 0.8767 - Accuracy-Score: 0.8465 - AUROC: 0.9113 - AP: 0.9332
[37m2024-08-15 08:52:44,456 [INFO] - Epoch: 19/50
[37m2024-08-15 08:52:44,972 [INFO] - Training epoch stats:     Loss: 0.0338 - F1-Score: 0.9889 - Accuracy-Score: 0.9861 - AUROC: 0.9991 - AP: 0.9993
[37m2024-08-15 08:52:45,359 [INFO] - Validation epoch stats:   Loss: 1.0642 - F1-Score: 0.8853 - Accuracy-Score: 0.8558 - AUROC: 0.9154 - AP: 0.9335
[37m2024-08-15 08:52:45,415 [INFO] - Epoch: 20/50
[37m2024-08-15 08:52:45,903 [INFO] - Training epoch stats:     Loss: 0.0302 - F1-Score: 0.9908 - Accuracy-Score: 0.9883 - AUROC: 0.9993 - AP: 0.9994
[37m2024-08-15 08:52:46,293 [INFO] - Validation epoch stats:   Loss: 1.0988 - F1-Score: 0.8906 - Accuracy-Score: 0.8598 - AUROC: 0.9127 - AP: 0.9289
[37m2024-08-15 08:52:46,349 [INFO] - Epoch: 21/50
[37m2024-08-15 08:52:46,899 [INFO] - Training epoch stats:     Loss: 0.0290 - F1-Score: 0.9906 - Accuracy-Score: 0.9881 - AUROC: 0.9994 - AP: 0.9997
[37m2024-08-15 08:52:47,306 [INFO] - Validation epoch stats:   Loss: 1.2490 - F1-Score: 0.8900 - Accuracy-Score: 0.8609 - AUROC: 0.9126 - AP: 0.9280
[37m2024-08-15 08:52:47,370 [INFO] - Epoch: 22/50
[37m2024-08-15 08:52:47,911 [INFO] - Training epoch stats:     Loss: 0.0320 - F1-Score: 0.9905 - Accuracy-Score: 0.9880 - AUROC: 0.9993 - AP: 0.9995
[37m2024-08-15 08:52:48,310 [INFO] - Validation epoch stats:   Loss: 1.0709 - F1-Score: 0.8887 - Accuracy-Score: 0.8588 - AUROC: 0.9143 - AP: 0.9309
[37m2024-08-15 08:52:48,316 [INFO] - Performing early stopping!
[37m2024-08-15 08:52:48,320 [INFO] - Finished run 8b0pnfdo
