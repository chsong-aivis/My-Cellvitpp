[37m2024-08-15 08:47:21,035 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 08:47:21,036 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/No-Aug/5/Seed-2/2024-08-15T084711_CellViT-Virchow2-5Percent
[37m2024-08-15 08:47:21,098 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f2721dec4c0>]
[37m2024-08-15 08:47:21,107 [INFO] - Using GPU: cuda:0
[37m2024-08-15 08:47:21,119 [INFO] - Using device: cuda:0
[37m2024-08-15 08:47:21,124 [INFO] - Loss function:
[37m2024-08-15 08:47:21,129 [INFO] - CrossEntropyLoss()
[37m2024-08-15 08:47:32,962 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 08:47:34,958 [INFO] - <All keys matched successfully>
[37m2024-08-15 08:47:38,567 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 08:47:38,578 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 08:47:38,583 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 08:47:38,587 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 08:47:38,672 [INFO] - Caching datasets
[37m2024-08-15 08:47:42,125 [INFO] - Instantiate Trainer
[37m2024-08-15 08:47:42,136 [INFO] - Calling Trainer Fit
[37m2024-08-15 08:47:42,141 [INFO] - Dataset is cached after first epoch
[37m2024-08-15 08:47:42,146 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 08:47:42,151 [INFO] - Epoch: 1/50
[37m2024-08-15 08:47:42,764 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/415cd7c2804650d95b3438d463c092ea83a85b3c90a7871cf11347dfd688f579.h5
[37m2024-08-15 08:47:43,178 [INFO] - Training epoch stats:     Loss: 0.3242 - F1-Score: 0.8310 - Accuracy-Score: 0.8459 - AUROC: 0.9395 - AP: 0.9203
[37m2024-08-15 08:47:52,097 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 08:47:53,056 [INFO] - Validation epoch stats:   Loss: 0.5540 - F1-Score: 0.7924 - Accuracy-Score: 0.7651 - AUROC: 0.8672 - AP: 0.9149
[37m2024-08-15 08:47:53,058 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:47:53,225 [INFO] - Epoch: 2/50
[37m2024-08-15 08:47:53,348 [INFO] - Training epoch stats:     Loss: 0.1486 - F1-Score: 0.9340 - Accuracy-Score: 0.9426 - AUROC: 0.9864 - AP: 0.9801
[37m2024-08-15 08:47:54,670 [INFO] - Validation epoch stats:   Loss: 0.6066 - F1-Score: 0.7905 - Accuracy-Score: 0.7602 - AUROC: 0.8567 - AP: 0.9051
[37m2024-08-15 08:47:54,814 [INFO] - Epoch: 3/50
[37m2024-08-15 08:47:55,020 [INFO] - Training epoch stats:     Loss: 0.1167 - F1-Score: 0.9434 - Accuracy-Score: 0.9502 - AUROC: 0.9911 - AP: 0.9881
[37m2024-08-15 08:47:57,959 [INFO] - Validation epoch stats:   Loss: 0.8832 - F1-Score: 0.7271 - Accuracy-Score: 0.7109 - AUROC: 0.8502 - AP: 0.9009
[37m2024-08-15 08:47:58,159 [INFO] - Epoch: 4/50
[37m2024-08-15 08:47:58,864 [INFO] - Training epoch stats:     Loss: 0.0880 - F1-Score: 0.9589 - Accuracy-Score: 0.9643 - AUROC: 0.9951 - AP: 0.9935
[37m2024-08-15 08:47:59,378 [INFO] - Validation epoch stats:   Loss: 0.9458 - F1-Score: 0.7430 - Accuracy-Score: 0.7219 - AUROC: 0.8465 - AP: 0.8979
[37m2024-08-15 08:47:59,440 [INFO] - Epoch: 5/50
[37m2024-08-15 08:47:59,580 [INFO] - Training epoch stats:     Loss: 0.0854 - F1-Score: 0.9625 - Accuracy-Score: 0.9671 - AUROC: 0.9956 - AP: 0.9942
[37m2024-08-15 08:48:00,062 [INFO] - Validation epoch stats:   Loss: 1.2444 - F1-Score: 0.6937 - Accuracy-Score: 0.6866 - AUROC: 0.8374 - AP: 0.8920
[37m2024-08-15 08:48:00,116 [INFO] - Epoch: 6/50
[37m2024-08-15 08:48:00,272 [INFO] - Training epoch stats:     Loss: 0.0856 - F1-Score: 0.9594 - Accuracy-Score: 0.9647 - AUROC: 0.9955 - AP: 0.9942
[37m2024-08-15 08:48:00,758 [INFO] - Validation epoch stats:   Loss: 1.2730 - F1-Score: 0.6968 - Accuracy-Score: 0.6882 - AUROC: 0.8434 - AP: 0.8966
[37m2024-08-15 08:48:00,817 [INFO] - Epoch: 7/50
[37m2024-08-15 08:48:01,001 [INFO] - Training epoch stats:     Loss: 0.0738 - F1-Score: 0.9645 - Accuracy-Score: 0.9691 - AUROC: 0.9966 - AP: 0.9956
[37m2024-08-15 08:48:01,808 [INFO] - Validation epoch stats:   Loss: 0.9259 - F1-Score: 0.7687 - Accuracy-Score: 0.7369 - AUROC: 0.8352 - AP: 0.8895
[37m2024-08-15 08:48:01,868 [INFO] - Epoch: 8/50
[37m2024-08-15 08:48:02,065 [INFO] - Training epoch stats:     Loss: 0.0655 - F1-Score: 0.9706 - Accuracy-Score: 0.9743 - AUROC: 0.9972 - AP: 0.9967
[37m2024-08-15 08:48:02,916 [INFO] - Validation epoch stats:   Loss: 1.2379 - F1-Score: 0.7125 - Accuracy-Score: 0.6970 - AUROC: 0.8340 - AP: 0.8899
[37m2024-08-15 08:48:03,013 [INFO] - Epoch: 9/50
[37m2024-08-15 08:48:03,183 [INFO] - Training epoch stats:     Loss: 0.0508 - F1-Score: 0.9750 - Accuracy-Score: 0.9783 - AUROC: 0.9984 - AP: 0.9979
[37m2024-08-15 08:48:03,617 [INFO] - Validation epoch stats:   Loss: 1.2989 - F1-Score: 0.7237 - Accuracy-Score: 0.7000 - AUROC: 0.8128 - AP: 0.8751
[37m2024-08-15 08:48:03,691 [INFO] - Epoch: 10/50
[37m2024-08-15 08:48:03,838 [INFO] - Training epoch stats:     Loss: 0.0421 - F1-Score: 0.9816 - Accuracy-Score: 0.9839 - AUROC: 0.9988 - AP: 0.9984
[37m2024-08-15 08:48:04,255 [INFO] - Validation epoch stats:   Loss: 1.3730 - F1-Score: 0.7127 - Accuracy-Score: 0.6946 - AUROC: 0.8203 - AP: 0.8781
[37m2024-08-15 08:48:04,331 [INFO] - Epoch: 11/50
[37m2024-08-15 08:48:04,456 [INFO] - Training epoch stats:     Loss: 0.0383 - F1-Score: 0.9857 - Accuracy-Score: 0.9876 - AUROC: 0.9989 - AP: 0.9985
[37m2024-08-15 08:48:04,894 [INFO] - Validation epoch stats:   Loss: 1.6500 - F1-Score: 0.7169 - Accuracy-Score: 0.7014 - AUROC: 0.8281 - AP: 0.8870
[37m2024-08-15 08:48:04,978 [INFO] - Epoch: 12/50
[37m2024-08-15 08:48:05,110 [INFO] - Training epoch stats:     Loss: 0.0264 - F1-Score: 0.9876 - Accuracy-Score: 0.9892 - AUROC: 0.9996 - AP: 0.9995
[37m2024-08-15 08:48:05,510 [INFO] - Validation epoch stats:   Loss: 1.4438 - F1-Score: 0.7510 - Accuracy-Score: 0.7252 - AUROC: 0.8334 - AP: 0.8891
[37m2024-08-15 08:48:05,588 [INFO] - Epoch: 13/50
[37m2024-08-15 08:48:05,711 [INFO] - Training epoch stats:     Loss: 0.0502 - F1-Score: 0.9802 - Accuracy-Score: 0.9827 - AUROC: 0.9983 - AP: 0.9972
[37m2024-08-15 08:48:06,155 [INFO] - Validation epoch stats:   Loss: 1.9072 - F1-Score: 0.7196 - Accuracy-Score: 0.7027 - AUROC: 0.8271 - AP: 0.8847
[37m2024-08-15 08:48:06,227 [INFO] - Epoch: 14/50
[37m2024-08-15 08:48:06,484 [INFO] - Training epoch stats:     Loss: 0.0435 - F1-Score: 0.9838 - Accuracy-Score: 0.9860 - AUROC: 0.9990 - AP: 0.9986
[37m2024-08-15 08:48:07,772 [INFO] - Validation epoch stats:   Loss: 1.6193 - F1-Score: 0.7392 - Accuracy-Score: 0.7163 - AUROC: 0.8315 - AP: 0.8855
[37m2024-08-15 08:48:07,913 [INFO] - Epoch: 15/50
[37m2024-08-15 08:48:08,189 [INFO] - Training epoch stats:     Loss: 0.0329 - F1-Score: 0.9856 - Accuracy-Score: 0.9876 - AUROC: 0.9993 - AP: 0.9990
[37m2024-08-15 08:48:09,167 [INFO] - Validation epoch stats:   Loss: 1.6825 - F1-Score: 0.7389 - Accuracy-Score: 0.7180 - AUROC: 0.8369 - AP: 0.8889
[37m2024-08-15 08:48:09,255 [INFO] - Epoch: 16/50
[37m2024-08-15 08:48:09,494 [INFO] - Training epoch stats:     Loss: 0.0256 - F1-Score: 0.9949 - Accuracy-Score: 0.9956 - AUROC: 0.9992 - AP: 0.9992
[37m2024-08-15 08:48:10,362 [INFO] - Validation epoch stats:   Loss: 1.7471 - F1-Score: 0.7409 - Accuracy-Score: 0.7174 - AUROC: 0.8241 - AP: 0.8791
[37m2024-08-15 08:48:10,432 [INFO] - Epoch: 17/50
[37m2024-08-15 08:48:10,900 [INFO] - Training epoch stats:     Loss: 0.0188 - F1-Score: 0.9926 - Accuracy-Score: 0.9936 - AUROC: 0.9997 - AP: 0.9996
[37m2024-08-15 08:48:11,701 [INFO] - Validation epoch stats:   Loss: 2.2078 - F1-Score: 0.7024 - Accuracy-Score: 0.6890 - AUROC: 0.8243 - AP: 0.8788
[37m2024-08-15 08:48:11,855 [INFO] - Epoch: 18/50
[37m2024-08-15 08:48:12,166 [INFO] - Training epoch stats:     Loss: 0.0528 - F1-Score: 0.9788 - Accuracy-Score: 0.9815 - AUROC: 0.9984 - AP: 0.9974
[37m2024-08-15 08:48:13,655 [INFO] - Validation epoch stats:   Loss: 1.9388 - F1-Score: 0.7343 - Accuracy-Score: 0.7146 - AUROC: 0.8343 - AP: 0.8880
[37m2024-08-15 08:48:13,809 [INFO] - Epoch: 19/50
[37m2024-08-15 08:48:14,173 [INFO] - Training epoch stats:     Loss: 0.0387 - F1-Score: 0.9885 - Accuracy-Score: 0.9900 - AUROC: 0.9988 - AP: 0.9987
[37m2024-08-15 08:48:17,139 [INFO] - Validation epoch stats:   Loss: 1.9206 - F1-Score: 0.7407 - Accuracy-Score: 0.7201 - AUROC: 0.8410 - AP: 0.8935
[37m2024-08-15 08:48:17,200 [INFO] - Epoch: 20/50
[37m2024-08-15 08:48:17,398 [INFO] - Training epoch stats:     Loss: 0.0239 - F1-Score: 0.9889 - Accuracy-Score: 0.9904 - AUROC: 0.9996 - AP: 0.9995
[37m2024-08-15 08:48:18,150 [INFO] - Validation epoch stats:   Loss: 1.9206 - F1-Score: 0.7331 - Accuracy-Score: 0.7123 - AUROC: 0.8334 - AP: 0.8871
[37m2024-08-15 08:48:18,217 [INFO] - Epoch: 21/50
[37m2024-08-15 08:48:18,407 [INFO] - Training epoch stats:     Loss: 0.0204 - F1-Score: 0.9912 - Accuracy-Score: 0.9924 - AUROC: 0.9997 - AP: 0.9997
[37m2024-08-15 08:48:18,822 [INFO] - Validation epoch stats:   Loss: 1.8926 - F1-Score: 0.7698 - Accuracy-Score: 0.7392 - AUROC: 0.8327 - AP: 0.8845
[37m2024-08-15 08:48:18,837 [INFO] - Performing early stopping!
[37m2024-08-15 08:48:18,842 [INFO] - Finished run zedecpwm
