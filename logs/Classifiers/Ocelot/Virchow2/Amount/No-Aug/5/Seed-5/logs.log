[37m2024-08-15 08:47:46,353 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 08:47:46,356 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/No-Aug/5/Seed-5/2024-08-15T084728_CellViT-Virchow2-5Percent
[37m2024-08-15 08:47:46,438 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fef37f38580>]
[37m2024-08-15 08:47:46,449 [INFO] - Using GPU: cuda:0
[37m2024-08-15 08:47:46,460 [INFO] - Using device: cuda:0
[37m2024-08-15 08:47:46,469 [INFO] - Loss function:
[37m2024-08-15 08:47:46,477 [INFO] - CrossEntropyLoss()
[37m2024-08-15 08:47:55,967 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 08:47:58,678 [INFO] - <All keys matched successfully>
[37m2024-08-15 08:48:00,668 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 08:48:00,683 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 08:48:00,690 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 08:48:00,695 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 08:48:00,768 [INFO] - Caching datasets
[37m2024-08-15 08:48:02,383 [INFO] - Instantiate Trainer
[37m2024-08-15 08:48:02,394 [INFO] - Calling Trainer Fit
[37m2024-08-15 08:48:02,400 [INFO] - Dataset is cached after first epoch
[37m2024-08-15 08:48:02,405 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 08:48:02,409 [INFO] - Epoch: 1/50
[37m2024-08-15 08:48:03,064 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/415cd7c2804650d95b3438d463c092ea83a85b3c90a7871cf11347dfd688f579.h5
[37m2024-08-15 08:48:03,501 [INFO] - Training epoch stats:     Loss: 0.3759 - F1-Score: 0.8171 - Accuracy-Score: 0.8403 - AUROC: 0.9265 - AP: 0.9093
[37m2024-08-15 08:48:09,519 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 08:48:10,558 [INFO] - Validation epoch stats:   Loss: 0.6388 - F1-Score: 0.6907 - Accuracy-Score: 0.6854 - AUROC: 0.8585 - AP: 0.9036
[37m2024-08-15 08:48:10,566 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:48:10,957 [INFO] - Epoch: 2/50
[37m2024-08-15 08:48:11,110 [INFO] - Training epoch stats:     Loss: 0.1445 - F1-Score: 0.9269 - Accuracy-Score: 0.9362 - AUROC: 0.9866 - AP: 0.9831
[37m2024-08-15 08:48:12,067 [INFO] - Validation epoch stats:   Loss: 0.6139 - F1-Score: 0.7726 - Accuracy-Score: 0.7469 - AUROC: 0.8609 - AP: 0.9056
[37m2024-08-15 08:48:12,073 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:48:12,309 [INFO] - Epoch: 3/50
[37m2024-08-15 08:48:12,496 [INFO] - Training epoch stats:     Loss: 0.1231 - F1-Score: 0.9420 - Accuracy-Score: 0.9494 - AUROC: 0.9906 - AP: 0.9875
[37m2024-08-15 08:48:14,166 [INFO] - Validation epoch stats:   Loss: 0.7332 - F1-Score: 0.7439 - Accuracy-Score: 0.7254 - AUROC: 0.8647 - AP: 0.9065
[37m2024-08-15 08:48:14,173 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:48:14,446 [INFO] - Epoch: 4/50
[37m2024-08-15 08:48:14,678 [INFO] - Training epoch stats:     Loss: 0.1090 - F1-Score: 0.9448 - Accuracy-Score: 0.9518 - AUROC: 0.9927 - AP: 0.9896
[37m2024-08-15 08:48:16,875 [INFO] - Validation epoch stats:   Loss: 0.7637 - F1-Score: 0.7154 - Accuracy-Score: 0.7002 - AUROC: 0.8366 - AP: 0.8850
[37m2024-08-15 08:48:16,951 [INFO] - Epoch: 5/50
[37m2024-08-15 08:48:17,140 [INFO] - Training epoch stats:     Loss: 0.0950 - F1-Score: 0.9578 - Accuracy-Score: 0.9631 - AUROC: 0.9942 - AP: 0.9923
[37m2024-08-15 08:48:17,888 [INFO] - Validation epoch stats:   Loss: 0.7794 - F1-Score: 0.7347 - Accuracy-Score: 0.7161 - AUROC: 0.8482 - AP: 0.8926
[37m2024-08-15 08:48:17,941 [INFO] - Epoch: 6/50
[37m2024-08-15 08:48:18,134 [INFO] - Training epoch stats:     Loss: 0.0787 - F1-Score: 0.9627 - Accuracy-Score: 0.9675 - AUROC: 0.9961 - AP: 0.9949
[37m2024-08-15 08:48:18,653 [INFO] - Validation epoch stats:   Loss: 0.8936 - F1-Score: 0.7359 - Accuracy-Score: 0.7174 - AUROC: 0.8484 - AP: 0.8954
[37m2024-08-15 08:48:18,712 [INFO] - Epoch: 7/50
[37m2024-08-15 08:48:18,824 [INFO] - Training epoch stats:     Loss: 0.0708 - F1-Score: 0.9648 - Accuracy-Score: 0.9695 - AUROC: 0.9970 - AP: 0.9960
[37m2024-08-15 08:48:19,215 [INFO] - Validation epoch stats:   Loss: 0.8668 - F1-Score: 0.7583 - Accuracy-Score: 0.7292 - AUROC: 0.8358 - AP: 0.8864
[37m2024-08-15 08:48:19,277 [INFO] - Epoch: 8/50
[37m2024-08-15 08:48:19,382 [INFO] - Training epoch stats:     Loss: 0.0595 - F1-Score: 0.9701 - Accuracy-Score: 0.9739 - AUROC: 0.9978 - AP: 0.9971
[37m2024-08-15 08:48:19,764 [INFO] - Validation epoch stats:   Loss: 0.8881 - F1-Score: 0.7533 - Accuracy-Score: 0.7260 - AUROC: 0.8376 - AP: 0.8865
[37m2024-08-15 08:48:19,827 [INFO] - Epoch: 9/50
[37m2024-08-15 08:48:19,942 [INFO] - Training epoch stats:     Loss: 0.0490 - F1-Score: 0.9789 - Accuracy-Score: 0.9815 - AUROC: 0.9985 - AP: 0.9979
[37m2024-08-15 08:48:20,314 [INFO] - Validation epoch stats:   Loss: 1.1251 - F1-Score: 0.7330 - Accuracy-Score: 0.7091 - AUROC: 0.8268 - AP: 0.8796
[37m2024-08-15 08:48:20,380 [INFO] - Epoch: 10/50
[37m2024-08-15 08:48:20,489 [INFO] - Training epoch stats:     Loss: 0.0574 - F1-Score: 0.9769 - Accuracy-Score: 0.9799 - AUROC: 0.9975 - AP: 0.9952
[37m2024-08-15 08:48:20,875 [INFO] - Validation epoch stats:   Loss: 1.2194 - F1-Score: 0.7259 - Accuracy-Score: 0.7058 - AUROC: 0.8318 - AP: 0.8860
[37m2024-08-15 08:48:20,939 [INFO] - Epoch: 11/50
[37m2024-08-15 08:48:21,048 [INFO] - Training epoch stats:     Loss: 0.0622 - F1-Score: 0.9807 - Accuracy-Score: 0.9831 - AUROC: 0.9978 - AP: 0.9976
[37m2024-08-15 08:48:21,419 [INFO] - Validation epoch stats:   Loss: 1.3018 - F1-Score: 0.7216 - Accuracy-Score: 0.7001 - AUROC: 0.8208 - AP: 0.8797
[37m2024-08-15 08:48:21,481 [INFO] - Epoch: 12/50
[37m2024-08-15 08:48:21,589 [INFO] - Training epoch stats:     Loss: 0.0380 - F1-Score: 0.9816 - Accuracy-Score: 0.9839 - AUROC: 0.9991 - AP: 0.9988
[37m2024-08-15 08:48:22,074 [INFO] - Validation epoch stats:   Loss: 1.3765 - F1-Score: 0.7340 - Accuracy-Score: 0.7133 - AUROC: 0.8375 - AP: 0.8891
[37m2024-08-15 08:48:22,146 [INFO] - Epoch: 13/50
[37m2024-08-15 08:48:22,323 [INFO] - Training epoch stats:     Loss: 0.0335 - F1-Score: 0.9866 - Accuracy-Score: 0.9884 - AUROC: 0.9992 - AP: 0.9990
[37m2024-08-15 08:48:23,058 [INFO] - Validation epoch stats:   Loss: 1.4051 - F1-Score: 0.7349 - Accuracy-Score: 0.7123 - AUROC: 0.8330 - AP: 0.8852
[37m2024-08-15 08:48:23,130 [INFO] - Epoch: 14/50
[37m2024-08-15 08:48:23,302 [INFO] - Training epoch stats:     Loss: 0.0326 - F1-Score: 0.9848 - Accuracy-Score: 0.9868 - AUROC: 0.9993 - AP: 0.9991
[37m2024-08-15 08:48:23,955 [INFO] - Validation epoch stats:   Loss: 1.7066 - F1-Score: 0.6904 - Accuracy-Score: 0.6783 - AUROC: 0.8253 - AP: 0.8790
[37m2024-08-15 08:48:24,031 [INFO] - Epoch: 15/50
[37m2024-08-15 08:48:24,174 [INFO] - Training epoch stats:     Loss: 0.0310 - F1-Score: 0.9843 - Accuracy-Score: 0.9864 - AUROC: 0.9994 - AP: 0.9992
[37m2024-08-15 08:48:24,562 [INFO] - Validation epoch stats:   Loss: 1.7359 - F1-Score: 0.6930 - Accuracy-Score: 0.6830 - AUROC: 0.8342 - AP: 0.8863
[37m2024-08-15 08:48:24,635 [INFO] - Epoch: 16/50
[37m2024-08-15 08:48:24,732 [INFO] - Training epoch stats:     Loss: 0.0324 - F1-Score: 0.9848 - Accuracy-Score: 0.9868 - AUROC: 0.9993 - AP: 0.9991
[37m2024-08-15 08:48:25,128 [INFO] - Validation epoch stats:   Loss: 1.7614 - F1-Score: 0.6547 - Accuracy-Score: 0.6591 - AUROC: 0.8450 - AP: 0.8922
[37m2024-08-15 08:48:25,213 [INFO] - Epoch: 17/50
[37m2024-08-15 08:48:25,327 [INFO] - Training epoch stats:     Loss: 0.0260 - F1-Score: 0.9908 - Accuracy-Score: 0.9920 - AUROC: 0.9994 - AP: 0.9993
[37m2024-08-15 08:48:25,853 [INFO] - Validation epoch stats:   Loss: 1.6197 - F1-Score: 0.7056 - Accuracy-Score: 0.6963 - AUROC: 0.8510 - AP: 0.8961
[37m2024-08-15 08:48:25,907 [INFO] - Epoch: 18/50
[37m2024-08-15 08:48:26,047 [INFO] - Training epoch stats:     Loss: 0.0223 - F1-Score: 0.9908 - Accuracy-Score: 0.9920 - AUROC: 0.9996 - AP: 0.9995
[37m2024-08-15 08:48:26,456 [INFO] - Validation epoch stats:   Loss: 1.6635 - F1-Score: 0.7346 - Accuracy-Score: 0.7151 - AUROC: 0.8410 - AP: 0.8895
[37m2024-08-15 08:48:26,518 [INFO] - Epoch: 19/50
[37m2024-08-15 08:48:26,691 [INFO] - Training epoch stats:     Loss: 0.0268 - F1-Score: 0.9917 - Accuracy-Score: 0.9928 - AUROC: 0.9995 - AP: 0.9994
[37m2024-08-15 08:48:27,652 [INFO] - Validation epoch stats:   Loss: 1.9289 - F1-Score: 0.7328 - Accuracy-Score: 0.7135 - AUROC: 0.8396 - AP: 0.8919
[37m2024-08-15 08:48:27,715 [INFO] - Epoch: 20/50
[37m2024-08-15 08:48:27,888 [INFO] - Training epoch stats:     Loss: 0.0249 - F1-Score: 0.9894 - Accuracy-Score: 0.9908 - AUROC: 0.9993 - AP: 0.9986
[37m2024-08-15 08:48:28,648 [INFO] - Validation epoch stats:   Loss: 1.6378 - F1-Score: 0.7500 - Accuracy-Score: 0.7230 - AUROC: 0.8384 - AP: 0.8877
[37m2024-08-15 08:48:28,705 [INFO] - Epoch: 21/50
[37m2024-08-15 08:48:28,885 [INFO] - Training epoch stats:     Loss: 0.0393 - F1-Score: 0.9843 - Accuracy-Score: 0.9864 - AUROC: 0.9992 - AP: 0.9990
[37m2024-08-15 08:48:29,340 [INFO] - Validation epoch stats:   Loss: 1.9694 - F1-Score: 0.7042 - Accuracy-Score: 0.6908 - AUROC: 0.8367 - AP: 0.8873
[37m2024-08-15 08:48:29,403 [INFO] - Epoch: 22/50
[37m2024-08-15 08:48:29,514 [INFO] - Training epoch stats:     Loss: 0.0270 - F1-Score: 0.9866 - Accuracy-Score: 0.9884 - AUROC: 0.9996 - AP: 0.9995
[37m2024-08-15 08:48:29,897 [INFO] - Validation epoch stats:   Loss: 1.7261 - F1-Score: 0.7415 - Accuracy-Score: 0.7181 - AUROC: 0.8347 - AP: 0.8837
[37m2024-08-15 08:48:29,958 [INFO] - Epoch: 23/50
[37m2024-08-15 08:48:30,066 [INFO] - Training epoch stats:     Loss: 0.0230 - F1-Score: 0.9880 - Accuracy-Score: 0.9896 - AUROC: 0.9997 - AP: 0.9996
[37m2024-08-15 08:48:30,450 [INFO] - Validation epoch stats:   Loss: 1.9162 - F1-Score: 0.7252 - Accuracy-Score: 0.7077 - AUROC: 0.8388 - AP: 0.8861
[37m2024-08-15 08:48:30,456 [INFO] - Performing early stopping!
[37m2024-08-15 08:48:30,461 [INFO] - Finished run 6dphgh9p
