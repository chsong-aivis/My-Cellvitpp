[37m2024-08-15 08:55:41,492 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 08:55:41,494 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/No-Aug/75/Seed-4/2024-08-15T085532_CellViT-Virchow2-75Percent
[37m2024-08-15 08:55:41,555 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fed8450f280>]
[37m2024-08-15 08:55:41,560 [INFO] - Using GPU: cuda:0
[37m2024-08-15 08:55:41,564 [INFO] - Using device: cuda:0
[37m2024-08-15 08:55:41,568 [INFO] - Loss function:
[37m2024-08-15 08:55:41,572 [INFO] - CrossEntropyLoss()
[37m2024-08-15 08:56:36,361 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 08:57:00,070 [INFO] - <All keys matched successfully>
[37m2024-08-15 08:57:02,772 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 08:57:02,776 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 08:57:02,788 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 08:57:02,793 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 08:57:02,813 [INFO] - Caching datasets
[37m2024-08-15 08:57:08,642 [INFO] - Instantiate Trainer
[37m2024-08-15 08:57:08,648 [INFO] - Calling Trainer Fit
[37m2024-08-15 08:57:08,656 [INFO] - Dataset is cached after first epoch
[37m2024-08-15 08:57:08,663 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 08:57:08,671 [INFO] - Epoch: 1/50
[37m2024-08-15 08:57:17,525 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/82ae7b8f3d695aad4c0025d3800cd6eb60e2f979c6336023c8f02b7408a17fff.h5
[37m2024-08-15 08:57:24,162 [INFO] - Training epoch stats:     Loss: 0.2181 - F1-Score: 0.9311 - Accuracy-Score: 0.9157 - AUROC: 0.9687 - AP: 0.9743
[37m2024-08-15 08:57:29,220 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 08:57:29,707 [INFO] - Validation epoch stats:   Loss: 0.3984 - F1-Score: 0.8958 - Accuracy-Score: 0.8655 - AUROC: 0.9314 - AP: 0.9576
[37m2024-08-15 08:57:29,726 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:57:29,933 [INFO] - Epoch: 2/50
[37m2024-08-15 08:57:31,763 [INFO] - Training epoch stats:     Loss: 0.1348 - F1-Score: 0.9560 - Accuracy-Score: 0.9461 - AUROC: 0.9879 - AP: 0.9912
[37m2024-08-15 08:57:32,390 [INFO] - Validation epoch stats:   Loss: 0.4351 - F1-Score: 0.8890 - Accuracy-Score: 0.8587 - AUROC: 0.9254 - AP: 0.9523
[37m2024-08-15 08:57:32,452 [INFO] - Epoch: 3/50
[37m2024-08-15 08:57:34,280 [INFO] - Training epoch stats:     Loss: 0.1194 - F1-Score: 0.9622 - Accuracy-Score: 0.9539 - AUROC: 0.9905 - AP: 0.9932
[37m2024-08-15 08:57:34,916 [INFO] - Validation epoch stats:   Loss: 0.4649 - F1-Score: 0.8857 - Accuracy-Score: 0.8573 - AUROC: 0.9235 - AP: 0.9499
[37m2024-08-15 08:57:34,976 [INFO] - Epoch: 4/50
[37m2024-08-15 08:57:36,769 [INFO] - Training epoch stats:     Loss: 0.1066 - F1-Score: 0.9658 - Accuracy-Score: 0.9583 - AUROC: 0.9925 - AP: 0.9948
[37m2024-08-15 08:57:37,360 [INFO] - Validation epoch stats:   Loss: 0.5130 - F1-Score: 0.8772 - Accuracy-Score: 0.8486 - AUROC: 0.9185 - AP: 0.9473
[37m2024-08-15 08:57:37,426 [INFO] - Epoch: 5/50
[37m2024-08-15 08:57:39,209 [INFO] - Training epoch stats:     Loss: 0.0973 - F1-Score: 0.9696 - Accuracy-Score: 0.9628 - AUROC: 0.9937 - AP: 0.9955
[37m2024-08-15 08:57:39,894 [INFO] - Validation epoch stats:   Loss: 0.6016 - F1-Score: 0.8910 - Accuracy-Score: 0.8602 - AUROC: 0.9222 - AP: 0.9472
[37m2024-08-15 08:57:39,957 [INFO] - Epoch: 6/50
[37m2024-08-15 08:57:42,158 [INFO] - Training epoch stats:     Loss: 0.0884 - F1-Score: 0.9713 - Accuracy-Score: 0.9649 - AUROC: 0.9948 - AP: 0.9964
[37m2024-08-15 08:57:42,943 [INFO] - Validation epoch stats:   Loss: 0.5373 - F1-Score: 0.8952 - Accuracy-Score: 0.8655 - AUROC: 0.9294 - AP: 0.9528
[37m2024-08-15 08:57:43,014 [INFO] - Epoch: 7/50
[37m2024-08-15 08:57:44,763 [INFO] - Training epoch stats:     Loss: 0.0840 - F1-Score: 0.9726 - Accuracy-Score: 0.9666 - AUROC: 0.9953 - AP: 0.9967
[37m2024-08-15 08:57:45,246 [INFO] - Validation epoch stats:   Loss: 0.5807 - F1-Score: 0.8903 - Accuracy-Score: 0.8587 - AUROC: 0.9233 - AP: 0.9463
[37m2024-08-15 08:57:45,306 [INFO] - Epoch: 8/50
[37m2024-08-15 08:57:53,159 [INFO] - Training epoch stats:     Loss: 0.0779 - F1-Score: 0.9745 - Accuracy-Score: 0.9689 - AUROC: 0.9961 - AP: 0.9974
[37m2024-08-15 08:57:53,660 [INFO] - Validation epoch stats:   Loss: 0.6188 - F1-Score: 0.8912 - Accuracy-Score: 0.8596 - AUROC: 0.9219 - AP: 0.9417
[37m2024-08-15 08:57:53,730 [INFO] - Epoch: 9/50
[37m2024-08-15 08:57:55,667 [INFO] - Training epoch stats:     Loss: 0.0717 - F1-Score: 0.9771 - Accuracy-Score: 0.9722 - AUROC: 0.9967 - AP: 0.9977
[37m2024-08-15 08:57:56,094 [INFO] - Validation epoch stats:   Loss: 0.6900 - F1-Score: 0.8903 - Accuracy-Score: 0.8616 - AUROC: 0.9220 - AP: 0.9425
[37m2024-08-15 08:57:56,212 [INFO] - Epoch: 10/50
[37m2024-08-15 08:57:58,181 [INFO] - Training epoch stats:     Loss: 0.0672 - F1-Score: 0.9778 - Accuracy-Score: 0.9731 - AUROC: 0.9971 - AP: 0.9980
[37m2024-08-15 08:57:58,703 [INFO] - Validation epoch stats:   Loss: 0.6628 - F1-Score: 0.8846 - Accuracy-Score: 0.8524 - AUROC: 0.9170 - AP: 0.9402
[37m2024-08-15 08:57:58,764 [INFO] - Epoch: 11/50
[37m2024-08-15 08:58:00,769 [INFO] - Training epoch stats:     Loss: 0.0629 - F1-Score: 0.9791 - Accuracy-Score: 0.9746 - AUROC: 0.9974 - AP: 0.9982
[37m2024-08-15 08:58:01,482 [INFO] - Validation epoch stats:   Loss: 0.7599 - F1-Score: 0.8881 - Accuracy-Score: 0.8582 - AUROC: 0.9201 - AP: 0.9421
[37m2024-08-15 08:58:01,541 [INFO] - Epoch: 12/50
[37m2024-08-15 08:58:03,474 [INFO] - Training epoch stats:     Loss: 0.0569 - F1-Score: 0.9814 - Accuracy-Score: 0.9774 - AUROC: 0.9979 - AP: 0.9985
[37m2024-08-15 08:58:04,018 [INFO] - Validation epoch stats:   Loss: 0.8804 - F1-Score: 0.8953 - Accuracy-Score: 0.8663 - AUROC: 0.9211 - AP: 0.9364
[37m2024-08-15 08:58:04,078 [INFO] - Epoch: 13/50
[37m2024-08-15 08:58:05,972 [INFO] - Training epoch stats:     Loss: 0.0569 - F1-Score: 0.9805 - Accuracy-Score: 0.9764 - AUROC: 0.9979 - AP: 0.9986
[37m2024-08-15 08:58:06,537 [INFO] - Validation epoch stats:   Loss: 0.8099 - F1-Score: 0.8882 - Accuracy-Score: 0.8593 - AUROC: 0.9170 - AP: 0.9388
[37m2024-08-15 08:58:06,605 [INFO] - Epoch: 14/50
[37m2024-08-15 08:58:09,271 [INFO] - Training epoch stats:     Loss: 0.0526 - F1-Score: 0.9827 - Accuracy-Score: 0.9790 - AUROC: 0.9982 - AP: 0.9988
[37m2024-08-15 08:58:09,859 [INFO] - Validation epoch stats:   Loss: 1.0068 - F1-Score: 0.8836 - Accuracy-Score: 0.8542 - AUROC: 0.9156 - AP: 0.9373
[37m2024-08-15 08:58:09,913 [INFO] - Epoch: 15/50
[37m2024-08-15 08:58:12,170 [INFO] - Training epoch stats:     Loss: 0.0498 - F1-Score: 0.9839 - Accuracy-Score: 0.9804 - AUROC: 0.9983 - AP: 0.9987
[37m2024-08-15 08:58:12,868 [INFO] - Validation epoch stats:   Loss: 1.0279 - F1-Score: 0.8915 - Accuracy-Score: 0.8622 - AUROC: 0.9135 - AP: 0.9310
[37m2024-08-15 08:58:13,033 [INFO] - Epoch: 16/50
[37m2024-08-15 08:58:17,958 [INFO] - Training epoch stats:     Loss: 0.0498 - F1-Score: 0.9841 - Accuracy-Score: 0.9807 - AUROC: 0.9985 - AP: 0.9989
[37m2024-08-15 08:58:18,535 [INFO] - Validation epoch stats:   Loss: 0.9998 - F1-Score: 0.8923 - Accuracy-Score: 0.8624 - AUROC: 0.9170 - AP: 0.9340
[37m2024-08-15 08:58:18,597 [INFO] - Epoch: 17/50
[37m2024-08-15 08:58:20,273 [INFO] - Training epoch stats:     Loss: 0.0462 - F1-Score: 0.9852 - Accuracy-Score: 0.9821 - AUROC: 0.9986 - AP: 0.9990
[37m2024-08-15 08:58:21,990 [INFO] - Validation epoch stats:   Loss: 1.0630 - F1-Score: 0.8911 - Accuracy-Score: 0.8611 - AUROC: 0.9157 - AP: 0.9317
[37m2024-08-15 08:58:22,067 [INFO] - Epoch: 18/50
[37m2024-08-15 08:58:23,775 [INFO] - Training epoch stats:     Loss: 0.0454 - F1-Score: 0.9862 - Accuracy-Score: 0.9833 - AUROC: 0.9986 - AP: 0.9990
[37m2024-08-15 08:58:24,471 [INFO] - Validation epoch stats:   Loss: 1.1019 - F1-Score: 0.8864 - Accuracy-Score: 0.8570 - AUROC: 0.9131 - AP: 0.9306
[37m2024-08-15 08:58:24,531 [INFO] - Epoch: 19/50
[37m2024-08-15 08:58:26,215 [INFO] - Training epoch stats:     Loss: 0.0438 - F1-Score: 0.9862 - Accuracy-Score: 0.9832 - AUROC: 0.9987 - AP: 0.9991
[37m2024-08-15 08:58:26,765 [INFO] - Validation epoch stats:   Loss: 1.2417 - F1-Score: 0.8880 - Accuracy-Score: 0.8598 - AUROC: 0.9135 - AP: 0.9291
[37m2024-08-15 08:58:26,826 [INFO] - Epoch: 20/50
[37m2024-08-15 08:58:30,064 [INFO] - Training epoch stats:     Loss: 0.0392 - F1-Score: 0.9873 - Accuracy-Score: 0.9846 - AUROC: 0.9990 - AP: 0.9993
[37m2024-08-15 08:58:30,601 [INFO] - Validation epoch stats:   Loss: 1.4688 - F1-Score: 0.8853 - Accuracy-Score: 0.8540 - AUROC: 0.9031 - AP: 0.9184
[37m2024-08-15 08:58:30,662 [INFO] - Epoch: 21/50
[37m2024-08-15 08:58:32,561 [INFO] - Training epoch stats:     Loss: 0.0428 - F1-Score: 0.9866 - Accuracy-Score: 0.9837 - AUROC: 0.9988 - AP: 0.9991
[37m2024-08-15 08:58:33,088 [INFO] - Validation epoch stats:   Loss: 1.2678 - F1-Score: 0.8857 - Accuracy-Score: 0.8560 - AUROC: 0.9100 - AP: 0.9270
[37m2024-08-15 08:58:33,093 [INFO] - Performing early stopping!
[37m2024-08-15 08:58:33,100 [INFO] - Finished run 04ralv6h
