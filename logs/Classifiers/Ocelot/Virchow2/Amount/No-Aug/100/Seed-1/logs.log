[37m2024-08-15 08:45:23,518 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 08:45:23,519 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/No-Aug/100/Seed-1/2024-08-15T084513_CellViT-Virchow2-100Percent
[37m2024-08-15 08:45:23,579 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f7c5f6f44c0>]
[37m2024-08-15 08:45:23,584 [INFO] - Using GPU: cuda:0
[37m2024-08-15 08:45:23,588 [INFO] - Using device: cuda:0
[37m2024-08-15 08:45:23,593 [INFO] - Loss function:
[37m2024-08-15 08:45:23,597 [INFO] - CrossEntropyLoss()
[37m2024-08-15 08:45:31,962 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 08:45:32,962 [INFO] - <All keys matched successfully>
[37m2024-08-15 08:45:35,617 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 08:45:35,620 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 08:45:35,626 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 08:45:35,631 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 08:45:35,650 [INFO] - Caching datasets
[37m2024-08-15 08:45:41,104 [INFO] - Instantiate Trainer
[37m2024-08-15 08:45:41,109 [INFO] - Calling Trainer Fit
[37m2024-08-15 08:45:41,114 [INFO] - Dataset is cached after first epoch
[37m2024-08-15 08:45:41,118 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 08:45:41,122 [INFO] - Epoch: 1/50
[37m2024-08-15 08:45:51,828 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/3d66c617a89d344c633ed6276baafef3382c52d9086244afa9315121afbb1e89.h5
[37m2024-08-15 08:45:54,067 [INFO] - Training epoch stats:     Loss: 0.2078 - F1-Score: 0.9328 - Accuracy-Score: 0.9178 - AUROC: 0.9715 - AP: 0.9780
[37m2024-08-15 08:45:58,326 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 08:45:59,028 [INFO] - Validation epoch stats:   Loss: 0.3607 - F1-Score: 0.9031 - Accuracy-Score: 0.8737 - AUROC: 0.9372 - AP: 0.9570
[37m2024-08-15 08:45:59,034 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:45:59,203 [INFO] - Epoch: 2/50
[37m2024-08-15 08:46:01,675 [INFO] - Training epoch stats:     Loss: 0.1369 - F1-Score: 0.9567 - Accuracy-Score: 0.9471 - AUROC: 0.9876 - AP: 0.9909
[37m2024-08-15 08:46:02,177 [INFO] - Validation epoch stats:   Loss: 0.4252 - F1-Score: 0.8927 - Accuracy-Score: 0.8659 - AUROC: 0.9325 - AP: 0.9529
[37m2024-08-15 08:46:02,247 [INFO] - Epoch: 3/50
[37m2024-08-15 08:46:04,864 [INFO] - Training epoch stats:     Loss: 0.1224 - F1-Score: 0.9620 - Accuracy-Score: 0.9535 - AUROC: 0.9898 - AP: 0.9925
[37m2024-08-15 08:46:05,400 [INFO] - Validation epoch stats:   Loss: 0.4324 - F1-Score: 0.9006 - Accuracy-Score: 0.8742 - AUROC: 0.9360 - AP: 0.9574
[37m2024-08-15 08:46:05,465 [INFO] - Epoch: 4/50
[37m2024-08-15 08:46:07,265 [INFO] - Training epoch stats:     Loss: 0.1064 - F1-Score: 0.9652 - Accuracy-Score: 0.9576 - AUROC: 0.9923 - AP: 0.9945
[37m2024-08-15 08:46:07,845 [INFO] - Validation epoch stats:   Loss: 0.4627 - F1-Score: 0.9044 - Accuracy-Score: 0.8775 - AUROC: 0.9353 - AP: 0.9534
[37m2024-08-15 08:46:07,919 [INFO] - Epoch: 5/50
[37m2024-08-15 08:46:10,560 [INFO] - Training epoch stats:     Loss: 0.1018 - F1-Score: 0.9678 - Accuracy-Score: 0.9607 - AUROC: 0.9931 - AP: 0.9951
[37m2024-08-15 08:46:10,978 [INFO] - Validation epoch stats:   Loss: 0.5235 - F1-Score: 0.8987 - Accuracy-Score: 0.8695 - AUROC: 0.9343 - AP: 0.9533
[37m2024-08-15 08:46:11,043 [INFO] - Epoch: 6/50
[37m2024-08-15 08:46:13,570 [INFO] - Training epoch stats:     Loss: 0.0925 - F1-Score: 0.9705 - Accuracy-Score: 0.9641 - AUROC: 0.9943 - AP: 0.9959
[37m2024-08-15 08:46:14,427 [INFO] - Validation epoch stats:   Loss: 0.4835 - F1-Score: 0.9045 - Accuracy-Score: 0.8761 - AUROC: 0.9376 - AP: 0.9549
[37m2024-08-15 08:46:14,434 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:46:14,600 [INFO] - Epoch: 7/50
[37m2024-08-15 08:46:16,571 [INFO] - Training epoch stats:     Loss: 0.0872 - F1-Score: 0.9721 - Accuracy-Score: 0.9660 - AUROC: 0.9950 - AP: 0.9965
[37m2024-08-15 08:46:17,293 [INFO] - Validation epoch stats:   Loss: 0.5770 - F1-Score: 0.9008 - Accuracy-Score: 0.8735 - AUROC: 0.9352 - AP: 0.9545
[37m2024-08-15 08:46:17,355 [INFO] - Epoch: 8/50
[37m2024-08-15 08:46:19,111 [INFO] - Training epoch stats:     Loss: 0.0773 - F1-Score: 0.9750 - Accuracy-Score: 0.9695 - AUROC: 0.9960 - AP: 0.9972
[37m2024-08-15 08:46:19,509 [INFO] - Validation epoch stats:   Loss: 0.7315 - F1-Score: 0.8946 - Accuracy-Score: 0.8666 - AUROC: 0.9291 - AP: 0.9480
[37m2024-08-15 08:46:19,580 [INFO] - Epoch: 9/50
[37m2024-08-15 08:46:21,661 [INFO] - Training epoch stats:     Loss: 0.0746 - F1-Score: 0.9763 - Accuracy-Score: 0.9712 - AUROC: 0.9963 - AP: 0.9974
[37m2024-08-15 08:46:22,391 [INFO] - Validation epoch stats:   Loss: 0.6779 - F1-Score: 0.9007 - Accuracy-Score: 0.8735 - AUROC: 0.9341 - AP: 0.9521
[37m2024-08-15 08:46:22,450 [INFO] - Epoch: 10/50
[37m2024-08-15 08:46:24,578 [INFO] - Training epoch stats:     Loss: 0.0663 - F1-Score: 0.9787 - Accuracy-Score: 0.9741 - AUROC: 0.9970 - AP: 0.9979
[37m2024-08-15 08:46:25,016 [INFO] - Validation epoch stats:   Loss: 0.6791 - F1-Score: 0.9014 - Accuracy-Score: 0.8738 - AUROC: 0.9338 - AP: 0.9513
[37m2024-08-15 08:46:25,078 [INFO] - Epoch: 11/50
[37m2024-08-15 08:46:27,065 [INFO] - Training epoch stats:     Loss: 0.0645 - F1-Score: 0.9788 - Accuracy-Score: 0.9742 - AUROC: 0.9972 - AP: 0.9979
[37m2024-08-15 08:46:27,771 [INFO] - Validation epoch stats:   Loss: 0.7897 - F1-Score: 0.8974 - Accuracy-Score: 0.8712 - AUROC: 0.9308 - AP: 0.9489
[37m2024-08-15 08:46:27,837 [INFO] - Epoch: 12/50
[37m2024-08-15 08:46:29,849 [INFO] - Training epoch stats:     Loss: 0.0605 - F1-Score: 0.9804 - Accuracy-Score: 0.9761 - AUROC: 0.9977 - AP: 0.9984
[37m2024-08-15 08:46:30,210 [INFO] - Validation epoch stats:   Loss: 0.7794 - F1-Score: 0.9007 - Accuracy-Score: 0.8729 - AUROC: 0.9272 - AP: 0.9422
[37m2024-08-15 08:46:30,267 [INFO] - Epoch: 13/50
[37m2024-08-15 08:46:31,959 [INFO] - Training epoch stats:     Loss: 0.0593 - F1-Score: 0.9810 - Accuracy-Score: 0.9769 - AUROC: 0.9977 - AP: 0.9983
[37m2024-08-15 08:46:32,371 [INFO] - Validation epoch stats:   Loss: 0.8934 - F1-Score: 0.8920 - Accuracy-Score: 0.8625 - AUROC: 0.9197 - AP: 0.9385
[37m2024-08-15 08:46:32,432 [INFO] - Epoch: 14/50
[37m2024-08-15 08:46:34,930 [INFO] - Training epoch stats:     Loss: 0.0577 - F1-Score: 0.9817 - Accuracy-Score: 0.9777 - AUROC: 0.9978 - AP: 0.9984
[37m2024-08-15 08:46:35,404 [INFO] - Validation epoch stats:   Loss: 0.8714 - F1-Score: 0.8962 - Accuracy-Score: 0.8681 - AUROC: 0.9296 - AP: 0.9475
[37m2024-08-15 08:46:35,467 [INFO] - Epoch: 15/50
[37m2024-08-15 08:46:37,156 [INFO] - Training epoch stats:     Loss: 0.0518 - F1-Score: 0.9830 - Accuracy-Score: 0.9793 - AUROC: 0.9982 - AP: 0.9987
[37m2024-08-15 08:46:37,485 [INFO] - Validation epoch stats:   Loss: 0.9043 - F1-Score: 0.8966 - Accuracy-Score: 0.8686 - AUROC: 0.9249 - AP: 0.9418
[37m2024-08-15 08:46:37,549 [INFO] - Epoch: 16/50
[37m2024-08-15 08:46:40,258 [INFO] - Training epoch stats:     Loss: 0.0519 - F1-Score: 0.9837 - Accuracy-Score: 0.9801 - AUROC: 0.9983 - AP: 0.9988
[37m2024-08-15 08:46:40,766 [INFO] - Validation epoch stats:   Loss: 0.9855 - F1-Score: 0.8922 - Accuracy-Score: 0.8636 - AUROC: 0.9217 - AP: 0.9399
[37m2024-08-15 08:46:40,828 [INFO] - Epoch: 17/50
[37m2024-08-15 08:46:42,405 [INFO] - Training epoch stats:     Loss: 0.0479 - F1-Score: 0.9842 - Accuracy-Score: 0.9808 - AUROC: 0.9984 - AP: 0.9988
[37m2024-08-15 08:46:42,777 [INFO] - Validation epoch stats:   Loss: 1.1036 - F1-Score: 0.8966 - Accuracy-Score: 0.8663 - AUROC: 0.9157 - AP: 0.9298
[37m2024-08-15 08:46:42,845 [INFO] - Epoch: 18/50
[37m2024-08-15 08:46:44,572 [INFO] - Training epoch stats:     Loss: 0.0498 - F1-Score: 0.9840 - Accuracy-Score: 0.9806 - AUROC: 0.9984 - AP: 0.9988
[37m2024-08-15 08:46:45,152 [INFO] - Validation epoch stats:   Loss: 1.0185 - F1-Score: 0.8932 - Accuracy-Score: 0.8635 - AUROC: 0.9188 - AP: 0.9357
[37m2024-08-15 08:46:45,214 [INFO] - Epoch: 19/50
[37m2024-08-15 08:46:47,558 [INFO] - Training epoch stats:     Loss: 0.0473 - F1-Score: 0.9847 - Accuracy-Score: 0.9813 - AUROC: 0.9985 - AP: 0.9989
[37m2024-08-15 08:46:47,919 [INFO] - Validation epoch stats:   Loss: 1.0878 - F1-Score: 0.8877 - Accuracy-Score: 0.8589 - AUROC: 0.9191 - AP: 0.9377
[37m2024-08-15 08:46:47,994 [INFO] - Epoch: 20/50
[37m2024-08-15 08:46:49,856 [INFO] - Training epoch stats:     Loss: 0.0441 - F1-Score: 0.9859 - Accuracy-Score: 0.9829 - AUROC: 0.9988 - AP: 0.9992
[37m2024-08-15 08:46:50,272 [INFO] - Validation epoch stats:   Loss: 1.0613 - F1-Score: 0.8953 - Accuracy-Score: 0.8654 - AUROC: 0.9194 - AP: 0.9346
[37m2024-08-15 08:46:50,334 [INFO] - Epoch: 21/50
[37m2024-08-15 08:46:53,059 [INFO] - Training epoch stats:     Loss: 0.0408 - F1-Score: 0.9868 - Accuracy-Score: 0.9840 - AUROC: 0.9988 - AP: 0.9990
[37m2024-08-15 08:46:53,492 [INFO] - Validation epoch stats:   Loss: 1.2099 - F1-Score: 0.8933 - Accuracy-Score: 0.8646 - AUROC: 0.9183 - AP: 0.9352
[37m2024-08-15 08:46:53,565 [INFO] - Epoch: 22/50
[37m2024-08-15 08:46:55,213 [INFO] - Training epoch stats:     Loss: 0.0430 - F1-Score: 0.9861 - Accuracy-Score: 0.9831 - AUROC: 0.9988 - AP: 0.9991
[37m2024-08-15 08:46:55,592 [INFO] - Validation epoch stats:   Loss: 1.2931 - F1-Score: 0.8853 - Accuracy-Score: 0.8575 - AUROC: 0.9177 - AP: 0.9369
[37m2024-08-15 08:46:55,658 [INFO] - Epoch: 23/50
[37m2024-08-15 08:46:57,201 [INFO] - Training epoch stats:     Loss: 0.0427 - F1-Score: 0.9865 - Accuracy-Score: 0.9836 - AUROC: 0.9988 - AP: 0.9990
[37m2024-08-15 08:46:57,661 [INFO] - Validation epoch stats:   Loss: 1.3600 - F1-Score: 0.8889 - Accuracy-Score: 0.8587 - AUROC: 0.9112 - AP: 0.9270
[37m2024-08-15 08:46:57,724 [INFO] - Epoch: 24/50
[37m2024-08-15 08:47:00,213 [INFO] - Training epoch stats:     Loss: 0.0376 - F1-Score: 0.9876 - Accuracy-Score: 0.9849 - AUROC: 0.9991 - AP: 0.9994
[37m2024-08-15 08:47:00,711 [INFO] - Validation epoch stats:   Loss: 1.3979 - F1-Score: 0.8903 - Accuracy-Score: 0.8608 - AUROC: 0.9151 - AP: 0.9307
[37m2024-08-15 08:47:00,776 [INFO] - Epoch: 25/50
[37m2024-08-15 08:47:02,355 [INFO] - Training epoch stats:     Loss: 0.0271 - F1-Score: 0.9906 - Accuracy-Score: 0.9885 - AUROC: 0.9995 - AP: 0.9996
[37m2024-08-15 08:47:02,828 [INFO] - Validation epoch stats:   Loss: 1.3629 - F1-Score: 0.8927 - Accuracy-Score: 0.8642 - AUROC: 0.9189 - AP: 0.9345
[37m2024-08-15 08:47:02,883 [INFO] - Epoch: 26/50
[37m2024-08-15 08:47:05,756 [INFO] - Training epoch stats:     Loss: 0.0220 - F1-Score: 0.9916 - Accuracy-Score: 0.9898 - AUROC: 0.9996 - AP: 0.9997
[37m2024-08-15 08:47:06,075 [INFO] - Validation epoch stats:   Loss: 1.4237 - F1-Score: 0.8930 - Accuracy-Score: 0.8651 - AUROC: 0.9183 - AP: 0.9341
[37m2024-08-15 08:47:06,081 [INFO] - Performing early stopping!
[37m2024-08-15 08:47:06,089 [INFO] - Finished run ixewahga
