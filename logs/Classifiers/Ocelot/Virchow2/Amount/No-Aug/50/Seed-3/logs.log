[37m2024-08-15 08:53:08,903 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 08:53:08,903 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow2/Amount/No-Aug/50/Seed-3/2024-08-15T085259_CellViT-Virchow2-50Percent
[37m2024-08-15 08:53:08,978 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f0551c24550>]
[37m2024-08-15 08:53:08,983 [INFO] - Using GPU: cuda:0
[37m2024-08-15 08:53:08,988 [INFO] - Using device: cuda:0
[37m2024-08-15 08:53:08,992 [INFO] - Loss function:
[37m2024-08-15 08:53:08,997 [INFO] - CrossEntropyLoss()
[37m2024-08-15 08:53:37,863 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow2-x40-AMP.pth
[37m2024-08-15 08:54:13,057 [INFO] - <All keys matched successfully>
[37m2024-08-15 08:54:21,428 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 08:54:21,431 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 08:54:21,436 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.009409727686291442, 'weight_decay': 0.00014345992571792625}
[37m2024-08-15 08:54:21,442 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 08:54:21,465 [INFO] - Caching datasets
[37m2024-08-15 08:54:24,662 [INFO] - Instantiate Trainer
[37m2024-08-15 08:54:24,675 [INFO] - Calling Trainer Fit
[37m2024-08-15 08:54:24,685 [INFO] - Dataset is cached after first epoch
[37m2024-08-15 08:54:24,696 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 08:54:24,704 [INFO] - Epoch: 1/50
[37m2024-08-15 08:54:31,535 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/e14ed85a91d310937278de4b2a04d722bd037a6da2782c3701420a1a9cc1310f.h5
[37m2024-08-15 08:54:33,062 [INFO] - Training epoch stats:     Loss: 0.2324 - F1-Score: 0.9286 - Accuracy-Score: 0.9077 - AUROC: 0.9640 - AP: 0.9748
[37m2024-08-15 08:54:37,752 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/d3f39bcf5e12d4434d29435a83ab7bcf9794a8be57cbfca649b939673729a883.h5
[37m2024-08-15 08:54:38,361 [INFO] - Validation epoch stats:   Loss: 0.3594 - F1-Score: 0.8924 - Accuracy-Score: 0.8649 - AUROC: 0.9323 - AP: 0.9577
[37m2024-08-15 08:54:38,411 [INFO] - New best model - save checkpoint
[37m2024-08-15 08:54:38,628 [INFO] - Epoch: 2/50
[37m2024-08-15 08:54:39,757 [INFO] - Training epoch stats:     Loss: 0.1373 - F1-Score: 0.9587 - Accuracy-Score: 0.9468 - AUROC: 0.9868 - AP: 0.9918
[37m2024-08-15 08:54:40,171 [INFO] - Validation epoch stats:   Loss: 0.4093 - F1-Score: 0.8915 - Accuracy-Score: 0.8577 - AUROC: 0.9260 - AP: 0.9483
[37m2024-08-15 08:54:40,311 [INFO] - Epoch: 3/50
[37m2024-08-15 08:54:41,565 [INFO] - Training epoch stats:     Loss: 0.1212 - F1-Score: 0.9626 - Accuracy-Score: 0.9518 - AUROC: 0.9900 - AP: 0.9939
[37m2024-08-15 08:54:42,074 [INFO] - Validation epoch stats:   Loss: 0.4576 - F1-Score: 0.8812 - Accuracy-Score: 0.8516 - AUROC: 0.9218 - AP: 0.9463
[37m2024-08-15 08:54:42,137 [INFO] - Epoch: 4/50
[37m2024-08-15 08:54:43,156 [INFO] - Training epoch stats:     Loss: 0.1059 - F1-Score: 0.9670 - Accuracy-Score: 0.9576 - AUROC: 0.9922 - AP: 0.9952
[37m2024-08-15 08:54:43,617 [INFO] - Validation epoch stats:   Loss: 0.4444 - F1-Score: 0.8964 - Accuracy-Score: 0.8658 - AUROC: 0.9285 - AP: 0.9497
[37m2024-08-15 08:54:43,727 [INFO] - Epoch: 5/50
[37m2024-08-15 08:54:44,731 [INFO] - Training epoch stats:     Loss: 0.0964 - F1-Score: 0.9707 - Accuracy-Score: 0.9624 - AUROC: 0.9935 - AP: 0.9961
[37m2024-08-15 08:54:45,164 [INFO] - Validation epoch stats:   Loss: 0.4499 - F1-Score: 0.8895 - Accuracy-Score: 0.8584 - AUROC: 0.9215 - AP: 0.9455
[37m2024-08-15 08:54:45,223 [INFO] - Epoch: 6/50
[37m2024-08-15 08:54:46,258 [INFO] - Training epoch stats:     Loss: 0.0888 - F1-Score: 0.9729 - Accuracy-Score: 0.9653 - AUROC: 0.9946 - AP: 0.9968
[37m2024-08-15 08:54:46,761 [INFO] - Validation epoch stats:   Loss: 0.5561 - F1-Score: 0.8882 - Accuracy-Score: 0.8570 - AUROC: 0.9164 - AP: 0.9363
[37m2024-08-15 08:54:46,826 [INFO] - Epoch: 7/50
[37m2024-08-15 08:54:47,941 [INFO] - Training epoch stats:     Loss: 0.0804 - F1-Score: 0.9756 - Accuracy-Score: 0.9687 - AUROC: 0.9955 - AP: 0.9973
[37m2024-08-15 08:54:48,374 [INFO] - Validation epoch stats:   Loss: 0.6364 - F1-Score: 0.8779 - Accuracy-Score: 0.8468 - AUROC: 0.9126 - AP: 0.9352
[37m2024-08-15 08:54:48,433 [INFO] - Epoch: 8/50
[37m2024-08-15 08:54:49,462 [INFO] - Training epoch stats:     Loss: 0.0767 - F1-Score: 0.9769 - Accuracy-Score: 0.9704 - AUROC: 0.9961 - AP: 0.9977
[37m2024-08-15 08:54:50,057 [INFO] - Validation epoch stats:   Loss: 0.6460 - F1-Score: 0.8857 - Accuracy-Score: 0.8546 - AUROC: 0.9113 - AP: 0.9290
[37m2024-08-15 08:54:50,154 [INFO] - Epoch: 9/50
[37m2024-08-15 08:54:51,086 [INFO] - Training epoch stats:     Loss: 0.0682 - F1-Score: 0.9798 - Accuracy-Score: 0.9742 - AUROC: 0.9967 - AP: 0.9979
[37m2024-08-15 08:54:51,506 [INFO] - Validation epoch stats:   Loss: 0.7350 - F1-Score: 0.8844 - Accuracy-Score: 0.8491 - AUROC: 0.9036 - AP: 0.9235
[37m2024-08-15 08:54:51,572 [INFO] - Epoch: 10/50
[37m2024-08-15 08:54:52,459 [INFO] - Training epoch stats:     Loss: 0.0626 - F1-Score: 0.9812 - Accuracy-Score: 0.9759 - AUROC: 0.9973 - AP: 0.9984
[37m2024-08-15 08:54:52,878 [INFO] - Validation epoch stats:   Loss: 0.7817 - F1-Score: 0.8781 - Accuracy-Score: 0.8451 - AUROC: 0.9065 - AP: 0.9272
[37m2024-08-15 08:54:52,936 [INFO] - Epoch: 11/50
[37m2024-08-15 08:54:54,521 [INFO] - Training epoch stats:     Loss: 0.0602 - F1-Score: 0.9814 - Accuracy-Score: 0.9762 - AUROC: 0.9975 - AP: 0.9984
[37m2024-08-15 08:54:54,962 [INFO] - Validation epoch stats:   Loss: 0.8371 - F1-Score: 0.8809 - Accuracy-Score: 0.8477 - AUROC: 0.9041 - AP: 0.9241
[37m2024-08-15 08:54:55,023 [INFO] - Epoch: 12/50
[37m2024-08-15 08:54:56,207 [INFO] - Training epoch stats:     Loss: 0.0550 - F1-Score: 0.9822 - Accuracy-Score: 0.9772 - AUROC: 0.9980 - AP: 0.9989
[37m2024-08-15 08:54:56,642 [INFO] - Validation epoch stats:   Loss: 0.9586 - F1-Score: 0.8739 - Accuracy-Score: 0.8382 - AUROC: 0.8941 - AP: 0.9134
[37m2024-08-15 08:54:56,707 [INFO] - Epoch: 13/50
[37m2024-08-15 08:54:57,867 [INFO] - Training epoch stats:     Loss: 0.0519 - F1-Score: 0.9834 - Accuracy-Score: 0.9788 - AUROC: 0.9982 - AP: 0.9989
[37m2024-08-15 08:54:58,333 [INFO] - Validation epoch stats:   Loss: 1.0063 - F1-Score: 0.8735 - Accuracy-Score: 0.8356 - AUROC: 0.8898 - AP: 0.9095
[37m2024-08-15 08:54:58,387 [INFO] - Epoch: 14/50
[37m2024-08-15 08:54:59,382 [INFO] - Training epoch stats:     Loss: 0.0468 - F1-Score: 0.9850 - Accuracy-Score: 0.9808 - AUROC: 0.9986 - AP: 0.9992
[37m2024-08-15 08:54:59,867 [INFO] - Validation epoch stats:   Loss: 1.0293 - F1-Score: 0.8699 - Accuracy-Score: 0.8337 - AUROC: 0.8937 - AP: 0.9155
[37m2024-08-15 08:54:59,920 [INFO] - Epoch: 15/50
[37m2024-08-15 08:55:00,988 [INFO] - Training epoch stats:     Loss: 0.0518 - F1-Score: 0.9835 - Accuracy-Score: 0.9789 - AUROC: 0.9981 - AP: 0.9988
[37m2024-08-15 08:55:01,429 [INFO] - Validation epoch stats:   Loss: 1.0403 - F1-Score: 0.8724 - Accuracy-Score: 0.8359 - AUROC: 0.8893 - AP: 0.9092
[37m2024-08-15 08:55:01,490 [INFO] - Epoch: 16/50
[37m2024-08-15 08:55:02,560 [INFO] - Training epoch stats:     Loss: 0.0479 - F1-Score: 0.9856 - Accuracy-Score: 0.9816 - AUROC: 0.9984 - AP: 0.9990
[37m2024-08-15 08:55:03,266 [INFO] - Validation epoch stats:   Loss: 1.0397 - F1-Score: 0.8748 - Accuracy-Score: 0.8403 - AUROC: 0.8958 - AP: 0.9138
[37m2024-08-15 08:55:03,330 [INFO] - Epoch: 17/50
[37m2024-08-15 08:55:04,368 [INFO] - Training epoch stats:     Loss: 0.0458 - F1-Score: 0.9858 - Accuracy-Score: 0.9818 - AUROC: 0.9987 - AP: 0.9993
[37m2024-08-15 08:55:04,837 [INFO] - Validation epoch stats:   Loss: 1.2310 - F1-Score: 0.8651 - Accuracy-Score: 0.8295 - AUROC: 0.8876 - AP: 0.9079
[37m2024-08-15 08:55:04,899 [INFO] - Epoch: 18/50
[37m2024-08-15 08:55:05,982 [INFO] - Training epoch stats:     Loss: 0.0418 - F1-Score: 0.9870 - Accuracy-Score: 0.9834 - AUROC: 0.9988 - AP: 0.9992
[37m2024-08-15 08:55:06,490 [INFO] - Validation epoch stats:   Loss: 1.3827 - F1-Score: 0.8572 - Accuracy-Score: 0.8247 - AUROC: 0.8903 - AP: 0.9101
[37m2024-08-15 08:55:06,561 [INFO] - Epoch: 19/50
[37m2024-08-15 08:55:08,157 [INFO] - Training epoch stats:     Loss: 0.0401 - F1-Score: 0.9878 - Accuracy-Score: 0.9843 - AUROC: 0.9989 - AP: 0.9993
[37m2024-08-15 08:55:09,078 [INFO] - Validation epoch stats:   Loss: 1.2549 - F1-Score: 0.8708 - Accuracy-Score: 0.8358 - AUROC: 0.8906 - AP: 0.9088
[37m2024-08-15 08:55:09,137 [INFO] - Epoch: 20/50
[37m2024-08-15 08:55:10,367 [INFO] - Training epoch stats:     Loss: 0.0397 - F1-Score: 0.9882 - Accuracy-Score: 0.9849 - AUROC: 0.9990 - AP: 0.9994
[37m2024-08-15 08:55:11,051 [INFO] - Validation epoch stats:   Loss: 1.2995 - F1-Score: 0.8780 - Accuracy-Score: 0.8444 - AUROC: 0.8967 - AP: 0.9131
[37m2024-08-15 08:55:11,105 [INFO] - Epoch: 21/50
[37m2024-08-15 08:55:12,363 [INFO] - Training epoch stats:     Loss: 0.0422 - F1-Score: 0.9878 - Accuracy-Score: 0.9844 - AUROC: 0.9988 - AP: 0.9991
[37m2024-08-15 08:55:12,877 [INFO] - Validation epoch stats:   Loss: 1.1335 - F1-Score: 0.8738 - Accuracy-Score: 0.8416 - AUROC: 0.9042 - AP: 0.9239
[37m2024-08-15 08:55:12,884 [INFO] - Performing early stopping!
[37m2024-08-15 08:55:12,890 [INFO] - Finished run rl5erhgj
