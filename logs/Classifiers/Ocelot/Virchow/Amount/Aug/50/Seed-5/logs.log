[37m2024-08-14 22:48:08,507 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-14 22:48:08,508 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/Aug/50/Seed-5/2024-08-14T224757_CellViT-Virchow-50Percent
[37m2024-08-14 22:48:08,573 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f94b2434430>]
[37m2024-08-14 22:48:08,580 [INFO] - Using GPU: cuda:0
[37m2024-08-14 22:48:08,585 [INFO] - Using device: cuda:0
[37m2024-08-14 22:48:08,590 [INFO] - Loss function:
[37m2024-08-14 22:48:08,596 [INFO] - CrossEntropyLoss()
[37m2024-08-14 22:48:14,873 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow-x40-AMP.pth
[37m2024-08-14 22:48:15,053 [INFO] - <All keys matched successfully>
[37m2024-08-14 22:48:15,968 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-14 22:48:15,976 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-14 22:48:15,982 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-14 22:48:15,988 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-14 22:48:16,015 [INFO] - Caching datasets
[37m2024-08-14 22:48:18,536 [INFO] - Instantiate Trainer
[37m2024-08-14 22:48:18,545 [INFO] - Calling Trainer Fit
[37m2024-08-14 22:48:18,549 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-14 22:48:18,553 [INFO] - Epoch: 1/50
[37m2024-08-14 22:48:18,558 [INFO] - Extracting training cells
[37m2024-08-14 22:51:19,870 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.605, Recall: 0.706, Detected-Cells: 21909
[37m2024-08-14 22:51:20,611 [INFO] - Training epoch stats:     Loss: 0.2938 - F1-Score: 0.9067 - Accuracy-Score: 0.8768 - AUROC: 0.9438 - AP: 0.9618
[37m2024-08-14 22:51:24,423 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-14 22:51:24,870 [INFO] - Validation epoch stats:   Loss: 0.3899 - F1-Score: 0.8848 - Accuracy-Score: 0.8503 - AUROC: 0.9026 - AP: 0.9277
[37m2024-08-14 22:51:24,877 [INFO] - New best model - save checkpoint
[37m2024-08-14 22:51:25,060 [INFO] - Epoch: 2/50
[37m2024-08-14 22:51:25,065 [INFO] - Extracting training cells
[37m2024-08-14 22:54:17,138 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.596, Recall: 0.693, Detected-Cells: 21698
[37m2024-08-14 22:54:18,019 [INFO] - Training epoch stats:     Loss: 0.1969 - F1-Score: 0.9405 - Accuracy-Score: 0.9237 - AUROC: 0.9730 - AP: 0.9819
[37m2024-08-14 22:54:18,485 [INFO] - Validation epoch stats:   Loss: 0.4511 - F1-Score: 0.8681 - Accuracy-Score: 0.8354 - AUROC: 0.8961 - AP: 0.9207
[37m2024-08-14 22:54:18,554 [INFO] - Epoch: 3/50
[37m2024-08-14 22:54:18,559 [INFO] - Extracting training cells
[37m2024-08-14 22:57:10,210 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.605, Recall: 0.693, Detected-Cells: 21656
[37m2024-08-14 22:57:10,876 [INFO] - Training epoch stats:     Loss: 0.1729 - F1-Score: 0.9484 - Accuracy-Score: 0.9344 - AUROC: 0.9796 - AP: 0.9865
[37m2024-08-14 22:57:11,259 [INFO] - Validation epoch stats:   Loss: 0.4777 - F1-Score: 0.8523 - Accuracy-Score: 0.8181 - AUROC: 0.8889 - AP: 0.9162
[37m2024-08-14 22:57:11,336 [INFO] - Epoch: 4/50
[37m2024-08-14 22:57:11,340 [INFO] - Extracting training cells
[37m2024-08-14 23:00:04,477 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.596, Recall: 0.699, Detected-Cells: 21419
[37m2024-08-14 23:00:05,306 [INFO] - Training epoch stats:     Loss: 0.1590 - F1-Score: 0.9533 - Accuracy-Score: 0.9404 - AUROC: 0.9821 - AP: 0.9881
[37m2024-08-14 23:00:05,766 [INFO] - Validation epoch stats:   Loss: 0.4541 - F1-Score: 0.8758 - Accuracy-Score: 0.8405 - AUROC: 0.8959 - AP: 0.9208
[37m2024-08-14 23:00:05,838 [INFO] - Epoch: 5/50
[37m2024-08-14 23:00:05,843 [INFO] - Extracting training cells
[37m2024-08-14 23:03:00,500 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.603, Recall: 0.702, Detected-Cells: 21587
[37m2024-08-14 23:03:01,369 [INFO] - Training epoch stats:     Loss: 0.1544 - F1-Score: 0.9531 - Accuracy-Score: 0.9403 - AUROC: 0.9832 - AP: 0.9888
[37m2024-08-14 23:03:01,829 [INFO] - Validation epoch stats:   Loss: 0.5402 - F1-Score: 0.8382 - Accuracy-Score: 0.8047 - AUROC: 0.8870 - AP: 0.9157
[37m2024-08-14 23:03:01,888 [INFO] - Epoch: 6/50
[37m2024-08-14 23:03:01,894 [INFO] - Extracting training cells
[37m2024-08-14 23:05:53,013 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.602, Recall: 0.696, Detected-Cells: 21129
[37m2024-08-14 23:05:53,649 [INFO] - Training epoch stats:     Loss: 0.1446 - F1-Score: 0.9575 - Accuracy-Score: 0.9456 - AUROC: 0.9858 - AP: 0.9912
[37m2024-08-14 23:05:54,055 [INFO] - Validation epoch stats:   Loss: 0.5090 - F1-Score: 0.8521 - Accuracy-Score: 0.8170 - AUROC: 0.8909 - AP: 0.9200
[37m2024-08-14 23:05:54,127 [INFO] - Epoch: 7/50
[37m2024-08-14 23:05:54,133 [INFO] - Extracting training cells
[37m2024-08-14 23:08:49,464 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.612, Recall: 0.703, Detected-Cells: 22159
[37m2024-08-14 23:08:50,310 [INFO] - Training epoch stats:     Loss: 0.1340 - F1-Score: 0.9610 - Accuracy-Score: 0.9501 - AUROC: 0.9872 - AP: 0.9916
[37m2024-08-14 23:08:50,782 [INFO] - Validation epoch stats:   Loss: 0.5109 - F1-Score: 0.8586 - Accuracy-Score: 0.8236 - AUROC: 0.8918 - AP: 0.9193
[37m2024-08-14 23:08:50,840 [INFO] - Epoch: 8/50
[37m2024-08-14 23:08:50,846 [INFO] - Extracting training cells
[37m2024-08-14 23:11:42,510 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.603, Recall: 0.694, Detected-Cells: 21914
[37m2024-08-14 23:11:43,203 [INFO] - Training epoch stats:     Loss: 0.1322 - F1-Score: 0.9612 - Accuracy-Score: 0.9499 - AUROC: 0.9879 - AP: 0.9928
[37m2024-08-14 23:11:43,509 [INFO] - Validation epoch stats:   Loss: 0.5750 - F1-Score: 0.8386 - Accuracy-Score: 0.8047 - AUROC: 0.8857 - AP: 0.9153
[37m2024-08-14 23:11:43,576 [INFO] - Epoch: 9/50
[37m2024-08-14 23:11:43,582 [INFO] - Extracting training cells
[37m2024-08-14 23:14:34,602 [INFO] - Extraction detection metrics - F1: 0.612, Precision: 0.594, Recall: 0.693, Detected-Cells: 21365
[37m2024-08-14 23:14:35,451 [INFO] - Training epoch stats:     Loss: 0.1201 - F1-Score: 0.9647 - Accuracy-Score: 0.9551 - AUROC: 0.9900 - AP: 0.9936
[37m2024-08-14 23:14:35,910 [INFO] - Validation epoch stats:   Loss: 0.5591 - F1-Score: 0.8496 - Accuracy-Score: 0.8144 - AUROC: 0.8874 - AP: 0.9167
[37m2024-08-14 23:14:35,972 [INFO] - Epoch: 10/50
[37m2024-08-14 23:14:35,978 [INFO] - Extracting training cells
[37m2024-08-14 23:17:27,587 [INFO] - Extraction detection metrics - F1: 0.627, Precision: 0.607, Recall: 0.707, Detected-Cells: 22349
[37m2024-08-14 23:17:28,263 [INFO] - Training epoch stats:     Loss: 0.1156 - F1-Score: 0.9649 - Accuracy-Score: 0.9548 - AUROC: 0.9909 - AP: 0.9946
[37m2024-08-14 23:17:28,772 [INFO] - Validation epoch stats:   Loss: 0.5907 - F1-Score: 0.8424 - Accuracy-Score: 0.8076 - AUROC: 0.8843 - AP: 0.9130
[37m2024-08-14 23:17:28,839 [INFO] - Epoch: 11/50
[37m2024-08-14 23:17:28,845 [INFO] - Extracting training cells
[37m2024-08-14 23:20:22,640 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.603, Recall: 0.702, Detected-Cells: 21545
[37m2024-08-14 23:20:23,467 [INFO] - Training epoch stats:     Loss: 0.1138 - F1-Score: 0.9664 - Accuracy-Score: 0.9571 - AUROC: 0.9908 - AP: 0.9940
[37m2024-08-14 23:20:23,928 [INFO] - Validation epoch stats:   Loss: 0.5974 - F1-Score: 0.8472 - Accuracy-Score: 0.8121 - AUROC: 0.8844 - AP: 0.9133
[37m2024-08-14 23:20:24,004 [INFO] - Epoch: 12/50
[37m2024-08-14 23:20:24,010 [INFO] - Extracting training cells
[37m2024-08-14 23:23:14,876 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.600, Recall: 0.704, Detected-Cells: 22280
[37m2024-08-14 23:23:15,552 [INFO] - Training epoch stats:     Loss: 0.1061 - F1-Score: 0.9688 - Accuracy-Score: 0.9604 - AUROC: 0.9920 - AP: 0.9946
[37m2024-08-14 23:23:15,935 [INFO] - Validation epoch stats:   Loss: 0.5901 - F1-Score: 0.8504 - Accuracy-Score: 0.8143 - AUROC: 0.8847 - AP: 0.9138
[37m2024-08-14 23:23:16,003 [INFO] - Epoch: 13/50
[37m2024-08-14 23:23:16,008 [INFO] - Extracting training cells
[37m2024-08-14 23:26:07,507 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.606, Recall: 0.702, Detected-Cells: 21878
[37m2024-08-14 23:26:08,167 [INFO] - Training epoch stats:     Loss: 0.1023 - F1-Score: 0.9683 - Accuracy-Score: 0.9593 - AUROC: 0.9928 - AP: 0.9957
[37m2024-08-14 23:26:08,589 [INFO] - Validation epoch stats:   Loss: 0.6465 - F1-Score: 0.8369 - Accuracy-Score: 0.8027 - AUROC: 0.8849 - AP: 0.9157
[37m2024-08-14 23:26:08,656 [INFO] - Epoch: 14/50
[37m2024-08-14 23:26:08,661 [INFO] - Extracting training cells
[37m2024-08-14 23:29:03,037 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.600, Recall: 0.696, Detected-Cells: 21849
[37m2024-08-14 23:29:03,721 [INFO] - Training epoch stats:     Loss: 0.0939 - F1-Score: 0.9723 - Accuracy-Score: 0.9647 - AUROC: 0.9940 - AP: 0.9964
[37m2024-08-14 23:29:04,103 [INFO] - Validation epoch stats:   Loss: 0.6462 - F1-Score: 0.8421 - Accuracy-Score: 0.8069 - AUROC: 0.8836 - AP: 0.9137
[37m2024-08-14 23:29:04,165 [INFO] - Epoch: 15/50
[37m2024-08-14 23:29:04,170 [INFO] - Extracting training cells
[37m2024-08-14 23:31:55,353 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.603, Recall: 0.698, Detected-Cells: 21587
[37m2024-08-14 23:31:56,151 [INFO] - Training epoch stats:     Loss: 0.1106 - F1-Score: 0.9692 - Accuracy-Score: 0.9600 - AUROC: 0.9912 - AP: 0.9945
[37m2024-08-14 23:31:56,465 [INFO] - Validation epoch stats:   Loss: 0.6304 - F1-Score: 0.8400 - Accuracy-Score: 0.8037 - AUROC: 0.8789 - AP: 0.9101
[37m2024-08-14 23:31:56,531 [INFO] - Epoch: 16/50
[37m2024-08-14 23:31:56,536 [INFO] - Extracting training cells
[37m2024-08-14 23:34:48,363 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.603, Recall: 0.697, Detected-Cells: 22016
[37m2024-08-14 23:34:49,024 [INFO] - Training epoch stats:     Loss: 0.0930 - F1-Score: 0.9731 - Accuracy-Score: 0.9654 - AUROC: 0.9940 - AP: 0.9964
[37m2024-08-14 23:34:49,429 [INFO] - Validation epoch stats:   Loss: 0.6335 - F1-Score: 0.8390 - Accuracy-Score: 0.8037 - AUROC: 0.8828 - AP: 0.9122
[37m2024-08-14 23:34:49,510 [INFO] - Epoch: 17/50
[37m2024-08-14 23:34:49,516 [INFO] - Extracting training cells
[37m2024-08-14 23:37:40,930 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.606, Recall: 0.695, Detected-Cells: 21603
[37m2024-08-14 23:37:41,582 [INFO] - Training epoch stats:     Loss: 0.0966 - F1-Score: 0.9725 - Accuracy-Score: 0.9637 - AUROC: 0.9935 - AP: 0.9965
[37m2024-08-14 23:37:41,884 [INFO] - Validation epoch stats:   Loss: 0.6309 - F1-Score: 0.8454 - Accuracy-Score: 0.8101 - AUROC: 0.8826 - AP: 0.9114
[37m2024-08-14 23:37:41,962 [INFO] - Epoch: 18/50
[37m2024-08-14 23:37:41,969 [INFO] - Extracting training cells
[37m2024-08-14 23:40:34,086 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.596, Recall: 0.692, Detected-Cells: 21669
[37m2024-08-14 23:40:34,761 [INFO] - Training epoch stats:     Loss: 0.0945 - F1-Score: 0.9725 - Accuracy-Score: 0.9650 - AUROC: 0.9936 - AP: 0.9958
[37m2024-08-14 23:40:35,064 [INFO] - Validation epoch stats:   Loss: 0.6375 - F1-Score: 0.8403 - Accuracy-Score: 0.8059 - AUROC: 0.8847 - AP: 0.9123
[37m2024-08-14 23:40:35,135 [INFO] - Epoch: 19/50
[37m2024-08-14 23:40:35,140 [INFO] - Extracting training cells
[37m2024-08-14 23:43:28,894 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.609, Recall: 0.704, Detected-Cells: 22239
[37m2024-08-14 23:43:29,383 [INFO] - Training epoch stats:     Loss: 0.0865 - F1-Score: 0.9760 - Accuracy-Score: 0.9690 - AUROC: 0.9947 - AP: 0.9968
[37m2024-08-14 23:43:29,688 [INFO] - Validation epoch stats:   Loss: 0.6470 - F1-Score: 0.8472 - Accuracy-Score: 0.8120 - AUROC: 0.8842 - AP: 0.9131
[37m2024-08-14 23:43:29,752 [INFO] - Epoch: 20/50
[37m2024-08-14 23:43:29,757 [INFO] - Extracting training cells
[37m2024-08-14 23:46:21,942 [INFO] - Extraction detection metrics - F1: 0.631, Precision: 0.609, Recall: 0.712, Detected-Cells: 22715
[37m2024-08-14 23:46:22,829 [INFO] - Training epoch stats:     Loss: 0.0867 - F1-Score: 0.9755 - Accuracy-Score: 0.9684 - AUROC: 0.9945 - AP: 0.9965
[37m2024-08-14 23:46:23,287 [INFO] - Validation epoch stats:   Loss: 0.6428 - F1-Score: 0.8496 - Accuracy-Score: 0.8143 - AUROC: 0.8828 - AP: 0.9100
[37m2024-08-14 23:46:23,345 [INFO] - Epoch: 21/50
[37m2024-08-14 23:46:23,350 [INFO] - Extracting training cells
[37m2024-08-14 23:49:13,976 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.604, Recall: 0.693, Detected-Cells: 21735
[37m2024-08-14 23:49:14,630 [INFO] - Training epoch stats:     Loss: 0.0863 - F1-Score: 0.9764 - Accuracy-Score: 0.9695 - AUROC: 0.9942 - AP: 0.9960
[37m2024-08-14 23:49:14,937 [INFO] - Validation epoch stats:   Loss: 0.6457 - F1-Score: 0.8442 - Accuracy-Score: 0.8094 - AUROC: 0.8830 - AP: 0.9104
[37m2024-08-14 23:49:14,942 [INFO] - Performing early stopping!
[37m2024-08-14 23:49:14,950 [INFO] - Finished run pftnl0b6
