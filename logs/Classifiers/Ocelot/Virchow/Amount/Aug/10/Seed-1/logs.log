[37m2024-08-11 20:17:03,151 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 20:17:03,152 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/Aug/10/Seed-1/2024-08-11T201652_CellViT-Virchow-10Percent
[37m2024-08-11 20:17:03,220 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f6515714160>]
[37m2024-08-11 20:17:03,226 [INFO] - Using GPU: cuda:0
[37m2024-08-11 20:17:03,232 [INFO] - Using device: cuda:0
[37m2024-08-11 20:17:03,237 [INFO] - Loss function:
[37m2024-08-11 20:17:03,242 [INFO] - CrossEntropyLoss()
[37m2024-08-11 20:17:12,078 [INFO] - <All keys matched successfully>
[37m2024-08-11 20:17:13,322 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 20:17:13,324 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 20:17:13,330 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 20:17:13,335 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 20:17:13,361 [INFO] - Caching datasets
[37m2024-08-11 20:17:15,654 [INFO] - Instantiate Trainer
[37m2024-08-11 20:17:15,666 [INFO] - Calling Trainer Fit
[37m2024-08-11 20:17:15,672 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 20:17:15,677 [INFO] - Epoch: 1/50
[37m2024-08-11 20:17:15,683 [INFO] - Extracting training cells
[37m2024-08-11 20:17:51,496 [INFO] - Extraction detection metrics - F1: 0.610, Precision: 0.597, Recall: 0.696, Detected-Cells: 4891
[37m2024-08-11 20:17:51,811 [INFO] - Training epoch stats:     Loss: 0.4318 - F1-Score: 0.8434 - Accuracy-Score: 0.7802 - AUROC: 0.8968 - AP: 0.9416
[37m2024-08-11 20:17:56,027 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 20:17:56,450 [INFO] - Validation epoch stats:   Loss: 0.4013 - F1-Score: 0.8832 - Accuracy-Score: 0.8529 - AUROC: 0.9054 - AP: 0.9411
[37m2024-08-11 20:17:56,451 [INFO] - New best model - save checkpoint
[37m2024-08-11 20:17:56,639 [INFO] - Epoch: 2/50
[37m2024-08-11 20:17:56,646 [INFO] - Extracting training cells
[37m2024-08-11 20:18:24,696 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.610, Recall: 0.709, Detected-Cells: 5027
[37m2024-08-11 20:18:24,875 [INFO] - Training epoch stats:     Loss: 0.1913 - F1-Score: 0.9443 - Accuracy-Score: 0.9338 - AUROC: 0.9806 - AP: 0.9862
[37m2024-08-11 20:18:25,185 [INFO] - Validation epoch stats:   Loss: 0.4162 - F1-Score: 0.8649 - Accuracy-Score: 0.8354 - AUROC: 0.9036 - AP: 0.9394
[37m2024-08-11 20:18:25,249 [INFO] - Epoch: 3/50
[37m2024-08-11 20:18:25,254 [INFO] - Extracting training cells
[37m2024-08-11 20:18:52,557 [INFO] - Extraction detection metrics - F1: 0.592, Precision: 0.570, Recall: 0.690, Detected-Cells: 4629
[37m2024-08-11 20:18:52,706 [INFO] - Training epoch stats:     Loss: 0.1926 - F1-Score: 0.9429 - Accuracy-Score: 0.9274 - AUROC: 0.9749 - AP: 0.9841
[37m2024-08-11 20:18:53,011 [INFO] - Validation epoch stats:   Loss: 0.4403 - F1-Score: 0.8538 - Accuracy-Score: 0.8222 - AUROC: 0.8933 - AP: 0.9342
[37m2024-08-11 20:18:53,081 [INFO] - Epoch: 4/50
[37m2024-08-11 20:18:53,086 [INFO] - Extracting training cells
[37m2024-08-11 20:19:21,129 [INFO] - Extraction detection metrics - F1: 0.608, Precision: 0.588, Recall: 0.705, Detected-Cells: 4927
[37m2024-08-11 20:19:21,333 [INFO] - Training epoch stats:     Loss: 0.1546 - F1-Score: 0.9499 - Accuracy-Score: 0.9389 - AUROC: 0.9846 - AP: 0.9892
[37m2024-08-11 20:19:21,793 [INFO] - Validation epoch stats:   Loss: 0.4532 - F1-Score: 0.8476 - Accuracy-Score: 0.8150 - AUROC: 0.8882 - AP: 0.9303
[37m2024-08-11 20:19:21,858 [INFO] - Epoch: 5/50
[37m2024-08-11 20:19:21,865 [INFO] - Extracting training cells
[37m2024-08-11 20:19:49,638 [INFO] - Extraction detection metrics - F1: 0.603, Precision: 0.596, Recall: 0.695, Detected-Cells: 4778
[37m2024-08-11 20:19:49,823 [INFO] - Training epoch stats:     Loss: 0.1481 - F1-Score: 0.9506 - Accuracy-Score: 0.9422 - AUROC: 0.9861 - AP: 0.9870
[37m2024-08-11 20:19:50,215 [INFO] - Validation epoch stats:   Loss: 0.4816 - F1-Score: 0.8372 - Accuracy-Score: 0.8057 - AUROC: 0.8866 - AP: 0.9284
[37m2024-08-11 20:19:50,286 [INFO] - Epoch: 6/50
[37m2024-08-11 20:19:50,292 [INFO] - Extracting training cells
[37m2024-08-11 20:20:17,637 [INFO] - Extraction detection metrics - F1: 0.603, Precision: 0.588, Recall: 0.695, Detected-Cells: 4833
[37m2024-08-11 20:20:17,817 [INFO] - Training epoch stats:     Loss: 0.1686 - F1-Score: 0.9482 - Accuracy-Score: 0.9377 - AUROC: 0.9799 - AP: 0.9796
[37m2024-08-11 20:20:18,258 [INFO] - Validation epoch stats:   Loss: 0.5096 - F1-Score: 0.8132 - Accuracy-Score: 0.7834 - AUROC: 0.8819 - AP: 0.9261
[37m2024-08-11 20:20:18,323 [INFO] - Epoch: 7/50
[37m2024-08-11 20:20:18,327 [INFO] - Extracting training cells
[37m2024-08-11 20:20:45,892 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.599, Recall: 0.720, Detected-Cells: 5240
[37m2024-08-11 20:20:46,077 [INFO] - Training epoch stats:     Loss: 0.1231 - F1-Score: 0.9626 - Accuracy-Score: 0.9546 - AUROC: 0.9909 - AP: 0.9931
[37m2024-08-11 20:20:46,444 [INFO] - Validation epoch stats:   Loss: 0.5327 - F1-Score: 0.8144 - Accuracy-Score: 0.7870 - AUROC: 0.8901 - AP: 0.9314
[37m2024-08-11 20:20:46,505 [INFO] - Epoch: 8/50
[37m2024-08-11 20:20:46,511 [INFO] - Extracting training cells
[37m2024-08-11 20:21:13,066 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.601, Recall: 0.709, Detected-Cells: 5009
[37m2024-08-11 20:21:13,259 [INFO] - Training epoch stats:     Loss: 0.1240 - F1-Score: 0.9633 - Accuracy-Score: 0.9547 - AUROC: 0.9894 - AP: 0.9925
[37m2024-08-11 20:21:13,716 [INFO] - Validation epoch stats:   Loss: 0.5024 - F1-Score: 0.8385 - Accuracy-Score: 0.8068 - AUROC: 0.8854 - AP: 0.9286
[37m2024-08-11 20:21:13,795 [INFO] - Epoch: 9/50
[37m2024-08-11 20:21:13,802 [INFO] - Extracting training cells
[37m2024-08-11 20:21:42,242 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.611, Recall: 0.715, Detected-Cells: 4997
[37m2024-08-11 20:21:42,439 [INFO] - Training epoch stats:     Loss: 0.1325 - F1-Score: 0.9585 - Accuracy-Score: 0.9508 - AUROC: 0.9869 - AP: 0.9873
[37m2024-08-11 20:21:42,904 [INFO] - Validation epoch stats:   Loss: 0.5553 - F1-Score: 0.8063 - Accuracy-Score: 0.7782 - AUROC: 0.8824 - AP: 0.9252
[37m2024-08-11 20:21:42,973 [INFO] - Epoch: 10/50
[37m2024-08-11 20:21:42,979 [INFO] - Extracting training cells
[37m2024-08-11 20:22:11,517 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.612, Recall: 0.709, Detected-Cells: 5047
[37m2024-08-11 20:22:11,704 [INFO] - Training epoch stats:     Loss: 0.1133 - F1-Score: 0.9660 - Accuracy-Score: 0.9592 - AUROC: 0.9907 - AP: 0.9921
[37m2024-08-11 20:22:12,144 [INFO] - Validation epoch stats:   Loss: 0.5590 - F1-Score: 0.8068 - Accuracy-Score: 0.7785 - AUROC: 0.8831 - AP: 0.9260
[37m2024-08-11 20:22:12,206 [INFO] - Epoch: 11/50
[37m2024-08-11 20:22:12,211 [INFO] - Extracting training cells
[37m2024-08-11 20:22:40,197 [INFO] - Extraction detection metrics - F1: 0.611, Precision: 0.602, Recall: 0.698, Detected-Cells: 4966
[37m2024-08-11 20:22:40,388 [INFO] - Training epoch stats:     Loss: 0.1166 - F1-Score: 0.9642 - Accuracy-Score: 0.9567 - AUROC: 0.9908 - AP: 0.9930
[37m2024-08-11 20:22:40,824 [INFO] - Validation epoch stats:   Loss: 0.5780 - F1-Score: 0.8022 - Accuracy-Score: 0.7744 - AUROC: 0.8805 - AP: 0.9249
[37m2024-08-11 20:22:40,886 [INFO] - Epoch: 12/50
[37m2024-08-11 20:22:40,892 [INFO] - Extracting training cells
[37m2024-08-11 20:23:08,756 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.607, Recall: 0.717, Detected-Cells: 5182
[37m2024-08-11 20:23:08,921 [INFO] - Training epoch stats:     Loss: 0.1267 - F1-Score: 0.9630 - Accuracy-Score: 0.9554 - AUROC: 0.9886 - AP: 0.9908
[37m2024-08-11 20:23:09,233 [INFO] - Validation epoch stats:   Loss: 0.5372 - F1-Score: 0.8258 - Accuracy-Score: 0.7941 - AUROC: 0.8820 - AP: 0.9251
[37m2024-08-11 20:23:09,299 [INFO] - Epoch: 13/50
[37m2024-08-11 20:23:09,304 [INFO] - Extracting training cells
[37m2024-08-11 20:23:36,849 [INFO] - Extraction detection metrics - F1: 0.607, Precision: 0.590, Recall: 0.703, Detected-Cells: 5176
[37m2024-08-11 20:23:37,050 [INFO] - Training epoch stats:     Loss: 0.1098 - F1-Score: 0.9668 - Accuracy-Score: 0.9596 - AUROC: 0.9923 - AP: 0.9948
[37m2024-08-11 20:23:37,481 [INFO] - Validation epoch stats:   Loss: 0.5616 - F1-Score: 0.8155 - Accuracy-Score: 0.7820 - AUROC: 0.8711 - AP: 0.9184
[37m2024-08-11 20:23:37,554 [INFO] - Epoch: 14/50
[37m2024-08-11 20:23:37,560 [INFO] - Extracting training cells
[37m2024-08-11 20:24:04,888 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.597, Recall: 0.714, Detected-Cells: 4939
[37m2024-08-11 20:24:05,095 [INFO] - Training epoch stats:     Loss: 0.1055 - F1-Score: 0.9684 - Accuracy-Score: 0.9629 - AUROC: 0.9922 - AP: 0.9923
[37m2024-08-11 20:24:05,550 [INFO] - Validation epoch stats:   Loss: 0.5677 - F1-Score: 0.8208 - Accuracy-Score: 0.7877 - AUROC: 0.8751 - AP: 0.9213
[37m2024-08-11 20:24:05,622 [INFO] - Epoch: 15/50
[37m2024-08-11 20:24:05,628 [INFO] - Extracting training cells
[37m2024-08-11 20:24:33,957 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.608, Recall: 0.715, Detected-Cells: 5139
[37m2024-08-11 20:24:34,184 [INFO] - Training epoch stats:     Loss: 0.0972 - F1-Score: 0.9714 - Accuracy-Score: 0.9654 - AUROC: 0.9929 - AP: 0.9939
[37m2024-08-11 20:24:34,661 [INFO] - Validation epoch stats:   Loss: 0.6204 - F1-Score: 0.7998 - Accuracy-Score: 0.7712 - AUROC: 0.8773 - AP: 0.9229
[37m2024-08-11 20:24:34,728 [INFO] - Epoch: 16/50
[37m2024-08-11 20:24:34,735 [INFO] - Extracting training cells
[37m2024-08-11 20:25:03,236 [INFO] - Extraction detection metrics - F1: 0.609, Precision: 0.593, Recall: 0.701, Detected-Cells: 4942
[37m2024-08-11 20:25:03,439 [INFO] - Training epoch stats:     Loss: 0.0878 - F1-Score: 0.9710 - Accuracy-Score: 0.9648 - AUROC: 0.9953 - AP: 0.9969
[37m2024-08-11 20:25:03,915 [INFO] - Validation epoch stats:   Loss: 0.6180 - F1-Score: 0.8082 - Accuracy-Score: 0.7782 - AUROC: 0.8774 - AP: 0.9229
[37m2024-08-11 20:25:03,978 [INFO] - Epoch: 17/50
[37m2024-08-11 20:25:03,984 [INFO] - Extracting training cells
[37m2024-08-11 20:25:32,362 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.594, Recall: 0.711, Detected-Cells: 5084
[37m2024-08-11 20:25:32,518 [INFO] - Training epoch stats:     Loss: 0.1043 - F1-Score: 0.9673 - Accuracy-Score: 0.9605 - AUROC: 0.9926 - AP: 0.9946
[37m2024-08-11 20:25:32,839 [INFO] - Validation epoch stats:   Loss: 0.6272 - F1-Score: 0.8032 - Accuracy-Score: 0.7735 - AUROC: 0.8735 - AP: 0.9207
[37m2024-08-11 20:25:32,909 [INFO] - Epoch: 18/50
[37m2024-08-11 20:25:32,915 [INFO] - Extracting training cells
[37m2024-08-11 20:26:01,145 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.593, Recall: 0.715, Detected-Cells: 4798
[37m2024-08-11 20:26:01,323 [INFO] - Training epoch stats:     Loss: 0.0950 - F1-Score: 0.9674 - Accuracy-Score: 0.9614 - AUROC: 0.9937 - AP: 0.9944
[37m2024-08-11 20:26:01,747 [INFO] - Validation epoch stats:   Loss: 0.6384 - F1-Score: 0.7993 - Accuracy-Score: 0.7707 - AUROC: 0.8747 - AP: 0.9213
[37m2024-08-11 20:26:01,820 [INFO] - Epoch: 19/50
[37m2024-08-11 20:26:01,826 [INFO] - Extracting training cells
[37m2024-08-11 20:26:29,414 [INFO] - Extraction detection metrics - F1: 0.609, Precision: 0.593, Recall: 0.704, Detected-Cells: 4946
[37m2024-08-11 20:26:29,594 [INFO] - Training epoch stats:     Loss: 0.0951 - F1-Score: 0.9725 - Accuracy-Score: 0.9664 - AUROC: 0.9932 - AP: 0.9944
[37m2024-08-11 20:26:29,992 [INFO] - Validation epoch stats:   Loss: 0.6405 - F1-Score: 0.8038 - Accuracy-Score: 0.7750 - AUROC: 0.8770 - AP: 0.9236
[37m2024-08-11 20:26:30,063 [INFO] - Epoch: 20/50
[37m2024-08-11 20:26:30,069 [INFO] - Extracting training cells
[37m2024-08-11 20:26:57,973 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.592, Recall: 0.710, Detected-Cells: 4790
[37m2024-08-11 20:26:58,158 [INFO] - Training epoch stats:     Loss: 0.1643 - F1-Score: 0.9534 - Accuracy-Score: 0.9445 - AUROC: 0.9806 - AP: 0.9814
[37m2024-08-11 20:26:58,535 [INFO] - Validation epoch stats:   Loss: 0.6062 - F1-Score: 0.8074 - Accuracy-Score: 0.7769 - AUROC: 0.8734 - AP: 0.9213
[37m2024-08-11 20:26:58,597 [INFO] - Epoch: 21/50
[37m2024-08-11 20:26:58,603 [INFO] - Extracting training cells
[37m2024-08-11 20:27:26,185 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.598, Recall: 0.723, Detected-Cells: 5067
[37m2024-08-11 20:27:26,391 [INFO] - Training epoch stats:     Loss: 0.1039 - F1-Score: 0.9705 - Accuracy-Score: 0.9641 - AUROC: 0.9922 - AP: 0.9940
[37m2024-08-11 20:27:26,715 [INFO] - Validation epoch stats:   Loss: 0.6403 - F1-Score: 0.7973 - Accuracy-Score: 0.7689 - AUROC: 0.8738 - AP: 0.9208
[37m2024-08-11 20:27:26,722 [INFO] - Performing early stopping!
[37m2024-08-11 20:27:26,728 [INFO] - Finished run 4htv3qgl
