[37m2024-08-15 07:53:07,322 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-15 07:53:07,323 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/Aug/100/Seed-5/2024-08-15T075258_CellViT-Virchow-100Percent
[37m2024-08-15 07:53:07,382 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f195ac383a0>]
[37m2024-08-15 07:53:07,387 [INFO] - Using GPU: cuda:0
[37m2024-08-15 07:53:07,392 [INFO] - Using device: cuda:0
[37m2024-08-15 07:53:07,397 [INFO] - Loss function:
[37m2024-08-15 07:53:07,402 [INFO] - CrossEntropyLoss()
[37m2024-08-15 07:53:13,276 [INFO] - Loading checkpoint ./checkpoints/CellViT-Virchow-x40-AMP.pth
[37m2024-08-15 07:53:13,387 [INFO] - <All keys matched successfully>
[37m2024-08-15 07:53:14,378 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-15 07:53:14,384 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-15 07:53:14,388 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-15 07:53:14,392 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-15 07:53:14,409 [INFO] - Caching datasets
[37m2024-08-15 07:53:19,064 [INFO] - Instantiate Trainer
[37m2024-08-15 07:53:19,072 [INFO] - Calling Trainer Fit
[37m2024-08-15 07:53:19,076 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-15 07:53:19,080 [INFO] - Epoch: 1/50
[37m2024-08-15 07:53:19,084 [INFO] - Extracting training cells
[37m2024-08-15 07:59:07,906 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.602, Recall: 0.706, Detected-Cells: 43701
[37m2024-08-15 07:59:09,289 [INFO] - Training epoch stats:     Loss: 0.2783 - F1-Score: 0.9061 - Accuracy-Score: 0.8849 - AUROC: 0.9511 - AP: 0.9639
[37m2024-08-15 07:59:13,603 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-15 07:59:14,051 [INFO] - Validation epoch stats:   Loss: 0.3628 - F1-Score: 0.8903 - Accuracy-Score: 0.8605 - AUROC: 0.9233 - AP: 0.9512
[37m2024-08-15 07:59:14,057 [INFO] - New best model - save checkpoint
[37m2024-08-15 07:59:14,243 [INFO] - Epoch: 2/50
[37m2024-08-15 07:59:14,248 [INFO] - Extracting training cells
[37m2024-08-15 08:04:55,549 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.600, Recall: 0.702, Detected-Cells: 43338
[37m2024-08-15 08:04:56,858 [INFO] - Training epoch stats:     Loss: 0.1939 - F1-Score: 0.9387 - Accuracy-Score: 0.9250 - AUROC: 0.9750 - AP: 0.9814
[37m2024-08-15 08:04:57,198 [INFO] - Validation epoch stats:   Loss: 0.4236 - F1-Score: 0.8738 - Accuracy-Score: 0.8438 - AUROC: 0.9121 - AP: 0.9392
[37m2024-08-15 08:04:57,255 [INFO] - Epoch: 3/50
[37m2024-08-15 08:04:57,259 [INFO] - Extracting training cells
[37m2024-08-15 08:10:36,096 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.601, Recall: 0.703, Detected-Cells: 43525
[37m2024-08-15 08:10:37,407 [INFO] - Training epoch stats:     Loss: 0.1648 - F1-Score: 0.9475 - Accuracy-Score: 0.9363 - AUROC: 0.9820 - AP: 0.9866
[37m2024-08-15 08:10:37,744 [INFO] - Validation epoch stats:   Loss: 0.4377 - F1-Score: 0.8746 - Accuracy-Score: 0.8435 - AUROC: 0.9114 - AP: 0.9380
[37m2024-08-15 08:10:37,810 [INFO] - Epoch: 4/50
[37m2024-08-15 08:10:37,814 [INFO] - Extracting training cells
[37m2024-08-15 08:16:23,525 [INFO] - Extraction detection metrics - F1: 0.612, Precision: 0.596, Recall: 0.701, Detected-Cells: 42813
[37m2024-08-15 08:16:25,268 [INFO] - Training epoch stats:     Loss: 0.1486 - F1-Score: 0.9524 - Accuracy-Score: 0.9435 - AUROC: 0.9856 - AP: 0.9890
[37m2024-08-15 08:16:25,777 [INFO] - Validation epoch stats:   Loss: 0.4831 - F1-Score: 0.8596 - Accuracy-Score: 0.8300 - AUROC: 0.9109 - AP: 0.9394
[37m2024-08-15 08:16:25,841 [INFO] - Epoch: 5/50
[37m2024-08-15 08:16:25,846 [INFO] - Extracting training cells
[37m2024-08-15 08:22:09,027 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.602, Recall: 0.705, Detected-Cells: 43011
[37m2024-08-15 08:22:10,828 [INFO] - Training epoch stats:     Loss: 0.1399 - F1-Score: 0.9564 - Accuracy-Score: 0.9472 - AUROC: 0.9869 - AP: 0.9906
[37m2024-08-15 08:22:11,345 [INFO] - Validation epoch stats:   Loss: 0.4808 - F1-Score: 0.8689 - Accuracy-Score: 0.8396 - AUROC: 0.9143 - AP: 0.9432
[37m2024-08-15 08:22:11,409 [INFO] - Epoch: 6/50
[37m2024-08-15 08:22:11,414 [INFO] - Extracting training cells
[37m2024-08-15 08:27:51,426 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.598, Recall: 0.699, Detected-Cells: 42178
[37m2024-08-15 08:27:52,683 [INFO] - Training epoch stats:     Loss: 0.1436 - F1-Score: 0.9549 - Accuracy-Score: 0.9463 - AUROC: 0.9860 - AP: 0.9888
[37m2024-08-15 08:27:53,023 [INFO] - Validation epoch stats:   Loss: 0.4692 - F1-Score: 0.8753 - Accuracy-Score: 0.8451 - AUROC: 0.9132 - AP: 0.9407
[37m2024-08-15 08:27:53,085 [INFO] - Epoch: 7/50
[37m2024-08-15 08:27:53,089 [INFO] - Extracting training cells
[37m2024-08-15 08:33:38,332 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.600, Recall: 0.701, Detected-Cells: 43556
[37m2024-08-15 08:33:40,393 [INFO] - Training epoch stats:     Loss: 0.1217 - F1-Score: 0.9622 - Accuracy-Score: 0.9543 - AUROC: 0.9900 - AP: 0.9924
[37m2024-08-15 08:33:40,786 [INFO] - Validation epoch stats:   Loss: 0.4946 - F1-Score: 0.8667 - Accuracy-Score: 0.8368 - AUROC: 0.9099 - AP: 0.9326
[37m2024-08-15 08:33:40,858 [INFO] - Epoch: 8/50
[37m2024-08-15 08:33:40,863 [INFO] - Extracting training cells
[37m2024-08-15 08:39:23,282 [INFO] - Extraction detection metrics - F1: 0.612, Precision: 0.593, Recall: 0.699, Detected-Cells: 43133
[37m2024-08-15 08:39:24,566 [INFO] - Training epoch stats:     Loss: 0.1127 - F1-Score: 0.9650 - Accuracy-Score: 0.9579 - AUROC: 0.9914 - AP: 0.9932
[37m2024-08-15 08:39:24,902 [INFO] - Validation epoch stats:   Loss: 0.5334 - F1-Score: 0.8571 - Accuracy-Score: 0.8275 - AUROC: 0.9116 - AP: 0.9390
[37m2024-08-15 08:39:24,974 [INFO] - Epoch: 9/50
[37m2024-08-15 08:39:24,979 [INFO] - Extracting training cells
[37m2024-08-15 08:45:08,778 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.595, Recall: 0.702, Detected-Cells: 43384
[37m2024-08-15 08:45:10,446 [INFO] - Training epoch stats:     Loss: 0.1111 - F1-Score: 0.9656 - Accuracy-Score: 0.9588 - AUROC: 0.9915 - AP: 0.9934
[37m2024-08-15 08:45:11,089 [INFO] - Validation epoch stats:   Loss: 0.5176 - F1-Score: 0.8669 - Accuracy-Score: 0.8369 - AUROC: 0.9128 - AP: 0.9411
[37m2024-08-15 08:45:11,154 [INFO] - Epoch: 10/50
[37m2024-08-15 08:45:11,160 [INFO] - Extracting training cells
[37m2024-08-15 08:50:58,080 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.600, Recall: 0.703, Detected-Cells: 43838
[37m2024-08-15 08:50:59,429 [INFO] - Training epoch stats:     Loss: 0.1053 - F1-Score: 0.9688 - Accuracy-Score: 0.9613 - AUROC: 0.9925 - AP: 0.9950
[37m2024-08-15 08:50:59,777 [INFO] - Validation epoch stats:   Loss: 0.4938 - F1-Score: 0.8769 - Accuracy-Score: 0.8484 - AUROC: 0.9181 - AP: 0.9442
[37m2024-08-15 08:50:59,849 [INFO] - Epoch: 11/50
[37m2024-08-15 08:50:59,855 [INFO] - Extracting training cells
[37m2024-08-15 08:56:42,452 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.594, Recall: 0.705, Detected-Cells: 43025
[37m2024-08-15 08:56:43,754 [INFO] - Training epoch stats:     Loss: 0.1034 - F1-Score: 0.9682 - Accuracy-Score: 0.9619 - AUROC: 0.9928 - AP: 0.9947
[37m2024-08-15 08:56:44,094 [INFO] - Validation epoch stats:   Loss: 0.5240 - F1-Score: 0.8681 - Accuracy-Score: 0.8381 - AUROC: 0.9108 - AP: 0.9386
[37m2024-08-15 08:56:44,153 [INFO] - Epoch: 12/50
[37m2024-08-15 08:56:44,158 [INFO] - Extracting training cells
[37m2024-08-15 09:02:28,476 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.599, Recall: 0.702, Detected-Cells: 43295
[37m2024-08-15 09:02:29,987 [INFO] - Training epoch stats:     Loss: 0.1006 - F1-Score: 0.9690 - Accuracy-Score: 0.9628 - AUROC: 0.9930 - AP: 0.9949
[37m2024-08-15 09:02:30,322 [INFO] - Validation epoch stats:   Loss: 0.5418 - F1-Score: 0.8682 - Accuracy-Score: 0.8381 - AUROC: 0.9097 - AP: 0.9369
[37m2024-08-15 09:02:30,392 [INFO] - Epoch: 13/50
[37m2024-08-15 09:02:30,397 [INFO] - Extracting training cells
[37m2024-08-15 09:08:17,438 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.598, Recall: 0.704, Detected-Cells: 43465
[37m2024-08-15 09:08:18,973 [INFO] - Training epoch stats:     Loss: 0.0959 - F1-Score: 0.9710 - Accuracy-Score: 0.9650 - AUROC: 0.9938 - AP: 0.9956
[37m2024-08-15 09:08:19,392 [INFO] - Validation epoch stats:   Loss: 0.5268 - F1-Score: 0.8700 - Accuracy-Score: 0.8403 - AUROC: 0.9136 - AP: 0.9414
[37m2024-08-15 09:08:19,473 [INFO] - Epoch: 14/50
[37m2024-08-15 09:08:19,477 [INFO] - Extracting training cells
[37m2024-08-15 09:14:03,235 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.602, Recall: 0.705, Detected-Cells: 43297
[37m2024-08-15 09:14:04,523 [INFO] - Training epoch stats:     Loss: 0.0845 - F1-Score: 0.9738 - Accuracy-Score: 0.9681 - AUROC: 0.9952 - AP: 0.9967
[37m2024-08-15 09:14:04,863 [INFO] - Validation epoch stats:   Loss: 0.5583 - F1-Score: 0.8710 - Accuracy-Score: 0.8418 - AUROC: 0.9139 - AP: 0.9388
[37m2024-08-15 09:14:04,934 [INFO] - Epoch: 15/50
[37m2024-08-15 09:14:04,939 [INFO] - Extracting training cells
[37m2024-08-15 09:19:47,303 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.595, Recall: 0.701, Detected-Cells: 42729
[37m2024-08-15 09:19:48,705 [INFO] - Training epoch stats:     Loss: 0.0977 - F1-Score: 0.9709 - Accuracy-Score: 0.9648 - AUROC: 0.9930 - AP: 0.9946
[37m2024-08-15 09:19:49,231 [INFO] - Validation epoch stats:   Loss: 0.5848 - F1-Score: 0.8675 - Accuracy-Score: 0.8370 - AUROC: 0.9064 - AP: 0.9315
[37m2024-08-15 09:19:49,311 [INFO] - Epoch: 16/50
[37m2024-08-15 09:19:49,317 [INFO] - Extracting training cells
[37m2024-08-15 09:25:34,816 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.597, Recall: 0.700, Detected-Cells: 43005
[37m2024-08-15 09:25:36,527 [INFO] - Training epoch stats:     Loss: 0.0925 - F1-Score: 0.9730 - Accuracy-Score: 0.9674 - AUROC: 0.9940 - AP: 0.9955
[37m2024-08-15 09:25:37,020 [INFO] - Validation epoch stats:   Loss: 0.5449 - F1-Score: 0.8808 - Accuracy-Score: 0.8510 - AUROC: 0.9141 - AP: 0.9390
[37m2024-08-15 09:25:37,098 [INFO] - Epoch: 17/50
[37m2024-08-15 09:25:37,102 [INFO] - Extracting training cells
[37m2024-08-15 09:31:20,743 [INFO] - Extraction detection metrics - F1: 0.610, Precision: 0.591, Recall: 0.692, Detected-Cells: 43485
[37m2024-08-15 09:31:22,039 [INFO] - Training epoch stats:     Loss: 0.0806 - F1-Score: 0.9760 - Accuracy-Score: 0.9708 - AUROC: 0.9956 - AP: 0.9969
[37m2024-08-15 09:31:22,380 [INFO] - Validation epoch stats:   Loss: 0.5693 - F1-Score: 0.8774 - Accuracy-Score: 0.8480 - AUROC: 0.9112 - AP: 0.9352
[37m2024-08-15 09:31:22,458 [INFO] - Epoch: 18/50
[37m2024-08-15 09:31:22,463 [INFO] - Extracting training cells
[37m2024-08-15 09:37:07,652 [INFO] - Extraction detection metrics - F1: 0.611, Precision: 0.588, Recall: 0.696, Detected-Cells: 42413
[37m2024-08-15 09:37:08,934 [INFO] - Training epoch stats:     Loss: 0.0828 - F1-Score: 0.9752 - Accuracy-Score: 0.9701 - AUROC: 0.9954 - AP: 0.9966
[37m2024-08-15 09:37:09,417 [INFO] - Validation epoch stats:   Loss: 0.5996 - F1-Score: 0.8677 - Accuracy-Score: 0.8382 - AUROC: 0.9087 - AP: 0.9337
[37m2024-08-15 09:37:09,490 [INFO] - Epoch: 19/50
[37m2024-08-15 09:37:09,495 [INFO] - Extracting training cells
[37m2024-08-15 09:42:52,985 [INFO] - Extraction detection metrics - F1: 0.611, Precision: 0.593, Recall: 0.697, Detected-Cells: 43044
[37m2024-08-15 09:42:54,781 [INFO] - Training epoch stats:     Loss: 0.0817 - F1-Score: 0.9753 - Accuracy-Score: 0.9703 - AUROC: 0.9955 - AP: 0.9968
[37m2024-08-15 09:42:55,248 [INFO] - Validation epoch stats:   Loss: 0.5870 - F1-Score: 0.8721 - Accuracy-Score: 0.8427 - AUROC: 0.9112 - AP: 0.9365
[37m2024-08-15 09:42:55,306 [INFO] - Epoch: 20/50
[37m2024-08-15 09:42:55,311 [INFO] - Extracting training cells
[37m2024-08-15 09:48:39,591 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.599, Recall: 0.705, Detected-Cells: 44137
[37m2024-08-15 09:48:40,918 [INFO] - Training epoch stats:     Loss: 0.0857 - F1-Score: 0.9751 - Accuracy-Score: 0.9701 - AUROC: 0.9948 - AP: 0.9961
[37m2024-08-15 09:48:41,363 [INFO] - Validation epoch stats:   Loss: 0.5887 - F1-Score: 0.8686 - Accuracy-Score: 0.8392 - AUROC: 0.9113 - AP: 0.9371
[37m2024-08-15 09:48:41,442 [INFO] - Epoch: 21/50
[37m2024-08-15 09:48:41,448 [INFO] - Extracting training cells
[37m2024-08-15 09:54:21,945 [INFO] - Extraction detection metrics - F1: 0.611, Precision: 0.597, Recall: 0.698, Detected-Cells: 42814
[37m2024-08-15 09:54:23,238 [INFO] - Training epoch stats:     Loss: 0.0804 - F1-Score: 0.9754 - Accuracy-Score: 0.9705 - AUROC: 0.9955 - AP: 0.9967
[37m2024-08-15 09:54:23,577 [INFO] - Validation epoch stats:   Loss: 0.5883 - F1-Score: 0.8774 - Accuracy-Score: 0.8477 - AUROC: 0.9094 - AP: 0.9327
[37m2024-08-15 09:54:23,582 [INFO] - Performing early stopping!
[37m2024-08-15 09:54:23,588 [INFO] - Finished run 9ud0z2us
