[37m2024-08-12 03:45:55,193 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-12 03:45:55,195 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/Aug/100/Seed-2/2024-08-12T034542_CellViT-Virchow-100Percent
[37m2024-08-12 03:45:55,268 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fa73e7e41c0>]
[37m2024-08-12 03:45:55,274 [INFO] - Using GPU: cuda:0
[37m2024-08-12 03:45:55,280 [INFO] - Using device: cuda:0
[37m2024-08-12 03:45:55,286 [INFO] - Loss function:
[37m2024-08-12 03:45:55,291 [INFO] - CrossEntropyLoss()
[37m2024-08-12 03:46:04,460 [INFO] - <All keys matched successfully>
[37m2024-08-12 03:46:05,510 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-12 03:46:05,518 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-12 03:46:05,523 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-12 03:46:05,528 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-12 03:46:05,549 [INFO] - Caching datasets
[37m2024-08-12 03:46:12,722 [INFO] - Instantiate Trainer
[37m2024-08-12 03:46:12,730 [INFO] - Calling Trainer Fit
[37m2024-08-12 03:46:12,738 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-12 03:46:12,753 [INFO] - Epoch: 1/50
[37m2024-08-12 03:46:12,760 [INFO] - Extracting training cells
[37m2024-08-12 03:50:10,890 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.598, Recall: 0.706, Detected-Cells: 43672
[37m2024-08-12 03:50:12,289 [INFO] - Training epoch stats:     Loss: 0.2729 - F1-Score: 0.9078 - Accuracy-Score: 0.8870 - AUROC: 0.9528 - AP: 0.9647
[37m2024-08-12 03:50:16,541 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-12 03:50:16,843 [INFO] - Validation epoch stats:   Loss: 0.3944 - F1-Score: 0.8825 - Accuracy-Score: 0.8530 - AUROC: 0.9138 - AP: 0.9375
[37m2024-08-12 03:50:16,850 [INFO] - New best model - save checkpoint
[37m2024-08-12 03:50:17,037 [INFO] - Epoch: 2/50
[37m2024-08-12 03:50:17,046 [INFO] - Extracting training cells
[37m2024-08-12 03:54:07,911 [INFO] - Extraction detection metrics - F1: 0.607, Precision: 0.588, Recall: 0.695, Detected-Cells: 42500
[37m2024-08-12 03:54:09,554 [INFO] - Training epoch stats:     Loss: 0.1880 - F1-Score: 0.9382 - Accuracy-Score: 0.9264 - AUROC: 0.9772 - AP: 0.9828
[37m2024-08-12 03:54:09,894 [INFO] - Validation epoch stats:   Loss: 0.4248 - F1-Score: 0.8727 - Accuracy-Score: 0.8427 - AUROC: 0.9145 - AP: 0.9446
[37m2024-08-12 03:54:09,901 [INFO] - New best model - save checkpoint
[37m2024-08-12 03:54:10,086 [INFO] - Epoch: 3/50
[37m2024-08-12 03:54:10,092 [INFO] - Extracting training cells
[37m2024-08-12 03:58:05,357 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.597, Recall: 0.708, Detected-Cells: 43570
[37m2024-08-12 03:58:06,866 [INFO] - Training epoch stats:     Loss: 0.1637 - F1-Score: 0.9485 - Accuracy-Score: 0.9381 - AUROC: 0.9823 - AP: 0.9866
[37m2024-08-12 03:58:07,384 [INFO] - Validation epoch stats:   Loss: 0.4497 - F1-Score: 0.8698 - Accuracy-Score: 0.8398 - AUROC: 0.9131 - AP: 0.9444
[37m2024-08-12 03:58:07,463 [INFO] - Epoch: 4/50
[37m2024-08-12 03:58:07,468 [INFO] - Extracting training cells
[37m2024-08-12 04:01:59,334 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.598, Recall: 0.699, Detected-Cells: 42664
[37m2024-08-12 04:02:00,713 [INFO] - Training epoch stats:     Loss: 0.1496 - F1-Score: 0.9529 - Accuracy-Score: 0.9426 - AUROC: 0.9850 - AP: 0.9890
[37m2024-08-12 04:02:01,084 [INFO] - Validation epoch stats:   Loss: 0.4724 - F1-Score: 0.8634 - Accuracy-Score: 0.8325 - AUROC: 0.9094 - AP: 0.9414
[37m2024-08-12 04:02:01,156 [INFO] - Epoch: 5/50
[37m2024-08-12 04:02:01,162 [INFO] - Extracting training cells
[37m2024-08-12 04:05:55,254 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.597, Recall: 0.700, Detected-Cells: 42827
[37m2024-08-12 04:05:57,065 [INFO] - Training epoch stats:     Loss: 0.1458 - F1-Score: 0.9552 - Accuracy-Score: 0.9455 - AUROC: 0.9858 - AP: 0.9898
[37m2024-08-12 04:05:57,658 [INFO] - Validation epoch stats:   Loss: 0.4855 - F1-Score: 0.8591 - Accuracy-Score: 0.8298 - AUROC: 0.9110 - AP: 0.9433
[37m2024-08-12 04:05:57,732 [INFO] - Epoch: 6/50
[37m2024-08-12 04:05:57,738 [INFO] - Extracting training cells
[37m2024-08-12 04:09:51,875 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.601, Recall: 0.701, Detected-Cells: 43066
[37m2024-08-12 04:09:53,255 [INFO] - Training epoch stats:     Loss: 0.1310 - F1-Score: 0.9603 - Accuracy-Score: 0.9512 - AUROC: 0.9885 - AP: 0.9917
[37m2024-08-12 04:09:53,721 [INFO] - Validation epoch stats:   Loss: 0.4555 - F1-Score: 0.8899 - Accuracy-Score: 0.8604 - AUROC: 0.9150 - AP: 0.9407
[37m2024-08-12 04:09:53,728 [INFO] - New best model - save checkpoint
[37m2024-08-12 04:09:53,907 [INFO] - Epoch: 7/50
[37m2024-08-12 04:09:53,912 [INFO] - Extracting training cells
[37m2024-08-12 04:13:44,059 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.599, Recall: 0.700, Detected-Cells: 43209
[37m2024-08-12 04:13:45,631 [INFO] - Training epoch stats:     Loss: 0.1244 - F1-Score: 0.9615 - Accuracy-Score: 0.9533 - AUROC: 0.9896 - AP: 0.9923
[37m2024-08-12 04:13:45,990 [INFO] - Validation epoch stats:   Loss: 0.4643 - F1-Score: 0.8827 - Accuracy-Score: 0.8539 - AUROC: 0.9178 - AP: 0.9445
[37m2024-08-12 04:13:45,991 [INFO] - New best model - save checkpoint
[37m2024-08-12 04:13:46,167 [INFO] - Epoch: 8/50
[37m2024-08-12 04:13:46,173 [INFO] - Extracting training cells
[37m2024-08-12 04:17:43,520 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.598, Recall: 0.700, Detected-Cells: 43050
[37m2024-08-12 04:17:45,156 [INFO] - Training epoch stats:     Loss: 0.1180 - F1-Score: 0.9637 - Accuracy-Score: 0.9557 - AUROC: 0.9904 - AP: 0.9931
[37m2024-08-12 04:17:45,566 [INFO] - Validation epoch stats:   Loss: 0.5020 - F1-Score: 0.8728 - Accuracy-Score: 0.8433 - AUROC: 0.9127 - AP: 0.9405
[37m2024-08-12 04:17:45,639 [INFO] - Epoch: 9/50
[37m2024-08-12 04:17:45,645 [INFO] - Extracting training cells
[37m2024-08-12 04:21:42,056 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.597, Recall: 0.701, Detected-Cells: 42827
[37m2024-08-12 04:21:43,556 [INFO] - Training epoch stats:     Loss: 0.1111 - F1-Score: 0.9637 - Accuracy-Score: 0.9565 - AUROC: 0.9918 - AP: 0.9939
[37m2024-08-12 04:21:43,972 [INFO] - Validation epoch stats:   Loss: 0.5370 - F1-Score: 0.8673 - Accuracy-Score: 0.8372 - AUROC: 0.9100 - AP: 0.9366
[37m2024-08-12 04:21:44,059 [INFO] - Epoch: 10/50
[37m2024-08-12 04:21:44,065 [INFO] - Extracting training cells
[37m2024-08-12 04:25:37,385 [INFO] - Extraction detection metrics - F1: 0.611, Precision: 0.590, Recall: 0.702, Detected-Cells: 42746
[37m2024-08-12 04:25:38,859 [INFO] - Training epoch stats:     Loss: 0.1140 - F1-Score: 0.9647 - Accuracy-Score: 0.9572 - AUROC: 0.9911 - AP: 0.9936
[37m2024-08-12 04:25:39,207 [INFO] - Validation epoch stats:   Loss: 0.5101 - F1-Score: 0.8779 - Accuracy-Score: 0.8484 - AUROC: 0.9111 - AP: 0.9370
[37m2024-08-12 04:25:39,278 [INFO] - Epoch: 11/50
[37m2024-08-12 04:25:39,283 [INFO] - Extracting training cells
[37m2024-08-12 04:29:35,732 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.598, Recall: 0.704, Detected-Cells: 43136
[37m2024-08-12 04:29:37,669 [INFO] - Training epoch stats:     Loss: 0.1000 - F1-Score: 0.9694 - Accuracy-Score: 0.9631 - AUROC: 0.9932 - AP: 0.9949
[37m2024-08-12 04:29:38,190 [INFO] - Validation epoch stats:   Loss: 0.5618 - F1-Score: 0.8656 - Accuracy-Score: 0.8357 - AUROC: 0.9047 - AP: 0.9314
[37m2024-08-12 04:29:38,275 [INFO] - Epoch: 12/50
[37m2024-08-12 04:29:38,281 [INFO] - Extracting training cells
[37m2024-08-12 04:33:32,793 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.596, Recall: 0.702, Detected-Cells: 43219
[37m2024-08-12 04:33:34,280 [INFO] - Training epoch stats:     Loss: 0.0960 - F1-Score: 0.9698 - Accuracy-Score: 0.9638 - AUROC: 0.9939 - AP: 0.9956
[37m2024-08-12 04:33:34,889 [INFO] - Validation epoch stats:   Loss: 0.5338 - F1-Score: 0.8747 - Accuracy-Score: 0.8454 - AUROC: 0.9102 - AP: 0.9375
[37m2024-08-12 04:33:34,957 [INFO] - Epoch: 13/50
[37m2024-08-12 04:33:34,962 [INFO] - Extracting training cells
[37m2024-08-12 04:37:27,715 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.606, Recall: 0.708, Detected-Cells: 43607
[37m2024-08-12 04:37:29,360 [INFO] - Training epoch stats:     Loss: 0.0936 - F1-Score: 0.9710 - Accuracy-Score: 0.9649 - AUROC: 0.9942 - AP: 0.9957
[37m2024-08-12 04:37:29,870 [INFO] - Validation epoch stats:   Loss: 0.5469 - F1-Score: 0.8768 - Accuracy-Score: 0.8475 - AUROC: 0.9127 - AP: 0.9364
[37m2024-08-12 04:37:29,952 [INFO] - Epoch: 14/50
[37m2024-08-12 04:37:29,959 [INFO] - Extracting training cells
[37m2024-08-12 04:41:28,134 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.599, Recall: 0.700, Detected-Cells: 42562
[37m2024-08-12 04:41:29,469 [INFO] - Training epoch stats:     Loss: 0.0946 - F1-Score: 0.9707 - Accuracy-Score: 0.9643 - AUROC: 0.9940 - AP: 0.9957
[37m2024-08-12 04:41:29,922 [INFO] - Validation epoch stats:   Loss: 0.5637 - F1-Score: 0.8737 - Accuracy-Score: 0.8441 - AUROC: 0.9086 - AP: 0.9313
[37m2024-08-12 04:41:29,991 [INFO] - Epoch: 15/50
[37m2024-08-12 04:41:29,997 [INFO] - Extracting training cells
[37m2024-08-12 04:45:26,355 [INFO] - Extraction detection metrics - F1: 0.610, Precision: 0.592, Recall: 0.701, Detected-Cells: 42935
[37m2024-08-12 04:45:27,591 [INFO] - Training epoch stats:     Loss: 0.0923 - F1-Score: 0.9718 - Accuracy-Score: 0.9662 - AUROC: 0.9942 - AP: 0.9957
[37m2024-08-12 04:45:27,998 [INFO] - Validation epoch stats:   Loss: 0.5742 - F1-Score: 0.8602 - Accuracy-Score: 0.8300 - AUROC: 0.9080 - AP: 0.9348
[37m2024-08-12 04:45:28,061 [INFO] - Epoch: 16/50
[37m2024-08-12 04:45:28,066 [INFO] - Extracting training cells
[37m2024-08-12 04:49:23,744 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.596, Recall: 0.704, Detected-Cells: 43295
[37m2024-08-12 04:49:25,371 [INFO] - Training epoch stats:     Loss: 0.0977 - F1-Score: 0.9702 - Accuracy-Score: 0.9643 - AUROC: 0.9933 - AP: 0.9946
[37m2024-08-12 04:49:25,888 [INFO] - Validation epoch stats:   Loss: 0.5665 - F1-Score: 0.8666 - Accuracy-Score: 0.8369 - AUROC: 0.9086 - AP: 0.9333
[37m2024-08-12 04:49:25,954 [INFO] - Epoch: 17/50
[37m2024-08-12 04:49:25,960 [INFO] - Extracting training cells
[37m2024-08-12 04:53:19,523 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.598, Recall: 0.698, Detected-Cells: 43364
[37m2024-08-12 04:53:20,871 [INFO] - Training epoch stats:     Loss: 0.0867 - F1-Score: 0.9743 - Accuracy-Score: 0.9690 - AUROC: 0.9947 - AP: 0.9960
[37m2024-08-12 04:53:21,208 [INFO] - Validation epoch stats:   Loss: 0.5571 - F1-Score: 0.8738 - Accuracy-Score: 0.8443 - AUROC: 0.9102 - AP: 0.9334
[37m2024-08-12 04:53:21,278 [INFO] - Epoch: 18/50
[37m2024-08-12 04:53:21,284 [INFO] - Extracting training cells
[37m2024-08-12 04:57:13,135 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.600, Recall: 0.700, Detected-Cells: 42998
[37m2024-08-12 04:57:14,770 [INFO] - Training epoch stats:     Loss: 0.0809 - F1-Score: 0.9755 - Accuracy-Score: 0.9706 - AUROC: 0.9956 - AP: 0.9967
[37m2024-08-12 04:57:15,312 [INFO] - Validation epoch stats:   Loss: 0.5621 - F1-Score: 0.8765 - Accuracy-Score: 0.8467 - AUROC: 0.9099 - AP: 0.9313
[37m2024-08-12 04:57:15,382 [INFO] - Epoch: 19/50
[37m2024-08-12 04:57:15,388 [INFO] - Extracting training cells
[37m2024-08-12 05:01:07,332 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.603, Recall: 0.714, Detected-Cells: 44353
[37m2024-08-12 05:01:09,266 [INFO] - Training epoch stats:     Loss: 0.0804 - F1-Score: 0.9758 - Accuracy-Score: 0.9709 - AUROC: 0.9956 - AP: 0.9968
[37m2024-08-12 05:01:09,764 [INFO] - Validation epoch stats:   Loss: 0.5696 - F1-Score: 0.8769 - Accuracy-Score: 0.8467 - AUROC: 0.9100 - AP: 0.9343
[37m2024-08-12 05:01:09,839 [INFO] - Epoch: 20/50
[37m2024-08-12 05:01:09,845 [INFO] - Extracting training cells
[37m2024-08-12 05:05:09,344 [INFO] - Extraction detection metrics - F1: 0.609, Precision: 0.593, Recall: 0.695, Detected-Cells: 42075
[37m2024-08-12 05:05:10,875 [INFO] - Training epoch stats:     Loss: 0.0808 - F1-Score: 0.9759 - Accuracy-Score: 0.9714 - AUROC: 0.9953 - AP: 0.9963
[37m2024-08-12 05:05:11,391 [INFO] - Validation epoch stats:   Loss: 0.6018 - F1-Score: 0.8663 - Accuracy-Score: 0.8368 - AUROC: 0.9095 - AP: 0.9335
[37m2024-08-12 05:05:11,457 [INFO] - Epoch: 21/50
[37m2024-08-12 05:05:11,463 [INFO] - Extracting training cells
[37m2024-08-12 05:09:05,122 [INFO] - Extraction detection metrics - F1: 0.612, Precision: 0.594, Recall: 0.698, Detected-Cells: 42476
[37m2024-08-12 05:09:06,465 [INFO] - Training epoch stats:     Loss: 0.0797 - F1-Score: 0.9774 - Accuracy-Score: 0.9721 - AUROC: 0.9956 - AP: 0.9970
[37m2024-08-12 05:09:06,803 [INFO] - Validation epoch stats:   Loss: 0.5911 - F1-Score: 0.8733 - Accuracy-Score: 0.8436 - AUROC: 0.9072 - AP: 0.9294
[37m2024-08-12 05:09:06,863 [INFO] - Epoch: 22/50
[37m2024-08-12 05:09:06,869 [INFO] - Extracting training cells
[37m2024-08-12 05:12:59,783 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.598, Recall: 0.702, Detected-Cells: 43364
[37m2024-08-12 05:13:01,168 [INFO] - Training epoch stats:     Loss: 0.0693 - F1-Score: 0.9794 - Accuracy-Score: 0.9753 - AUROC: 0.9968 - AP: 0.9976
[37m2024-08-12 05:13:01,706 [INFO] - Validation epoch stats:   Loss: 0.6128 - F1-Score: 0.8681 - Accuracy-Score: 0.8388 - AUROC: 0.9076 - AP: 0.9297
[37m2024-08-12 05:13:01,781 [INFO] - Epoch: 23/50
[37m2024-08-12 05:13:01,787 [INFO] - Extracting training cells
[37m2024-08-12 05:16:55,027 [INFO] - Extraction detection metrics - F1: 0.611, Precision: 0.596, Recall: 0.701, Detected-Cells: 42473
[37m2024-08-12 05:16:56,350 [INFO] - Training epoch stats:     Loss: 0.0781 - F1-Score: 0.9771 - Accuracy-Score: 0.9723 - AUROC: 0.9959 - AP: 0.9970
[37m2024-08-12 05:16:56,688 [INFO] - Validation epoch stats:   Loss: 0.5944 - F1-Score: 0.8734 - Accuracy-Score: 0.8431 - AUROC: 0.9061 - AP: 0.9296
[37m2024-08-12 05:16:56,756 [INFO] - Epoch: 24/50
[37m2024-08-12 05:16:56,762 [INFO] - Extracting training cells
[37m2024-08-12 05:20:50,984 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.605, Recall: 0.706, Detected-Cells: 43250
[37m2024-08-12 05:20:52,675 [INFO] - Training epoch stats:     Loss: 0.0821 - F1-Score: 0.9758 - Accuracy-Score: 0.9711 - AUROC: 0.9952 - AP: 0.9962
[37m2024-08-12 05:20:53,184 [INFO] - Validation epoch stats:   Loss: 0.5792 - F1-Score: 0.8756 - Accuracy-Score: 0.8459 - AUROC: 0.9084 - AP: 0.9298
[37m2024-08-12 05:20:53,263 [INFO] - Epoch: 25/50
[37m2024-08-12 05:20:53,271 [INFO] - Extracting training cells
[37m2024-08-12 05:24:49,543 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.599, Recall: 0.704, Detected-Cells: 43286
[37m2024-08-12 05:24:50,917 [INFO] - Training epoch stats:     Loss: 0.0738 - F1-Score: 0.9783 - Accuracy-Score: 0.9740 - AUROC: 0.9963 - AP: 0.9974
[37m2024-08-12 05:24:51,298 [INFO] - Validation epoch stats:   Loss: 0.5736 - F1-Score: 0.8817 - Accuracy-Score: 0.8522 - AUROC: 0.9108 - AP: 0.9330
[37m2024-08-12 05:24:51,369 [INFO] - Epoch: 26/50
[37m2024-08-12 05:24:51,378 [INFO] - Extracting training cells
[37m2024-08-12 05:28:47,371 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.596, Recall: 0.707, Detected-Cells: 43654
[37m2024-08-12 05:28:49,066 [INFO] - Training epoch stats:     Loss: 0.0686 - F1-Score: 0.9806 - Accuracy-Score: 0.9764 - AUROC: 0.9968 - AP: 0.9978
[37m2024-08-12 05:28:49,628 [INFO] - Validation epoch stats:   Loss: 0.5872 - F1-Score: 0.8776 - Accuracy-Score: 0.8484 - AUROC: 0.9108 - AP: 0.9325
[37m2024-08-12 05:28:49,695 [INFO] - Epoch: 27/50
[37m2024-08-12 05:28:49,701 [INFO] - Extracting training cells
[37m2024-08-12 05:32:47,239 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.597, Recall: 0.706, Detected-Cells: 43343
[37m2024-08-12 05:32:49,171 [INFO] - Training epoch stats:     Loss: 0.0677 - F1-Score: 0.9802 - Accuracy-Score: 0.9763 - AUROC: 0.9967 - AP: 0.9974
[37m2024-08-12 05:32:49,711 [INFO] - Validation epoch stats:   Loss: 0.5979 - F1-Score: 0.8747 - Accuracy-Score: 0.8451 - AUROC: 0.9096 - AP: 0.9322
[37m2024-08-12 05:32:49,718 [INFO] - Performing early stopping!
[37m2024-08-12 05:32:49,727 [INFO] - Finished run fn1d1l8d
