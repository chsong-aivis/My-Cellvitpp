[37m2024-08-12 01:32:48,884 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-12 01:32:48,886 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/Aug/25/Seed-2/2024-08-12T013238_CellViT-Virchow-25Percent
[37m2024-08-12 01:32:48,961 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f1423d3c1c0>]
[37m2024-08-12 01:32:48,968 [INFO] - Using GPU: cuda:0
[37m2024-08-12 01:32:48,973 [INFO] - Using device: cuda:0
[37m2024-08-12 01:32:48,979 [INFO] - Loss function:
[37m2024-08-12 01:32:48,984 [INFO] - CrossEntropyLoss()
[37m2024-08-12 01:32:58,080 [INFO] - <All keys matched successfully>
[37m2024-08-12 01:32:59,460 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-12 01:32:59,463 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-12 01:32:59,468 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-12 01:32:59,474 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-12 01:32:59,494 [INFO] - Caching datasets
[37m2024-08-12 01:33:02,076 [INFO] - Instantiate Trainer
[37m2024-08-12 01:33:02,090 [INFO] - Calling Trainer Fit
[37m2024-08-12 01:33:02,095 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-12 01:33:02,100 [INFO] - Epoch: 1/50
[37m2024-08-12 01:33:02,106 [INFO] - Extracting training cells
[37m2024-08-12 01:34:11,707 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.602, Recall: 0.706, Detected-Cells: 11950
[37m2024-08-12 01:34:12,180 [INFO] - Training epoch stats:     Loss: 0.3166 - F1-Score: 0.9009 - Accuracy-Score: 0.8727 - AUROC: 0.9413 - AP: 0.9583
[37m2024-08-12 01:34:16,221 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-12 01:34:16,649 [INFO] - Validation epoch stats:   Loss: 0.4126 - F1-Score: 0.8653 - Accuracy-Score: 0.8361 - AUROC: 0.9057 - AP: 0.9372
[37m2024-08-12 01:34:16,656 [INFO] - New best model - save checkpoint
[37m2024-08-12 01:34:16,852 [INFO] - Epoch: 2/50
[37m2024-08-12 01:34:16,859 [INFO] - Extracting training cells
[37m2024-08-12 01:35:18,959 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.589, Recall: 0.705, Detected-Cells: 11877
[37m2024-08-12 01:35:19,453 [INFO] - Training epoch stats:     Loss: 0.1699 - F1-Score: 0.9506 - Accuracy-Score: 0.9366 - AUROC: 0.9802 - AP: 0.9872
[37m2024-08-12 01:35:19,922 [INFO] - Validation epoch stats:   Loss: 0.4254 - F1-Score: 0.8751 - Accuracy-Score: 0.8434 - AUROC: 0.9001 - AP: 0.9272
[37m2024-08-12 01:35:19,994 [INFO] - Epoch: 3/50
[37m2024-08-12 01:35:20,000 [INFO] - Extracting training cells
[37m2024-08-12 01:36:22,190 [INFO] - Extraction detection metrics - F1: 0.627, Precision: 0.608, Recall: 0.703, Detected-Cells: 12420
[37m2024-08-12 01:36:22,584 [INFO] - Training epoch stats:     Loss: 0.1570 - F1-Score: 0.9528 - Accuracy-Score: 0.9411 - AUROC: 0.9829 - AP: 0.9882
[37m2024-08-12 01:36:22,883 [INFO] - Validation epoch stats:   Loss: 0.4259 - F1-Score: 0.8801 - Accuracy-Score: 0.8494 - AUROC: 0.9045 - AP: 0.9315
[37m2024-08-12 01:36:22,948 [INFO] - Epoch: 4/50
[37m2024-08-12 01:36:22,953 [INFO] - Extracting training cells
[37m2024-08-12 01:37:26,272 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.592, Recall: 0.708, Detected-Cells: 12321
[37m2024-08-12 01:37:26,669 [INFO] - Training epoch stats:     Loss: 0.1358 - F1-Score: 0.9593 - Accuracy-Score: 0.9495 - AUROC: 0.9874 - AP: 0.9912
[37m2024-08-12 01:37:26,976 [INFO] - Validation epoch stats:   Loss: 0.4778 - F1-Score: 0.8581 - Accuracy-Score: 0.8286 - AUROC: 0.9038 - AP: 0.9328
[37m2024-08-12 01:37:27,039 [INFO] - Epoch: 5/50
[37m2024-08-12 01:37:27,044 [INFO] - Extracting training cells
[37m2024-08-12 01:38:28,515 [INFO] - Extraction detection metrics - F1: 0.629, Precision: 0.605, Recall: 0.716, Detected-Cells: 12110
[37m2024-08-12 01:38:29,012 [INFO] - Training epoch stats:     Loss: 0.1374 - F1-Score: 0.9588 - Accuracy-Score: 0.9486 - AUROC: 0.9874 - AP: 0.9915
[37m2024-08-12 01:38:29,481 [INFO] - Validation epoch stats:   Loss: 0.5046 - F1-Score: 0.8512 - Accuracy-Score: 0.8206 - AUROC: 0.8958 - AP: 0.9265
[37m2024-08-12 01:38:29,555 [INFO] - Epoch: 6/50
[37m2024-08-12 01:38:29,561 [INFO] - Extracting training cells
[37m2024-08-12 01:39:33,498 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.603, Recall: 0.701, Detected-Cells: 12226
[37m2024-08-12 01:39:33,892 [INFO] - Training epoch stats:     Loss: 0.1274 - F1-Score: 0.9621 - Accuracy-Score: 0.9522 - AUROC: 0.9886 - AP: 0.9921
[37m2024-08-12 01:39:34,205 [INFO] - Validation epoch stats:   Loss: 0.5103 - F1-Score: 0.8535 - Accuracy-Score: 0.8233 - AUROC: 0.8986 - AP: 0.9292
[37m2024-08-12 01:39:34,268 [INFO] - Epoch: 7/50
[37m2024-08-12 01:39:34,273 [INFO] - Extracting training cells
[37m2024-08-12 01:40:35,730 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.596, Recall: 0.702, Detected-Cells: 12051
[37m2024-08-12 01:40:36,117 [INFO] - Training epoch stats:     Loss: 0.1188 - F1-Score: 0.9650 - Accuracy-Score: 0.9557 - AUROC: 0.9899 - AP: 0.9933
[37m2024-08-12 01:40:36,507 [INFO] - Validation epoch stats:   Loss: 0.5249 - F1-Score: 0.8489 - Accuracy-Score: 0.8188 - AUROC: 0.8966 - AP: 0.9278
[37m2024-08-12 01:40:36,575 [INFO] - Epoch: 8/50
[37m2024-08-12 01:40:36,581 [INFO] - Extracting training cells
[37m2024-08-12 01:41:38,394 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.603, Recall: 0.709, Detected-Cells: 12169
[37m2024-08-12 01:41:38,795 [INFO] - Training epoch stats:     Loss: 0.1055 - F1-Score: 0.9682 - Accuracy-Score: 0.9598 - AUROC: 0.9925 - AP: 0.9954
[37m2024-08-12 01:41:39,113 [INFO] - Validation epoch stats:   Loss: 0.5129 - F1-Score: 0.8608 - Accuracy-Score: 0.8298 - AUROC: 0.8980 - AP: 0.9290
[37m2024-08-12 01:41:39,181 [INFO] - Epoch: 9/50
[37m2024-08-12 01:41:39,186 [INFO] - Extracting training cells
[37m2024-08-12 01:42:41,006 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.600, Recall: 0.706, Detected-Cells: 11932
[37m2024-08-12 01:42:41,385 [INFO] - Training epoch stats:     Loss: 0.1122 - F1-Score: 0.9650 - Accuracy-Score: 0.9569 - AUROC: 0.9916 - AP: 0.9939
[37m2024-08-12 01:42:41,770 [INFO] - Validation epoch stats:   Loss: 0.5313 - F1-Score: 0.8526 - Accuracy-Score: 0.8230 - AUROC: 0.8994 - AP: 0.9303
[37m2024-08-12 01:42:41,842 [INFO] - Epoch: 10/50
[37m2024-08-12 01:42:41,847 [INFO] - Extracting training cells
[37m2024-08-12 01:43:43,981 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.598, Recall: 0.703, Detected-Cells: 11949
[37m2024-08-12 01:43:44,353 [INFO] - Training epoch stats:     Loss: 0.1246 - F1-Score: 0.9622 - Accuracy-Score: 0.9531 - AUROC: 0.9889 - AP: 0.9924
[37m2024-08-12 01:43:44,678 [INFO] - Validation epoch stats:   Loss: 0.5345 - F1-Score: 0.8459 - Accuracy-Score: 0.8151 - AUROC: 0.8953 - AP: 0.9309
[37m2024-08-12 01:43:44,750 [INFO] - Epoch: 11/50
[37m2024-08-12 01:43:44,755 [INFO] - Extracting training cells
[37m2024-08-12 01:44:46,854 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.600, Recall: 0.705, Detected-Cells: 12489
[37m2024-08-12 01:44:47,254 [INFO] - Training epoch stats:     Loss: 0.1175 - F1-Score: 0.9642 - Accuracy-Score: 0.9540 - AUROC: 0.9908 - AP: 0.9947
[37m2024-08-12 01:44:47,688 [INFO] - Validation epoch stats:   Loss: 0.5199 - F1-Score: 0.8562 - Accuracy-Score: 0.8248 - AUROC: 0.8962 - AP: 0.9281
[37m2024-08-12 01:44:47,769 [INFO] - Epoch: 12/50
[37m2024-08-12 01:44:47,774 [INFO] - Extracting training cells
[37m2024-08-12 01:45:51,079 [INFO] - Extraction detection metrics - F1: 0.607, Precision: 0.590, Recall: 0.693, Detected-Cells: 11939
[37m2024-08-12 01:45:51,506 [INFO] - Training epoch stats:     Loss: 0.1058 - F1-Score: 0.9692 - Accuracy-Score: 0.9616 - AUROC: 0.9920 - AP: 0.9941
[37m2024-08-12 01:45:51,896 [INFO] - Validation epoch stats:   Loss: 0.5529 - F1-Score: 0.8486 - Accuracy-Score: 0.8189 - AUROC: 0.9000 - AP: 0.9324
[37m2024-08-12 01:45:51,967 [INFO] - Epoch: 13/50
[37m2024-08-12 01:45:51,972 [INFO] - Extracting training cells
[37m2024-08-12 01:46:53,945 [INFO] - Extraction detection metrics - F1: 0.632, Precision: 0.610, Recall: 0.714, Detected-Cells: 12470
[37m2024-08-12 01:46:54,338 [INFO] - Training epoch stats:     Loss: 0.0935 - F1-Score: 0.9705 - Accuracy-Score: 0.9634 - AUROC: 0.9941 - AP: 0.9961
[37m2024-08-12 01:46:54,650 [INFO] - Validation epoch stats:   Loss: 0.5630 - F1-Score: 0.8495 - Accuracy-Score: 0.8195 - AUROC: 0.8979 - AP: 0.9317
[37m2024-08-12 01:46:54,721 [INFO] - Epoch: 14/50
[37m2024-08-12 01:46:54,728 [INFO] - Extracting training cells
[37m2024-08-12 01:47:57,638 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.601, Recall: 0.708, Detected-Cells: 12378
[37m2024-08-12 01:47:58,029 [INFO] - Training epoch stats:     Loss: 0.0969 - F1-Score: 0.9714 - Accuracy-Score: 0.9638 - AUROC: 0.9931 - AP: 0.9954
[37m2024-08-12 01:47:58,350 [INFO] - Validation epoch stats:   Loss: 0.5690 - F1-Score: 0.8495 - Accuracy-Score: 0.8202 - AUROC: 0.9014 - AP: 0.9354
[37m2024-08-12 01:47:58,419 [INFO] - Epoch: 15/50
[37m2024-08-12 01:47:58,423 [INFO] - Extracting training cells
[37m2024-08-12 01:48:59,727 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.606, Recall: 0.712, Detected-Cells: 12279
[37m2024-08-12 01:49:00,127 [INFO] - Training epoch stats:     Loss: 0.0903 - F1-Score: 0.9752 - Accuracy-Score: 0.9681 - AUROC: 0.9942 - AP: 0.9965
[37m2024-08-12 01:49:00,572 [INFO] - Validation epoch stats:   Loss: 0.5592 - F1-Score: 0.8544 - Accuracy-Score: 0.8243 - AUROC: 0.8999 - AP: 0.9332
[37m2024-08-12 01:49:00,658 [INFO] - Epoch: 16/50
[37m2024-08-12 01:49:00,664 [INFO] - Extracting training cells
[37m2024-08-12 01:50:02,890 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.599, Recall: 0.699, Detected-Cells: 11947
[37m2024-08-12 01:50:03,266 [INFO] - Training epoch stats:     Loss: 0.1005 - F1-Score: 0.9699 - Accuracy-Score: 0.9622 - AUROC: 0.9926 - AP: 0.9952
[37m2024-08-12 01:50:03,576 [INFO] - Validation epoch stats:   Loss: 0.5553 - F1-Score: 0.8557 - Accuracy-Score: 0.8265 - AUROC: 0.9024 - AP: 0.9344
[37m2024-08-12 01:50:03,647 [INFO] - Epoch: 17/50
[37m2024-08-12 01:50:03,653 [INFO] - Extracting training cells
[37m2024-08-12 01:51:05,600 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.605, Recall: 0.702, Detected-Cells: 12062
[37m2024-08-12 01:51:05,966 [INFO] - Training epoch stats:     Loss: 0.0877 - F1-Score: 0.9730 - Accuracy-Score: 0.9663 - AUROC: 0.9948 - AP: 0.9962
[37m2024-08-12 01:51:06,278 [INFO] - Validation epoch stats:   Loss: 0.5726 - F1-Score: 0.8576 - Accuracy-Score: 0.8281 - AUROC: 0.9041 - AP: 0.9361
[37m2024-08-12 01:51:06,342 [INFO] - Epoch: 18/50
[37m2024-08-12 01:51:06,348 [INFO] - Extracting training cells
[37m2024-08-12 01:52:07,844 [INFO] - Extraction detection metrics - F1: 0.636, Precision: 0.613, Recall: 0.719, Detected-Cells: 12491
[37m2024-08-12 01:52:08,220 [INFO] - Training epoch stats:     Loss: 0.0883 - F1-Score: 0.9745 - Accuracy-Score: 0.9677 - AUROC: 0.9947 - AP: 0.9966
[37m2024-08-12 01:52:08,545 [INFO] - Validation epoch stats:   Loss: 0.5820 - F1-Score: 0.8498 - Accuracy-Score: 0.8205 - AUROC: 0.9017 - AP: 0.9344
[37m2024-08-12 01:52:08,610 [INFO] - Epoch: 19/50
[37m2024-08-12 01:52:08,615 [INFO] - Extracting training cells
[37m2024-08-12 01:53:09,987 [INFO] - Extraction detection metrics - F1: 0.632, Precision: 0.611, Recall: 0.718, Detected-Cells: 12443
[37m2024-08-12 01:53:10,377 [INFO] - Training epoch stats:     Loss: 0.0812 - F1-Score: 0.9767 - Accuracy-Score: 0.9711 - AUROC: 0.9955 - AP: 0.9969
[37m2024-08-12 01:53:10,799 [INFO] - Validation epoch stats:   Loss: 0.6224 - F1-Score: 0.8440 - Accuracy-Score: 0.8147 - AUROC: 0.8986 - AP: 0.9315
[37m2024-08-12 01:53:10,871 [INFO] - Epoch: 20/50
[37m2024-08-12 01:53:10,876 [INFO] - Extracting training cells
[37m2024-08-12 01:54:12,641 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.605, Recall: 0.691, Detected-Cells: 12145
[37m2024-08-12 01:54:13,051 [INFO] - Training epoch stats:     Loss: 0.0944 - F1-Score: 0.9713 - Accuracy-Score: 0.9634 - AUROC: 0.9936 - AP: 0.9957
[37m2024-08-12 01:54:13,383 [INFO] - Validation epoch stats:   Loss: 0.6538 - F1-Score: 0.8372 - Accuracy-Score: 0.8083 - AUROC: 0.8939 - AP: 0.9292
[37m2024-08-12 01:54:13,447 [INFO] - Epoch: 21/50
[37m2024-08-12 01:54:13,452 [INFO] - Extracting training cells
[37m2024-08-12 01:55:16,212 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.592, Recall: 0.693, Detected-Cells: 11929
[37m2024-08-12 01:55:16,579 [INFO] - Training epoch stats:     Loss: 0.0989 - F1-Score: 0.9729 - Accuracy-Score: 0.9650 - AUROC: 0.9928 - AP: 0.9954
[37m2024-08-12 01:55:16,896 [INFO] - Validation epoch stats:   Loss: 0.6242 - F1-Score: 0.8444 - Accuracy-Score: 0.8151 - AUROC: 0.8965 - AP: 0.9317
[37m2024-08-12 01:55:16,903 [INFO] - Performing early stopping!
[37m2024-08-12 01:55:16,910 [INFO] - Finished run 0rnkuqki
