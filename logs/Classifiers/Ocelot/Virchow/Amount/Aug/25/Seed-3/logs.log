[37m2024-08-12 05:54:11,673 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-12 05:54:11,674 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/Aug/25/Seed-3/2024-08-12T055403_CellViT-Virchow-25Percent
[37m2024-08-12 05:54:11,741 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7efb01738190>]
[37m2024-08-12 05:54:11,748 [INFO] - Using GPU: cuda:0
[37m2024-08-12 05:54:11,754 [INFO] - Using device: cuda:0
[37m2024-08-12 05:54:11,759 [INFO] - Loss function:
[37m2024-08-12 05:54:11,764 [INFO] - CrossEntropyLoss()
[37m2024-08-12 05:54:22,958 [INFO] - <All keys matched successfully>
[37m2024-08-12 05:54:24,420 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-12 05:54:24,428 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-12 05:54:24,433 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-12 05:54:24,438 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-12 05:54:24,461 [INFO] - Caching datasets
[37m2024-08-12 05:54:27,550 [INFO] - Instantiate Trainer
[37m2024-08-12 05:54:27,562 [INFO] - Calling Trainer Fit
[37m2024-08-12 05:54:27,567 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-12 05:54:27,572 [INFO] - Epoch: 1/50
[37m2024-08-12 05:54:27,580 [INFO] - Extracting training cells
[37m2024-08-12 05:55:39,526 [INFO] - Extraction detection metrics - F1: 0.625, Precision: 0.605, Recall: 0.703, Detected-Cells: 12337
[37m2024-08-12 05:55:40,014 [INFO] - Training epoch stats:     Loss: 0.3160 - F1-Score: 0.8991 - Accuracy-Score: 0.8684 - AUROC: 0.9394 - AP: 0.9605
[37m2024-08-12 05:55:44,957 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-12 05:55:45,412 [INFO] - Validation epoch stats:   Loss: 0.3715 - F1-Score: 0.8918 - Accuracy-Score: 0.8636 - AUROC: 0.9145 - AP: 0.9438
[37m2024-08-12 05:55:45,418 [INFO] - New best model - save checkpoint
[37m2024-08-12 05:55:45,619 [INFO] - Epoch: 2/50
[37m2024-08-12 05:55:45,625 [INFO] - Extracting training cells
[37m2024-08-12 05:56:50,493 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.604, Recall: 0.697, Detected-Cells: 11941
[37m2024-08-12 05:56:50,903 [INFO] - Training epoch stats:     Loss: 0.1796 - F1-Score: 0.9472 - Accuracy-Score: 0.9326 - AUROC: 0.9780 - AP: 0.9847
[37m2024-08-12 05:56:51,234 [INFO] - Validation epoch stats:   Loss: 0.4068 - F1-Score: 0.8844 - Accuracy-Score: 0.8545 - AUROC: 0.9053 - AP: 0.9359
[37m2024-08-12 05:56:51,293 [INFO] - Epoch: 3/50
[37m2024-08-12 05:56:51,299 [INFO] - Extracting training cells
[37m2024-08-12 05:57:54,728 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.599, Recall: 0.700, Detected-Cells: 12287
[37m2024-08-12 05:57:55,217 [INFO] - Training epoch stats:     Loss: 0.1538 - F1-Score: 0.9520 - Accuracy-Score: 0.9399 - AUROC: 0.9843 - AP: 0.9893
[37m2024-08-12 05:57:55,679 [INFO] - Validation epoch stats:   Loss: 0.4355 - F1-Score: 0.8709 - Accuracy-Score: 0.8397 - AUROC: 0.9017 - AP: 0.9311
[37m2024-08-12 05:57:55,748 [INFO] - Epoch: 4/50
[37m2024-08-12 05:57:55,753 [INFO] - Extracting training cells
[37m2024-08-12 05:58:59,447 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.594, Recall: 0.702, Detected-Cells: 12038
[37m2024-08-12 05:58:59,923 [INFO] - Training epoch stats:     Loss: 0.1375 - F1-Score: 0.9599 - Accuracy-Score: 0.9504 - AUROC: 0.9861 - AP: 0.9893
[37m2024-08-12 05:59:00,386 [INFO] - Validation epoch stats:   Loss: 0.4679 - F1-Score: 0.8612 - Accuracy-Score: 0.8299 - AUROC: 0.8971 - AP: 0.9269
[37m2024-08-12 05:59:00,458 [INFO] - Epoch: 5/50
[37m2024-08-12 05:59:00,467 [INFO] - Extracting training cells
[37m2024-08-12 06:00:04,670 [INFO] - Extraction detection metrics - F1: 0.603, Precision: 0.580, Recall: 0.686, Detected-Cells: 11724
[37m2024-08-12 06:00:05,034 [INFO] - Training epoch stats:     Loss: 0.1297 - F1-Score: 0.9595 - Accuracy-Score: 0.9493 - AUROC: 0.9889 - AP: 0.9928
[37m2024-08-12 06:00:05,352 [INFO] - Validation epoch stats:   Loss: 0.5338 - F1-Score: 0.8432 - Accuracy-Score: 0.8138 - AUROC: 0.8999 - AP: 0.9299
[37m2024-08-12 06:00:05,414 [INFO] - Epoch: 6/50
[37m2024-08-12 06:00:05,418 [INFO] - Extracting training cells
[37m2024-08-12 06:01:08,615 [INFO] - Extraction detection metrics - F1: 0.617, Precision: 0.594, Recall: 0.699, Detected-Cells: 12081
[37m2024-08-12 06:01:09,134 [INFO] - Training epoch stats:     Loss: 0.1274 - F1-Score: 0.9620 - Accuracy-Score: 0.9503 - AUROC: 0.9881 - AP: 0.9931
[37m2024-08-12 06:01:09,614 [INFO] - Validation epoch stats:   Loss: 0.4925 - F1-Score: 0.8583 - Accuracy-Score: 0.8273 - AUROC: 0.8990 - AP: 0.9287
[37m2024-08-12 06:01:09,675 [INFO] - Epoch: 7/50
[37m2024-08-12 06:01:09,681 [INFO] - Extracting training cells
[37m2024-08-12 06:02:15,445 [INFO] - Extraction detection metrics - F1: 0.628, Precision: 0.612, Recall: 0.709, Detected-Cells: 12250
[37m2024-08-12 06:02:15,841 [INFO] - Training epoch stats:     Loss: 0.1209 - F1-Score: 0.9644 - Accuracy-Score: 0.9555 - AUROC: 0.9901 - AP: 0.9938
[37m2024-08-12 06:02:16,282 [INFO] - Validation epoch stats:   Loss: 0.5096 - F1-Score: 0.8591 - Accuracy-Score: 0.8287 - AUROC: 0.9000 - AP: 0.9301
[37m2024-08-12 06:02:16,344 [INFO] - Epoch: 8/50
[37m2024-08-12 06:02:16,350 [INFO] - Extracting training cells
[37m2024-08-12 06:03:20,367 [INFO] - Extraction detection metrics - F1: 0.609, Precision: 0.585, Recall: 0.686, Detected-Cells: 12051
[37m2024-08-12 06:03:20,751 [INFO] - Training epoch stats:     Loss: 0.1246 - F1-Score: 0.9614 - Accuracy-Score: 0.9513 - AUROC: 0.9894 - AP: 0.9934
[37m2024-08-12 06:03:21,221 [INFO] - Validation epoch stats:   Loss: 0.5265 - F1-Score: 0.8493 - Accuracy-Score: 0.8192 - AUROC: 0.8973 - AP: 0.9275
[37m2024-08-12 06:03:21,631 [INFO] - Epoch: 9/50
[37m2024-08-12 06:03:21,810 [INFO] - Extracting training cells
[37m2024-08-12 06:04:24,712 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.597, Recall: 0.701, Detected-Cells: 12185
[37m2024-08-12 06:04:25,218 [INFO] - Training epoch stats:     Loss: 0.1161 - F1-Score: 0.9647 - Accuracy-Score: 0.9549 - AUROC: 0.9907 - AP: 0.9938
[37m2024-08-12 06:04:25,691 [INFO] - Validation epoch stats:   Loss: 0.5271 - F1-Score: 0.8485 - Accuracy-Score: 0.8175 - AUROC: 0.8944 - AP: 0.9270
[37m2024-08-12 06:04:25,760 [INFO] - Epoch: 10/50
[37m2024-08-12 06:04:25,766 [INFO] - Extracting training cells
[37m2024-08-12 06:05:30,013 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.600, Recall: 0.693, Detected-Cells: 12013
[37m2024-08-12 06:05:30,394 [INFO] - Training epoch stats:     Loss: 0.1175 - F1-Score: 0.9632 - Accuracy-Score: 0.9535 - AUROC: 0.9906 - AP: 0.9940
[37m2024-08-12 06:05:30,710 [INFO] - Validation epoch stats:   Loss: 0.5355 - F1-Score: 0.8476 - Accuracy-Score: 0.8171 - AUROC: 0.8974 - AP: 0.9297
[37m2024-08-12 06:05:30,779 [INFO] - Epoch: 11/50
[37m2024-08-12 06:05:30,784 [INFO] - Extracting training cells
[37m2024-08-12 06:06:32,588 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.601, Recall: 0.701, Detected-Cells: 12132
[37m2024-08-12 06:06:32,950 [INFO] - Training epoch stats:     Loss: 0.1221 - F1-Score: 0.9645 - Accuracy-Score: 0.9545 - AUROC: 0.9888 - AP: 0.9926
[37m2024-08-12 06:06:33,274 [INFO] - Validation epoch stats:   Loss: 0.5159 - F1-Score: 0.8578 - Accuracy-Score: 0.8270 - AUROC: 0.8987 - AP: 0.9304
[37m2024-08-12 06:06:33,318 [INFO] - Epoch: 12/50
[37m2024-08-12 06:06:33,321 [INFO] - Extracting training cells
[37m2024-08-12 06:07:36,140 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.589, Recall: 0.699, Detected-Cells: 11803
[37m2024-08-12 06:07:36,783 [INFO] - Training epoch stats:     Loss: 0.1162 - F1-Score: 0.9636 - Accuracy-Score: 0.9545 - AUROC: 0.9908 - AP: 0.9938
[37m2024-08-12 06:07:37,102 [INFO] - Validation epoch stats:   Loss: 0.5463 - F1-Score: 0.8526 - Accuracy-Score: 0.8207 - AUROC: 0.8923 - AP: 0.9242
[37m2024-08-12 06:07:37,164 [INFO] - Epoch: 13/50
[37m2024-08-12 06:07:37,170 [INFO] - Extracting training cells
[37m2024-08-12 06:08:41,173 [INFO] - Extraction detection metrics - F1: 0.623, Precision: 0.603, Recall: 0.708, Detected-Cells: 12404
[37m2024-08-12 06:08:41,687 [INFO] - Training epoch stats:     Loss: 0.0987 - F1-Score: 0.9711 - Accuracy-Score: 0.9632 - AUROC: 0.9931 - AP: 0.9956
[37m2024-08-12 06:08:42,124 [INFO] - Validation epoch stats:   Loss: 0.5997 - F1-Score: 0.8423 - Accuracy-Score: 0.8124 - AUROC: 0.8938 - AP: 0.9265
[37m2024-08-12 06:08:42,184 [INFO] - Epoch: 14/50
[37m2024-08-12 06:08:42,189 [INFO] - Extracting training cells
[37m2024-08-12 06:09:44,783 [INFO] - Extraction detection metrics - F1: 0.622, Precision: 0.600, Recall: 0.698, Detected-Cells: 11864
[37m2024-08-12 06:09:45,160 [INFO] - Training epoch stats:     Loss: 0.0969 - F1-Score: 0.9711 - Accuracy-Score: 0.9638 - AUROC: 0.9932 - AP: 0.9954
[37m2024-08-12 06:09:45,481 [INFO] - Validation epoch stats:   Loss: 0.5941 - F1-Score: 0.8454 - Accuracy-Score: 0.8160 - AUROC: 0.8974 - AP: 0.9284
[37m2024-08-12 06:09:45,538 [INFO] - Epoch: 15/50
[37m2024-08-12 06:09:45,543 [INFO] - Extracting training cells
[37m2024-08-12 06:10:48,195 [INFO] - Extraction detection metrics - F1: 0.616, Precision: 0.598, Recall: 0.690, Detected-Cells: 11997
[37m2024-08-12 06:10:48,556 [INFO] - Training epoch stats:     Loss: 0.0972 - F1-Score: 0.9705 - Accuracy-Score: 0.9623 - AUROC: 0.9936 - AP: 0.9959
[37m2024-08-12 06:10:49,024 [INFO] - Validation epoch stats:   Loss: 0.5623 - F1-Score: 0.8557 - Accuracy-Score: 0.8259 - AUROC: 0.9027 - AP: 0.9334
[37m2024-08-12 06:10:49,094 [INFO] - Epoch: 16/50
[37m2024-08-12 06:10:49,100 [INFO] - Extracting training cells
[37m2024-08-12 06:11:52,768 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.593, Recall: 0.689, Detected-Cells: 12150
[37m2024-08-12 06:11:53,161 [INFO] - Training epoch stats:     Loss: 0.0893 - F1-Score: 0.9741 - Accuracy-Score: 0.9665 - AUROC: 0.9947 - AP: 0.9970
[37m2024-08-12 06:11:53,486 [INFO] - Validation epoch stats:   Loss: 0.5970 - F1-Score: 0.8482 - Accuracy-Score: 0.8192 - AUROC: 0.9029 - AP: 0.9351
[37m2024-08-12 06:11:53,549 [INFO] - Epoch: 17/50
[37m2024-08-12 06:11:53,554 [INFO] - Extracting training cells
[37m2024-08-12 06:12:57,192 [INFO] - Extraction detection metrics - F1: 0.634, Precision: 0.613, Recall: 0.715, Detected-Cells: 12501
[37m2024-08-12 06:12:57,587 [INFO] - Training epoch stats:     Loss: 0.0863 - F1-Score: 0.9736 - Accuracy-Score: 0.9666 - AUROC: 0.9949 - AP: 0.9968
[37m2024-08-12 06:12:57,911 [INFO] - Validation epoch stats:   Loss: 0.6027 - F1-Score: 0.8487 - Accuracy-Score: 0.8197 - AUROC: 0.9031 - AP: 0.9357
[37m2024-08-12 06:12:57,978 [INFO] - Epoch: 18/50
[37m2024-08-12 06:12:57,983 [INFO] - Extracting training cells
[37m2024-08-12 06:14:00,543 [INFO] - Extraction detection metrics - F1: 0.608, Precision: 0.584, Recall: 0.687, Detected-Cells: 11966
[37m2024-08-12 06:14:01,053 [INFO] - Training epoch stats:     Loss: 0.1028 - F1-Score: 0.9703 - Accuracy-Score: 0.9621 - AUROC: 0.9928 - AP: 0.9960
[37m2024-08-12 06:14:01,538 [INFO] - Validation epoch stats:   Loss: 0.5559 - F1-Score: 0.8590 - Accuracy-Score: 0.8279 - AUROC: 0.8987 - AP: 0.9318
[37m2024-08-12 06:14:01,603 [INFO] - Epoch: 19/50
[37m2024-08-12 06:14:01,608 [INFO] - Extracting training cells
[37m2024-08-12 06:15:02,727 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.591, Recall: 0.694, Detected-Cells: 12013
[37m2024-08-12 06:15:03,136 [INFO] - Training epoch stats:     Loss: 0.0956 - F1-Score: 0.9716 - Accuracy-Score: 0.9642 - AUROC: 0.9938 - AP: 0.9960
[37m2024-08-12 06:15:03,463 [INFO] - Validation epoch stats:   Loss: 0.6012 - F1-Score: 0.8492 - Accuracy-Score: 0.8192 - AUROC: 0.8968 - AP: 0.9299
[37m2024-08-12 06:15:03,525 [INFO] - Epoch: 20/50
[37m2024-08-12 06:15:03,530 [INFO] - Extracting training cells
[37m2024-08-12 06:16:06,163 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.600, Recall: 0.703, Detected-Cells: 12316
[37m2024-08-12 06:16:06,559 [INFO] - Training epoch stats:     Loss: 0.0975 - F1-Score: 0.9705 - Accuracy-Score: 0.9633 - AUROC: 0.9935 - AP: 0.9958
[37m2024-08-12 06:16:06,980 [INFO] - Validation epoch stats:   Loss: 0.5707 - F1-Score: 0.8563 - Accuracy-Score: 0.8258 - AUROC: 0.8988 - AP: 0.9303
[37m2024-08-12 06:16:07,050 [INFO] - Epoch: 21/50
[37m2024-08-12 06:16:07,055 [INFO] - Extracting training cells
[37m2024-08-12 06:17:10,812 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.605, Recall: 0.700, Detected-Cells: 12221
[37m2024-08-12 06:17:11,194 [INFO] - Training epoch stats:     Loss: 0.0943 - F1-Score: 0.9726 - Accuracy-Score: 0.9641 - AUROC: 0.9938 - AP: 0.9966
[37m2024-08-12 06:17:11,514 [INFO] - Validation epoch stats:   Loss: 0.5834 - F1-Score: 0.8547 - Accuracy-Score: 0.8251 - AUROC: 0.9008 - AP: 0.9324
[37m2024-08-12 06:17:11,520 [INFO] - Performing early stopping!
[37m2024-08-12 06:17:11,527 [INFO] - Finished run m7004756
