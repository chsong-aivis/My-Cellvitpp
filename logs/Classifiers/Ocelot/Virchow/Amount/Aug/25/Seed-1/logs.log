[37m2024-08-11 20:28:02,198 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 20:28:02,199 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/Aug/25/Seed-1/2024-08-11T202751_CellViT-Virchow-25Percent
[37m2024-08-11 20:28:02,273 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f9d9d707fd0>]
[37m2024-08-11 20:28:02,280 [INFO] - Using GPU: cuda:0
[37m2024-08-11 20:28:02,289 [INFO] - Using device: cuda:0
[37m2024-08-11 20:28:02,295 [INFO] - Loss function:
[37m2024-08-11 20:28:02,300 [INFO] - CrossEntropyLoss()
[37m2024-08-11 20:28:11,371 [INFO] - <All keys matched successfully>
[37m2024-08-11 20:28:12,594 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 20:28:12,602 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 20:28:12,607 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 20:28:12,613 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 20:28:12,636 [INFO] - Caching datasets
[37m2024-08-11 20:28:15,720 [INFO] - Instantiate Trainer
[37m2024-08-11 20:28:15,733 [INFO] - Calling Trainer Fit
[37m2024-08-11 20:28:15,739 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 20:28:15,745 [INFO] - Epoch: 1/50
[37m2024-08-11 20:28:15,751 [INFO] - Extracting training cells
[37m2024-08-11 20:29:26,955 [INFO] - Extraction detection metrics - F1: 0.613, Precision: 0.589, Recall: 0.698, Detected-Cells: 12043
[37m2024-08-11 20:29:27,361 [INFO] - Training epoch stats:     Loss: 0.3298 - F1-Score: 0.8952 - Accuracy-Score: 0.8588 - AUROC: 0.9343 - AP: 0.9587
[37m2024-08-11 20:29:31,253 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 20:29:31,668 [INFO] - Validation epoch stats:   Loss: 0.4277 - F1-Score: 0.8543 - Accuracy-Score: 0.8272 - AUROC: 0.9076 - AP: 0.9377
[37m2024-08-11 20:29:31,673 [INFO] - New best model - save checkpoint
[37m2024-08-11 20:29:31,858 [INFO] - Epoch: 2/50
[37m2024-08-11 20:29:31,865 [INFO] - Extracting training cells
[37m2024-08-11 20:30:33,969 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.592, Recall: 0.694, Detected-Cells: 11909
[37m2024-08-11 20:30:34,346 [INFO] - Training epoch stats:     Loss: 0.1909 - F1-Score: 0.9439 - Accuracy-Score: 0.9285 - AUROC: 0.9760 - AP: 0.9851
[37m2024-08-11 20:30:34,657 [INFO] - Validation epoch stats:   Loss: 0.4120 - F1-Score: 0.8765 - Accuracy-Score: 0.8463 - AUROC: 0.9036 - AP: 0.9333
[37m2024-08-11 20:30:34,712 [INFO] - Epoch: 3/50
[37m2024-08-11 20:30:34,718 [INFO] - Extracting training cells
[37m2024-08-11 20:31:37,994 [INFO] - Extraction detection metrics - F1: 0.610, Precision: 0.592, Recall: 0.694, Detected-Cells: 11821
[37m2024-08-11 20:31:38,351 [INFO] - Training epoch stats:     Loss: 0.1591 - F1-Score: 0.9536 - Accuracy-Score: 0.9407 - AUROC: 0.9821 - AP: 0.9883
[37m2024-08-11 20:31:38,663 [INFO] - Validation epoch stats:   Loss: 0.4549 - F1-Score: 0.8578 - Accuracy-Score: 0.8272 - AUROC: 0.8987 - AP: 0.9309
[37m2024-08-11 20:31:38,731 [INFO] - Epoch: 4/50
[37m2024-08-11 20:31:38,737 [INFO] - Extracting training cells
[37m2024-08-11 20:32:39,787 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.594, Recall: 0.688, Detected-Cells: 11975
[37m2024-08-11 20:32:40,163 [INFO] - Training epoch stats:     Loss: 0.1448 - F1-Score: 0.9561 - Accuracy-Score: 0.9451 - AUROC: 0.9860 - AP: 0.9908
[37m2024-08-11 20:32:40,470 [INFO] - Validation epoch stats:   Loss: 0.4591 - F1-Score: 0.8635 - Accuracy-Score: 0.8323 - AUROC: 0.8970 - AP: 0.9281
[37m2024-08-11 20:32:40,539 [INFO] - Epoch: 5/50
[37m2024-08-11 20:32:40,544 [INFO] - Extracting training cells
[37m2024-08-11 20:33:42,255 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.602, Recall: 0.705, Detected-Cells: 11934
[37m2024-08-11 20:33:42,634 [INFO] - Training epoch stats:     Loss: 0.1351 - F1-Score: 0.9586 - Accuracy-Score: 0.9472 - AUROC: 0.9873 - AP: 0.9918
[37m2024-08-11 20:33:42,935 [INFO] - Validation epoch stats:   Loss: 0.4757 - F1-Score: 0.8620 - Accuracy-Score: 0.8307 - AUROC: 0.8982 - AP: 0.9296
[37m2024-08-11 20:33:43,001 [INFO] - Epoch: 6/50
[37m2024-08-11 20:33:43,006 [INFO] - Extracting training cells
[37m2024-08-11 20:34:48,167 [INFO] - Extraction detection metrics - F1: 0.625, Precision: 0.606, Recall: 0.708, Detected-Cells: 12343
[37m2024-08-11 20:34:48,558 [INFO] - Training epoch stats:     Loss: 0.1190 - F1-Score: 0.9634 - Accuracy-Score: 0.9545 - AUROC: 0.9905 - AP: 0.9938
[37m2024-08-11 20:34:48,870 [INFO] - Validation epoch stats:   Loss: 0.5242 - F1-Score: 0.8454 - Accuracy-Score: 0.8147 - AUROC: 0.8947 - AP: 0.9252
[37m2024-08-11 20:34:48,941 [INFO] - Epoch: 7/50
[37m2024-08-11 20:34:48,946 [INFO] - Extracting training cells
[37m2024-08-11 20:35:52,358 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.601, Recall: 0.710, Detected-Cells: 11982
[37m2024-08-11 20:35:52,742 [INFO] - Training epoch stats:     Loss: 0.1267 - F1-Score: 0.9622 - Accuracy-Score: 0.9526 - AUROC: 0.9886 - AP: 0.9924
[37m2024-08-11 20:35:53,058 [INFO] - Validation epoch stats:   Loss: 0.4697 - F1-Score: 0.8650 - Accuracy-Score: 0.8356 - AUROC: 0.9062 - AP: 0.9356
[37m2024-08-11 20:35:53,125 [INFO] - Epoch: 8/50
[37m2024-08-11 20:35:53,131 [INFO] - Extracting training cells
[37m2024-08-11 20:36:56,157 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.604, Recall: 0.709, Detected-Cells: 12139
[37m2024-08-11 20:36:56,663 [INFO] - Training epoch stats:     Loss: 0.1190 - F1-Score: 0.9647 - Accuracy-Score: 0.9546 - AUROC: 0.9901 - AP: 0.9938
[37m2024-08-11 20:36:57,146 [INFO] - Validation epoch stats:   Loss: 0.4767 - F1-Score: 0.8655 - Accuracy-Score: 0.8343 - AUROC: 0.9016 - AP: 0.9319
[37m2024-08-11 20:36:57,216 [INFO] - Epoch: 9/50
[37m2024-08-11 20:36:57,222 [INFO] - Extracting training cells
[37m2024-08-11 20:38:00,904 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.587, Recall: 0.701, Detected-Cells: 12101
[37m2024-08-11 20:38:01,285 [INFO] - Training epoch stats:     Loss: 0.1110 - F1-Score: 0.9663 - Accuracy-Score: 0.9576 - AUROC: 0.9916 - AP: 0.9949
[37m2024-08-11 20:38:01,601 [INFO] - Validation epoch stats:   Loss: 0.5278 - F1-Score: 0.8469 - Accuracy-Score: 0.8173 - AUROC: 0.8989 - AP: 0.9291
[37m2024-08-11 20:38:01,670 [INFO] - Epoch: 10/50
[37m2024-08-11 20:38:01,675 [INFO] - Extracting training cells
[37m2024-08-11 20:39:05,239 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.599, Recall: 0.699, Detected-Cells: 12176
[37m2024-08-11 20:39:05,618 [INFO] - Training epoch stats:     Loss: 0.1094 - F1-Score: 0.9671 - Accuracy-Score: 0.9585 - AUROC: 0.9913 - AP: 0.9940
[37m2024-08-11 20:39:05,928 [INFO] - Validation epoch stats:   Loss: 0.4781 - F1-Score: 0.8674 - Accuracy-Score: 0.8368 - AUROC: 0.9045 - AP: 0.9328
[37m2024-08-11 20:39:05,997 [INFO] - Epoch: 11/50
[37m2024-08-11 20:39:06,003 [INFO] - Extracting training cells
[37m2024-08-11 20:40:09,087 [INFO] - Extraction detection metrics - F1: 0.618, Precision: 0.597, Recall: 0.699, Detected-Cells: 12225
[37m2024-08-11 20:40:09,478 [INFO] - Training epoch stats:     Loss: 0.1010 - F1-Score: 0.9700 - Accuracy-Score: 0.9627 - AUROC: 0.9929 - AP: 0.9952
[37m2024-08-11 20:40:09,787 [INFO] - Validation epoch stats:   Loss: 0.5154 - F1-Score: 0.8585 - Accuracy-Score: 0.8289 - AUROC: 0.9042 - AP: 0.9336
[37m2024-08-11 20:40:09,858 [INFO] - Epoch: 12/50
[37m2024-08-11 20:40:09,862 [INFO] - Extracting training cells
[37m2024-08-11 20:41:11,336 [INFO] - Extraction detection metrics - F1: 0.621, Precision: 0.600, Recall: 0.700, Detected-Cells: 12015
[37m2024-08-11 20:41:11,759 [INFO] - Training epoch stats:     Loss: 0.1035 - F1-Score: 0.9699 - Accuracy-Score: 0.9608 - AUROC: 0.9926 - AP: 0.9958
[37m2024-08-11 20:41:12,373 [INFO] - Validation epoch stats:   Loss: 0.5201 - F1-Score: 0.8570 - Accuracy-Score: 0.8264 - AUROC: 0.8989 - AP: 0.9280
[37m2024-08-11 20:41:12,447 [INFO] - Epoch: 13/50
[37m2024-08-11 20:41:12,452 [INFO] - Extracting training cells
[37m2024-08-11 20:42:13,684 [INFO] - Extraction detection metrics - F1: 0.629, Precision: 0.611, Recall: 0.707, Detected-Cells: 12304
[37m2024-08-11 20:42:14,065 [INFO] - Training epoch stats:     Loss: 0.0903 - F1-Score: 0.9737 - Accuracy-Score: 0.9659 - AUROC: 0.9943 - AP: 0.9966
[37m2024-08-11 20:42:14,372 [INFO] - Validation epoch stats:   Loss: 0.5623 - F1-Score: 0.8545 - Accuracy-Score: 0.8252 - AUROC: 0.9010 - AP: 0.9287
[37m2024-08-11 20:42:14,445 [INFO] - Epoch: 14/50
[37m2024-08-11 20:42:14,451 [INFO] - Extracting training cells
[37m2024-08-11 20:43:16,096 [INFO] - Extraction detection metrics - F1: 0.606, Precision: 0.586, Recall: 0.685, Detected-Cells: 11666
[37m2024-08-11 20:43:16,572 [INFO] - Training epoch stats:     Loss: 0.1030 - F1-Score: 0.9685 - Accuracy-Score: 0.9608 - AUROC: 0.9923 - AP: 0.9945
[37m2024-08-11 20:43:17,028 [INFO] - Validation epoch stats:   Loss: 0.5286 - F1-Score: 0.8611 - Accuracy-Score: 0.8295 - AUROC: 0.8959 - AP: 0.9244
[37m2024-08-11 20:43:17,099 [INFO] - Epoch: 15/50
[37m2024-08-11 20:43:17,104 [INFO] - Extracting training cells
[37m2024-08-11 20:44:20,873 [INFO] - Extraction detection metrics - F1: 0.626, Precision: 0.602, Recall: 0.709, Detected-Cells: 12511
[37m2024-08-11 20:44:21,273 [INFO] - Training epoch stats:     Loss: 0.0908 - F1-Score: 0.9739 - Accuracy-Score: 0.9665 - AUROC: 0.9944 - AP: 0.9967
[37m2024-08-11 20:44:21,589 [INFO] - Validation epoch stats:   Loss: 0.5451 - F1-Score: 0.8636 - Accuracy-Score: 0.8335 - AUROC: 0.9016 - AP: 0.9298
[37m2024-08-11 20:44:21,653 [INFO] - Epoch: 16/50
[37m2024-08-11 20:44:21,658 [INFO] - Extracting training cells
[37m2024-08-11 20:45:23,572 [INFO] - Extraction detection metrics - F1: 0.614, Precision: 0.599, Recall: 0.694, Detected-Cells: 11924
[37m2024-08-11 20:45:23,952 [INFO] - Training epoch stats:     Loss: 0.0900 - F1-Score: 0.9742 - Accuracy-Score: 0.9677 - AUROC: 0.9937 - AP: 0.9956
[37m2024-08-11 20:45:24,266 [INFO] - Validation epoch stats:   Loss: 0.5476 - F1-Score: 0.8560 - Accuracy-Score: 0.8256 - AUROC: 0.9005 - AP: 0.9293
[37m2024-08-11 20:45:24,323 [INFO] - Epoch: 17/50
[37m2024-08-11 20:45:24,328 [INFO] - Extracting training cells
[37m2024-08-11 20:46:24,638 [INFO] - Extraction detection metrics - F1: 0.620, Precision: 0.604, Recall: 0.699, Detected-Cells: 12128
[37m2024-08-11 20:46:25,017 [INFO] - Training epoch stats:     Loss: 0.0912 - F1-Score: 0.9718 - Accuracy-Score: 0.9646 - AUROC: 0.9944 - AP: 0.9964
[37m2024-08-11 20:46:25,331 [INFO] - Validation epoch stats:   Loss: 0.5731 - F1-Score: 0.8500 - Accuracy-Score: 0.8196 - AUROC: 0.8981 - AP: 0.9295
[37m2024-08-11 20:46:25,399 [INFO] - Epoch: 18/50
[37m2024-08-11 20:46:25,404 [INFO] - Extracting training cells
[37m2024-08-11 20:47:28,361 [INFO] - Extraction detection metrics - F1: 0.624, Precision: 0.604, Recall: 0.704, Detected-Cells: 12135
[37m2024-08-11 20:47:28,797 [INFO] - Training epoch stats:     Loss: 0.0837 - F1-Score: 0.9760 - Accuracy-Score: 0.9690 - AUROC: 0.9952 - AP: 0.9972
[37m2024-08-11 20:47:29,204 [INFO] - Validation epoch stats:   Loss: 0.5814 - F1-Score: 0.8503 - Accuracy-Score: 0.8195 - AUROC: 0.8969 - AP: 0.9290
[37m2024-08-11 20:47:29,274 [INFO] - Epoch: 19/50
[37m2024-08-11 20:47:29,279 [INFO] - Extracting training cells
[37m2024-08-11 20:48:30,615 [INFO] - Extraction detection metrics - F1: 0.615, Precision: 0.597, Recall: 0.694, Detected-Cells: 11799
[37m2024-08-11 20:48:30,986 [INFO] - Training epoch stats:     Loss: 0.0998 - F1-Score: 0.9710 - Accuracy-Score: 0.9630 - AUROC: 0.9933 - AP: 0.9960
[37m2024-08-11 20:48:31,303 [INFO] - Validation epoch stats:   Loss: 0.5786 - F1-Score: 0.8499 - Accuracy-Score: 0.8196 - AUROC: 0.8981 - AP: 0.9293
[37m2024-08-11 20:48:31,367 [INFO] - Epoch: 20/50
[37m2024-08-11 20:48:31,373 [INFO] - Extracting training cells
[37m2024-08-11 20:49:34,821 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.598, Recall: 0.700, Detected-Cells: 11993
[37m2024-08-11 20:49:35,191 [INFO] - Training epoch stats:     Loss: 0.0950 - F1-Score: 0.9724 - Accuracy-Score: 0.9653 - AUROC: 0.9937 - AP: 0.9961
[37m2024-08-11 20:49:35,499 [INFO] - Validation epoch stats:   Loss: 0.5870 - F1-Score: 0.8485 - Accuracy-Score: 0.8188 - AUROC: 0.9000 - AP: 0.9299
[37m2024-08-11 20:49:35,567 [INFO] - Epoch: 21/50
[37m2024-08-11 20:49:35,572 [INFO] - Extracting training cells
[37m2024-08-11 20:50:37,857 [INFO] - Extraction detection metrics - F1: 0.619, Precision: 0.594, Recall: 0.692, Detected-Cells: 12161
[37m2024-08-11 20:50:38,682 [INFO] - Training epoch stats:     Loss: 0.0957 - F1-Score: 0.9722 - Accuracy-Score: 0.9655 - AUROC: 0.9935 - AP: 0.9952
[37m2024-08-11 20:50:39,132 [INFO] - Validation epoch stats:   Loss: 0.5691 - F1-Score: 0.8529 - Accuracy-Score: 0.8219 - AUROC: 0.8967 - AP: 0.9260
[37m2024-08-11 20:50:39,138 [INFO] - Performing early stopping!
[37m2024-08-11 20:50:39,147 [INFO] - Finished run rwtxqnxo
