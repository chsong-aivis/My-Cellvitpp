[37m2024-08-11 19:48:07,798 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:48:07,800 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/100/Seed-3/2024-08-11T194757_CellViT-Virchow-100Percent
[37m2024-08-11 19:48:07,874 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f2f0cbcae60>]
[37m2024-08-11 19:48:07,904 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:48:07,909 [INFO] - Using device: cuda:0
[37m2024-08-11 19:48:07,955 [INFO] - Loss function:
[37m2024-08-11 19:48:07,960 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:48:23,466 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:48:24,702 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:48:24,708 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:48:24,713 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:48:24,718 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:48:24,736 [INFO] - Caching datasets
[37m2024-08-11 19:48:31,733 [INFO] - Instantiate Trainer
[37m2024-08-11 19:48:31,741 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:48:31,751 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:48:31,756 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:48:31,765 [INFO] - Epoch: 1/50
[37m2024-08-11 19:48:42,207 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/5d3a6f4be7dabd3ef5aee77fef6efe9fa2f0a18dcb5c8e0300b17482abf922f6.h5
[37m2024-08-11 19:48:44,267 [INFO] - Training epoch stats:     Loss: 0.2663 - F1-Score: 0.9084 - Accuracy-Score: 0.8882 - AUROC: 0.9553 - AP: 0.9671
[37m2024-08-11 19:48:49,190 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:48:49,637 [INFO] - Validation epoch stats:   Loss: 0.3895 - F1-Score: 0.8787 - Accuracy-Score: 0.8487 - AUROC: 0.9175 - AP: 0.9456
[37m2024-08-11 19:48:49,642 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:49,843 [INFO] - Epoch: 2/50
[37m2024-08-11 19:48:51,872 [INFO] - Training epoch stats:     Loss: 0.1707 - F1-Score: 0.9454 - Accuracy-Score: 0.9342 - AUROC: 0.9810 - AP: 0.9859
[37m2024-08-11 19:48:52,319 [INFO] - Validation epoch stats:   Loss: 0.3988 - F1-Score: 0.8808 - Accuracy-Score: 0.8498 - AUROC: 0.9197 - AP: 0.9480
[37m2024-08-11 19:48:52,325 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:52,508 [INFO] - Epoch: 3/50
[37m2024-08-11 19:48:54,577 [INFO] - Training epoch stats:     Loss: 0.1412 - F1-Score: 0.9553 - Accuracy-Score: 0.9462 - AUROC: 0.9869 - AP: 0.9904
[37m2024-08-11 19:48:55,056 [INFO] - Validation epoch stats:   Loss: 0.4110 - F1-Score: 0.8854 - Accuracy-Score: 0.8544 - AUROC: 0.9206 - AP: 0.9487
[37m2024-08-11 19:48:55,062 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:55,241 [INFO] - Epoch: 4/50
[37m2024-08-11 19:48:57,159 [INFO] - Training epoch stats:     Loss: 0.1217 - F1-Score: 0.9620 - Accuracy-Score: 0.9543 - AUROC: 0.9903 - AP: 0.9929
[37m2024-08-11 19:48:57,642 [INFO] - Validation epoch stats:   Loss: 0.4322 - F1-Score: 0.8752 - Accuracy-Score: 0.8448 - AUROC: 0.9195 - AP: 0.9483
[37m2024-08-11 19:48:57,717 [INFO] - Epoch: 5/50
[37m2024-08-11 19:48:59,658 [INFO] - Training epoch stats:     Loss: 0.1056 - F1-Score: 0.9670 - Accuracy-Score: 0.9604 - AUROC: 0.9927 - AP: 0.9947
[37m2024-08-11 19:49:00,104 [INFO] - Validation epoch stats:   Loss: 0.4710 - F1-Score: 0.8702 - Accuracy-Score: 0.8399 - AUROC: 0.9170 - AP: 0.9443
[37m2024-08-11 19:49:00,169 [INFO] - Epoch: 6/50
[37m2024-08-11 19:49:02,370 [INFO] - Training epoch stats:     Loss: 0.0939 - F1-Score: 0.9706 - Accuracy-Score: 0.9646 - AUROC: 0.9943 - AP: 0.9959
[37m2024-08-11 19:49:02,788 [INFO] - Validation epoch stats:   Loss: 0.4704 - F1-Score: 0.8755 - Accuracy-Score: 0.8449 - AUROC: 0.9194 - AP: 0.9459
[37m2024-08-11 19:49:02,910 [INFO] - Epoch: 7/50
[37m2024-08-11 19:49:05,270 [INFO] - Training epoch stats:     Loss: 0.0836 - F1-Score: 0.9751 - Accuracy-Score: 0.9700 - AUROC: 0.9954 - AP: 0.9967
[37m2024-08-11 19:49:05,794 [INFO] - Validation epoch stats:   Loss: 0.4930 - F1-Score: 0.8737 - Accuracy-Score: 0.8439 - AUROC: 0.9193 - AP: 0.9458
[37m2024-08-11 19:49:05,866 [INFO] - Epoch: 8/50
[37m2024-08-11 19:49:07,873 [INFO] - Training epoch stats:     Loss: 0.0756 - F1-Score: 0.9775 - Accuracy-Score: 0.9730 - AUROC: 0.9964 - AP: 0.9974
[37m2024-08-11 19:49:08,371 [INFO] - Validation epoch stats:   Loss: 0.4861 - F1-Score: 0.8803 - Accuracy-Score: 0.8499 - AUROC: 0.9194 - AP: 0.9444
[37m2024-08-11 19:49:08,449 [INFO] - Epoch: 9/50
[37m2024-08-11 19:49:10,174 [INFO] - Training epoch stats:     Loss: 0.0682 - F1-Score: 0.9803 - Accuracy-Score: 0.9763 - AUROC: 0.9971 - AP: 0.9979
[37m2024-08-11 19:49:10,676 [INFO] - Validation epoch stats:   Loss: 0.5324 - F1-Score: 0.8699 - Accuracy-Score: 0.8408 - AUROC: 0.9182 - AP: 0.9439
[37m2024-08-11 19:49:10,751 [INFO] - Epoch: 10/50
[37m2024-08-11 19:49:12,764 [INFO] - Training epoch stats:     Loss: 0.0613 - F1-Score: 0.9823 - Accuracy-Score: 0.9788 - AUROC: 0.9977 - AP: 0.9983
[37m2024-08-11 19:49:13,266 [INFO] - Validation epoch stats:   Loss: 0.5317 - F1-Score: 0.8758 - Accuracy-Score: 0.8469 - AUROC: 0.9208 - AP: 0.9452
[37m2024-08-11 19:49:13,272 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:49:13,438 [INFO] - Epoch: 11/50
[37m2024-08-11 19:49:15,574 [INFO] - Training epoch stats:     Loss: 0.0559 - F1-Score: 0.9839 - Accuracy-Score: 0.9807 - AUROC: 0.9981 - AP: 0.9987
[37m2024-08-11 19:49:16,109 [INFO] - Validation epoch stats:   Loss: 0.5600 - F1-Score: 0.8738 - Accuracy-Score: 0.8449 - AUROC: 0.9189 - AP: 0.9426
[37m2024-08-11 19:49:16,178 [INFO] - Epoch: 12/50
[37m2024-08-11 19:49:18,160 [INFO] - Training epoch stats:     Loss: 0.0502 - F1-Score: 0.9859 - Accuracy-Score: 0.9831 - AUROC: 0.9986 - AP: 0.9990
[37m2024-08-11 19:49:18,665 [INFO] - Validation epoch stats:   Loss: 0.5488 - F1-Score: 0.8837 - Accuracy-Score: 0.8546 - AUROC: 0.9193 - AP: 0.9426
[37m2024-08-11 19:49:18,729 [INFO] - Epoch: 13/50
[37m2024-08-11 19:49:20,768 [INFO] - Training epoch stats:     Loss: 0.0459 - F1-Score: 0.9875 - Accuracy-Score: 0.9850 - AUROC: 0.9988 - AP: 0.9992
[37m2024-08-11 19:49:21,296 [INFO] - Validation epoch stats:   Loss: 0.5534 - F1-Score: 0.8831 - Accuracy-Score: 0.8536 - AUROC: 0.9197 - AP: 0.9427
[37m2024-08-11 19:49:21,365 [INFO] - Epoch: 14/50
[37m2024-08-11 19:49:23,364 [INFO] - Training epoch stats:     Loss: 0.0418 - F1-Score: 0.9891 - Accuracy-Score: 0.9869 - AUROC: 0.9991 - AP: 0.9993
[37m2024-08-11 19:49:23,907 [INFO] - Validation epoch stats:   Loss: 0.5793 - F1-Score: 0.8791 - Accuracy-Score: 0.8501 - AUROC: 0.9198 - AP: 0.9424
[37m2024-08-11 19:49:23,980 [INFO] - Epoch: 15/50
[37m2024-08-11 19:49:25,973 [INFO] - Training epoch stats:     Loss: 0.0383 - F1-Score: 0.9904 - Accuracy-Score: 0.9885 - AUROC: 0.9993 - AP: 0.9995
[37m2024-08-11 19:49:26,546 [INFO] - Validation epoch stats:   Loss: 0.6071 - F1-Score: 0.8755 - Accuracy-Score: 0.8466 - AUROC: 0.9186 - AP: 0.9425
[37m2024-08-11 19:49:26,613 [INFO] - Epoch: 16/50
[37m2024-08-11 19:49:28,769 [INFO] - Training epoch stats:     Loss: 0.0349 - F1-Score: 0.9917 - Accuracy-Score: 0.9900 - AUROC: 0.9994 - AP: 0.9996
[37m2024-08-11 19:49:29,346 [INFO] - Validation epoch stats:   Loss: 0.5992 - F1-Score: 0.8812 - Accuracy-Score: 0.8522 - AUROC: 0.9194 - AP: 0.9423
[37m2024-08-11 19:49:29,409 [INFO] - Epoch: 17/50
[37m2024-08-11 19:49:31,671 [INFO] - Training epoch stats:     Loss: 0.0325 - F1-Score: 0.9922 - Accuracy-Score: 0.9907 - AUROC: 0.9995 - AP: 0.9997
[37m2024-08-11 19:49:32,085 [INFO] - Validation epoch stats:   Loss: 0.6287 - F1-Score: 0.8765 - Accuracy-Score: 0.8470 - AUROC: 0.9163 - AP: 0.9384
[37m2024-08-11 19:49:32,147 [INFO] - Epoch: 18/50
[37m2024-08-11 19:49:34,168 [INFO] - Training epoch stats:     Loss: 0.0298 - F1-Score: 0.9936 - Accuracy-Score: 0.9923 - AUROC: 0.9996 - AP: 0.9997
[37m2024-08-11 19:49:34,621 [INFO] - Validation epoch stats:   Loss: 0.6433 - F1-Score: 0.8784 - Accuracy-Score: 0.8488 - AUROC: 0.9164 - AP: 0.9391
[37m2024-08-11 19:49:34,691 [INFO] - Epoch: 19/50
[37m2024-08-11 19:49:36,778 [INFO] - Training epoch stats:     Loss: 0.0272 - F1-Score: 0.9940 - Accuracy-Score: 0.9928 - AUROC: 0.9997 - AP: 0.9998
[37m2024-08-11 19:49:37,428 [INFO] - Validation epoch stats:   Loss: 0.6495 - F1-Score: 0.8803 - Accuracy-Score: 0.8511 - AUROC: 0.9162 - AP: 0.9374
[37m2024-08-11 19:49:37,493 [INFO] - Epoch: 20/50
[37m2024-08-11 19:49:39,469 [INFO] - Training epoch stats:     Loss: 0.0253 - F1-Score: 0.9947 - Accuracy-Score: 0.9937 - AUROC: 0.9998 - AP: 0.9998
[37m2024-08-11 19:49:40,013 [INFO] - Validation epoch stats:   Loss: 0.6650 - F1-Score: 0.8778 - Accuracy-Score: 0.8487 - AUROC: 0.9165 - AP: 0.9382
[37m2024-08-11 19:49:40,108 [INFO] - Epoch: 21/50
[37m2024-08-11 19:49:42,274 [INFO] - Training epoch stats:     Loss: 0.0229 - F1-Score: 0.9955 - Accuracy-Score: 0.9946 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:49:42,761 [INFO] - Validation epoch stats:   Loss: 0.6840 - F1-Score: 0.8814 - Accuracy-Score: 0.8519 - AUROC: 0.9148 - AP: 0.9363
[37m2024-08-11 19:49:42,836 [INFO] - Epoch: 22/50
[37m2024-08-11 19:49:44,967 [INFO] - Training epoch stats:     Loss: 0.0221 - F1-Score: 0.9957 - Accuracy-Score: 0.9948 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:49:45,383 [INFO] - Validation epoch stats:   Loss: 0.6891 - F1-Score: 0.8827 - Accuracy-Score: 0.8539 - AUROC: 0.9164 - AP: 0.9370
[37m2024-08-11 19:49:45,516 [INFO] - Epoch: 23/50
[37m2024-08-11 19:49:47,469 [INFO] - Training epoch stats:     Loss: 0.0201 - F1-Score: 0.9963 - Accuracy-Score: 0.9955 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:49:47,915 [INFO] - Validation epoch stats:   Loss: 0.7116 - F1-Score: 0.8757 - Accuracy-Score: 0.8468 - AUROC: 0.9160 - AP: 0.9374
[37m2024-08-11 19:49:47,981 [INFO] - Epoch: 24/50
[37m2024-08-11 19:49:49,968 [INFO] - Training epoch stats:     Loss: 0.0188 - F1-Score: 0.9966 - Accuracy-Score: 0.9960 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:49:50,379 [INFO] - Validation epoch stats:   Loss: 0.6972 - F1-Score: 0.8827 - Accuracy-Score: 0.8536 - AUROC: 0.9172 - AP: 0.9382
[37m2024-08-11 19:49:50,444 [INFO] - Epoch: 25/50
[37m2024-08-11 19:49:52,670 [INFO] - Training epoch stats:     Loss: 0.0174 - F1-Score: 0.9968 - Accuracy-Score: 0.9962 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:49:53,372 [INFO] - Validation epoch stats:   Loss: 0.7043 - F1-Score: 0.8824 - Accuracy-Score: 0.8530 - AUROC: 0.9153 - AP: 0.9364
[37m2024-08-11 19:49:53,520 [INFO] - Epoch: 26/50
[37m2024-08-11 19:49:55,270 [INFO] - Training epoch stats:     Loss: 0.0165 - F1-Score: 0.9973 - Accuracy-Score: 0.9968 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:49:55,773 [INFO] - Validation epoch stats:   Loss: 0.7282 - F1-Score: 0.8776 - Accuracy-Score: 0.8480 - AUROC: 0.9142 - AP: 0.9351
[37m2024-08-11 19:49:55,825 [INFO] - Epoch: 27/50
[37m2024-08-11 19:49:58,168 [INFO] - Training epoch stats:     Loss: 0.0155 - F1-Score: 0.9975 - Accuracy-Score: 0.9970 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:49:58,697 [INFO] - Validation epoch stats:   Loss: 0.7752 - F1-Score: 0.8723 - Accuracy-Score: 0.8433 - AUROC: 0.9146 - AP: 0.9360
[37m2024-08-11 19:49:58,760 [INFO] - Epoch: 28/50
[37m2024-08-11 19:50:00,779 [INFO] - Training epoch stats:     Loss: 0.0147 - F1-Score: 0.9977 - Accuracy-Score: 0.9973 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:50:01,307 [INFO] - Validation epoch stats:   Loss: 0.7582 - F1-Score: 0.8768 - Accuracy-Score: 0.8476 - AUROC: 0.9147 - AP: 0.9350
[37m2024-08-11 19:50:01,376 [INFO] - Epoch: 29/50
[37m2024-08-11 19:50:03,360 [INFO] - Training epoch stats:     Loss: 0.0142 - F1-Score: 0.9979 - Accuracy-Score: 0.9975 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:50:03,794 [INFO] - Validation epoch stats:   Loss: 0.7761 - F1-Score: 0.8756 - Accuracy-Score: 0.8466 - AUROC: 0.9142 - AP: 0.9349
[37m2024-08-11 19:50:03,854 [INFO] - Epoch: 30/50
[37m2024-08-11 19:50:05,771 [INFO] - Training epoch stats:     Loss: 0.0130 - F1-Score: 0.9983 - Accuracy-Score: 0.9980 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:50:06,131 [INFO] - Validation epoch stats:   Loss: 0.7575 - F1-Score: 0.8802 - Accuracy-Score: 0.8509 - AUROC: 0.9151 - AP: 0.9357
[37m2024-08-11 19:50:06,136 [INFO] - Performing early stopping!
[37m2024-08-11 19:50:06,143 [INFO] - Finished run p08l7f4l
