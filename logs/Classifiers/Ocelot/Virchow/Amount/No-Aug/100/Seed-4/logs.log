[37m2024-08-11 19:46:44,881 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:46:44,882 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/100/Seed-4/2024-08-11T194633_CellViT-Virchow-100Percent
[37m2024-08-11 19:46:44,945 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f6667f82350>]
[37m2024-08-11 19:46:44,950 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:46:44,954 [INFO] - Using device: cuda:0
[37m2024-08-11 19:46:44,959 [INFO] - Loss function:
[37m2024-08-11 19:46:44,964 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:46:50,434 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:46:51,307 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:46:51,309 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:46:51,314 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:46:51,319 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:46:51,334 [INFO] - Caching datasets
[37m2024-08-11 19:46:57,975 [INFO] - Instantiate Trainer
[37m2024-08-11 19:46:57,986 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:46:57,992 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:46:57,998 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:46:58,004 [INFO] - Epoch: 1/50
[37m2024-08-11 19:47:08,522 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/5d3a6f4be7dabd3ef5aee77fef6efe9fa2f0a18dcb5c8e0300b17482abf922f6.h5
[37m2024-08-11 19:47:10,785 [INFO] - Training epoch stats:     Loss: 0.2629 - F1-Score: 0.9110 - Accuracy-Score: 0.8919 - AUROC: 0.9563 - AP: 0.9681
[37m2024-08-11 19:47:14,921 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:47:15,397 [INFO] - Validation epoch stats:   Loss: 0.3989 - F1-Score: 0.8763 - Accuracy-Score: 0.8467 - AUROC: 0.9156 - AP: 0.9409
[37m2024-08-11 19:47:15,403 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:47:15,577 [INFO] - Epoch: 2/50
[37m2024-08-11 19:47:17,600 [INFO] - Training epoch stats:     Loss: 0.1696 - F1-Score: 0.9461 - Accuracy-Score: 0.9350 - AUROC: 0.9812 - AP: 0.9859
[37m2024-08-11 19:47:18,024 [INFO] - Validation epoch stats:   Loss: 0.4380 - F1-Score: 0.8701 - Accuracy-Score: 0.8399 - AUROC: 0.9150 - AP: 0.9430
[37m2024-08-11 19:47:18,086 [INFO] - Epoch: 3/50
[37m2024-08-11 19:47:19,548 [INFO] - Training epoch stats:     Loss: 0.1392 - F1-Score: 0.9563 - Accuracy-Score: 0.9473 - AUROC: 0.9873 - AP: 0.9906
[37m2024-08-11 19:47:19,850 [INFO] - Validation epoch stats:   Loss: 0.4575 - F1-Score: 0.8646 - Accuracy-Score: 0.8350 - AUROC: 0.9168 - AP: 0.9448
[37m2024-08-11 19:47:19,857 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:47:20,037 [INFO] - Epoch: 4/50
[37m2024-08-11 19:47:21,952 [INFO] - Training epoch stats:     Loss: 0.1182 - F1-Score: 0.9632 - Accuracy-Score: 0.9558 - AUROC: 0.9908 - AP: 0.9933
[37m2024-08-11 19:47:22,404 [INFO] - Validation epoch stats:   Loss: 0.4499 - F1-Score: 0.8737 - Accuracy-Score: 0.8433 - AUROC: 0.9171 - AP: 0.9450
[37m2024-08-11 19:47:22,410 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:47:22,590 [INFO] - Epoch: 5/50
[37m2024-08-11 19:47:24,136 [INFO] - Training epoch stats:     Loss: 0.1034 - F1-Score: 0.9685 - Accuracy-Score: 0.9621 - AUROC: 0.9931 - AP: 0.9950
[37m2024-08-11 19:47:24,440 [INFO] - Validation epoch stats:   Loss: 0.4630 - F1-Score: 0.8759 - Accuracy-Score: 0.8449 - AUROC: 0.9168 - AP: 0.9437
[37m2024-08-11 19:47:24,498 [INFO] - Epoch: 6/50
[37m2024-08-11 19:47:26,398 [INFO] - Training epoch stats:     Loss: 0.0912 - F1-Score: 0.9724 - Accuracy-Score: 0.9668 - AUROC: 0.9946 - AP: 0.9961
[37m2024-08-11 19:47:26,768 [INFO] - Validation epoch stats:   Loss: 0.4584 - F1-Score: 0.8822 - Accuracy-Score: 0.8506 - AUROC: 0.9175 - AP: 0.9434
[37m2024-08-11 19:47:26,786 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:47:26,963 [INFO] - Epoch: 7/50
[37m2024-08-11 19:47:28,623 [INFO] - Training epoch stats:     Loss: 0.0812 - F1-Score: 0.9755 - Accuracy-Score: 0.9706 - AUROC: 0.9958 - AP: 0.9970
[37m2024-08-11 19:47:28,923 [INFO] - Validation epoch stats:   Loss: 0.5054 - F1-Score: 0.8741 - Accuracy-Score: 0.8439 - AUROC: 0.9166 - AP: 0.9433
[37m2024-08-11 19:47:28,993 [INFO] - Epoch: 8/50
[37m2024-08-11 19:47:30,387 [INFO] - Training epoch stats:     Loss: 0.0736 - F1-Score: 0.9777 - Accuracy-Score: 0.9733 - AUROC: 0.9966 - AP: 0.9975
[37m2024-08-11 19:47:30,692 [INFO] - Validation epoch stats:   Loss: 0.5128 - F1-Score: 0.8762 - Accuracy-Score: 0.8465 - AUROC: 0.9170 - AP: 0.9428
[37m2024-08-11 19:47:30,756 [INFO] - Epoch: 9/50
[37m2024-08-11 19:47:32,199 [INFO] - Training epoch stats:     Loss: 0.0657 - F1-Score: 0.9809 - Accuracy-Score: 0.9770 - AUROC: 0.9973 - AP: 0.9981
[37m2024-08-11 19:47:32,518 [INFO] - Validation epoch stats:   Loss: 0.5299 - F1-Score: 0.8812 - Accuracy-Score: 0.8515 - AUROC: 0.9193 - AP: 0.9447
[37m2024-08-11 19:47:32,524 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:47:32,698 [INFO] - Epoch: 10/50
[37m2024-08-11 19:47:34,156 [INFO] - Training epoch stats:     Loss: 0.0602 - F1-Score: 0.9828 - Accuracy-Score: 0.9793 - AUROC: 0.9978 - AP: 0.9984
[37m2024-08-11 19:47:34,457 [INFO] - Validation epoch stats:   Loss: 0.5327 - F1-Score: 0.8784 - Accuracy-Score: 0.8492 - AUROC: 0.9174 - AP: 0.9406
[37m2024-08-11 19:47:34,528 [INFO] - Epoch: 11/50
[37m2024-08-11 19:47:35,958 [INFO] - Training epoch stats:     Loss: 0.0538 - F1-Score: 0.9852 - Accuracy-Score: 0.9822 - AUROC: 0.9983 - AP: 0.9988
[37m2024-08-11 19:47:36,267 [INFO] - Validation epoch stats:   Loss: 0.5498 - F1-Score: 0.8842 - Accuracy-Score: 0.8549 - AUROC: 0.9188 - AP: 0.9424
[37m2024-08-11 19:47:36,328 [INFO] - Epoch: 12/50
[37m2024-08-11 19:47:37,754 [INFO] - Training epoch stats:     Loss: 0.0489 - F1-Score: 0.9868 - Accuracy-Score: 0.9842 - AUROC: 0.9986 - AP: 0.9990
[37m2024-08-11 19:47:38,081 [INFO] - Validation epoch stats:   Loss: 0.5809 - F1-Score: 0.8791 - Accuracy-Score: 0.8495 - AUROC: 0.9168 - AP: 0.9412
[37m2024-08-11 19:47:38,139 [INFO] - Epoch: 13/50
[37m2024-08-11 19:47:39,586 [INFO] - Training epoch stats:     Loss: 0.0443 - F1-Score: 0.9883 - Accuracy-Score: 0.9860 - AUROC: 0.9989 - AP: 0.9992
[37m2024-08-11 19:47:39,891 [INFO] - Validation epoch stats:   Loss: 0.6103 - F1-Score: 0.8714 - Accuracy-Score: 0.8424 - AUROC: 0.9157 - AP: 0.9389
[37m2024-08-11 19:47:39,949 [INFO] - Epoch: 14/50
[37m2024-08-11 19:47:41,423 [INFO] - Training epoch stats:     Loss: 0.0403 - F1-Score: 0.9896 - Accuracy-Score: 0.9875 - AUROC: 0.9992 - AP: 0.9994
[37m2024-08-11 19:47:41,766 [INFO] - Validation epoch stats:   Loss: 0.5917 - F1-Score: 0.8833 - Accuracy-Score: 0.8547 - AUROC: 0.9196 - AP: 0.9416
[37m2024-08-11 19:47:41,773 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:47:41,951 [INFO] - Epoch: 15/50
[37m2024-08-11 19:47:43,516 [INFO] - Training epoch stats:     Loss: 0.0373 - F1-Score: 0.9905 - Accuracy-Score: 0.9887 - AUROC: 0.9993 - AP: 0.9995
[37m2024-08-11 19:47:44,012 [INFO] - Validation epoch stats:   Loss: 0.6250 - F1-Score: 0.8738 - Accuracy-Score: 0.8445 - AUROC: 0.9162 - AP: 0.9391
[37m2024-08-11 19:47:44,082 [INFO] - Epoch: 16/50
[37m2024-08-11 19:47:46,165 [INFO] - Training epoch stats:     Loss: 0.0336 - F1-Score: 0.9922 - Accuracy-Score: 0.9906 - AUROC: 0.9995 - AP: 0.9996
[37m2024-08-11 19:47:46,633 [INFO] - Validation epoch stats:   Loss: 0.6435 - F1-Score: 0.8774 - Accuracy-Score: 0.8489 - AUROC: 0.9185 - AP: 0.9409
[37m2024-08-11 19:47:46,698 [INFO] - Epoch: 17/50
[37m2024-08-11 19:47:48,380 [INFO] - Training epoch stats:     Loss: 0.0305 - F1-Score: 0.9931 - Accuracy-Score: 0.9918 - AUROC: 0.9996 - AP: 0.9997
[37m2024-08-11 19:47:48,685 [INFO] - Validation epoch stats:   Loss: 0.6274 - F1-Score: 0.8835 - Accuracy-Score: 0.8547 - AUROC: 0.9179 - AP: 0.9395
[37m2024-08-11 19:47:48,770 [INFO] - Epoch: 18/50
[37m2024-08-11 19:47:50,216 [INFO] - Training epoch stats:     Loss: 0.0283 - F1-Score: 0.9935 - Accuracy-Score: 0.9922 - AUROC: 0.9997 - AP: 0.9998
[37m2024-08-11 19:47:50,533 [INFO] - Validation epoch stats:   Loss: 0.6487 - F1-Score: 0.8775 - Accuracy-Score: 0.8483 - AUROC: 0.9181 - AP: 0.9401
[37m2024-08-11 19:47:50,612 [INFO] - Epoch: 19/50
[37m2024-08-11 19:47:52,110 [INFO] - Training epoch stats:     Loss: 0.0257 - F1-Score: 0.9946 - Accuracy-Score: 0.9935 - AUROC: 0.9998 - AP: 0.9998
[37m2024-08-11 19:47:52,437 [INFO] - Validation epoch stats:   Loss: 0.6867 - F1-Score: 0.8757 - Accuracy-Score: 0.8470 - AUROC: 0.9167 - AP: 0.9384
[37m2024-08-11 19:47:52,512 [INFO] - Epoch: 20/50
[37m2024-08-11 19:47:54,339 [INFO] - Training epoch stats:     Loss: 0.0240 - F1-Score: 0.9951 - Accuracy-Score: 0.9941 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:47:54,829 [INFO] - Validation epoch stats:   Loss: 0.6696 - F1-Score: 0.8836 - Accuracy-Score: 0.8546 - AUROC: 0.9182 - AP: 0.9400
[37m2024-08-11 19:47:54,917 [INFO] - Epoch: 21/50
[37m2024-08-11 19:47:56,827 [INFO] - Training epoch stats:     Loss: 0.0219 - F1-Score: 0.9959 - Accuracy-Score: 0.9951 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:47:57,254 [INFO] - Validation epoch stats:   Loss: 0.6803 - F1-Score: 0.8874 - Accuracy-Score: 0.8587 - AUROC: 0.9186 - AP: 0.9397
[37m2024-08-11 19:47:57,329 [INFO] - Epoch: 22/50
[37m2024-08-11 19:47:59,256 [INFO] - Training epoch stats:     Loss: 0.0207 - F1-Score: 0.9959 - Accuracy-Score: 0.9951 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:47:59,574 [INFO] - Validation epoch stats:   Loss: 0.6837 - F1-Score: 0.8851 - Accuracy-Score: 0.8558 - AUROC: 0.9177 - AP: 0.9397
[37m2024-08-11 19:47:59,646 [INFO] - Epoch: 23/50
[37m2024-08-11 19:48:01,649 [INFO] - Training epoch stats:     Loss: 0.0194 - F1-Score: 0.9965 - Accuracy-Score: 0.9958 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:48:01,980 [INFO] - Validation epoch stats:   Loss: 0.7115 - F1-Score: 0.8825 - Accuracy-Score: 0.8533 - AUROC: 0.9169 - AP: 0.9378
[37m2024-08-11 19:48:02,059 [INFO] - Epoch: 24/50
[37m2024-08-11 19:48:03,546 [INFO] - Training epoch stats:     Loss: 0.0176 - F1-Score: 0.9969 - Accuracy-Score: 0.9963 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:48:03,841 [INFO] - Validation epoch stats:   Loss: 0.7393 - F1-Score: 0.8764 - Accuracy-Score: 0.8477 - AUROC: 0.9175 - AP: 0.9395
[37m2024-08-11 19:48:03,926 [INFO] - Epoch: 25/50
[37m2024-08-11 19:48:05,371 [INFO] - Training epoch stats:     Loss: 0.0165 - F1-Score: 0.9975 - Accuracy-Score: 0.9970 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:48:05,678 [INFO] - Validation epoch stats:   Loss: 0.7393 - F1-Score: 0.8782 - Accuracy-Score: 0.8491 - AUROC: 0.9161 - AP: 0.9379
[37m2024-08-11 19:48:05,739 [INFO] - Epoch: 26/50
[37m2024-08-11 19:48:07,246 [INFO] - Training epoch stats:     Loss: 0.0153 - F1-Score: 0.9977 - Accuracy-Score: 0.9972 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:07,577 [INFO] - Validation epoch stats:   Loss: 0.7371 - F1-Score: 0.8851 - Accuracy-Score: 0.8560 - AUROC: 0.9171 - AP: 0.9381
[37m2024-08-11 19:48:07,642 [INFO] - Epoch: 27/50
[37m2024-08-11 19:48:09,590 [INFO] - Training epoch stats:     Loss: 0.0144 - F1-Score: 0.9977 - Accuracy-Score: 0.9973 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:10,032 [INFO] - Validation epoch stats:   Loss: 0.7593 - F1-Score: 0.8784 - Accuracy-Score: 0.8495 - AUROC: 0.9171 - AP: 0.9390
[37m2024-08-11 19:48:10,100 [INFO] - Epoch: 28/50
[37m2024-08-11 19:48:12,061 [INFO] - Training epoch stats:     Loss: 0.0145 - F1-Score: 0.9976 - Accuracy-Score: 0.9971 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:12,407 [INFO] - Validation epoch stats:   Loss: 0.7705 - F1-Score: 0.8792 - Accuracy-Score: 0.8504 - AUROC: 0.9165 - AP: 0.9378
[37m2024-08-11 19:48:12,473 [INFO] - Epoch: 29/50
[37m2024-08-11 19:48:13,903 [INFO] - Training epoch stats:     Loss: 0.0128 - F1-Score: 0.9985 - Accuracy-Score: 0.9981 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:14,242 [INFO] - Validation epoch stats:   Loss: 0.7738 - F1-Score: 0.8818 - Accuracy-Score: 0.8530 - AUROC: 0.9177 - AP: 0.9390
[37m2024-08-11 19:48:14,320 [INFO] - Epoch: 30/50
[37m2024-08-11 19:48:15,747 [INFO] - Training epoch stats:     Loss: 0.0125 - F1-Score: 0.9982 - Accuracy-Score: 0.9979 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:16,064 [INFO] - Validation epoch stats:   Loss: 0.7771 - F1-Score: 0.8812 - Accuracy-Score: 0.8524 - AUROC: 0.9171 - AP: 0.9380
[37m2024-08-11 19:48:16,123 [INFO] - Epoch: 31/50
[37m2024-08-11 19:48:17,477 [INFO] - Training epoch stats:     Loss: 0.0117 - F1-Score: 0.9986 - Accuracy-Score: 0.9984 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:17,788 [INFO] - Validation epoch stats:   Loss: 0.7923 - F1-Score: 0.8815 - Accuracy-Score: 0.8529 - AUROC: 0.9175 - AP: 0.9385
[37m2024-08-11 19:48:17,856 [INFO] - Epoch: 32/50
[37m2024-08-11 19:48:19,226 [INFO] - Training epoch stats:     Loss: 0.0112 - F1-Score: 0.9986 - Accuracy-Score: 0.9984 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:19,539 [INFO] - Validation epoch stats:   Loss: 0.8054 - F1-Score: 0.8790 - Accuracy-Score: 0.8502 - AUROC: 0.9167 - AP: 0.9380
[37m2024-08-11 19:48:19,607 [INFO] - Epoch: 33/50
[37m2024-08-11 19:48:20,977 [INFO] - Training epoch stats:     Loss: 0.0105 - F1-Score: 0.9987 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:21,288 [INFO] - Validation epoch stats:   Loss: 0.8167 - F1-Score: 0.8791 - Accuracy-Score: 0.8503 - AUROC: 0.9166 - AP: 0.9375
[37m2024-08-11 19:48:21,349 [INFO] - Epoch: 34/50
[37m2024-08-11 19:48:22,734 [INFO] - Training epoch stats:     Loss: 0.0101 - F1-Score: 0.9990 - Accuracy-Score: 0.9988 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:48:23,044 [INFO] - Validation epoch stats:   Loss: 0.8137 - F1-Score: 0.8832 - Accuracy-Score: 0.8540 - AUROC: 0.9158 - AP: 0.9360
[37m2024-08-11 19:48:23,050 [INFO] - Performing early stopping!
[37m2024-08-11 19:48:23,058 [INFO] - Finished run 6eilbl2h
