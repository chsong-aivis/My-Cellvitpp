[37m2024-08-11 19:27:16,925 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:27:16,926 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/100/Seed-1/2024-08-11T192706_CellViT-Virchow-100Percent
[37m2024-08-11 19:27:16,993 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fd4bc0d7070>]
[37m2024-08-11 19:27:16,994 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:27:16,999 [INFO] - Using device: cuda:0
[37m2024-08-11 19:27:17,005 [INFO] - Loss function:
[37m2024-08-11 19:27:17,011 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:27:25,781 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:27:26,987 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:27:26,988 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:27:26,993 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:27:26,998 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:27:27,016 [INFO] - Caching datasets
[37m2024-08-11 19:27:33,801 [INFO] - Instantiate Trainer
[37m2024-08-11 19:27:33,807 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:27:33,808 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:27:33,814 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:27:33,820 [INFO] - Epoch: 1/50
[37m2024-08-11 19:27:33,826 [INFO] - Extracting training cells
[37m2024-08-11 19:31:33,092 [INFO] - Extraction detection metrics - F1: 0.634, Precision: 0.615, Recall: 0.722, Detected-Cells: 45931
[37m2024-08-11 19:31:33,095 [INFO] - Caching dataset 5d3a6f4be7dabd3ef5aee77fef6efe9fa2f0a18dcb5c8e0300b17482abf922f6 to disk...
[37m2024-08-11 19:32:06,675 [INFO] - Training epoch stats:     Loss: 0.2653 - F1-Score: 0.9078 - Accuracy-Score: 0.8877 - AUROC: 0.9557 - AP: 0.9677
[37m2024-08-11 19:32:10,740 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:32:11,180 [INFO] - Validation epoch stats:   Loss: 0.3896 - F1-Score: 0.8759 - Accuracy-Score: 0.8470 - AUROC: 0.9200 - AP: 0.9457
[37m2024-08-11 19:32:11,181 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:32:11,388 [INFO] - Epoch: 2/50
[37m2024-08-11 19:32:13,271 [INFO] - Training epoch stats:     Loss: 0.1673 - F1-Score: 0.9468 - Accuracy-Score: 0.9359 - AUROC: 0.9818 - AP: 0.9864
[37m2024-08-11 19:32:13,695 [INFO] - Validation epoch stats:   Loss: 0.4219 - F1-Score: 0.8757 - Accuracy-Score: 0.8469 - AUROC: 0.9192 - AP: 0.9466
[37m2024-08-11 19:32:13,743 [INFO] - Epoch: 3/50
[37m2024-08-11 19:32:15,673 [INFO] - Training epoch stats:     Loss: 0.1373 - F1-Score: 0.9567 - Accuracy-Score: 0.9479 - AUROC: 0.9876 - AP: 0.9909
[37m2024-08-11 19:32:16,135 [INFO] - Validation epoch stats:   Loss: 0.4194 - F1-Score: 0.8821 - Accuracy-Score: 0.8512 - AUROC: 0.9185 - AP: 0.9460
[37m2024-08-11 19:32:16,180 [INFO] - Epoch: 4/50
[37m2024-08-11 19:32:18,171 [INFO] - Training epoch stats:     Loss: 0.1177 - F1-Score: 0.9628 - Accuracy-Score: 0.9553 - AUROC: 0.9909 - AP: 0.9934
[37m2024-08-11 19:32:18,593 [INFO] - Validation epoch stats:   Loss: 0.4578 - F1-Score: 0.8708 - Accuracy-Score: 0.8418 - AUROC: 0.9197 - AP: 0.9465
[37m2024-08-11 19:32:18,668 [INFO] - Epoch: 5/50
[37m2024-08-11 19:32:20,383 [INFO] - Training epoch stats:     Loss: 0.1038 - F1-Score: 0.9674 - Accuracy-Score: 0.9608 - AUROC: 0.9930 - AP: 0.9948
[37m2024-08-11 19:32:20,746 [INFO] - Validation epoch stats:   Loss: 0.4861 - F1-Score: 0.8684 - Accuracy-Score: 0.8384 - AUROC: 0.9165 - AP: 0.9446
[37m2024-08-11 19:32:20,815 [INFO] - Epoch: 6/50
[37m2024-08-11 19:32:22,258 [INFO] - Training epoch stats:     Loss: 0.0912 - F1-Score: 0.9718 - Accuracy-Score: 0.9661 - AUROC: 0.9946 - AP: 0.9961
[37m2024-08-11 19:32:22,549 [INFO] - Validation epoch stats:   Loss: 0.5078 - F1-Score: 0.8699 - Accuracy-Score: 0.8416 - AUROC: 0.9199 - AP: 0.9473
[37m2024-08-11 19:32:22,627 [INFO] - Epoch: 7/50
[37m2024-08-11 19:32:24,056 [INFO] - Training epoch stats:     Loss: 0.0819 - F1-Score: 0.9756 - Accuracy-Score: 0.9707 - AUROC: 0.9956 - AP: 0.9968
[37m2024-08-11 19:32:24,354 [INFO] - Validation epoch stats:   Loss: 0.4904 - F1-Score: 0.8776 - Accuracy-Score: 0.8478 - AUROC: 0.9164 - AP: 0.9423
[37m2024-08-11 19:32:24,394 [INFO] - Epoch: 8/50
[37m2024-08-11 19:32:26,357 [INFO] - Training epoch stats:     Loss: 0.0739 - F1-Score: 0.9782 - Accuracy-Score: 0.9738 - AUROC: 0.9965 - AP: 0.9975
[37m2024-08-11 19:32:26,726 [INFO] - Validation epoch stats:   Loss: 0.4972 - F1-Score: 0.8752 - Accuracy-Score: 0.8457 - AUROC: 0.9183 - AP: 0.9444
[37m2024-08-11 19:32:26,807 [INFO] - Epoch: 9/50
[37m2024-08-11 19:32:28,360 [INFO] - Training epoch stats:     Loss: 0.0666 - F1-Score: 0.9806 - Accuracy-Score: 0.9767 - AUROC: 0.9972 - AP: 0.9980
[37m2024-08-11 19:32:28,647 [INFO] - Validation epoch stats:   Loss: 0.5226 - F1-Score: 0.8712 - Accuracy-Score: 0.8429 - AUROC: 0.9203 - AP: 0.9455
[37m2024-08-11 19:32:28,647 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:32:28,844 [INFO] - Epoch: 10/50
[37m2024-08-11 19:32:30,197 [INFO] - Training epoch stats:     Loss: 0.0599 - F1-Score: 0.9826 - Accuracy-Score: 0.9791 - AUROC: 0.9978 - AP: 0.9984
[37m2024-08-11 19:32:30,601 [INFO] - Validation epoch stats:   Loss: 0.5395 - F1-Score: 0.8757 - Accuracy-Score: 0.8466 - AUROC: 0.9179 - AP: 0.9430
[37m2024-08-11 19:32:30,668 [INFO] - Epoch: 11/50
[37m2024-08-11 19:32:32,261 [INFO] - Training epoch stats:     Loss: 0.0544 - F1-Score: 0.9852 - Accuracy-Score: 0.9823 - AUROC: 0.9982 - AP: 0.9988
[37m2024-08-11 19:32:32,611 [INFO] - Validation epoch stats:   Loss: 0.5540 - F1-Score: 0.8748 - Accuracy-Score: 0.8460 - AUROC: 0.9180 - AP: 0.9429
[37m2024-08-11 19:32:32,686 [INFO] - Epoch: 12/50
[37m2024-08-11 19:32:34,465 [INFO] - Training epoch stats:     Loss: 0.0492 - F1-Score: 0.9868 - Accuracy-Score: 0.9842 - AUROC: 0.9986 - AP: 0.9990
[37m2024-08-11 19:32:34,881 [INFO] - Validation epoch stats:   Loss: 0.5494 - F1-Score: 0.8801 - Accuracy-Score: 0.8517 - AUROC: 0.9207 - AP: 0.9440
[37m2024-08-11 19:32:34,882 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:32:35,092 [INFO] - Epoch: 13/50
[37m2024-08-11 19:32:36,881 [INFO] - Training epoch stats:     Loss: 0.0447 - F1-Score: 0.9886 - Accuracy-Score: 0.9863 - AUROC: 0.9989 - AP: 0.9992
[37m2024-08-11 19:32:37,439 [INFO] - Validation epoch stats:   Loss: 0.5987 - F1-Score: 0.8724 - Accuracy-Score: 0.8438 - AUROC: 0.9182 - AP: 0.9414
[37m2024-08-11 19:32:37,525 [INFO] - Epoch: 14/50
[37m2024-08-11 19:32:39,471 [INFO] - Training epoch stats:     Loss: 0.0411 - F1-Score: 0.9897 - Accuracy-Score: 0.9876 - AUROC: 0.9991 - AP: 0.9994
[37m2024-08-11 19:32:39,910 [INFO] - Validation epoch stats:   Loss: 0.6017 - F1-Score: 0.8735 - Accuracy-Score: 0.8454 - AUROC: 0.9192 - AP: 0.9421
[37m2024-08-11 19:32:39,984 [INFO] - Epoch: 15/50
[37m2024-08-11 19:32:41,975 [INFO] - Training epoch stats:     Loss: 0.0376 - F1-Score: 0.9904 - Accuracy-Score: 0.9885 - AUROC: 0.9993 - AP: 0.9995
[37m2024-08-11 19:32:42,435 [INFO] - Validation epoch stats:   Loss: 0.6185 - F1-Score: 0.8763 - Accuracy-Score: 0.8477 - AUROC: 0.9179 - AP: 0.9407
[37m2024-08-11 19:32:42,513 [INFO] - Epoch: 16/50
[37m2024-08-11 19:32:44,471 [INFO] - Training epoch stats:     Loss: 0.0343 - F1-Score: 0.9917 - Accuracy-Score: 0.9901 - AUROC: 0.9995 - AP: 0.9996
[37m2024-08-11 19:32:44,829 [INFO] - Validation epoch stats:   Loss: 0.6444 - F1-Score: 0.8748 - Accuracy-Score: 0.8461 - AUROC: 0.9156 - AP: 0.9381
[37m2024-08-11 19:32:44,891 [INFO] - Epoch: 17/50
[37m2024-08-11 19:32:47,070 [INFO] - Training epoch stats:     Loss: 0.0312 - F1-Score: 0.9926 - Accuracy-Score: 0.9911 - AUROC: 0.9996 - AP: 0.9997
[37m2024-08-11 19:32:47,457 [INFO] - Validation epoch stats:   Loss: 0.6644 - F1-Score: 0.8682 - Accuracy-Score: 0.8401 - AUROC: 0.9187 - AP: 0.9416
[37m2024-08-11 19:32:47,524 [INFO] - Epoch: 18/50
[37m2024-08-11 19:32:49,308 [INFO] - Training epoch stats:     Loss: 0.0285 - F1-Score: 0.9940 - Accuracy-Score: 0.9928 - AUROC: 0.9997 - AP: 0.9998
[37m2024-08-11 19:32:49,648 [INFO] - Validation epoch stats:   Loss: 0.6320 - F1-Score: 0.8849 - Accuracy-Score: 0.8560 - AUROC: 0.9175 - AP: 0.9388
[37m2024-08-11 19:32:49,711 [INFO] - Epoch: 19/50
[37m2024-08-11 19:32:51,167 [INFO] - Training epoch stats:     Loss: 0.0271 - F1-Score: 0.9941 - Accuracy-Score: 0.9930 - AUROC: 0.9997 - AP: 0.9998
[37m2024-08-11 19:32:51,575 [INFO] - Validation epoch stats:   Loss: 0.6660 - F1-Score: 0.8751 - Accuracy-Score: 0.8467 - AUROC: 0.9181 - AP: 0.9405
[37m2024-08-11 19:32:51,662 [INFO] - Epoch: 20/50
[37m2024-08-11 19:32:53,658 [INFO] - Training epoch stats:     Loss: 0.0245 - F1-Score: 0.9950 - Accuracy-Score: 0.9941 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:32:54,037 [INFO] - Validation epoch stats:   Loss: 0.6799 - F1-Score: 0.8742 - Accuracy-Score: 0.8454 - AUROC: 0.9162 - AP: 0.9388
[37m2024-08-11 19:32:54,123 [INFO] - Epoch: 21/50
[37m2024-08-11 19:32:55,968 [INFO] - Training epoch stats:     Loss: 0.0228 - F1-Score: 0.9955 - Accuracy-Score: 0.9947 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:32:56,437 [INFO] - Validation epoch stats:   Loss: 0.6838 - F1-Score: 0.8764 - Accuracy-Score: 0.8476 - AUROC: 0.9164 - AP: 0.9385
[37m2024-08-11 19:32:56,526 [INFO] - Epoch: 22/50
[37m2024-08-11 19:32:58,356 [INFO] - Training epoch stats:     Loss: 0.0212 - F1-Score: 0.9960 - Accuracy-Score: 0.9953 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:32:58,702 [INFO] - Validation epoch stats:   Loss: 0.6778 - F1-Score: 0.8834 - Accuracy-Score: 0.8554 - AUROC: 0.9196 - AP: 0.9412
[37m2024-08-11 19:32:58,780 [INFO] - Epoch: 23/50
[37m2024-08-11 19:33:00,767 [INFO] - Training epoch stats:     Loss: 0.0199 - F1-Score: 0.9966 - Accuracy-Score: 0.9959 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:33:01,216 [INFO] - Validation epoch stats:   Loss: 0.6763 - F1-Score: 0.8882 - Accuracy-Score: 0.8597 - AUROC: 0.9191 - AP: 0.9395
[37m2024-08-11 19:33:01,267 [INFO] - Epoch: 24/50
[37m2024-08-11 19:33:03,171 [INFO] - Training epoch stats:     Loss: 0.0181 - F1-Score: 0.9970 - Accuracy-Score: 0.9964 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:33:03,559 [INFO] - Validation epoch stats:   Loss: 0.6918 - F1-Score: 0.8834 - Accuracy-Score: 0.8550 - AUROC: 0.9190 - AP: 0.9402
[37m2024-08-11 19:33:03,644 [INFO] - Epoch: 25/50
[37m2024-08-11 19:33:05,465 [INFO] - Training epoch stats:     Loss: 0.0171 - F1-Score: 0.9973 - Accuracy-Score: 0.9968 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:33:05,889 [INFO] - Validation epoch stats:   Loss: 0.7152 - F1-Score: 0.8798 - Accuracy-Score: 0.8515 - AUROC: 0.9186 - AP: 0.9405
[37m2024-08-11 19:33:05,956 [INFO] - Epoch: 26/50
[37m2024-08-11 19:33:07,658 [INFO] - Training epoch stats:     Loss: 0.0157 - F1-Score: 0.9977 - Accuracy-Score: 0.9973 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:33:08,273 [INFO] - Validation epoch stats:   Loss: 0.7303 - F1-Score: 0.8768 - Accuracy-Score: 0.8485 - AUROC: 0.9184 - AP: 0.9402
[37m2024-08-11 19:33:08,337 [INFO] - Epoch: 27/50
[37m2024-08-11 19:33:10,169 [INFO] - Training epoch stats:     Loss: 0.0148 - F1-Score: 0.9977 - Accuracy-Score: 0.9972 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:33:10,603 [INFO] - Validation epoch stats:   Loss: 0.7336 - F1-Score: 0.8795 - Accuracy-Score: 0.8515 - AUROC: 0.9191 - AP: 0.9405
[37m2024-08-11 19:33:10,691 [INFO] - Epoch: 28/50
[37m2024-08-11 19:33:12,558 [INFO] - Training epoch stats:     Loss: 0.0140 - F1-Score: 0.9983 - Accuracy-Score: 0.9980 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:33:12,970 [INFO] - Validation epoch stats:   Loss: 0.7322 - F1-Score: 0.8812 - Accuracy-Score: 0.8530 - AUROC: 0.9193 - AP: 0.9411
[37m2024-08-11 19:33:13,032 [INFO] - Epoch: 29/50
[37m2024-08-11 19:33:14,962 [INFO] - Training epoch stats:     Loss: 0.0132 - F1-Score: 0.9981 - Accuracy-Score: 0.9977 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:33:15,376 [INFO] - Validation epoch stats:   Loss: 0.7736 - F1-Score: 0.8745 - Accuracy-Score: 0.8462 - AUROC: 0.9169 - AP: 0.9381
[37m2024-08-11 19:33:15,464 [INFO] - Epoch: 30/50
[37m2024-08-11 19:33:17,276 [INFO] - Training epoch stats:     Loss: 0.0126 - F1-Score: 0.9986 - Accuracy-Score: 0.9983 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:33:17,772 [INFO] - Validation epoch stats:   Loss: 0.7621 - F1-Score: 0.8789 - Accuracy-Score: 0.8503 - AUROC: 0.9161 - AP: 0.9376
[37m2024-08-11 19:33:17,864 [INFO] - Epoch: 31/50
[37m2024-08-11 19:33:19,667 [INFO] - Training epoch stats:     Loss: 0.0121 - F1-Score: 0.9983 - Accuracy-Score: 0.9979 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:33:20,082 [INFO] - Validation epoch stats:   Loss: 0.7708 - F1-Score: 0.8769 - Accuracy-Score: 0.8483 - AUROC: 0.9161 - AP: 0.9372
[37m2024-08-11 19:33:20,135 [INFO] - Epoch: 32/50
[37m2024-08-11 19:33:22,069 [INFO] - Training epoch stats:     Loss: 0.0112 - F1-Score: 0.9986 - Accuracy-Score: 0.9983 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:33:22,512 [INFO] - Validation epoch stats:   Loss: 0.7765 - F1-Score: 0.8798 - Accuracy-Score: 0.8513 - AUROC: 0.9167 - AP: 0.9375
[37m2024-08-11 19:33:22,513 [INFO] - Performing early stopping!
[37m2024-08-11 19:33:22,524 [INFO] - Finished run rhk47hc4
