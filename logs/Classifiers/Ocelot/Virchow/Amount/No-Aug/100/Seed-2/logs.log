[37m2024-08-11 19:48:05,243 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:48:05,244 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/100/Seed-2/2024-08-11T194753_CellViT-Virchow-100Percent
[37m2024-08-11 19:48:05,313 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7ff898110280>]
[37m2024-08-11 19:48:05,320 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:48:05,325 [INFO] - Using device: cuda:0
[37m2024-08-11 19:48:05,329 [INFO] - Loss function:
[37m2024-08-11 19:48:05,335 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:48:18,468 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:48:21,171 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:48:21,178 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:48:21,183 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:48:21,188 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:48:21,272 [INFO] - Caching datasets
[37m2024-08-11 19:48:29,075 [INFO] - Instantiate Trainer
[37m2024-08-11 19:48:29,082 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:48:29,088 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:48:29,092 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:48:29,097 [INFO] - Epoch: 1/50
[37m2024-08-11 19:48:42,427 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/5d3a6f4be7dabd3ef5aee77fef6efe9fa2f0a18dcb5c8e0300b17482abf922f6.h5
[37m2024-08-11 19:48:44,774 [INFO] - Training epoch stats:     Loss: 0.2644 - F1-Score: 0.9097 - Accuracy-Score: 0.8901 - AUROC: 0.9560 - AP: 0.9679
[37m2024-08-11 19:48:49,274 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:48:49,749 [INFO] - Validation epoch stats:   Loss: 0.3876 - F1-Score: 0.8784 - Accuracy-Score: 0.8486 - AUROC: 0.9162 - AP: 0.9427
[37m2024-08-11 19:48:49,755 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:49,966 [INFO] - Epoch: 2/50
[37m2024-08-11 19:48:52,064 [INFO] - Training epoch stats:     Loss: 0.1728 - F1-Score: 0.9446 - Accuracy-Score: 0.9332 - AUROC: 0.9806 - AP: 0.9857
[37m2024-08-11 19:48:52,561 [INFO] - Validation epoch stats:   Loss: 0.3936 - F1-Score: 0.8830 - Accuracy-Score: 0.8509 - AUROC: 0.9191 - AP: 0.9469
[37m2024-08-11 19:48:52,568 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:52,750 [INFO] - Epoch: 3/50
[37m2024-08-11 19:48:54,869 [INFO] - Training epoch stats:     Loss: 0.1410 - F1-Score: 0.9559 - Accuracy-Score: 0.9469 - AUROC: 0.9869 - AP: 0.9904
[37m2024-08-11 19:48:55,303 [INFO] - Validation epoch stats:   Loss: 0.4291 - F1-Score: 0.8746 - Accuracy-Score: 0.8445 - AUROC: 0.9167 - AP: 0.9443
[37m2024-08-11 19:48:55,367 [INFO] - Epoch: 4/50
[37m2024-08-11 19:48:57,277 [INFO] - Training epoch stats:     Loss: 0.1212 - F1-Score: 0.9623 - Accuracy-Score: 0.9546 - AUROC: 0.9904 - AP: 0.9929
[37m2024-08-11 19:48:57,750 [INFO] - Validation epoch stats:   Loss: 0.4375 - F1-Score: 0.8769 - Accuracy-Score: 0.8468 - AUROC: 0.9181 - AP: 0.9465
[37m2024-08-11 19:48:57,811 [INFO] - Epoch: 5/50
[37m2024-08-11 19:48:59,465 [INFO] - Training epoch stats:     Loss: 0.1048 - F1-Score: 0.9673 - Accuracy-Score: 0.9607 - AUROC: 0.9928 - AP: 0.9947
[37m2024-08-11 19:49:00,047 [INFO] - Validation epoch stats:   Loss: 0.4660 - F1-Score: 0.8694 - Accuracy-Score: 0.8397 - AUROC: 0.9169 - AP: 0.9443
[37m2024-08-11 19:49:00,117 [INFO] - Epoch: 6/50
[37m2024-08-11 19:49:02,171 [INFO] - Training epoch stats:     Loss: 0.0939 - F1-Score: 0.9715 - Accuracy-Score: 0.9658 - AUROC: 0.9942 - AP: 0.9958
[37m2024-08-11 19:49:02,684 [INFO] - Validation epoch stats:   Loss: 0.4680 - F1-Score: 0.8770 - Accuracy-Score: 0.8473 - AUROC: 0.9178 - AP: 0.9445
[37m2024-08-11 19:49:02,753 [INFO] - Epoch: 7/50
[37m2024-08-11 19:49:05,471 [INFO] - Training epoch stats:     Loss: 0.0838 - F1-Score: 0.9745 - Accuracy-Score: 0.9694 - AUROC: 0.9955 - AP: 0.9967
[37m2024-08-11 19:49:05,955 [INFO] - Validation epoch stats:   Loss: 0.4924 - F1-Score: 0.8756 - Accuracy-Score: 0.8473 - AUROC: 0.9216 - AP: 0.9479
[37m2024-08-11 19:49:05,962 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:49:06,139 [INFO] - Epoch: 8/50
[37m2024-08-11 19:49:08,168 [INFO] - Training epoch stats:     Loss: 0.0747 - F1-Score: 0.9777 - Accuracy-Score: 0.9732 - AUROC: 0.9965 - AP: 0.9975
[37m2024-08-11 19:49:08,603 [INFO] - Validation epoch stats:   Loss: 0.5047 - F1-Score: 0.8790 - Accuracy-Score: 0.8499 - AUROC: 0.9190 - AP: 0.9441
[37m2024-08-11 19:49:08,664 [INFO] - Epoch: 9/50
[37m2024-08-11 19:49:10,572 [INFO] - Training epoch stats:     Loss: 0.0677 - F1-Score: 0.9800 - Accuracy-Score: 0.9760 - AUROC: 0.9972 - AP: 0.9979
[37m2024-08-11 19:49:11,055 [INFO] - Validation epoch stats:   Loss: 0.5779 - F1-Score: 0.8618 - Accuracy-Score: 0.8332 - AUROC: 0.9153 - AP: 0.9405
[37m2024-08-11 19:49:11,115 [INFO] - Epoch: 10/50
[37m2024-08-11 19:49:13,169 [INFO] - Training epoch stats:     Loss: 0.0612 - F1-Score: 0.9826 - Accuracy-Score: 0.9791 - AUROC: 0.9977 - AP: 0.9983
[37m2024-08-11 19:49:13,681 [INFO] - Validation epoch stats:   Loss: 0.5479 - F1-Score: 0.8737 - Accuracy-Score: 0.8447 - AUROC: 0.9174 - AP: 0.9423
[37m2024-08-11 19:49:13,751 [INFO] - Epoch: 11/50
[37m2024-08-11 19:49:15,871 [INFO] - Training epoch stats:     Loss: 0.0545 - F1-Score: 0.9845 - Accuracy-Score: 0.9814 - AUROC: 0.9983 - AP: 0.9987
[37m2024-08-11 19:49:16,307 [INFO] - Validation epoch stats:   Loss: 0.5932 - F1-Score: 0.8701 - Accuracy-Score: 0.8412 - AUROC: 0.9147 - AP: 0.9383
[37m2024-08-11 19:49:16,374 [INFO] - Epoch: 12/50
[37m2024-08-11 19:49:18,281 [INFO] - Training epoch stats:     Loss: 0.0495 - F1-Score: 0.9869 - Accuracy-Score: 0.9843 - AUROC: 0.9986 - AP: 0.9990
[37m2024-08-11 19:49:18,817 [INFO] - Validation epoch stats:   Loss: 0.5783 - F1-Score: 0.8771 - Accuracy-Score: 0.8474 - AUROC: 0.9138 - AP: 0.9373
[37m2024-08-11 19:49:18,900 [INFO] - Epoch: 13/50
[37m2024-08-11 19:49:20,967 [INFO] - Training epoch stats:     Loss: 0.0459 - F1-Score: 0.9875 - Accuracy-Score: 0.9850 - AUROC: 0.9989 - AP: 0.9992
[37m2024-08-11 19:49:21,455 [INFO] - Validation epoch stats:   Loss: 0.5974 - F1-Score: 0.8729 - Accuracy-Score: 0.8438 - AUROC: 0.9163 - AP: 0.9393
[37m2024-08-11 19:49:21,519 [INFO] - Epoch: 14/50
[37m2024-08-11 19:49:23,555 [INFO] - Training epoch stats:     Loss: 0.0419 - F1-Score: 0.9892 - Accuracy-Score: 0.9871 - AUROC: 0.9991 - AP: 0.9993
[37m2024-08-11 19:49:24,055 [INFO] - Validation epoch stats:   Loss: 0.5954 - F1-Score: 0.8810 - Accuracy-Score: 0.8526 - AUROC: 0.9179 - AP: 0.9399
[37m2024-08-11 19:49:24,118 [INFO] - Epoch: 15/50
[37m2024-08-11 19:49:26,173 [INFO] - Training epoch stats:     Loss: 0.0377 - F1-Score: 0.9904 - Accuracy-Score: 0.9885 - AUROC: 0.9993 - AP: 0.9995
[37m2024-08-11 19:49:26,662 [INFO] - Validation epoch stats:   Loss: 0.6275 - F1-Score: 0.8754 - Accuracy-Score: 0.8469 - AUROC: 0.9161 - AP: 0.9377
[37m2024-08-11 19:49:26,815 [INFO] - Epoch: 16/50
[37m2024-08-11 19:49:28,958 [INFO] - Training epoch stats:     Loss: 0.0342 - F1-Score: 0.9920 - Accuracy-Score: 0.9904 - AUROC: 0.9995 - AP: 0.9996
[37m2024-08-11 19:49:29,412 [INFO] - Validation epoch stats:   Loss: 0.6695 - F1-Score: 0.8689 - Accuracy-Score: 0.8402 - AUROC: 0.9147 - AP: 0.9370
[37m2024-08-11 19:49:29,509 [INFO] - Epoch: 17/50
[37m2024-08-11 19:49:31,864 [INFO] - Training epoch stats:     Loss: 0.0318 - F1-Score: 0.9926 - Accuracy-Score: 0.9911 - AUROC: 0.9996 - AP: 0.9997
[37m2024-08-11 19:49:32,324 [INFO] - Validation epoch stats:   Loss: 0.6509 - F1-Score: 0.8759 - Accuracy-Score: 0.8473 - AUROC: 0.9168 - AP: 0.9393
[37m2024-08-11 19:49:32,397 [INFO] - Epoch: 18/50
[37m2024-08-11 19:49:34,367 [INFO] - Training epoch stats:     Loss: 0.0291 - F1-Score: 0.9935 - Accuracy-Score: 0.9922 - AUROC: 0.9997 - AP: 0.9998
[37m2024-08-11 19:49:34,805 [INFO] - Validation epoch stats:   Loss: 0.6650 - F1-Score: 0.8754 - Accuracy-Score: 0.8466 - AUROC: 0.9142 - AP: 0.9359
[37m2024-08-11 19:49:34,876 [INFO] - Epoch: 19/50
[37m2024-08-11 19:49:37,058 [INFO] - Training epoch stats:     Loss: 0.0262 - F1-Score: 0.9946 - Accuracy-Score: 0.9936 - AUROC: 0.9998 - AP: 0.9998
[37m2024-08-11 19:49:37,534 [INFO] - Validation epoch stats:   Loss: 0.6982 - F1-Score: 0.8747 - Accuracy-Score: 0.8459 - AUROC: 0.9138 - AP: 0.9352
[37m2024-08-11 19:49:37,617 [INFO] - Epoch: 20/50
[37m2024-08-11 19:49:39,579 [INFO] - Training epoch stats:     Loss: 0.0242 - F1-Score: 0.9950 - Accuracy-Score: 0.9940 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:49:40,166 [INFO] - Validation epoch stats:   Loss: 0.6899 - F1-Score: 0.8767 - Accuracy-Score: 0.8481 - AUROC: 0.9158 - AP: 0.9366
[37m2024-08-11 19:49:40,312 [INFO] - Epoch: 21/50
[37m2024-08-11 19:49:42,064 [INFO] - Training epoch stats:     Loss: 0.0226 - F1-Score: 0.9955 - Accuracy-Score: 0.9946 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:49:42,697 [INFO] - Validation epoch stats:   Loss: 0.7478 - F1-Score: 0.8629 - Accuracy-Score: 0.8344 - AUROC: 0.9136 - AP: 0.9358
[37m2024-08-11 19:49:42,779 [INFO] - Epoch: 22/50
[37m2024-08-11 19:49:44,765 [INFO] - Training epoch stats:     Loss: 0.0212 - F1-Score: 0.9960 - Accuracy-Score: 0.9952 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:49:45,290 [INFO] - Validation epoch stats:   Loss: 0.7359 - F1-Score: 0.8719 - Accuracy-Score: 0.8436 - AUROC: 0.9146 - AP: 0.9351
[37m2024-08-11 19:49:45,351 [INFO] - Epoch: 23/50
[37m2024-08-11 19:49:47,168 [INFO] - Training epoch stats:     Loss: 0.0196 - F1-Score: 0.9965 - Accuracy-Score: 0.9958 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:49:47,670 [INFO] - Validation epoch stats:   Loss: 0.7255 - F1-Score: 0.8756 - Accuracy-Score: 0.8467 - AUROC: 0.9136 - AP: 0.9340
[37m2024-08-11 19:49:47,742 [INFO] - Epoch: 24/50
[37m2024-08-11 19:49:49,664 [INFO] - Training epoch stats:     Loss: 0.0179 - F1-Score: 0.9970 - Accuracy-Score: 0.9964 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:49:50,139 [INFO] - Validation epoch stats:   Loss: 0.7341 - F1-Score: 0.8732 - Accuracy-Score: 0.8442 - AUROC: 0.9141 - AP: 0.9350
[37m2024-08-11 19:49:50,209 [INFO] - Epoch: 25/50
[37m2024-08-11 19:49:52,559 [INFO] - Training epoch stats:     Loss: 0.0176 - F1-Score: 0.9969 - Accuracy-Score: 0.9963 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:49:53,190 [INFO] - Validation epoch stats:   Loss: 0.7645 - F1-Score: 0.8695 - Accuracy-Score: 0.8411 - AUROC: 0.9152 - AP: 0.9361
[37m2024-08-11 19:49:53,319 [INFO] - Epoch: 26/50
[37m2024-08-11 19:49:55,568 [INFO] - Training epoch stats:     Loss: 0.0157 - F1-Score: 0.9978 - Accuracy-Score: 0.9974 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:49:56,026 [INFO] - Validation epoch stats:   Loss: 0.7793 - F1-Score: 0.8722 - Accuracy-Score: 0.8435 - AUROC: 0.9134 - AP: 0.9339
[37m2024-08-11 19:49:56,100 [INFO] - Epoch: 27/50
[37m2024-08-11 19:49:58,574 [INFO] - Training epoch stats:     Loss: 0.0149 - F1-Score: 0.9977 - Accuracy-Score: 0.9972 - AUROC: 1.0000 - AP: 1.0000
[37m2024-08-11 19:49:59,069 [INFO] - Validation epoch stats:   Loss: 0.7491 - F1-Score: 0.8777 - Accuracy-Score: 0.8484 - AUROC: 0.9139 - AP: 0.9335
[37m2024-08-11 19:49:59,077 [INFO] - Performing early stopping!
[37m2024-08-11 19:49:59,087 [INFO] - Finished run 6z44c4xq
