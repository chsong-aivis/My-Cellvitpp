[37m2024-08-11 19:47:35,320 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:47:35,321 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/100/Seed-5/2024-08-11T194724_CellViT-Virchow-100Percent
[37m2024-08-11 19:47:35,388 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f55d99ff970>]
[37m2024-08-11 19:47:35,394 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:47:35,398 [INFO] - Using device: cuda:0
[37m2024-08-11 19:47:35,403 [INFO] - Loss function:
[37m2024-08-11 19:47:35,408 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:47:41,180 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:47:42,103 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:47:42,111 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:47:42,116 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:47:42,121 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:47:42,138 [INFO] - Caching datasets
[37m2024-08-11 19:47:48,176 [INFO] - Instantiate Trainer
[37m2024-08-11 19:47:48,185 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:47:48,190 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:47:48,195 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:47:48,200 [INFO] - Epoch: 1/50
[37m2024-08-11 19:47:58,876 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/5d3a6f4be7dabd3ef5aee77fef6efe9fa2f0a18dcb5c8e0300b17482abf922f6.h5
[37m2024-08-11 19:48:01,115 [INFO] - Training epoch stats:     Loss: 0.2671 - F1-Score: 0.9099 - Accuracy-Score: 0.8899 - AUROC: 0.9552 - AP: 0.9676
[37m2024-08-11 19:48:05,109 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:48:05,503 [INFO] - Validation epoch stats:   Loss: 0.3852 - F1-Score: 0.8789 - Accuracy-Score: 0.8490 - AUROC: 0.9158 - AP: 0.9400
[37m2024-08-11 19:48:05,510 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:05,678 [INFO] - Epoch: 2/50
[37m2024-08-11 19:48:07,354 [INFO] - Training epoch stats:     Loss: 0.1740 - F1-Score: 0.9442 - Accuracy-Score: 0.9328 - AUROC: 0.9803 - AP: 0.9854
[37m2024-08-11 19:48:07,724 [INFO] - Validation epoch stats:   Loss: 0.4041 - F1-Score: 0.8751 - Accuracy-Score: 0.8448 - AUROC: 0.9177 - AP: 0.9449
[37m2024-08-11 19:48:07,729 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:07,910 [INFO] - Epoch: 3/50
[37m2024-08-11 19:48:09,776 [INFO] - Training epoch stats:     Loss: 0.1442 - F1-Score: 0.9543 - Accuracy-Score: 0.9450 - AUROC: 0.9865 - AP: 0.9900
[37m2024-08-11 19:48:10,264 [INFO] - Validation epoch stats:   Loss: 0.4180 - F1-Score: 0.8776 - Accuracy-Score: 0.8468 - AUROC: 0.9183 - AP: 0.9460
[37m2024-08-11 19:48:10,270 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:10,450 [INFO] - Epoch: 4/50
[37m2024-08-11 19:48:12,415 [INFO] - Training epoch stats:     Loss: 0.1244 - F1-Score: 0.9609 - Accuracy-Score: 0.9530 - AUROC: 0.9899 - AP: 0.9926
[37m2024-08-11 19:48:12,798 [INFO] - Validation epoch stats:   Loss: 0.4507 - F1-Score: 0.8682 - Accuracy-Score: 0.8379 - AUROC: 0.9162 - AP: 0.9453
[37m2024-08-11 19:48:12,862 [INFO] - Epoch: 5/50
[37m2024-08-11 19:48:14,444 [INFO] - Training epoch stats:     Loss: 0.1091 - F1-Score: 0.9664 - Accuracy-Score: 0.9596 - AUROC: 0.9922 - AP: 0.9944
[37m2024-08-11 19:48:14,759 [INFO] - Validation epoch stats:   Loss: 0.4914 - F1-Score: 0.8568 - Accuracy-Score: 0.8271 - AUROC: 0.9148 - AP: 0.9448
[37m2024-08-11 19:48:14,820 [INFO] - Epoch: 6/50
[37m2024-08-11 19:48:16,213 [INFO] - Training epoch stats:     Loss: 0.0958 - F1-Score: 0.9709 - Accuracy-Score: 0.9651 - AUROC: 0.9941 - AP: 0.9957
[37m2024-08-11 19:48:16,542 [INFO] - Validation epoch stats:   Loss: 0.4853 - F1-Score: 0.8691 - Accuracy-Score: 0.8378 - AUROC: 0.9143 - AP: 0.9421
[37m2024-08-11 19:48:16,607 [INFO] - Epoch: 7/50
[37m2024-08-11 19:48:18,308 [INFO] - Training epoch stats:     Loss: 0.0857 - F1-Score: 0.9740 - Accuracy-Score: 0.9688 - AUROC: 0.9952 - AP: 0.9965
[37m2024-08-11 19:48:18,641 [INFO] - Validation epoch stats:   Loss: 0.4734 - F1-Score: 0.8773 - Accuracy-Score: 0.8480 - AUROC: 0.9219 - AP: 0.9488
[37m2024-08-11 19:48:18,647 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:48:18,822 [INFO] - Epoch: 8/50
[37m2024-08-11 19:48:20,253 [INFO] - Training epoch stats:     Loss: 0.0775 - F1-Score: 0.9770 - Accuracy-Score: 0.9724 - AUROC: 0.9962 - AP: 0.9972
[37m2024-08-11 19:48:20,594 [INFO] - Validation epoch stats:   Loss: 0.5038 - F1-Score: 0.8789 - Accuracy-Score: 0.8482 - AUROC: 0.9165 - AP: 0.9432
[37m2024-08-11 19:48:20,654 [INFO] - Epoch: 9/50
[37m2024-08-11 19:48:22,081 [INFO] - Training epoch stats:     Loss: 0.0691 - F1-Score: 0.9799 - Accuracy-Score: 0.9759 - AUROC: 0.9970 - AP: 0.9978
[37m2024-08-11 19:48:22,398 [INFO] - Validation epoch stats:   Loss: 0.5378 - F1-Score: 0.8678 - Accuracy-Score: 0.8374 - AUROC: 0.9147 - AP: 0.9416
[37m2024-08-11 19:48:22,452 [INFO] - Epoch: 10/50
[37m2024-08-11 19:48:23,841 [INFO] - Training epoch stats:     Loss: 0.0634 - F1-Score: 0.9817 - Accuracy-Score: 0.9781 - AUROC: 0.9975 - AP: 0.9982
[37m2024-08-11 19:48:24,135 [INFO] - Validation epoch stats:   Loss: 0.5454 - F1-Score: 0.8669 - Accuracy-Score: 0.8372 - AUROC: 0.9161 - AP: 0.9431
[37m2024-08-11 19:48:24,203 [INFO] - Epoch: 11/50
[37m2024-08-11 19:48:25,603 [INFO] - Training epoch stats:     Loss: 0.0564 - F1-Score: 0.9843 - Accuracy-Score: 0.9811 - AUROC: 0.9981 - AP: 0.9987
[37m2024-08-11 19:48:25,901 [INFO] - Validation epoch stats:   Loss: 0.5333 - F1-Score: 0.8805 - Accuracy-Score: 0.8501 - AUROC: 0.9181 - AP: 0.9437
[37m2024-08-11 19:48:25,965 [INFO] - Epoch: 12/50
[37m2024-08-11 19:48:27,399 [INFO] - Training epoch stats:     Loss: 0.0512 - F1-Score: 0.9859 - Accuracy-Score: 0.9831 - AUROC: 0.9985 - AP: 0.9990
[37m2024-08-11 19:48:27,702 [INFO] - Validation epoch stats:   Loss: 0.5715 - F1-Score: 0.8682 - Accuracy-Score: 0.8382 - AUROC: 0.9146 - AP: 0.9403
[37m2024-08-11 19:48:27,771 [INFO] - Epoch: 13/50
[37m2024-08-11 19:48:29,194 [INFO] - Training epoch stats:     Loss: 0.0462 - F1-Score: 0.9878 - Accuracy-Score: 0.9853 - AUROC: 0.9988 - AP: 0.9992
[37m2024-08-11 19:48:29,522 [INFO] - Validation epoch stats:   Loss: 0.5764 - F1-Score: 0.8743 - Accuracy-Score: 0.8439 - AUROC: 0.9151 - AP: 0.9409
[37m2024-08-11 19:48:29,586 [INFO] - Epoch: 14/50
[37m2024-08-11 19:48:31,025 [INFO] - Training epoch stats:     Loss: 0.0423 - F1-Score: 0.9892 - Accuracy-Score: 0.9871 - AUROC: 0.9990 - AP: 0.9993
[37m2024-08-11 19:48:31,334 [INFO] - Validation epoch stats:   Loss: 0.6045 - F1-Score: 0.8696 - Accuracy-Score: 0.8398 - AUROC: 0.9154 - AP: 0.9404
[37m2024-08-11 19:48:31,412 [INFO] - Epoch: 15/50
[37m2024-08-11 19:48:32,831 [INFO] - Training epoch stats:     Loss: 0.0386 - F1-Score: 0.9906 - Accuracy-Score: 0.9888 - AUROC: 0.9992 - AP: 0.9995
[37m2024-08-11 19:48:33,127 [INFO] - Validation epoch stats:   Loss: 0.6224 - F1-Score: 0.8710 - Accuracy-Score: 0.8412 - AUROC: 0.9153 - AP: 0.9403
[37m2024-08-11 19:48:33,189 [INFO] - Epoch: 16/50
[37m2024-08-11 19:48:34,584 [INFO] - Training epoch stats:     Loss: 0.0358 - F1-Score: 0.9913 - Accuracy-Score: 0.9896 - AUROC: 0.9994 - AP: 0.9996
[37m2024-08-11 19:48:34,878 [INFO] - Validation epoch stats:   Loss: 0.6572 - F1-Score: 0.8653 - Accuracy-Score: 0.8357 - AUROC: 0.9134 - AP: 0.9383
[37m2024-08-11 19:48:34,944 [INFO] - Epoch: 17/50
[37m2024-08-11 19:48:36,579 [INFO] - Training epoch stats:     Loss: 0.0328 - F1-Score: 0.9924 - Accuracy-Score: 0.9909 - AUROC: 0.9995 - AP: 0.9997
[37m2024-08-11 19:48:36,886 [INFO] - Validation epoch stats:   Loss: 0.6753 - F1-Score: 0.8665 - Accuracy-Score: 0.8365 - AUROC: 0.9117 - AP: 0.9370
[37m2024-08-11 19:48:36,947 [INFO] - Epoch: 18/50
[37m2024-08-11 19:48:38,402 [INFO] - Training epoch stats:     Loss: 0.0294 - F1-Score: 0.9936 - Accuracy-Score: 0.9923 - AUROC: 0.9996 - AP: 0.9997
[37m2024-08-11 19:48:38,720 [INFO] - Validation epoch stats:   Loss: 0.6804 - F1-Score: 0.8671 - Accuracy-Score: 0.8376 - AUROC: 0.9145 - AP: 0.9395
[37m2024-08-11 19:48:38,786 [INFO] - Epoch: 19/50
[37m2024-08-11 19:48:40,174 [INFO] - Training epoch stats:     Loss: 0.0281 - F1-Score: 0.9934 - Accuracy-Score: 0.9921 - AUROC: 0.9997 - AP: 0.9998
[37m2024-08-11 19:48:40,472 [INFO] - Validation epoch stats:   Loss: 0.6888 - F1-Score: 0.8686 - Accuracy-Score: 0.8385 - AUROC: 0.9124 - AP: 0.9370
[37m2024-08-11 19:48:40,537 [INFO] - Epoch: 20/50
[37m2024-08-11 19:48:41,940 [INFO] - Training epoch stats:     Loss: 0.0255 - F1-Score: 0.9949 - Accuracy-Score: 0.9938 - AUROC: 0.9998 - AP: 0.9998
[37m2024-08-11 19:48:42,240 [INFO] - Validation epoch stats:   Loss: 0.6939 - F1-Score: 0.8719 - Accuracy-Score: 0.8420 - AUROC: 0.9134 - AP: 0.9373
[37m2024-08-11 19:48:42,310 [INFO] - Epoch: 21/50
[37m2024-08-11 19:48:43,730 [INFO] - Training epoch stats:     Loss: 0.0240 - F1-Score: 0.9948 - Accuracy-Score: 0.9938 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:48:44,032 [INFO] - Validation epoch stats:   Loss: 0.6851 - F1-Score: 0.8726 - Accuracy-Score: 0.8428 - AUROC: 0.9151 - AP: 0.9390
[37m2024-08-11 19:48:44,106 [INFO] - Epoch: 22/50
[37m2024-08-11 19:48:45,543 [INFO] - Training epoch stats:     Loss: 0.0221 - F1-Score: 0.9958 - Accuracy-Score: 0.9950 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:48:45,843 [INFO] - Validation epoch stats:   Loss: 0.7022 - F1-Score: 0.8725 - Accuracy-Score: 0.8427 - AUROC: 0.9149 - AP: 0.9391
[37m2024-08-11 19:48:45,911 [INFO] - Epoch: 23/50
[37m2024-08-11 19:48:47,311 [INFO] - Training epoch stats:     Loss: 0.0214 - F1-Score: 0.9956 - Accuracy-Score: 0.9948 - AUROC: 0.9998 - AP: 0.9999
[37m2024-08-11 19:48:47,606 [INFO] - Validation epoch stats:   Loss: 0.7214 - F1-Score: 0.8696 - Accuracy-Score: 0.8396 - AUROC: 0.9128 - AP: 0.9370
[37m2024-08-11 19:48:47,676 [INFO] - Epoch: 24/50
[37m2024-08-11 19:48:49,085 [INFO] - Training epoch stats:     Loss: 0.0191 - F1-Score: 0.9965 - Accuracy-Score: 0.9958 - AUROC: 0.9999 - AP: 0.9999
[37m2024-08-11 19:48:49,412 [INFO] - Validation epoch stats:   Loss: 0.7456 - F1-Score: 0.8650 - Accuracy-Score: 0.8352 - AUROC: 0.9122 - AP: 0.9360
[37m2024-08-11 19:48:49,478 [INFO] - Epoch: 25/50
[37m2024-08-11 19:48:50,869 [INFO] - Training epoch stats:     Loss: 0.0177 - F1-Score: 0.9972 - Accuracy-Score: 0.9966 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:48:51,162 [INFO] - Validation epoch stats:   Loss: 0.7489 - F1-Score: 0.8742 - Accuracy-Score: 0.8442 - AUROC: 0.9122 - AP: 0.9343
[37m2024-08-11 19:48:51,226 [INFO] - Epoch: 26/50
[37m2024-08-11 19:48:53,006 [INFO] - Training epoch stats:     Loss: 0.0167 - F1-Score: 0.9970 - Accuracy-Score: 0.9964 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:48:53,303 [INFO] - Validation epoch stats:   Loss: 0.7694 - F1-Score: 0.8683 - Accuracy-Score: 0.8391 - AUROC: 0.9143 - AP: 0.9367
[37m2024-08-11 19:48:53,376 [INFO] - Epoch: 27/50
[37m2024-08-11 19:48:54,986 [INFO] - Training epoch stats:     Loss: 0.0160 - F1-Score: 0.9975 - Accuracy-Score: 0.9970 - AUROC: 0.9999 - AP: 1.0000
[37m2024-08-11 19:48:55,274 [INFO] - Validation epoch stats:   Loss: 0.7538 - F1-Score: 0.8746 - Accuracy-Score: 0.8448 - AUROC: 0.9128 - AP: 0.9350
[37m2024-08-11 19:48:55,279 [INFO] - Performing early stopping!
[37m2024-08-11 19:48:55,286 [INFO] - Finished run hynene5f
