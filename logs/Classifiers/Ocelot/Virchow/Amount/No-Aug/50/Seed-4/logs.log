[37m2024-08-11 19:43:41,670 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:43:41,673 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/50/Seed-4/2024-08-11T194332_CellViT-Virchow-50Percent
[37m2024-08-11 19:43:41,756 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f44d81a6410>]
[37m2024-08-11 19:43:41,767 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:43:41,775 [INFO] - Using device: cuda:0
[37m2024-08-11 19:43:41,783 [INFO] - Loss function:
[37m2024-08-11 19:43:41,791 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:43:48,431 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:43:49,614 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:43:49,621 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:43:49,626 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:43:49,631 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:43:49,650 [INFO] - Caching datasets
[37m2024-08-11 19:43:54,686 [INFO] - Instantiate Trainer
[37m2024-08-11 19:43:54,698 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:43:54,704 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:43:54,709 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:43:54,714 [INFO] - Epoch: 1/50
[37m2024-08-11 19:43:59,882 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/76865c33d4949345c1c79ff7ec9937d8c27914bbe4868c306fe2b2c012bbd024.h5
[37m2024-08-11 19:44:01,129 [INFO] - Training epoch stats:     Loss: 0.2878 - F1-Score: 0.9063 - Accuracy-Score: 0.8770 - AUROC: 0.9461 - AP: 0.9657
[37m2024-08-11 19:44:04,814 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:44:05,262 [INFO] - Validation epoch stats:   Loss: 0.3739 - F1-Score: 0.8887 - Accuracy-Score: 0.8561 - AUROC: 0.9113 - AP: 0.9339
[37m2024-08-11 19:44:05,267 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:44:05,475 [INFO] - Epoch: 2/50
[37m2024-08-11 19:44:06,485 [INFO] - Training epoch stats:     Loss: 0.1719 - F1-Score: 0.9500 - Accuracy-Score: 0.9357 - AUROC: 0.9797 - AP: 0.9873
[37m2024-08-11 19:44:06,927 [INFO] - Validation epoch stats:   Loss: 0.4403 - F1-Score: 0.8735 - Accuracy-Score: 0.8403 - AUROC: 0.8997 - AP: 0.9256
[37m2024-08-11 19:44:06,993 [INFO] - Epoch: 3/50
[37m2024-08-11 19:44:08,205 [INFO] - Training epoch stats:     Loss: 0.1435 - F1-Score: 0.9582 - Accuracy-Score: 0.9463 - AUROC: 0.9859 - AP: 0.9913
[37m2024-08-11 19:44:08,654 [INFO] - Validation epoch stats:   Loss: 0.4798 - F1-Score: 0.8623 - Accuracy-Score: 0.8283 - AUROC: 0.8957 - AP: 0.9242
[37m2024-08-11 19:44:08,734 [INFO] - Epoch: 4/50
[37m2024-08-11 19:44:09,716 [INFO] - Training epoch stats:     Loss: 0.1259 - F1-Score: 0.9631 - Accuracy-Score: 0.9527 - AUROC: 0.9892 - AP: 0.9934
[37m2024-08-11 19:44:10,165 [INFO] - Validation epoch stats:   Loss: 0.5130 - F1-Score: 0.8577 - Accuracy-Score: 0.8227 - AUROC: 0.8913 - AP: 0.9211
[37m2024-08-11 19:44:10,236 [INFO] - Epoch: 5/50
[37m2024-08-11 19:44:11,047 [INFO] - Training epoch stats:     Loss: 0.1125 - F1-Score: 0.9674 - Accuracy-Score: 0.9582 - AUROC: 0.9914 - AP: 0.9949
[37m2024-08-11 19:44:11,368 [INFO] - Validation epoch stats:   Loss: 0.5485 - F1-Score: 0.8494 - Accuracy-Score: 0.8151 - AUROC: 0.8890 - AP: 0.9187
[37m2024-08-11 19:44:11,434 [INFO] - Epoch: 6/50
[37m2024-08-11 19:44:11,987 [INFO] - Training epoch stats:     Loss: 0.1026 - F1-Score: 0.9696 - Accuracy-Score: 0.9611 - AUROC: 0.9929 - AP: 0.9958
[37m2024-08-11 19:44:12,285 [INFO] - Validation epoch stats:   Loss: 0.5785 - F1-Score: 0.8444 - Accuracy-Score: 0.8103 - AUROC: 0.8867 - AP: 0.9177
[37m2024-08-11 19:44:12,338 [INFO] - Epoch: 7/50
[37m2024-08-11 19:44:13,094 [INFO] - Training epoch stats:     Loss: 0.0929 - F1-Score: 0.9736 - Accuracy-Score: 0.9662 - AUROC: 0.9943 - AP: 0.9966
[37m2024-08-11 19:44:13,476 [INFO] - Validation epoch stats:   Loss: 0.5752 - F1-Score: 0.8520 - Accuracy-Score: 0.8179 - AUROC: 0.8898 - AP: 0.9195
[37m2024-08-11 19:44:13,544 [INFO] - Epoch: 8/50
[37m2024-08-11 19:44:14,285 [INFO] - Training epoch stats:     Loss: 0.0850 - F1-Score: 0.9754 - Accuracy-Score: 0.9685 - AUROC: 0.9954 - AP: 0.9973
[37m2024-08-11 19:44:14,641 [INFO] - Validation epoch stats:   Loss: 0.6541 - F1-Score: 0.8345 - Accuracy-Score: 0.8018 - AUROC: 0.8871 - AP: 0.9180
[37m2024-08-11 19:44:14,700 [INFO] - Epoch: 9/50
[37m2024-08-11 19:44:15,493 [INFO] - Training epoch stats:     Loss: 0.0793 - F1-Score: 0.9780 - Accuracy-Score: 0.9719 - AUROC: 0.9960 - AP: 0.9977
[37m2024-08-11 19:44:15,897 [INFO] - Validation epoch stats:   Loss: 0.6149 - F1-Score: 0.8485 - Accuracy-Score: 0.8136 - AUROC: 0.8856 - AP: 0.9163
[37m2024-08-11 19:44:15,962 [INFO] - Epoch: 10/50
[37m2024-08-11 19:44:16,691 [INFO] - Training epoch stats:     Loss: 0.0722 - F1-Score: 0.9811 - Accuracy-Score: 0.9758 - AUROC: 0.9967 - AP: 0.9981
[37m2024-08-11 19:44:16,982 [INFO] - Validation epoch stats:   Loss: 0.6795 - F1-Score: 0.8290 - Accuracy-Score: 0.7965 - AUROC: 0.8864 - AP: 0.9169
[37m2024-08-11 19:44:17,045 [INFO] - Epoch: 11/50
[37m2024-08-11 19:44:17,774 [INFO] - Training epoch stats:     Loss: 0.0667 - F1-Score: 0.9819 - Accuracy-Score: 0.9768 - AUROC: 0.9973 - AP: 0.9984
[37m2024-08-11 19:44:18,070 [INFO] - Validation epoch stats:   Loss: 0.6931 - F1-Score: 0.8351 - Accuracy-Score: 0.8013 - AUROC: 0.8822 - AP: 0.9132
[37m2024-08-11 19:44:18,126 [INFO] - Epoch: 12/50
[37m2024-08-11 19:44:18,847 [INFO] - Training epoch stats:     Loss: 0.0617 - F1-Score: 0.9838 - Accuracy-Score: 0.9793 - AUROC: 0.9977 - AP: 0.9987
[37m2024-08-11 19:44:19,140 [INFO] - Validation epoch stats:   Loss: 0.7026 - F1-Score: 0.8356 - Accuracy-Score: 0.8014 - AUROC: 0.8825 - AP: 0.9129
[37m2024-08-11 19:44:19,204 [INFO] - Epoch: 13/50
[37m2024-08-11 19:44:19,932 [INFO] - Training epoch stats:     Loss: 0.0573 - F1-Score: 0.9848 - Accuracy-Score: 0.9806 - AUROC: 0.9981 - AP: 0.9989
[37m2024-08-11 19:44:20,231 [INFO] - Validation epoch stats:   Loss: 0.7340 - F1-Score: 0.8289 - Accuracy-Score: 0.7950 - AUROC: 0.8802 - AP: 0.9112
[37m2024-08-11 19:44:20,292 [INFO] - Epoch: 14/50
[37m2024-08-11 19:44:21,009 [INFO] - Training epoch stats:     Loss: 0.0533 - F1-Score: 0.9862 - Accuracy-Score: 0.9824 - AUROC: 0.9985 - AP: 0.9991
[37m2024-08-11 19:44:21,421 [INFO] - Validation epoch stats:   Loss: 0.7310 - F1-Score: 0.8419 - Accuracy-Score: 0.8078 - AUROC: 0.8835 - AP: 0.9137
[37m2024-08-11 19:44:21,489 [INFO] - Epoch: 15/50
[37m2024-08-11 19:44:22,478 [INFO] - Training epoch stats:     Loss: 0.0486 - F1-Score: 0.9877 - Accuracy-Score: 0.9843 - AUROC: 0.9988 - AP: 0.9993
[37m2024-08-11 19:44:22,913 [INFO] - Validation epoch stats:   Loss: 0.7420 - F1-Score: 0.8417 - Accuracy-Score: 0.8074 - AUROC: 0.8824 - AP: 0.9115
[37m2024-08-11 19:44:22,983 [INFO] - Epoch: 16/50
[37m2024-08-11 19:44:23,960 [INFO] - Training epoch stats:     Loss: 0.0457 - F1-Score: 0.9892 - Accuracy-Score: 0.9862 - AUROC: 0.9989 - AP: 0.9994
[37m2024-08-11 19:44:24,741 [INFO] - Validation epoch stats:   Loss: 0.8110 - F1-Score: 0.8266 - Accuracy-Score: 0.7932 - AUROC: 0.8793 - AP: 0.9100
[37m2024-08-11 19:44:24,806 [INFO] - Epoch: 17/50
[37m2024-08-11 19:44:25,563 [INFO] - Training epoch stats:     Loss: 0.0431 - F1-Score: 0.9902 - Accuracy-Score: 0.9875 - AUROC: 0.9991 - AP: 0.9995
[37m2024-08-11 19:44:25,857 [INFO] - Validation epoch stats:   Loss: 0.7950 - F1-Score: 0.8364 - Accuracy-Score: 0.8027 - AUROC: 0.8814 - AP: 0.9117
[37m2024-08-11 19:44:25,918 [INFO] - Epoch: 18/50
[37m2024-08-11 19:44:26,628 [INFO] - Training epoch stats:     Loss: 0.0392 - F1-Score: 0.9912 - Accuracy-Score: 0.9888 - AUROC: 0.9993 - AP: 0.9996
[37m2024-08-11 19:44:26,918 [INFO] - Validation epoch stats:   Loss: 0.8172 - F1-Score: 0.8336 - Accuracy-Score: 0.7994 - AUROC: 0.8800 - AP: 0.9101
[37m2024-08-11 19:44:26,983 [INFO] - Epoch: 19/50
[37m2024-08-11 19:44:27,701 [INFO] - Training epoch stats:     Loss: 0.0366 - F1-Score: 0.9915 - Accuracy-Score: 0.9891 - AUROC: 0.9995 - AP: 0.9997
[37m2024-08-11 19:44:27,990 [INFO] - Validation epoch stats:   Loss: 0.7870 - F1-Score: 0.8464 - Accuracy-Score: 0.8112 - AUROC: 0.8814 - AP: 0.9106
[37m2024-08-11 19:44:28,053 [INFO] - Epoch: 20/50
[37m2024-08-11 19:44:28,763 [INFO] - Training epoch stats:     Loss: 0.0348 - F1-Score: 0.9921 - Accuracy-Score: 0.9900 - AUROC: 0.9995 - AP: 0.9997
[37m2024-08-11 19:44:29,051 [INFO] - Validation epoch stats:   Loss: 0.8335 - F1-Score: 0.8317 - Accuracy-Score: 0.7973 - AUROC: 0.8792 - AP: 0.9099
[37m2024-08-11 19:44:29,114 [INFO] - Epoch: 21/50
[37m2024-08-11 19:44:29,824 [INFO] - Training epoch stats:     Loss: 0.0321 - F1-Score: 0.9937 - Accuracy-Score: 0.9919 - AUROC: 0.9996 - AP: 0.9998
[37m2024-08-11 19:44:30,119 [INFO] - Validation epoch stats:   Loss: 0.8289 - F1-Score: 0.8401 - Accuracy-Score: 0.8054 - AUROC: 0.8806 - AP: 0.9108
[37m2024-08-11 19:44:30,124 [INFO] - Performing early stopping!
[37m2024-08-11 19:44:30,130 [INFO] - Finished run ijft4as3
