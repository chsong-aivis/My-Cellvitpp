[37m2024-08-11 19:43:26,580 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:43:26,582 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/25/Seed-5/2024-08-11T194316_CellViT-Virchow-25Percent
[37m2024-08-11 19:43:26,671 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f9cac1c63b0>]
[37m2024-08-11 19:43:26,677 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:43:26,682 [INFO] - Using device: cuda:0
[37m2024-08-11 19:43:26,688 [INFO] - Loss function:
[37m2024-08-11 19:43:26,693 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:43:32,764 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:43:33,480 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:43:33,487 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:43:33,492 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:43:33,496 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:43:33,511 [INFO] - Caching datasets
[37m2024-08-11 19:43:35,124 [INFO] - Instantiate Trainer
[37m2024-08-11 19:43:35,133 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:43:35,138 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:43:35,142 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:43:35,147 [INFO] - Epoch: 1/50
[37m2024-08-11 19:43:38,220 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/8dc9c688244a030831053c6e6ce7a69f57d5cad335365554de327377c2d6b882.h5
[37m2024-08-11 19:43:39,045 [INFO] - Training epoch stats:     Loss: 0.3019 - F1-Score: 0.9017 - Accuracy-Score: 0.8705 - AUROC: 0.9466 - AP: 0.9649
[37m2024-08-11 19:43:42,857 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:43:43,292 [INFO] - Validation epoch stats:   Loss: 0.3772 - F1-Score: 0.8881 - Accuracy-Score: 0.8588 - AUROC: 0.9129 - AP: 0.9441
[37m2024-08-11 19:43:43,298 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:43:43,488 [INFO] - Epoch: 2/50
[37m2024-08-11 19:43:44,052 [INFO] - Training epoch stats:     Loss: 0.1536 - F1-Score: 0.9544 - Accuracy-Score: 0.9426 - AUROC: 0.9842 - AP: 0.9895
[37m2024-08-11 19:43:44,558 [INFO] - Validation epoch stats:   Loss: 0.4305 - F1-Score: 0.8699 - Accuracy-Score: 0.8392 - AUROC: 0.9033 - AP: 0.9336
[37m2024-08-11 19:43:44,625 [INFO] - Epoch: 3/50
[37m2024-08-11 19:43:45,202 [INFO] - Training epoch stats:     Loss: 0.1277 - F1-Score: 0.9619 - Accuracy-Score: 0.9520 - AUROC: 0.9892 - AP: 0.9931
[37m2024-08-11 19:43:45,701 [INFO] - Validation epoch stats:   Loss: 0.4951 - F1-Score: 0.8484 - Accuracy-Score: 0.8195 - AUROC: 0.9024 - AP: 0.9318
[37m2024-08-11 19:43:45,764 [INFO] - Epoch: 4/50
[37m2024-08-11 19:43:46,332 [INFO] - Training epoch stats:     Loss: 0.1154 - F1-Score: 0.9657 - Accuracy-Score: 0.9570 - AUROC: 0.9913 - AP: 0.9945
[37m2024-08-11 19:43:46,834 [INFO] - Validation epoch stats:   Loss: 0.4947 - F1-Score: 0.8576 - Accuracy-Score: 0.8276 - AUROC: 0.9015 - AP: 0.9319
[37m2024-08-11 19:43:46,896 [INFO] - Epoch: 5/50
[37m2024-08-11 19:43:47,466 [INFO] - Training epoch stats:     Loss: 0.1046 - F1-Score: 0.9681 - Accuracy-Score: 0.9599 - AUROC: 0.9927 - AP: 0.9955
[37m2024-08-11 19:43:47,921 [INFO] - Validation epoch stats:   Loss: 0.5542 - F1-Score: 0.8354 - Accuracy-Score: 0.8068 - AUROC: 0.8990 - AP: 0.9313
[37m2024-08-11 19:43:47,987 [INFO] - Epoch: 6/50
[37m2024-08-11 19:43:48,570 [INFO] - Training epoch stats:     Loss: 0.0961 - F1-Score: 0.9713 - Accuracy-Score: 0.9640 - AUROC: 0.9941 - AP: 0.9963
[37m2024-08-11 19:43:49,031 [INFO] - Validation epoch stats:   Loss: 0.5075 - F1-Score: 0.8656 - Accuracy-Score: 0.8352 - AUROC: 0.9027 - AP: 0.9327
[37m2024-08-11 19:43:49,098 [INFO] - Epoch: 7/50
[37m2024-08-11 19:43:49,645 [INFO] - Training epoch stats:     Loss: 0.0909 - F1-Score: 0.9727 - Accuracy-Score: 0.9657 - AUROC: 0.9947 - AP: 0.9967
[37m2024-08-11 19:43:50,106 [INFO] - Validation epoch stats:   Loss: 0.5335 - F1-Score: 0.8588 - Accuracy-Score: 0.8285 - AUROC: 0.9011 - AP: 0.9325
[37m2024-08-11 19:43:50,179 [INFO] - Epoch: 8/50
[37m2024-08-11 19:43:50,788 [INFO] - Training epoch stats:     Loss: 0.0841 - F1-Score: 0.9746 - Accuracy-Score: 0.9681 - AUROC: 0.9954 - AP: 0.9972
[37m2024-08-11 19:43:52,034 [INFO] - Validation epoch stats:   Loss: 0.5940 - F1-Score: 0.8423 - Accuracy-Score: 0.8139 - AUROC: 0.9023 - AP: 0.9338
[37m2024-08-11 19:43:52,109 [INFO] - Epoch: 9/50
[37m2024-08-11 19:43:52,704 [INFO] - Training epoch stats:     Loss: 0.0784 - F1-Score: 0.9769 - Accuracy-Score: 0.9710 - AUROC: 0.9961 - AP: 0.9976
[37m2024-08-11 19:43:53,162 [INFO] - Validation epoch stats:   Loss: 0.6169 - F1-Score: 0.8388 - Accuracy-Score: 0.8100 - AUROC: 0.8995 - AP: 0.9322
[37m2024-08-11 19:43:53,232 [INFO] - Epoch: 10/50
[37m2024-08-11 19:43:53,807 [INFO] - Training epoch stats:     Loss: 0.0738 - F1-Score: 0.9785 - Accuracy-Score: 0.9730 - AUROC: 0.9966 - AP: 0.9979
[37m2024-08-11 19:43:54,256 [INFO] - Validation epoch stats:   Loss: 0.6080 - F1-Score: 0.8463 - Accuracy-Score: 0.8170 - AUROC: 0.9008 - AP: 0.9334
[37m2024-08-11 19:43:54,321 [INFO] - Epoch: 11/50
[37m2024-08-11 19:43:54,889 [INFO] - Training epoch stats:     Loss: 0.0706 - F1-Score: 0.9800 - Accuracy-Score: 0.9749 - AUROC: 0.9970 - AP: 0.9982
[37m2024-08-11 19:43:55,376 [INFO] - Validation epoch stats:   Loss: 0.6636 - F1-Score: 0.8302 - Accuracy-Score: 0.8019 - AUROC: 0.8997 - AP: 0.9324
[37m2024-08-11 19:43:55,447 [INFO] - Epoch: 12/50
[37m2024-08-11 19:43:56,067 [INFO] - Training epoch stats:     Loss: 0.0669 - F1-Score: 0.9811 - Accuracy-Score: 0.9763 - AUROC: 0.9973 - AP: 0.9984
[37m2024-08-11 19:43:56,556 [INFO] - Validation epoch stats:   Loss: 0.6316 - F1-Score: 0.8438 - Accuracy-Score: 0.8143 - AUROC: 0.9001 - AP: 0.9329
[37m2024-08-11 19:43:56,645 [INFO] - Epoch: 13/50
[37m2024-08-11 19:43:57,286 [INFO] - Training epoch stats:     Loss: 0.0624 - F1-Score: 0.9832 - Accuracy-Score: 0.9790 - AUROC: 0.9977 - AP: 0.9986
[37m2024-08-11 19:43:57,776 [INFO] - Validation epoch stats:   Loss: 0.6705 - F1-Score: 0.8391 - Accuracy-Score: 0.8101 - AUROC: 0.8998 - AP: 0.9322
[37m2024-08-11 19:43:57,842 [INFO] - Epoch: 14/50
[37m2024-08-11 19:43:58,458 [INFO] - Training epoch stats:     Loss: 0.0591 - F1-Score: 0.9836 - Accuracy-Score: 0.9794 - AUROC: 0.9981 - AP: 0.9988
[37m2024-08-11 19:43:58,869 [INFO] - Validation epoch stats:   Loss: 0.6860 - F1-Score: 0.8396 - Accuracy-Score: 0.8107 - AUROC: 0.8997 - AP: 0.9327
[37m2024-08-11 19:43:58,933 [INFO] - Epoch: 15/50
[37m2024-08-11 19:43:59,507 [INFO] - Training epoch stats:     Loss: 0.0554 - F1-Score: 0.9848 - Accuracy-Score: 0.9809 - AUROC: 0.9983 - AP: 0.9990
[37m2024-08-11 19:43:59,937 [INFO] - Validation epoch stats:   Loss: 0.6690 - F1-Score: 0.8465 - Accuracy-Score: 0.8170 - AUROC: 0.9002 - AP: 0.9332
[37m2024-08-11 19:43:59,994 [INFO] - Epoch: 16/50
[37m2024-08-11 19:44:00,573 [INFO] - Training epoch stats:     Loss: 0.0530 - F1-Score: 0.9849 - Accuracy-Score: 0.9810 - AUROC: 0.9984 - AP: 0.9990
[37m2024-08-11 19:44:01,018 [INFO] - Validation epoch stats:   Loss: 0.7083 - F1-Score: 0.8383 - Accuracy-Score: 0.8091 - AUROC: 0.8977 - AP: 0.9312
[37m2024-08-11 19:44:01,080 [INFO] - Epoch: 17/50
[37m2024-08-11 19:44:01,657 [INFO] - Training epoch stats:     Loss: 0.0500 - F1-Score: 0.9862 - Accuracy-Score: 0.9828 - AUROC: 0.9987 - AP: 0.9992
[37m2024-08-11 19:44:02,097 [INFO] - Validation epoch stats:   Loss: 0.7134 - F1-Score: 0.8422 - Accuracy-Score: 0.8127 - AUROC: 0.8985 - AP: 0.9316
[37m2024-08-11 19:44:02,181 [INFO] - Epoch: 18/50
[37m2024-08-11 19:44:02,758 [INFO] - Training epoch stats:     Loss: 0.0490 - F1-Score: 0.9865 - Accuracy-Score: 0.9831 - AUROC: 0.9987 - AP: 0.9992
[37m2024-08-11 19:44:03,205 [INFO] - Validation epoch stats:   Loss: 0.7288 - F1-Score: 0.8404 - Accuracy-Score: 0.8108 - AUROC: 0.8975 - AP: 0.9311
[37m2024-08-11 19:44:03,287 [INFO] - Epoch: 19/50
[37m2024-08-11 19:44:03,867 [INFO] - Training epoch stats:     Loss: 0.0460 - F1-Score: 0.9869 - Accuracy-Score: 0.9836 - AUROC: 0.9989 - AP: 0.9993
[37m2024-08-11 19:44:04,268 [INFO] - Validation epoch stats:   Loss: 0.7422 - F1-Score: 0.8395 - Accuracy-Score: 0.8104 - AUROC: 0.8989 - AP: 0.9321
[37m2024-08-11 19:44:04,335 [INFO] - Epoch: 20/50
[37m2024-08-11 19:44:04,895 [INFO] - Training epoch stats:     Loss: 0.0433 - F1-Score: 0.9887 - Accuracy-Score: 0.9859 - AUROC: 0.9991 - AP: 0.9994
[37m2024-08-11 19:44:05,343 [INFO] - Validation epoch stats:   Loss: 0.7487 - F1-Score: 0.8411 - Accuracy-Score: 0.8118 - AUROC: 0.8974 - AP: 0.9305
[37m2024-08-11 19:44:05,418 [INFO] - Epoch: 21/50
[37m2024-08-11 19:44:06,004 [INFO] - Training epoch stats:     Loss: 0.0418 - F1-Score: 0.9893 - Accuracy-Score: 0.9866 - AUROC: 0.9992 - AP: 0.9995
[37m2024-08-11 19:44:06,457 [INFO] - Validation epoch stats:   Loss: 0.7337 - F1-Score: 0.8471 - Accuracy-Score: 0.8167 - AUROC: 0.8965 - AP: 0.9297
[37m2024-08-11 19:44:06,463 [INFO] - Performing early stopping!
[37m2024-08-11 19:44:06,470 [INFO] - Finished run i8yveptn
