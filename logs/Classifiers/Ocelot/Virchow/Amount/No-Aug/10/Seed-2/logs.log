[37m2024-08-11 19:41:08,730 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:41:08,732 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/10/Seed-2/2024-08-11T194057_CellViT-Virchow-10Percent
[37m2024-08-11 19:41:08,801 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7febecf97040>]
[37m2024-08-11 19:41:08,807 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:41:08,813 [INFO] - Using device: cuda:0
[37m2024-08-11 19:41:08,819 [INFO] - Loss function:
[37m2024-08-11 19:41:08,824 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:41:23,173 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:41:25,358 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:41:25,361 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:41:25,366 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:41:25,372 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:41:25,393 [INFO] - Caching datasets
[37m2024-08-11 19:41:30,514 [INFO] - Instantiate Trainer
[37m2024-08-11 19:41:30,523 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:41:30,529 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:41:30,534 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:41:30,539 [INFO] - Epoch: 1/50
[37m2024-08-11 19:41:31,748 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/dc49e777c93251e51f6136208954ee0d960724437c4b039f157b3f9e0e43b5b2.h5
[37m2024-08-11 19:41:32,369 [INFO] - Training epoch stats:     Loss: 0.3789 - F1-Score: 0.8796 - Accuracy-Score: 0.8448 - AUROC: 0.9361 - AP: 0.9567
[37m2024-08-11 19:41:40,306 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:41:40,803 [INFO] - Validation epoch stats:   Loss: 0.4120 - F1-Score: 0.8683 - Accuracy-Score: 0.8392 - AUROC: 0.9008 - AP: 0.9369
[37m2024-08-11 19:41:40,810 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:41:41,000 [INFO] - Epoch: 2/50
[37m2024-08-11 19:41:41,243 [INFO] - Training epoch stats:     Loss: 0.1715 - F1-Score: 0.9467 - Accuracy-Score: 0.9358 - AUROC: 0.9828 - AP: 0.9880
[37m2024-08-11 19:41:41,677 [INFO] - Validation epoch stats:   Loss: 0.4121 - F1-Score: 0.8728 - Accuracy-Score: 0.8400 - AUROC: 0.8970 - AP: 0.9361
[37m2024-08-11 19:41:41,743 [INFO] - Epoch: 3/50
[37m2024-08-11 19:41:41,976 [INFO] - Training epoch stats:     Loss: 0.1343 - F1-Score: 0.9581 - Accuracy-Score: 0.9494 - AUROC: 0.9891 - AP: 0.9926
[37m2024-08-11 19:41:42,455 [INFO] - Validation epoch stats:   Loss: 0.4462 - F1-Score: 0.8607 - Accuracy-Score: 0.8289 - AUROC: 0.8935 - AP: 0.9336
[37m2024-08-11 19:41:42,517 [INFO] - Epoch: 4/50
[37m2024-08-11 19:41:42,755 [INFO] - Training epoch stats:     Loss: 0.1155 - F1-Score: 0.9634 - Accuracy-Score: 0.9558 - AUROC: 0.9921 - AP: 0.9946
[37m2024-08-11 19:41:43,207 [INFO] - Validation epoch stats:   Loss: 0.4973 - F1-Score: 0.8382 - Accuracy-Score: 0.8090 - AUROC: 0.8917 - AP: 0.9316
[37m2024-08-11 19:41:43,269 [INFO] - Epoch: 5/50
[37m2024-08-11 19:41:43,505 [INFO] - Training epoch stats:     Loss: 0.1030 - F1-Score: 0.9697 - Accuracy-Score: 0.9634 - AUROC: 0.9935 - AP: 0.9956
[37m2024-08-11 19:41:43,924 [INFO] - Validation epoch stats:   Loss: 0.5297 - F1-Score: 0.8289 - Accuracy-Score: 0.8004 - AUROC: 0.8902 - AP: 0.9307
[37m2024-08-11 19:41:44,033 [INFO] - Epoch: 6/50
[37m2024-08-11 19:41:44,263 [INFO] - Training epoch stats:     Loss: 0.0945 - F1-Score: 0.9709 - Accuracy-Score: 0.9649 - AUROC: 0.9947 - AP: 0.9964
[37m2024-08-11 19:41:44,717 [INFO] - Validation epoch stats:   Loss: 0.5563 - F1-Score: 0.8231 - Accuracy-Score: 0.7950 - AUROC: 0.8894 - AP: 0.9298
[37m2024-08-11 19:41:44,813 [INFO] - Epoch: 7/50
[37m2024-08-11 19:41:45,046 [INFO] - Training epoch stats:     Loss: 0.0875 - F1-Score: 0.9725 - Accuracy-Score: 0.9669 - AUROC: 0.9954 - AP: 0.9969
[37m2024-08-11 19:41:45,492 [INFO] - Validation epoch stats:   Loss: 0.5425 - F1-Score: 0.8365 - Accuracy-Score: 0.8062 - AUROC: 0.8878 - AP: 0.9287
[37m2024-08-11 19:41:45,548 [INFO] - Epoch: 8/50
[37m2024-08-11 19:41:45,812 [INFO] - Training epoch stats:     Loss: 0.0811 - F1-Score: 0.9757 - Accuracy-Score: 0.9707 - AUROC: 0.9962 - AP: 0.9974
[37m2024-08-11 19:41:46,275 [INFO] - Validation epoch stats:   Loss: 0.5599 - F1-Score: 0.8344 - Accuracy-Score: 0.8045 - AUROC: 0.8884 - AP: 0.9291
[37m2024-08-11 19:41:46,345 [INFO] - Epoch: 9/50
[37m2024-08-11 19:41:46,587 [INFO] - Training epoch stats:     Loss: 0.0757 - F1-Score: 0.9765 - Accuracy-Score: 0.9717 - AUROC: 0.9967 - AP: 0.9978
[37m2024-08-11 19:41:47,160 [INFO] - Validation epoch stats:   Loss: 0.6077 - F1-Score: 0.8205 - Accuracy-Score: 0.7920 - AUROC: 0.8859 - AP: 0.9271
[37m2024-08-11 19:41:47,229 [INFO] - Epoch: 10/50
[37m2024-08-11 19:41:47,473 [INFO] - Training epoch stats:     Loss: 0.0714 - F1-Score: 0.9801 - Accuracy-Score: 0.9760 - AUROC: 0.9971 - AP: 0.9981
[37m2024-08-11 19:41:47,973 [INFO] - Validation epoch stats:   Loss: 0.6191 - F1-Score: 0.8177 - Accuracy-Score: 0.7884 - AUROC: 0.8836 - AP: 0.9256
[37m2024-08-11 19:41:48,037 [INFO] - Epoch: 11/50
[37m2024-08-11 19:41:48,283 [INFO] - Training epoch stats:     Loss: 0.0684 - F1-Score: 0.9795 - Accuracy-Score: 0.9753 - AUROC: 0.9974 - AP: 0.9983
[37m2024-08-11 19:41:48,713 [INFO] - Validation epoch stats:   Loss: 0.6129 - F1-Score: 0.8262 - Accuracy-Score: 0.7955 - AUROC: 0.8829 - AP: 0.9244
[37m2024-08-11 19:41:48,778 [INFO] - Epoch: 12/50
[37m2024-08-11 19:41:48,984 [INFO] - Training epoch stats:     Loss: 0.0629 - F1-Score: 0.9826 - Accuracy-Score: 0.9790 - AUROC: 0.9978 - AP: 0.9985
[37m2024-08-11 19:41:49,347 [INFO] - Validation epoch stats:   Loss: 0.6420 - F1-Score: 0.8186 - Accuracy-Score: 0.7888 - AUROC: 0.8820 - AP: 0.9245
[37m2024-08-11 19:41:49,408 [INFO] - Epoch: 13/50
[37m2024-08-11 19:41:49,613 [INFO] - Training epoch stats:     Loss: 0.0599 - F1-Score: 0.9834 - Accuracy-Score: 0.9800 - AUROC: 0.9980 - AP: 0.9987
[37m2024-08-11 19:41:50,000 [INFO] - Validation epoch stats:   Loss: 0.6598 - F1-Score: 0.8157 - Accuracy-Score: 0.7860 - AUROC: 0.8805 - AP: 0.9228
[37m2024-08-11 19:41:50,061 [INFO] - Epoch: 14/50
[37m2024-08-11 19:41:50,295 [INFO] - Training epoch stats:     Loss: 0.0579 - F1-Score: 0.9843 - Accuracy-Score: 0.9811 - AUROC: 0.9982 - AP: 0.9988
[37m2024-08-11 19:41:50,708 [INFO] - Validation epoch stats:   Loss: 0.6689 - F1-Score: 0.8181 - Accuracy-Score: 0.7885 - AUROC: 0.8818 - AP: 0.9243
[37m2024-08-11 19:41:50,774 [INFO] - Epoch: 15/50
[37m2024-08-11 19:41:51,000 [INFO] - Training epoch stats:     Loss: 0.0531 - F1-Score: 0.9857 - Accuracy-Score: 0.9828 - AUROC: 0.9985 - AP: 0.9990
[37m2024-08-11 19:41:51,411 [INFO] - Validation epoch stats:   Loss: 0.6871 - F1-Score: 0.8155 - Accuracy-Score: 0.7856 - AUROC: 0.8796 - AP: 0.9223
[37m2024-08-11 19:41:51,478 [INFO] - Epoch: 16/50
[37m2024-08-11 19:41:52,069 [INFO] - Training epoch stats:     Loss: 0.0519 - F1-Score: 0.9846 - Accuracy-Score: 0.9815 - AUROC: 0.9986 - AP: 0.9991
[37m2024-08-11 19:41:52,502 [INFO] - Validation epoch stats:   Loss: 0.7027 - F1-Score: 0.8132 - Accuracy-Score: 0.7835 - AUROC: 0.8790 - AP: 0.9219
[37m2024-08-11 19:41:52,573 [INFO] - Epoch: 17/50
[37m2024-08-11 19:41:52,811 [INFO] - Training epoch stats:     Loss: 0.0487 - F1-Score: 0.9878 - Accuracy-Score: 0.9853 - AUROC: 0.9989 - AP: 0.9992
[37m2024-08-11 19:41:53,265 [INFO] - Validation epoch stats:   Loss: 0.7501 - F1-Score: 0.8004 - Accuracy-Score: 0.7724 - AUROC: 0.8785 - AP: 0.9219
[37m2024-08-11 19:41:53,329 [INFO] - Epoch: 18/50
[37m2024-08-11 19:41:53,569 [INFO] - Training epoch stats:     Loss: 0.0474 - F1-Score: 0.9868 - Accuracy-Score: 0.9841 - AUROC: 0.9989 - AP: 0.9993
[37m2024-08-11 19:41:53,971 [INFO] - Validation epoch stats:   Loss: 0.7027 - F1-Score: 0.8216 - Accuracy-Score: 0.7903 - AUROC: 0.8774 - AP: 0.9207
[37m2024-08-11 19:41:54,031 [INFO] - Epoch: 19/50
[37m2024-08-11 19:41:54,279 [INFO] - Training epoch stats:     Loss: 0.0448 - F1-Score: 0.9892 - Accuracy-Score: 0.9870 - AUROC: 0.9991 - AP: 0.9994
[37m2024-08-11 19:41:54,744 [INFO] - Validation epoch stats:   Loss: 0.7684 - F1-Score: 0.8005 - Accuracy-Score: 0.7722 - AUROC: 0.8765 - AP: 0.9204
[37m2024-08-11 19:41:54,812 [INFO] - Epoch: 20/50
[37m2024-08-11 19:41:55,083 [INFO] - Training epoch stats:     Loss: 0.0429 - F1-Score: 0.9893 - Accuracy-Score: 0.9872 - AUROC: 0.9991 - AP: 0.9994
[37m2024-08-11 19:41:55,531 [INFO] - Validation epoch stats:   Loss: 0.7814 - F1-Score: 0.8014 - Accuracy-Score: 0.7730 - AUROC: 0.8764 - AP: 0.9195
[37m2024-08-11 19:41:55,587 [INFO] - Epoch: 21/50
[37m2024-08-11 19:41:55,826 [INFO] - Training epoch stats:     Loss: 0.0417 - F1-Score: 0.9906 - Accuracy-Score: 0.9887 - AUROC: 0.9992 - AP: 0.9995
[37m2024-08-11 19:41:56,254 [INFO] - Validation epoch stats:   Loss: 0.7682 - F1-Score: 0.8058 - Accuracy-Score: 0.7764 - AUROC: 0.8758 - AP: 0.9198
[37m2024-08-11 19:41:56,260 [INFO] - Performing early stopping!
[37m2024-08-11 19:41:56,267 [INFO] - Finished run sv9y5emd
