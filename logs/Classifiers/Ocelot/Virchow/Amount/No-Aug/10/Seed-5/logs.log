[37m2024-08-11 19:42:23,426 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:42:23,427 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/10/Seed-5/2024-08-11T194213_CellViT-Virchow-10Percent
[37m2024-08-11 19:42:23,531 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f47680823b0>]
[37m2024-08-11 19:42:23,537 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:42:23,541 [INFO] - Using device: cuda:0
[37m2024-08-11 19:42:23,545 [INFO] - Loss function:
[37m2024-08-11 19:42:23,550 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:42:29,309 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:42:29,985 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:42:29,987 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:42:29,991 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:42:29,996 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:42:30,009 [INFO] - Caching datasets
[37m2024-08-11 19:42:31,245 [INFO] - Instantiate Trainer
[37m2024-08-11 19:42:31,262 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:42:31,267 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:42:31,271 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:42:31,275 [INFO] - Epoch: 1/50
[37m2024-08-11 19:42:32,380 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/dc49e777c93251e51f6136208954ee0d960724437c4b039f157b3f9e0e43b5b2.h5
[37m2024-08-11 19:42:32,773 [INFO] - Training epoch stats:     Loss: 0.3922 - F1-Score: 0.8766 - Accuracy-Score: 0.8387 - AUROC: 0.9349 - AP: 0.9550
[37m2024-08-11 19:42:37,011 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:42:37,419 [INFO] - Validation epoch stats:   Loss: 0.3951 - F1-Score: 0.8778 - Accuracy-Score: 0.8478 - AUROC: 0.9050 - AP: 0.9404
[37m2024-08-11 19:42:37,426 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:42:37,615 [INFO] - Epoch: 2/50
[37m2024-08-11 19:42:37,855 [INFO] - Training epoch stats:     Loss: 0.1761 - F1-Score: 0.9473 - Accuracy-Score: 0.9364 - AUROC: 0.9822 - AP: 0.9879
[37m2024-08-11 19:42:38,271 [INFO] - Validation epoch stats:   Loss: 0.4190 - F1-Score: 0.8650 - Accuracy-Score: 0.8340 - AUROC: 0.8970 - AP: 0.9368
[37m2024-08-11 19:42:38,340 [INFO] - Epoch: 3/50
[37m2024-08-11 19:42:38,588 [INFO] - Training epoch stats:     Loss: 0.1339 - F1-Score: 0.9581 - Accuracy-Score: 0.9494 - AUROC: 0.9891 - AP: 0.9925
[37m2024-08-11 19:42:39,025 [INFO] - Validation epoch stats:   Loss: 0.4539 - F1-Score: 0.8580 - Accuracy-Score: 0.8272 - AUROC: 0.8935 - AP: 0.9344
[37m2024-08-11 19:42:39,093 [INFO] - Epoch: 4/50
[37m2024-08-11 19:42:39,325 [INFO] - Training epoch stats:     Loss: 0.1152 - F1-Score: 0.9649 - Accuracy-Score: 0.9577 - AUROC: 0.9921 - AP: 0.9947
[37m2024-08-11 19:42:39,685 [INFO] - Validation epoch stats:   Loss: 0.4697 - F1-Score: 0.8563 - Accuracy-Score: 0.8247 - AUROC: 0.8917 - AP: 0.9327
[37m2024-08-11 19:42:39,751 [INFO] - Epoch: 5/50
[37m2024-08-11 19:42:39,961 [INFO] - Training epoch stats:     Loss: 0.1016 - F1-Score: 0.9687 - Accuracy-Score: 0.9622 - AUROC: 0.9937 - AP: 0.9957
[37m2024-08-11 19:42:40,325 [INFO] - Validation epoch stats:   Loss: 0.4807 - F1-Score: 0.8573 - Accuracy-Score: 0.8237 - AUROC: 0.8893 - AP: 0.9306
[37m2024-08-11 19:42:40,383 [INFO] - Epoch: 6/50
[37m2024-08-11 19:42:40,581 [INFO] - Training epoch stats:     Loss: 0.0925 - F1-Score: 0.9711 - Accuracy-Score: 0.9651 - AUROC: 0.9949 - AP: 0.9966
[37m2024-08-11 19:42:40,947 [INFO] - Validation epoch stats:   Loss: 0.5673 - F1-Score: 0.8169 - Accuracy-Score: 0.7886 - AUROC: 0.8865 - AP: 0.9288
[37m2024-08-11 19:42:41,007 [INFO] - Epoch: 7/50
[37m2024-08-11 19:42:41,210 [INFO] - Training epoch stats:     Loss: 0.0865 - F1-Score: 0.9742 - Accuracy-Score: 0.9690 - AUROC: 0.9957 - AP: 0.9971
[37m2024-08-11 19:42:41,580 [INFO] - Validation epoch stats:   Loss: 0.5400 - F1-Score: 0.8406 - Accuracy-Score: 0.8096 - AUROC: 0.8872 - AP: 0.9291
[37m2024-08-11 19:42:41,642 [INFO] - Epoch: 8/50
[37m2024-08-11 19:42:41,903 [INFO] - Training epoch stats:     Loss: 0.0804 - F1-Score: 0.9749 - Accuracy-Score: 0.9698 - AUROC: 0.9962 - AP: 0.9975
[37m2024-08-11 19:42:42,259 [INFO] - Validation epoch stats:   Loss: 0.5562 - F1-Score: 0.8357 - Accuracy-Score: 0.8045 - AUROC: 0.8855 - AP: 0.9279
[37m2024-08-11 19:42:42,317 [INFO] - Epoch: 9/50
[37m2024-08-11 19:42:42,518 [INFO] - Training epoch stats:     Loss: 0.0745 - F1-Score: 0.9788 - Accuracy-Score: 0.9745 - AUROC: 0.9969 - AP: 0.9979
[37m2024-08-11 19:42:42,874 [INFO] - Validation epoch stats:   Loss: 0.5782 - F1-Score: 0.8334 - Accuracy-Score: 0.8022 - AUROC: 0.8832 - AP: 0.9251
[37m2024-08-11 19:42:42,940 [INFO] - Epoch: 10/50
[37m2024-08-11 19:42:43,141 [INFO] - Training epoch stats:     Loss: 0.0708 - F1-Score: 0.9787 - Accuracy-Score: 0.9743 - AUROC: 0.9972 - AP: 0.9981
[37m2024-08-11 19:42:43,490 [INFO] - Validation epoch stats:   Loss: 0.6168 - F1-Score: 0.8191 - Accuracy-Score: 0.7893 - AUROC: 0.8819 - AP: 0.9248
[37m2024-08-11 19:42:43,558 [INFO] - Epoch: 11/50
[37m2024-08-11 19:42:43,755 [INFO] - Training epoch stats:     Loss: 0.0671 - F1-Score: 0.9816 - Accuracy-Score: 0.9779 - AUROC: 0.9975 - AP: 0.9983
[37m2024-08-11 19:42:44,107 [INFO] - Validation epoch stats:   Loss: 0.5882 - F1-Score: 0.8394 - Accuracy-Score: 0.8066 - AUROC: 0.8825 - AP: 0.9247
[37m2024-08-11 19:42:44,170 [INFO] - Epoch: 12/50
[37m2024-08-11 19:42:44,367 [INFO] - Training epoch stats:     Loss: 0.0643 - F1-Score: 0.9815 - Accuracy-Score: 0.9777 - AUROC: 0.9977 - AP: 0.9985
[37m2024-08-11 19:42:44,715 [INFO] - Validation epoch stats:   Loss: 0.6336 - F1-Score: 0.8229 - Accuracy-Score: 0.7922 - AUROC: 0.8805 - AP: 0.9241
[37m2024-08-11 19:42:44,782 [INFO] - Epoch: 13/50
[37m2024-08-11 19:42:44,981 [INFO] - Training epoch stats:     Loss: 0.0593 - F1-Score: 0.9826 - Accuracy-Score: 0.9790 - AUROC: 0.9981 - AP: 0.9988
[37m2024-08-11 19:42:45,333 [INFO] - Validation epoch stats:   Loss: 0.6493 - F1-Score: 0.8218 - Accuracy-Score: 0.7912 - AUROC: 0.8804 - AP: 0.9235
[37m2024-08-11 19:42:45,392 [INFO] - Epoch: 14/50
[37m2024-08-11 19:42:45,601 [INFO] - Training epoch stats:     Loss: 0.0579 - F1-Score: 0.9843 - Accuracy-Score: 0.9811 - AUROC: 0.9982 - AP: 0.9988
[37m2024-08-11 19:42:45,982 [INFO] - Validation epoch stats:   Loss: 0.6556 - F1-Score: 0.8247 - Accuracy-Score: 0.7939 - AUROC: 0.8814 - AP: 0.9247
[37m2024-08-11 19:42:46,059 [INFO] - Epoch: 15/50
[37m2024-08-11 19:42:46,305 [INFO] - Training epoch stats:     Loss: 0.0550 - F1-Score: 0.9860 - Accuracy-Score: 0.9832 - AUROC: 0.9984 - AP: 0.9990
[37m2024-08-11 19:42:46,720 [INFO] - Validation epoch stats:   Loss: 0.6495 - F1-Score: 0.8310 - Accuracy-Score: 0.7987 - AUROC: 0.8794 - AP: 0.9231
[37m2024-08-11 19:42:46,798 [INFO] - Epoch: 16/50
[37m2024-08-11 19:42:47,369 [INFO] - Training epoch stats:     Loss: 0.0506 - F1-Score: 0.9870 - Accuracy-Score: 0.9843 - AUROC: 0.9987 - AP: 0.9991
[37m2024-08-11 19:42:47,809 [INFO] - Validation epoch stats:   Loss: 0.6769 - F1-Score: 0.8237 - Accuracy-Score: 0.7923 - AUROC: 0.8787 - AP: 0.9225
[37m2024-08-11 19:42:47,883 [INFO] - Epoch: 17/50
[37m2024-08-11 19:42:48,093 [INFO] - Training epoch stats:     Loss: 0.0498 - F1-Score: 0.9852 - Accuracy-Score: 0.9822 - AUROC: 0.9988 - AP: 0.9992
[37m2024-08-11 19:42:48,497 [INFO] - Validation epoch stats:   Loss: 0.6773 - F1-Score: 0.8274 - Accuracy-Score: 0.7952 - AUROC: 0.8780 - AP: 0.9217
[37m2024-08-11 19:42:48,561 [INFO] - Epoch: 18/50
[37m2024-08-11 19:42:48,793 [INFO] - Training epoch stats:     Loss: 0.0485 - F1-Score: 0.9881 - Accuracy-Score: 0.9856 - AUROC: 0.9988 - AP: 0.9992
[37m2024-08-11 19:42:49,210 [INFO] - Validation epoch stats:   Loss: 0.7191 - F1-Score: 0.8149 - Accuracy-Score: 0.7849 - AUROC: 0.8776 - AP: 0.9216
[37m2024-08-11 19:42:49,268 [INFO] - Epoch: 19/50
[37m2024-08-11 19:42:49,501 [INFO] - Training epoch stats:     Loss: 0.0458 - F1-Score: 0.9885 - Accuracy-Score: 0.9862 - AUROC: 0.9990 - AP: 0.9993
[37m2024-08-11 19:42:49,918 [INFO] - Validation epoch stats:   Loss: 0.7342 - F1-Score: 0.8132 - Accuracy-Score: 0.7833 - AUROC: 0.8773 - AP: 0.9211
[37m2024-08-11 19:42:49,998 [INFO] - Epoch: 20/50
[37m2024-08-11 19:42:50,238 [INFO] - Training epoch stats:     Loss: 0.0431 - F1-Score: 0.9895 - Accuracy-Score: 0.9873 - AUROC: 0.9992 - AP: 0.9995
[37m2024-08-11 19:42:50,650 [INFO] - Validation epoch stats:   Loss: 0.7678 - F1-Score: 0.8040 - Accuracy-Score: 0.7752 - AUROC: 0.8764 - AP: 0.9206
[37m2024-08-11 19:42:50,729 [INFO] - Epoch: 21/50
[37m2024-08-11 19:42:50,966 [INFO] - Training epoch stats:     Loss: 0.0422 - F1-Score: 0.9893 - Accuracy-Score: 0.9872 - AUROC: 0.9992 - AP: 0.9994
[37m2024-08-11 19:42:51,377 [INFO] - Validation epoch stats:   Loss: 0.7769 - F1-Score: 0.8035 - Accuracy-Score: 0.7745 - AUROC: 0.8757 - AP: 0.9200
[37m2024-08-11 19:42:51,385 [INFO] - Performing early stopping!
[37m2024-08-11 19:42:51,393 [INFO] - Finished run dknto9w1
