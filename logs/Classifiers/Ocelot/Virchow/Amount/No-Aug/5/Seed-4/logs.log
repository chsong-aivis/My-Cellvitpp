[37m2024-08-11 19:40:08,394 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 19:40:08,396 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/Virchow/Amount/No-Aug/5/Seed-4/2024-08-11T193957_CellViT-Virchow-5Percent
[37m2024-08-11 19:40:08,507 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f4a55e99630>]
[37m2024-08-11 19:40:08,514 [INFO] - Using GPU: cuda:0
[37m2024-08-11 19:40:08,519 [INFO] - Using device: cuda:0
[37m2024-08-11 19:40:08,525 [INFO] - Loss function:
[37m2024-08-11 19:40:08,530 [INFO] - CrossEntropyLoss()
[37m2024-08-11 19:40:45,748 [INFO] - <All keys matched successfully>
[37m2024-08-11 19:40:46,740 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 19:40:46,747 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 19:40:46,752 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0004303882065443299, 'weight_decay': 0.0006034678620960006}
[37m2024-08-11 19:40:46,758 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 19:40:46,781 [INFO] - Caching datasets
[37m2024-08-11 19:40:50,081 [INFO] - Instantiate Trainer
[37m2024-08-11 19:40:50,088 [INFO] - Calling Trainer Fit
[37m2024-08-11 19:40:50,095 [INFO] - Dataset is cached after first epoch
[37m2024-08-11 19:40:50,100 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 19:40:50,106 [INFO] - Epoch: 1/50
[37m2024-08-11 19:40:50,658 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/e9314d76c2e1129f38e6fcb5b3ac71974840f657ccba7d21b407b8fa36ddadce.h5
[37m2024-08-11 19:40:51,217 [INFO] - Training epoch stats:     Loss: 0.4840 - F1-Score: 0.7986 - Accuracy-Score: 0.8348 - AUROC: 0.9249 - AP: 0.9097
[37m2024-08-11 19:40:55,604 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b9c748f76a42e9a5b6619f0756b1e70745a509b6263a3cac0bf6f7cad71394d3.h5
[37m2024-08-11 19:40:56,027 [INFO] - Validation epoch stats:   Loss: 0.5807 - F1-Score: 0.6794 - Accuracy-Score: 0.6794 - AUROC: 0.8897 - AP: 0.9272
[37m2024-08-11 19:40:56,033 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:40:56,218 [INFO] - Epoch: 2/50
[37m2024-08-11 19:40:56,339 [INFO] - Training epoch stats:     Loss: 0.2263 - F1-Score: 0.9180 - Accuracy-Score: 0.9285 - AUROC: 0.9791 - AP: 0.9724
[37m2024-08-11 19:40:56,743 [INFO] - Validation epoch stats:   Loss: 0.5433 - F1-Score: 0.7524 - Accuracy-Score: 0.7363 - AUROC: 0.8964 - AP: 0.9333
[37m2024-08-11 19:40:56,750 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:40:56,930 [INFO] - Epoch: 3/50
[37m2024-08-11 19:40:57,048 [INFO] - Training epoch stats:     Loss: 0.1624 - F1-Score: 0.9298 - Accuracy-Score: 0.9383 - AUROC: 0.9853 - AP: 0.9807
[37m2024-08-11 19:40:57,455 [INFO] - Validation epoch stats:   Loss: 0.6097 - F1-Score: 0.7305 - Accuracy-Score: 0.7196 - AUROC: 0.8976 - AP: 0.9353
[37m2024-08-11 19:40:57,461 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:40:57,616 [INFO] - Epoch: 4/50
[37m2024-08-11 19:40:57,730 [INFO] - Training epoch stats:     Loss: 0.1379 - F1-Score: 0.9365 - Accuracy-Score: 0.9448 - AUROC: 0.9890 - AP: 0.9860
[37m2024-08-11 19:40:58,145 [INFO] - Validation epoch stats:   Loss: 0.5360 - F1-Score: 0.8000 - Accuracy-Score: 0.7773 - AUROC: 0.8995 - AP: 0.9376
[37m2024-08-11 19:40:58,151 [INFO] - New best model - save checkpoint
[37m2024-08-11 19:40:58,318 [INFO] - Epoch: 5/50
[37m2024-08-11 19:40:58,436 [INFO] - Training epoch stats:     Loss: 0.1220 - F1-Score: 0.9429 - Accuracy-Score: 0.9497 - AUROC: 0.9917 - AP: 0.9893
[37m2024-08-11 19:40:58,851 [INFO] - Validation epoch stats:   Loss: 0.6675 - F1-Score: 0.7313 - Accuracy-Score: 0.7212 - AUROC: 0.8969 - AP: 0.9373
[37m2024-08-11 19:40:58,918 [INFO] - Epoch: 6/50
[37m2024-08-11 19:40:59,038 [INFO] - Training epoch stats:     Loss: 0.1088 - F1-Score: 0.9499 - Accuracy-Score: 0.9563 - AUROC: 0.9936 - AP: 0.9919
[37m2024-08-11 19:40:59,461 [INFO] - Validation epoch stats:   Loss: 0.5992 - F1-Score: 0.7812 - Accuracy-Score: 0.7614 - AUROC: 0.8976 - AP: 0.9383
[37m2024-08-11 19:40:59,526 [INFO] - Epoch: 7/50
[37m2024-08-11 19:40:59,645 [INFO] - Training epoch stats:     Loss: 0.0987 - F1-Score: 0.9534 - Accuracy-Score: 0.9591 - AUROC: 0.9945 - AP: 0.9929
[37m2024-08-11 19:41:00,072 [INFO] - Validation epoch stats:   Loss: 0.6389 - F1-Score: 0.7707 - Accuracy-Score: 0.7526 - AUROC: 0.8965 - AP: 0.9381
[37m2024-08-11 19:41:00,157 [INFO] - Epoch: 8/50
[37m2024-08-11 19:41:00,276 [INFO] - Training epoch stats:     Loss: 0.0945 - F1-Score: 0.9569 - Accuracy-Score: 0.9624 - AUROC: 0.9950 - AP: 0.9936
[37m2024-08-11 19:41:00,703 [INFO] - Validation epoch stats:   Loss: 0.6732 - F1-Score: 0.7622 - Accuracy-Score: 0.7455 - AUROC: 0.8947 - AP: 0.9371
[37m2024-08-11 19:41:00,767 [INFO] - Epoch: 9/50
[37m2024-08-11 19:41:00,888 [INFO] - Training epoch stats:     Loss: 0.0864 - F1-Score: 0.9645 - Accuracy-Score: 0.9689 - AUROC: 0.9959 - AP: 0.9947
[37m2024-08-11 19:41:01,312 [INFO] - Validation epoch stats:   Loss: 0.7043 - F1-Score: 0.7552 - Accuracy-Score: 0.7399 - AUROC: 0.8928 - AP: 0.9364
[37m2024-08-11 19:41:01,378 [INFO] - Epoch: 10/50
[37m2024-08-11 19:41:01,491 [INFO] - Training epoch stats:     Loss: 0.0824 - F1-Score: 0.9663 - Accuracy-Score: 0.9706 - AUROC: 0.9965 - AP: 0.9954
[37m2024-08-11 19:41:01,919 [INFO] - Validation epoch stats:   Loss: 0.7209 - F1-Score: 0.7549 - Accuracy-Score: 0.7395 - AUROC: 0.8913 - AP: 0.9356
[37m2024-08-11 19:41:01,988 [INFO] - Epoch: 11/50
[37m2024-08-11 19:41:02,091 [INFO] - Training epoch stats:     Loss: 0.0762 - F1-Score: 0.9686 - Accuracy-Score: 0.9726 - AUROC: 0.9971 - AP: 0.9962
[37m2024-08-11 19:41:02,518 [INFO] - Validation epoch stats:   Loss: 0.7145 - F1-Score: 0.7651 - Accuracy-Score: 0.7475 - AUROC: 0.8914 - AP: 0.9358
[37m2024-08-11 19:41:02,583 [INFO] - Epoch: 12/50
[37m2024-08-11 19:41:02,684 [INFO] - Training epoch stats:     Loss: 0.0748 - F1-Score: 0.9723 - Accuracy-Score: 0.9759 - AUROC: 0.9973 - AP: 0.9965
[37m2024-08-11 19:41:03,133 [INFO] - Validation epoch stats:   Loss: 0.7305 - F1-Score: 0.7651 - Accuracy-Score: 0.7473 - AUROC: 0.8895 - AP: 0.9346
[37m2024-08-11 19:41:03,198 [INFO] - Epoch: 13/50
[37m2024-08-11 19:41:03,297 [INFO] - Training epoch stats:     Loss: 0.0716 - F1-Score: 0.9691 - Accuracy-Score: 0.9730 - AUROC: 0.9976 - AP: 0.9969
[37m2024-08-11 19:41:03,733 [INFO] - Validation epoch stats:   Loss: 0.7364 - F1-Score: 0.7682 - Accuracy-Score: 0.7496 - AUROC: 0.8880 - AP: 0.9337
[37m2024-08-11 19:41:03,801 [INFO] - Epoch: 14/50
[37m2024-08-11 19:41:03,903 [INFO] - Training epoch stats:     Loss: 0.0662 - F1-Score: 0.9694 - Accuracy-Score: 0.9734 - AUROC: 0.9979 - AP: 0.9973
[37m2024-08-11 19:41:04,328 [INFO] - Validation epoch stats:   Loss: 0.7634 - F1-Score: 0.7608 - Accuracy-Score: 0.7434 - AUROC: 0.8877 - AP: 0.9334
[37m2024-08-11 19:41:04,393 [INFO] - Epoch: 15/50
[37m2024-08-11 19:41:04,492 [INFO] - Training epoch stats:     Loss: 0.0602 - F1-Score: 0.9752 - Accuracy-Score: 0.9783 - AUROC: 0.9983 - AP: 0.9978
[37m2024-08-11 19:41:04,915 [INFO] - Validation epoch stats:   Loss: 0.7652 - F1-Score: 0.7654 - Accuracy-Score: 0.7471 - AUROC: 0.8870 - AP: 0.9330
[37m2024-08-11 19:41:04,980 [INFO] - Epoch: 16/50
[37m2024-08-11 19:41:05,088 [INFO] - Training epoch stats:     Loss: 0.0603 - F1-Score: 0.9770 - Accuracy-Score: 0.9800 - AUROC: 0.9983 - AP: 0.9978
[37m2024-08-11 19:41:05,516 [INFO] - Validation epoch stats:   Loss: 0.7901 - F1-Score: 0.7609 - Accuracy-Score: 0.7432 - AUROC: 0.8852 - AP: 0.9319
[37m2024-08-11 19:41:05,580 [INFO] - Epoch: 17/50
[37m2024-08-11 19:41:05,683 [INFO] - Training epoch stats:     Loss: 0.0595 - F1-Score: 0.9790 - Accuracy-Score: 0.9816 - AUROC: 0.9986 - AP: 0.9982
[37m2024-08-11 19:41:06,113 [INFO] - Validation epoch stats:   Loss: 0.8229 - F1-Score: 0.7537 - Accuracy-Score: 0.7374 - AUROC: 0.8845 - AP: 0.9313
[37m2024-08-11 19:41:06,177 [INFO] - Epoch: 18/50
[37m2024-08-11 19:41:06,277 [INFO] - Training epoch stats:     Loss: 0.0546 - F1-Score: 0.9770 - Accuracy-Score: 0.9800 - AUROC: 0.9988 - AP: 0.9984
[37m2024-08-11 19:41:06,703 [INFO] - Validation epoch stats:   Loss: 0.7789 - F1-Score: 0.7728 - Accuracy-Score: 0.7526 - AUROC: 0.8845 - AP: 0.9312
[37m2024-08-11 19:41:06,774 [INFO] - Epoch: 19/50
[37m2024-08-11 19:41:06,876 [INFO] - Training epoch stats:     Loss: 0.0552 - F1-Score: 0.9786 - Accuracy-Score: 0.9812 - AUROC: 0.9988 - AP: 0.9984
[37m2024-08-11 19:41:07,632 [INFO] - Validation epoch stats:   Loss: 0.8533 - F1-Score: 0.7511 - Accuracy-Score: 0.7352 - AUROC: 0.8831 - AP: 0.9303
[37m2024-08-11 19:41:07,700 [INFO] - Epoch: 20/50
[37m2024-08-11 19:41:07,829 [INFO] - Training epoch stats:     Loss: 0.0509 - F1-Score: 0.9798 - Accuracy-Score: 0.9824 - AUROC: 0.9990 - AP: 0.9987
[37m2024-08-11 19:41:08,247 [INFO] - Validation epoch stats:   Loss: 0.8364 - F1-Score: 0.7609 - Accuracy-Score: 0.7427 - AUROC: 0.8822 - AP: 0.9298
[37m2024-08-11 19:41:08,318 [INFO] - Epoch: 21/50
[37m2024-08-11 19:41:08,438 [INFO] - Training epoch stats:     Loss: 0.0483 - F1-Score: 0.9845 - Accuracy-Score: 0.9865 - AUROC: 0.9991 - AP: 0.9988
[37m2024-08-11 19:41:08,873 [INFO] - Validation epoch stats:   Loss: 0.8746 - F1-Score: 0.7519 - Accuracy-Score: 0.7355 - AUROC: 0.8814 - AP: 0.9292
[37m2024-08-11 19:41:08,934 [INFO] - Epoch: 22/50
[37m2024-08-11 19:41:09,052 [INFO] - Training epoch stats:     Loss: 0.0479 - F1-Score: 0.9827 - Accuracy-Score: 0.9849 - AUROC: 0.9991 - AP: 0.9988
[37m2024-08-11 19:41:09,476 [INFO] - Validation epoch stats:   Loss: 0.8441 - F1-Score: 0.7649 - Accuracy-Score: 0.7457 - AUROC: 0.8808 - AP: 0.9286
[37m2024-08-11 19:41:09,538 [INFO] - Epoch: 23/50
[37m2024-08-11 19:41:09,657 [INFO] - Training epoch stats:     Loss: 0.0473 - F1-Score: 0.9833 - Accuracy-Score: 0.9853 - AUROC: 0.9992 - AP: 0.9989
[37m2024-08-11 19:41:10,083 [INFO] - Validation epoch stats:   Loss: 0.9312 - F1-Score: 0.7415 - Accuracy-Score: 0.7274 - AUROC: 0.8798 - AP: 0.9281
[37m2024-08-11 19:41:10,145 [INFO] - Epoch: 24/50
[37m2024-08-11 19:41:10,265 [INFO] - Training epoch stats:     Loss: 0.0466 - F1-Score: 0.9793 - Accuracy-Score: 0.9820 - AUROC: 0.9993 - AP: 0.9991
[37m2024-08-11 19:41:10,693 [INFO] - Validation epoch stats:   Loss: 0.8682 - F1-Score: 0.7632 - Accuracy-Score: 0.7443 - AUROC: 0.8804 - AP: 0.9284
[37m2024-08-11 19:41:10,702 [INFO] - Performing early stopping!
[37m2024-08-11 19:41:10,709 [INFO] - Finished run rqfqwphh
