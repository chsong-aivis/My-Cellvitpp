[37m2024-06-25 05:48:38,676 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-25 05:48:38,677 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/ViT256/Amount/No-Aug/100/2024-06-25T054829_CellViT-256-100Percent
[37m2024-06-25 05:48:38,756 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fa9977a8490>]
[37m2024-06-25 05:48:38,761 [INFO] - Using GPU: cuda:0
[37m2024-06-25 05:48:38,769 [INFO] - Using device: cuda:0
[37m2024-06-25 05:48:38,785 [INFO] - Loss function:
[37m2024-06-25 05:48:38,792 [INFO] - CrossEntropyLoss()
[37m2024-06-25 05:48:41,867 [INFO] - <All keys matched successfully>
[37m2024-06-25 05:48:42,172 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  98,560
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 99,074
Trainable params: 99,074
Non-trainable params: 0
Total mult-adds (M): 0.10
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.40
Estimated Total Size (MB): 0.40
==========================================================================================
[37m2024-06-25 05:48:42,173 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-25 05:48:42,179 [INFO] - {'betas': [0.85, 0.9], 'lr': 4.4403255414468894e-05, 'weight_decay': 8.22969479387945e-05}
[37m2024-06-25 05:48:42,185 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-25 05:48:42,204 [INFO] - Caching datasets
[37m2024-06-25 05:48:48,404 [INFO] - Instantiate Trainer
[37m2024-06-25 05:48:48,410 [INFO] - Calling Trainer Fit
[37m2024-06-25 05:48:48,411 [INFO] - Dataset is cached after first epoch
[37m2024-06-25 05:48:48,416 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-25 05:48:48,421 [INFO] - Epoch: 1/50
[37m2024-06-25 05:48:51,813 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/3fc8769b602695debd77f4c7f3e597e37fc8d0e2c6eed6e8e44ffcd3f1330054.h5
[37m2024-06-25 05:48:54,863 [INFO] - Training epoch stats:     Loss: 0.5820 - F1-Score: 0.8074 - Accuracy-Score: 0.7299 - AUROC: 0.8113 - AP: 0.8655
[37m2024-06-25 05:48:56,022 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/84a96648cf0731d52e69bfe32a74428f944857015825e7a06ae5f471f93f4855.h5
[37m2024-06-25 05:48:56,355 [INFO] - Validation epoch stats:   Loss: 0.4767 - F1-Score: 0.8617 - Accuracy-Score: 0.8152 - AUROC: 0.8966 - AP: 0.9374
[37m2024-06-25 05:48:56,355 [INFO] - New best model - save checkpoint
[37m2024-06-25 05:48:56,493 [INFO] - Epoch: 2/50
[37m2024-06-25 05:48:58,067 [INFO] - Training epoch stats:     Loss: 0.4255 - F1-Score: 0.8613 - Accuracy-Score: 0.8214 - AUROC: 0.8929 - AP: 0.9226
[37m2024-06-25 05:48:58,500 [INFO] - Validation epoch stats:   Loss: 0.3908 - F1-Score: 0.8680 - Accuracy-Score: 0.8319 - AUROC: 0.9069 - AP: 0.9442
[37m2024-06-25 05:48:58,501 [INFO] - New best model - save checkpoint
[37m2024-06-25 05:48:58,634 [INFO] - Epoch: 3/50
[37m2024-06-25 05:49:00,368 [INFO] - Training epoch stats:     Loss: 0.3777 - F1-Score: 0.8723 - Accuracy-Score: 0.8391 - AUROC: 0.9067 - AP: 0.9331
[37m2024-06-25 05:49:00,715 [INFO] - Validation epoch stats:   Loss: 0.3785 - F1-Score: 0.8689 - Accuracy-Score: 0.8359 - AUROC: 0.9109 - AP: 0.9463
[37m2024-06-25 05:49:00,716 [INFO] - New best model - save checkpoint
[37m2024-06-25 05:49:00,868 [INFO] - Epoch: 4/50
[37m2024-06-25 05:49:02,870 [INFO] - Training epoch stats:     Loss: 0.3600 - F1-Score: 0.8764 - Accuracy-Score: 0.8450 - AUROC: 0.9145 - AP: 0.9392
[37m2024-06-25 05:49:03,328 [INFO] - Validation epoch stats:   Loss: 0.3781 - F1-Score: 0.8693 - Accuracy-Score: 0.8378 - AUROC: 0.9123 - AP: 0.9468
[37m2024-06-25 05:49:03,329 [INFO] - New best model - save checkpoint
[37m2024-06-25 05:49:03,498 [INFO] - Epoch: 5/50
[37m2024-06-25 05:49:05,972 [INFO] - Training epoch stats:     Loss: 0.3477 - F1-Score: 0.8799 - Accuracy-Score: 0.8496 - AUROC: 0.9202 - AP: 0.9434
[37m2024-06-25 05:49:06,391 [INFO] - Validation epoch stats:   Loss: 0.3714 - F1-Score: 0.8721 - Accuracy-Score: 0.8404 - AUROC: 0.9132 - AP: 0.9470
[37m2024-06-25 05:49:06,392 [INFO] - New best model - save checkpoint
[37m2024-06-25 05:49:06,559 [INFO] - Epoch: 6/50
[37m2024-06-25 05:49:08,364 [INFO] - Training epoch stats:     Loss: 0.3381 - F1-Score: 0.8837 - Accuracy-Score: 0.8543 - AUROC: 0.9249 - AP: 0.9471
[37m2024-06-25 05:49:09,103 [INFO] - Validation epoch stats:   Loss: 0.3736 - F1-Score: 0.8705 - Accuracy-Score: 0.8392 - AUROC: 0.9133 - AP: 0.9470
[37m2024-06-25 05:49:09,104 [INFO] - New best model - save checkpoint
[37m2024-06-25 05:49:09,243 [INFO] - Epoch: 7/50
[37m2024-06-25 05:49:11,172 [INFO] - Training epoch stats:     Loss: 0.3299 - F1-Score: 0.8861 - Accuracy-Score: 0.8573 - AUROC: 0.9287 - AP: 0.9499
[37m2024-06-25 05:49:11,656 [INFO] - Validation epoch stats:   Loss: 0.3765 - F1-Score: 0.8696 - Accuracy-Score: 0.8389 - AUROC: 0.9134 - AP: 0.9470
[37m2024-06-25 05:49:11,659 [INFO] - New best model - save checkpoint
[37m2024-06-25 05:49:11,788 [INFO] - Epoch: 8/50
[37m2024-06-25 05:49:14,373 [INFO] - Training epoch stats:     Loss: 0.3233 - F1-Score: 0.8881 - Accuracy-Score: 0.8599 - AUROC: 0.9317 - AP: 0.9521
[37m2024-06-25 05:49:14,925 [INFO] - Validation epoch stats:   Loss: 0.3749 - F1-Score: 0.8713 - Accuracy-Score: 0.8404 - AUROC: 0.9134 - AP: 0.9469
[37m2024-06-25 05:49:14,978 [INFO] - Epoch: 9/50
[37m2024-06-25 05:49:17,073 [INFO] - Training epoch stats:     Loss: 0.3167 - F1-Score: 0.8907 - Accuracy-Score: 0.8632 - AUROC: 0.9347 - AP: 0.9543
[37m2024-06-25 05:49:17,577 [INFO] - Validation epoch stats:   Loss: 0.3760 - F1-Score: 0.8709 - Accuracy-Score: 0.8403 - AUROC: 0.9134 - AP: 0.9468
[37m2024-06-25 05:49:17,621 [INFO] - Epoch: 10/50
[37m2024-06-25 05:49:19,873 [INFO] - Training epoch stats:     Loss: 0.3107 - F1-Score: 0.8925 - Accuracy-Score: 0.8655 - AUROC: 0.9371 - AP: 0.9559
[37m2024-06-25 05:49:20,278 [INFO] - Validation epoch stats:   Loss: 0.3775 - F1-Score: 0.8704 - Accuracy-Score: 0.8397 - AUROC: 0.9130 - AP: 0.9467
[37m2024-06-25 05:49:20,320 [INFO] - Epoch: 11/50
[37m2024-06-25 05:49:22,471 [INFO] - Training epoch stats:     Loss: 0.3061 - F1-Score: 0.8944 - Accuracy-Score: 0.8680 - AUROC: 0.9392 - AP: 0.9575
[37m2024-06-25 05:49:22,877 [INFO] - Validation epoch stats:   Loss: 0.3803 - F1-Score: 0.8698 - Accuracy-Score: 0.8392 - AUROC: 0.9125 - AP: 0.9463
[37m2024-06-25 05:49:22,929 [INFO] - Epoch: 12/50
[37m2024-06-25 05:49:25,470 [INFO] - Training epoch stats:     Loss: 0.3011 - F1-Score: 0.8962 - Accuracy-Score: 0.8701 - AUROC: 0.9413 - AP: 0.9591
[37m2024-06-25 05:49:25,988 [INFO] - Validation epoch stats:   Loss: 0.3796 - F1-Score: 0.8704 - Accuracy-Score: 0.8397 - AUROC: 0.9127 - AP: 0.9464
[37m2024-06-25 05:49:26,041 [INFO] - Epoch: 13/50
[37m2024-06-25 05:49:28,158 [INFO] - Training epoch stats:     Loss: 0.2969 - F1-Score: 0.8978 - Accuracy-Score: 0.8722 - AUROC: 0.9430 - AP: 0.9602
[37m2024-06-25 05:49:28,483 [INFO] - Validation epoch stats:   Loss: 0.3805 - F1-Score: 0.8702 - Accuracy-Score: 0.8396 - AUROC: 0.9127 - AP: 0.9464
[37m2024-06-25 05:49:28,535 [INFO] - Epoch: 14/50
[37m2024-06-25 05:49:30,471 [INFO] - Training epoch stats:     Loss: 0.2932 - F1-Score: 0.8990 - Accuracy-Score: 0.8737 - AUROC: 0.9445 - AP: 0.9612
[37m2024-06-25 05:49:30,917 [INFO] - Validation epoch stats:   Loss: 0.3841 - F1-Score: 0.8690 - Accuracy-Score: 0.8384 - AUROC: 0.9121 - AP: 0.9462
[37m2024-06-25 05:49:30,975 [INFO] - Epoch: 15/50
[37m2024-06-25 05:49:32,862 [INFO] - Training epoch stats:     Loss: 0.2897 - F1-Score: 0.9004 - Accuracy-Score: 0.8755 - AUROC: 0.9459 - AP: 0.9623
[37m2024-06-25 05:49:33,816 [INFO] - Validation epoch stats:   Loss: 0.3816 - F1-Score: 0.8711 - Accuracy-Score: 0.8403 - AUROC: 0.9124 - AP: 0.9463
[37m2024-06-25 05:49:33,862 [INFO] - Epoch: 16/50
[37m2024-06-25 05:49:36,367 [INFO] - Training epoch stats:     Loss: 0.2864 - F1-Score: 0.9022 - Accuracy-Score: 0.8776 - AUROC: 0.9472 - AP: 0.9632
[37m2024-06-25 05:49:36,776 [INFO] - Validation epoch stats:   Loss: 0.3869 - F1-Score: 0.8692 - Accuracy-Score: 0.8388 - AUROC: 0.9120 - AP: 0.9461
[37m2024-06-25 05:49:36,812 [INFO] - Epoch: 17/50
[37m2024-06-25 05:49:38,759 [INFO] - Training epoch stats:     Loss: 0.2832 - F1-Score: 0.9035 - Accuracy-Score: 0.8795 - AUROC: 0.9484 - AP: 0.9639
[37m2024-06-25 05:49:39,084 [INFO] - Validation epoch stats:   Loss: 0.3794 - F1-Score: 0.8728 - Accuracy-Score: 0.8414 - AUROC: 0.9120 - AP: 0.9462
[37m2024-06-25 05:49:39,085 [INFO] - Performing early stopping!
[37m2024-06-25 05:49:39,093 [INFO] - Finished run 2enbztl0
