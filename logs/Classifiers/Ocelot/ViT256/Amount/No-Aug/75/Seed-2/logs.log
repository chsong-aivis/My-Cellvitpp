[37m2024-06-24 11:08:49,859 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-24 11:08:49,860 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/ViT256/Amount/No-Aug/75/2024-06-24T110840_CellViT-256-75Percent
[37m2024-06-24 11:08:49,928 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f6586758490>]
[37m2024-06-24 11:08:49,929 [INFO] - Using GPU: cuda:0
[37m2024-06-24 11:08:49,934 [INFO] - Using device: cuda:0
[37m2024-06-24 11:08:49,939 [INFO] - Loss function:
[37m2024-06-24 11:08:49,944 [INFO] - CrossEntropyLoss()
[37m2024-06-24 11:08:52,867 [INFO] - <All keys matched successfully>
[37m2024-06-24 11:08:54,545 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  98,560
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 99,074
Trainable params: 99,074
Non-trainable params: 0
Total mult-adds (M): 0.10
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.40
Estimated Total Size (MB): 0.40
==========================================================================================
[37m2024-06-24 11:08:54,546 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-24 11:08:54,550 [INFO] - {'betas': [0.85, 0.9], 'lr': 4.4403255414468894e-05, 'weight_decay': 8.22969479387945e-05}
[37m2024-06-24 11:08:54,555 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-24 11:08:54,574 [INFO] - Caching datasets
[37m2024-06-24 11:08:59,094 [INFO] - Instantiate Trainer
[37m2024-06-24 11:08:59,098 [INFO] - Calling Trainer Fit
[37m2024-06-24 11:08:59,102 [INFO] - Dataset is cached after first epoch
[37m2024-06-24 11:08:59,107 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-24 11:08:59,112 [INFO] - Epoch: 1/50
[37m2024-06-24 11:09:01,846 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/b1bc39a05222a6c924f6554fff98c94ef2c0be9b11d46cb7bf1faa5c6ff73ac8.h5
[37m2024-06-24 11:09:04,169 [INFO] - Training epoch stats:     Loss: 0.5951 - F1-Score: 0.8086 - Accuracy-Score: 0.7309 - AUROC: 0.8068 - AP: 0.8626
[37m2024-06-24 11:09:05,786 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/84a96648cf0731d52e69bfe32a74428f944857015825e7a06ae5f471f93f4855.h5
[37m2024-06-24 11:09:06,195 [INFO] - Validation epoch stats:   Loss: 0.5143 - F1-Score: 0.8642 - Accuracy-Score: 0.8145 - AUROC: 0.8925 - AP: 0.9308
[37m2024-06-24 11:09:06,196 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:06,358 [INFO] - Epoch: 2/50
[37m2024-06-24 11:09:08,668 [INFO] - Training epoch stats:     Loss: 0.4487 - F1-Score: 0.8600 - Accuracy-Score: 0.8163 - AUROC: 0.8918 - AP: 0.9228
[37m2024-06-24 11:09:09,047 [INFO] - Validation epoch stats:   Loss: 0.4169 - F1-Score: 0.8636 - Accuracy-Score: 0.8258 - AUROC: 0.9015 - AP: 0.9396
[37m2024-06-24 11:09:09,048 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:09,181 [INFO] - Epoch: 3/50
[37m2024-06-24 11:09:10,676 [INFO] - Training epoch stats:     Loss: 0.3863 - F1-Score: 0.8714 - Accuracy-Score: 0.8368 - AUROC: 0.9059 - AP: 0.9323
[37m2024-06-24 11:09:11,071 [INFO] - Validation epoch stats:   Loss: 0.3903 - F1-Score: 0.8666 - Accuracy-Score: 0.8319 - AUROC: 0.9069 - AP: 0.9434
[37m2024-06-24 11:09:11,072 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:11,213 [INFO] - Epoch: 4/50
[37m2024-06-24 11:09:13,484 [INFO] - Training epoch stats:     Loss: 0.3631 - F1-Score: 0.8772 - Accuracy-Score: 0.8456 - AUROC: 0.9137 - AP: 0.9378
[37m2024-06-24 11:09:14,024 [INFO] - Validation epoch stats:   Loss: 0.3816 - F1-Score: 0.8692 - Accuracy-Score: 0.8359 - AUROC: 0.9096 - AP: 0.9447
[37m2024-06-24 11:09:14,025 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:14,161 [INFO] - Epoch: 5/50
[37m2024-06-24 11:09:15,667 [INFO] - Training epoch stats:     Loss: 0.3492 - F1-Score: 0.8817 - Accuracy-Score: 0.8515 - AUROC: 0.9198 - AP: 0.9425
[37m2024-06-24 11:09:16,060 [INFO] - Validation epoch stats:   Loss: 0.3752 - F1-Score: 0.8717 - Accuracy-Score: 0.8385 - AUROC: 0.9107 - AP: 0.9450
[37m2024-06-24 11:09:16,061 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:16,204 [INFO] - Epoch: 6/50
[37m2024-06-24 11:09:18,373 [INFO] - Training epoch stats:     Loss: 0.3391 - F1-Score: 0.8847 - Accuracy-Score: 0.8555 - AUROC: 0.9245 - AP: 0.9460
[37m2024-06-24 11:09:18,929 [INFO] - Validation epoch stats:   Loss: 0.3752 - F1-Score: 0.8703 - Accuracy-Score: 0.8373 - AUROC: 0.9110 - AP: 0.9448
[37m2024-06-24 11:09:18,930 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:19,055 [INFO] - Epoch: 7/50
[37m2024-06-24 11:09:20,563 [INFO] - Training epoch stats:     Loss: 0.3303 - F1-Score: 0.8882 - Accuracy-Score: 0.8598 - AUROC: 0.9284 - AP: 0.9490
[37m2024-06-24 11:09:20,947 [INFO] - Validation epoch stats:   Loss: 0.3749 - F1-Score: 0.8703 - Accuracy-Score: 0.8375 - AUROC: 0.9112 - AP: 0.9448
[37m2024-06-24 11:09:20,948 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:21,088 [INFO] - Epoch: 8/50
[37m2024-06-24 11:09:23,170 [INFO] - Training epoch stats:     Loss: 0.3230 - F1-Score: 0.8909 - Accuracy-Score: 0.8633 - AUROC: 0.9317 - AP: 0.9513
[37m2024-06-24 11:09:23,805 [INFO] - Validation epoch stats:   Loss: 0.3754 - F1-Score: 0.8697 - Accuracy-Score: 0.8370 - AUROC: 0.9113 - AP: 0.9448
[37m2024-06-24 11:09:23,806 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:23,943 [INFO] - Epoch: 9/50
[37m2024-06-24 11:09:25,460 [INFO] - Training epoch stats:     Loss: 0.3164 - F1-Score: 0.8938 - Accuracy-Score: 0.8667 - AUROC: 0.9347 - AP: 0.9536
[37m2024-06-24 11:09:25,836 [INFO] - Validation epoch stats:   Loss: 0.3802 - F1-Score: 0.8679 - Accuracy-Score: 0.8361 - AUROC: 0.9113 - AP: 0.9448
[37m2024-06-24 11:09:25,889 [INFO] - Epoch: 10/50
[37m2024-06-24 11:09:27,867 [INFO] - Training epoch stats:     Loss: 0.3107 - F1-Score: 0.8951 - Accuracy-Score: 0.8686 - AUROC: 0.9372 - AP: 0.9554
[37m2024-06-24 11:09:28,503 [INFO] - Validation epoch stats:   Loss: 0.3764 - F1-Score: 0.8699 - Accuracy-Score: 0.8376 - AUROC: 0.9115 - AP: 0.9448
[37m2024-06-24 11:09:28,504 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:28,665 [INFO] - Epoch: 11/50
[37m2024-06-24 11:09:30,378 [INFO] - Training epoch stats:     Loss: 0.3050 - F1-Score: 0.8972 - Accuracy-Score: 0.8711 - AUROC: 0.9395 - AP: 0.9572
[37m2024-06-24 11:09:30,792 [INFO] - Validation epoch stats:   Loss: 0.3754 - F1-Score: 0.8706 - Accuracy-Score: 0.8384 - AUROC: 0.9118 - AP: 0.9450
[37m2024-06-24 11:09:30,793 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:30,920 [INFO] - Epoch: 12/50
[37m2024-06-24 11:09:32,675 [INFO] - Training epoch stats:     Loss: 0.2998 - F1-Score: 0.8991 - Accuracy-Score: 0.8736 - AUROC: 0.9418 - AP: 0.9589
[37m2024-06-24 11:09:33,347 [INFO] - Validation epoch stats:   Loss: 0.3779 - F1-Score: 0.8692 - Accuracy-Score: 0.8372 - AUROC: 0.9117 - AP: 0.9449
[37m2024-06-24 11:09:33,395 [INFO] - Epoch: 13/50
[37m2024-06-24 11:09:35,162 [INFO] - Training epoch stats:     Loss: 0.2950 - F1-Score: 0.9009 - Accuracy-Score: 0.8757 - AUROC: 0.9437 - AP: 0.9603
[37m2024-06-24 11:09:35,546 [INFO] - Validation epoch stats:   Loss: 0.3757 - F1-Score: 0.8703 - Accuracy-Score: 0.8381 - AUROC: 0.9119 - AP: 0.9450
[37m2024-06-24 11:09:35,547 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:35,706 [INFO] - Epoch: 14/50
[37m2024-06-24 11:09:37,266 [INFO] - Training epoch stats:     Loss: 0.2912 - F1-Score: 0.9030 - Accuracy-Score: 0.8784 - AUROC: 0.9452 - AP: 0.9614
[37m2024-06-24 11:09:37,934 [INFO] - Validation epoch stats:   Loss: 0.3787 - F1-Score: 0.8685 - Accuracy-Score: 0.8365 - AUROC: 0.9118 - AP: 0.9450
[37m2024-06-24 11:09:37,983 [INFO] - Epoch: 15/50
[37m2024-06-24 11:09:39,872 [INFO] - Training epoch stats:     Loss: 0.2871 - F1-Score: 0.9046 - Accuracy-Score: 0.8805 - AUROC: 0.9468 - AP: 0.9626
[37m2024-06-24 11:09:40,250 [INFO] - Validation epoch stats:   Loss: 0.3793 - F1-Score: 0.8685 - Accuracy-Score: 0.8365 - AUROC: 0.9118 - AP: 0.9450
[37m2024-06-24 11:09:40,295 [INFO] - Epoch: 16/50
[37m2024-06-24 11:09:41,757 [INFO] - Training epoch stats:     Loss: 0.2836 - F1-Score: 0.9059 - Accuracy-Score: 0.8821 - AUROC: 0.9482 - AP: 0.9635
[37m2024-06-24 11:09:42,195 [INFO] - Validation epoch stats:   Loss: 0.3782 - F1-Score: 0.8689 - Accuracy-Score: 0.8366 - AUROC: 0.9118 - AP: 0.9450
[37m2024-06-24 11:09:42,246 [INFO] - Epoch: 17/50
[37m2024-06-24 11:09:44,465 [INFO] - Training epoch stats:     Loss: 0.2802 - F1-Score: 0.9070 - Accuracy-Score: 0.8835 - AUROC: 0.9495 - AP: 0.9645
[37m2024-06-24 11:09:44,896 [INFO] - Validation epoch stats:   Loss: 0.3774 - F1-Score: 0.8698 - Accuracy-Score: 0.8373 - AUROC: 0.9119 - AP: 0.9451
[37m2024-06-24 11:09:44,941 [INFO] - Epoch: 18/50
[37m2024-06-24 11:09:46,373 [INFO] - Training epoch stats:     Loss: 0.2771 - F1-Score: 0.9088 - Accuracy-Score: 0.8857 - AUROC: 0.9508 - AP: 0.9654
[37m2024-06-24 11:09:46,764 [INFO] - Validation epoch stats:   Loss: 0.3803 - F1-Score: 0.8688 - Accuracy-Score: 0.8368 - AUROC: 0.9119 - AP: 0.9452
[37m2024-06-24 11:09:46,799 [INFO] - Epoch: 19/50
[37m2024-06-24 11:09:49,259 [INFO] - Training epoch stats:     Loss: 0.2742 - F1-Score: 0.9095 - Accuracy-Score: 0.8865 - AUROC: 0.9518 - AP: 0.9662
[37m2024-06-24 11:09:49,641 [INFO] - Validation epoch stats:   Loss: 0.3792 - F1-Score: 0.8694 - Accuracy-Score: 0.8371 - AUROC: 0.9120 - AP: 0.9452
[37m2024-06-24 11:09:49,641 [INFO] - New best model - save checkpoint
[37m2024-06-24 11:09:49,808 [INFO] - Epoch: 20/50
[37m2024-06-24 11:09:51,565 [INFO] - Training epoch stats:     Loss: 0.2718 - F1-Score: 0.9107 - Accuracy-Score: 0.8881 - AUROC: 0.9526 - AP: 0.9667
[37m2024-06-24 11:09:51,942 [INFO] - Validation epoch stats:   Loss: 0.3807 - F1-Score: 0.8682 - Accuracy-Score: 0.8360 - AUROC: 0.9119 - AP: 0.9452
[37m2024-06-24 11:09:51,983 [INFO] - Epoch: 21/50
[37m2024-06-24 11:09:53,773 [INFO] - Training epoch stats:     Loss: 0.2692 - F1-Score: 0.9114 - Accuracy-Score: 0.8892 - AUROC: 0.9535 - AP: 0.9673
[37m2024-06-24 11:09:54,405 [INFO] - Validation epoch stats:   Loss: 0.3795 - F1-Score: 0.8689 - Accuracy-Score: 0.8365 - AUROC: 0.9119 - AP: 0.9452
[37m2024-06-24 11:09:54,443 [INFO] - Epoch: 22/50
[37m2024-06-24 11:09:56,170 [INFO] - Training epoch stats:     Loss: 0.2671 - F1-Score: 0.9128 - Accuracy-Score: 0.8908 - AUROC: 0.9543 - AP: 0.9680
[37m2024-06-24 11:09:56,547 [INFO] - Validation epoch stats:   Loss: 0.3807 - F1-Score: 0.8686 - Accuracy-Score: 0.8363 - AUROC: 0.9118 - AP: 0.9452
[37m2024-06-24 11:09:56,584 [INFO] - Epoch: 23/50
[37m2024-06-24 11:09:58,165 [INFO] - Training epoch stats:     Loss: 0.2644 - F1-Score: 0.9131 - Accuracy-Score: 0.8911 - AUROC: 0.9553 - AP: 0.9687
[37m2024-06-24 11:09:58,590 [INFO] - Validation epoch stats:   Loss: 0.3820 - F1-Score: 0.8680 - Accuracy-Score: 0.8357 - AUROC: 0.9116 - AP: 0.9451
[37m2024-06-24 11:09:58,628 [INFO] - Epoch: 24/50
[37m2024-06-24 11:10:00,971 [INFO] - Training epoch stats:     Loss: 0.2631 - F1-Score: 0.9141 - Accuracy-Score: 0.8925 - AUROC: 0.9558 - AP: 0.9691
[37m2024-06-24 11:10:01,358 [INFO] - Validation epoch stats:   Loss: 0.3810 - F1-Score: 0.8688 - Accuracy-Score: 0.8365 - AUROC: 0.9118 - AP: 0.9453
[37m2024-06-24 11:10:01,437 [INFO] - Epoch: 25/50
[37m2024-06-24 11:10:02,871 [INFO] - Training epoch stats:     Loss: 0.2614 - F1-Score: 0.9146 - Accuracy-Score: 0.8930 - AUROC: 0.9563 - AP: 0.9696
[37m2024-06-24 11:10:03,249 [INFO] - Validation epoch stats:   Loss: 0.3820 - F1-Score: 0.8686 - Accuracy-Score: 0.8363 - AUROC: 0.9116 - AP: 0.9453
[37m2024-06-24 11:10:03,283 [INFO] - Epoch: 26/50
[37m2024-06-24 11:10:04,971 [INFO] - Training epoch stats:     Loss: 0.2598 - F1-Score: 0.9154 - Accuracy-Score: 0.8941 - AUROC: 0.9569 - AP: 0.9700
[37m2024-06-24 11:10:05,400 [INFO] - Validation epoch stats:   Loss: 0.3819 - F1-Score: 0.8685 - Accuracy-Score: 0.8360 - AUROC: 0.9117 - AP: 0.9453
[37m2024-06-24 11:10:05,438 [INFO] - Epoch: 27/50
[37m2024-06-24 11:10:06,961 [INFO] - Training epoch stats:     Loss: 0.2579 - F1-Score: 0.9156 - Accuracy-Score: 0.8943 - AUROC: 0.9576 - AP: 0.9704
[37m2024-06-24 11:10:07,352 [INFO] - Validation epoch stats:   Loss: 0.3820 - F1-Score: 0.8687 - Accuracy-Score: 0.8362 - AUROC: 0.9116 - AP: 0.9453
[37m2024-06-24 11:10:07,389 [INFO] - Epoch: 28/50
[37m2024-06-24 11:10:09,160 [INFO] - Training epoch stats:     Loss: 0.2563 - F1-Score: 0.9165 - Accuracy-Score: 0.8955 - AUROC: 0.9581 - AP: 0.9707
[37m2024-06-24 11:10:10,289 [INFO] - Validation epoch stats:   Loss: 0.3817 - F1-Score: 0.8684 - Accuracy-Score: 0.8357 - AUROC: 0.9116 - AP: 0.9453
[37m2024-06-24 11:10:10,324 [INFO] - Epoch: 29/50
[37m2024-06-24 11:10:14,075 [INFO] - Training epoch stats:     Loss: 0.2554 - F1-Score: 0.9170 - Accuracy-Score: 0.8961 - AUROC: 0.9584 - AP: 0.9711
[37m2024-06-24 11:10:14,661 [INFO] - Validation epoch stats:   Loss: 0.3833 - F1-Score: 0.8682 - Accuracy-Score: 0.8358 - AUROC: 0.9115 - AP: 0.9453
[37m2024-06-24 11:10:14,661 [INFO] - Performing early stopping!
[37m2024-06-24 11:10:14,669 [INFO] - Finished run qog7bz6o
