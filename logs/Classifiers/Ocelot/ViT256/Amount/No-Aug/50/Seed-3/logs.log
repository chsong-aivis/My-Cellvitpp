[37m2024-06-24 15:28:51,081 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-24 15:28:51,082 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/ocelot/ViT256/Amount/No-Aug/50/2024-06-24T152843_CellViT-256-50Percent
[37m2024-06-24 15:28:51,146 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7ff54e560430>]
[37m2024-06-24 15:28:51,146 [INFO] - Using GPU: cuda:0
[37m2024-06-24 15:28:51,151 [INFO] - Using device: cuda:0
[37m2024-06-24 15:28:51,155 [INFO] - Loss function:
[37m2024-06-24 15:28:51,159 [INFO] - CrossEntropyLoss()
[37m2024-06-24 15:28:53,976 [INFO] - <All keys matched successfully>
[37m2024-06-24 15:28:54,379 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 256]                  98,560
â”œâ”€ReLU: 1-2                              [1, 256]                  --
â”œâ”€Dropout: 1-3                           [1, 256]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    514
==========================================================================================
Total params: 99,074
Trainable params: 99,074
Non-trainable params: 0
Total mult-adds (M): 0.10
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.40
Estimated Total Size (MB): 0.40
==========================================================================================
[37m2024-06-24 15:28:54,380 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-24 15:28:54,384 [INFO] - {'betas': [0.85, 0.9], 'lr': 4.4403255414468894e-05, 'weight_decay': 8.22969479387945e-05}
[37m2024-06-24 15:28:54,389 [INFO] - Using early stopping with a range of 10 and maximize strategy
[37m2024-06-24 15:28:54,403 [INFO] - Caching datasets
[37m2024-06-24 15:28:57,773 [INFO] - Instantiate Trainer
[37m2024-06-24 15:28:57,779 [INFO] - Calling Trainer Fit
[37m2024-06-24 15:28:57,780 [INFO] - Dataset is cached after first epoch
[37m2024-06-24 15:28:57,784 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-24 15:28:57,788 [INFO] - Epoch: 1/50
[37m2024-06-24 15:29:00,440 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/75c91867b234af50d8708918bc6d8f413523c708a36318b7df3fa58b521876cc.h5
[37m2024-06-24 15:29:02,058 [INFO] - Training epoch stats:     Loss: 0.6168 - F1-Score: 0.7975 - Accuracy-Score: 0.6822 - AUROC: 0.7574 - AP: 0.8539
[37m2024-06-24 15:29:03,620 [INFO] - Loaded dataset from cache: /OCELOT-Orig/cache/84a96648cf0731d52e69bfe32a74428f944857015825e7a06ae5f471f93f4855.h5
[37m2024-06-24 15:29:04,163 [INFO] - Validation epoch stats:   Loss: 0.5655 - F1-Score: 0.8230 - Accuracy-Score: 0.7282 - AUROC: 0.8841 - AP: 0.9283
[37m2024-06-24 15:29:04,164 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:29:04,329 [INFO] - Epoch: 2/50
[37m2024-06-24 15:29:05,568 [INFO] - Training epoch stats:     Loss: 0.4967 - F1-Score: 0.8544 - Accuracy-Score: 0.7844 - AUROC: 0.8915 - AP: 0.9315
[37m2024-06-24 15:29:06,557 [INFO] - Validation epoch stats:   Loss: 0.4691 - F1-Score: 0.8553 - Accuracy-Score: 0.8006 - AUROC: 0.8951 - AP: 0.9379
[37m2024-06-24 15:29:06,561 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:29:06,755 [INFO] - Epoch: 3/50
[37m2024-06-24 15:29:08,369 [INFO] - Training epoch stats:     Loss: 0.4137 - F1-Score: 0.8787 - Accuracy-Score: 0.8318 - AUROC: 0.9048 - AP: 0.9414
[37m2024-06-24 15:29:09,061 [INFO] - Validation epoch stats:   Loss: 0.4123 - F1-Score: 0.8654 - Accuracy-Score: 0.8232 - AUROC: 0.9007 - AP: 0.9420
[37m2024-06-24 15:29:09,063 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:29:09,239 [INFO] - Epoch: 4/50
[37m2024-06-24 15:29:10,889 [INFO] - Training epoch stats:     Loss: 0.3708 - F1-Score: 0.8860 - Accuracy-Score: 0.8458 - AUROC: 0.9124 - AP: 0.9454
[37m2024-06-24 15:29:11,660 [INFO] - Validation epoch stats:   Loss: 0.3894 - F1-Score: 0.8687 - Accuracy-Score: 0.8309 - AUROC: 0.9045 - AP: 0.9444
[37m2024-06-24 15:29:11,662 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:29:11,849 [INFO] - Epoch: 5/50
[37m2024-06-24 15:29:14,871 [INFO] - Training epoch stats:     Loss: 0.3483 - F1-Score: 0.8914 - Accuracy-Score: 0.8546 - AUROC: 0.9190 - AP: 0.9496
[37m2024-06-24 15:29:15,804 [INFO] - Validation epoch stats:   Loss: 0.3786 - F1-Score: 0.8696 - Accuracy-Score: 0.8326 - AUROC: 0.9065 - AP: 0.9456
[37m2024-06-24 15:29:15,806 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:29:15,937 [INFO] - Epoch: 6/50
[37m2024-06-24 15:29:17,037 [INFO] - Training epoch stats:     Loss: 0.3345 - F1-Score: 0.8957 - Accuracy-Score: 0.8609 - AUROC: 0.9236 - AP: 0.9522
[37m2024-06-24 15:29:17,434 [INFO] - Validation epoch stats:   Loss: 0.3736 - F1-Score: 0.8706 - Accuracy-Score: 0.8345 - AUROC: 0.9078 - AP: 0.9463
[37m2024-06-24 15:29:17,436 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:29:17,587 [INFO] - Epoch: 7/50
[37m2024-06-24 15:29:18,624 [INFO] - Training epoch stats:     Loss: 0.3249 - F1-Score: 0.8979 - Accuracy-Score: 0.8639 - AUROC: 0.9275 - AP: 0.9551
[37m2024-06-24 15:29:19,021 [INFO] - Validation epoch stats:   Loss: 0.3731 - F1-Score: 0.8708 - Accuracy-Score: 0.8358 - AUROC: 0.9083 - AP: 0.9465
[37m2024-06-24 15:29:19,023 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:29:19,173 [INFO] - Epoch: 8/50
[37m2024-06-24 15:29:20,316 [INFO] - Training epoch stats:     Loss: 0.3173 - F1-Score: 0.8998 - Accuracy-Score: 0.8669 - AUROC: 0.9307 - AP: 0.9574
[37m2024-06-24 15:29:20,723 [INFO] - Validation epoch stats:   Loss: 0.3720 - F1-Score: 0.8711 - Accuracy-Score: 0.8362 - AUROC: 0.9083 - AP: 0.9464
[37m2024-06-24 15:29:20,724 [INFO] - New best model - save checkpoint
[37m2024-06-24 15:29:20,899 [INFO] - Epoch: 9/50
[37m2024-06-24 15:29:21,896 [INFO] - Training epoch stats:     Loss: 0.3111 - F1-Score: 0.9022 - Accuracy-Score: 0.8701 - AUROC: 0.9334 - AP: 0.9593
[37m2024-06-24 15:29:22,295 [INFO] - Validation epoch stats:   Loss: 0.3716 - F1-Score: 0.8703 - Accuracy-Score: 0.8353 - AUROC: 0.9083 - AP: 0.9463
[37m2024-06-24 15:29:22,354 [INFO] - Epoch: 10/50
[37m2024-06-24 15:29:23,398 [INFO] - Training epoch stats:     Loss: 0.3059 - F1-Score: 0.9033 - Accuracy-Score: 0.8714 - AUROC: 0.9356 - AP: 0.9609
[37m2024-06-24 15:29:23,815 [INFO] - Validation epoch stats:   Loss: 0.3735 - F1-Score: 0.8694 - Accuracy-Score: 0.8348 - AUROC: 0.9080 - AP: 0.9461
[37m2024-06-24 15:29:23,873 [INFO] - Epoch: 11/50
[37m2024-06-24 15:29:24,880 [INFO] - Training epoch stats:     Loss: 0.3007 - F1-Score: 0.9043 - Accuracy-Score: 0.8728 - AUROC: 0.9379 - AP: 0.9624
[37m2024-06-24 15:29:25,259 [INFO] - Validation epoch stats:   Loss: 0.3739 - F1-Score: 0.8689 - Accuracy-Score: 0.8344 - AUROC: 0.9080 - AP: 0.9460
[37m2024-06-24 15:29:25,293 [INFO] - Epoch: 12/50
[37m2024-06-24 15:29:26,248 [INFO] - Training epoch stats:     Loss: 0.2966 - F1-Score: 0.9055 - Accuracy-Score: 0.8746 - AUROC: 0.9396 - AP: 0.9635
[37m2024-06-24 15:29:26,643 [INFO] - Validation epoch stats:   Loss: 0.3745 - F1-Score: 0.8686 - Accuracy-Score: 0.8340 - AUROC: 0.9077 - AP: 0.9458
[37m2024-06-24 15:29:26,692 [INFO] - Epoch: 13/50
[37m2024-06-24 15:29:27,654 [INFO] - Training epoch stats:     Loss: 0.2930 - F1-Score: 0.9069 - Accuracy-Score: 0.8764 - AUROC: 0.9411 - AP: 0.9643
[37m2024-06-24 15:29:28,037 [INFO] - Validation epoch stats:   Loss: 0.3739 - F1-Score: 0.8689 - Accuracy-Score: 0.8340 - AUROC: 0.9078 - AP: 0.9458
[37m2024-06-24 15:29:28,087 [INFO] - Epoch: 14/50
[37m2024-06-24 15:29:29,075 [INFO] - Training epoch stats:     Loss: 0.2898 - F1-Score: 0.9078 - Accuracy-Score: 0.8777 - AUROC: 0.9424 - AP: 0.9652
[37m2024-06-24 15:29:29,448 [INFO] - Validation epoch stats:   Loss: 0.3736 - F1-Score: 0.8691 - Accuracy-Score: 0.8340 - AUROC: 0.9077 - AP: 0.9457
[37m2024-06-24 15:29:29,506 [INFO] - Epoch: 15/50
[37m2024-06-24 15:29:30,398 [INFO] - Training epoch stats:     Loss: 0.2861 - F1-Score: 0.9085 - Accuracy-Score: 0.8785 - AUROC: 0.9440 - AP: 0.9663
[37m2024-06-24 15:29:30,801 [INFO] - Validation epoch stats:   Loss: 0.3760 - F1-Score: 0.8686 - Accuracy-Score: 0.8337 - AUROC: 0.9071 - AP: 0.9454
[37m2024-06-24 15:29:30,845 [INFO] - Epoch: 16/50
[37m2024-06-24 15:29:31,889 [INFO] - Training epoch stats:     Loss: 0.2838 - F1-Score: 0.9095 - Accuracy-Score: 0.8800 - AUROC: 0.9449 - AP: 0.9668
[37m2024-06-24 15:29:32,276 [INFO] - Validation epoch stats:   Loss: 0.3782 - F1-Score: 0.8674 - Accuracy-Score: 0.8325 - AUROC: 0.9067 - AP: 0.9452
[37m2024-06-24 15:29:32,310 [INFO] - Epoch: 17/50
[37m2024-06-24 15:29:33,276 [INFO] - Training epoch stats:     Loss: 0.2803 - F1-Score: 0.9104 - Accuracy-Score: 0.8811 - AUROC: 0.9463 - AP: 0.9676
[37m2024-06-24 15:29:33,685 [INFO] - Validation epoch stats:   Loss: 0.3769 - F1-Score: 0.8682 - Accuracy-Score: 0.8330 - AUROC: 0.9070 - AP: 0.9452
[37m2024-06-24 15:29:33,719 [INFO] - Epoch: 18/50
[37m2024-06-24 15:29:34,666 [INFO] - Training epoch stats:     Loss: 0.2778 - F1-Score: 0.9119 - Accuracy-Score: 0.8832 - AUROC: 0.9473 - AP: 0.9684
[37m2024-06-24 15:29:35,053 [INFO] - Validation epoch stats:   Loss: 0.3784 - F1-Score: 0.8678 - Accuracy-Score: 0.8326 - AUROC: 0.9067 - AP: 0.9451
[37m2024-06-24 15:29:35,053 [INFO] - Performing early stopping!
[37m2024-06-24 15:29:35,060 [INFO] - Finished run kwt14m1x
