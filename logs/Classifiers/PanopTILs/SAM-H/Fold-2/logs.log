[37m2024-08-01 13:51:17,395 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-01 13:51:17,396 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/PanopTILs/SAM-H/2024-08-01T135109_CellViT-SAM-H
[37m2024-08-01 13:51:17,457 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fbd4b169660>]
[37m2024-08-01 13:51:17,458 [INFO] - Using GPU: cuda:0
[37m2024-08-01 13:51:17,462 [INFO] - Using device: cuda:0
[37m2024-08-01 13:51:17,485 [INFO] - Loss function:
[37m2024-08-01 13:51:17,485 [INFO] - CrossEntropyLoss()
[37m2024-08-01 13:51:35,661 [INFO] - <All keys matched successfully>
[37m2024-08-01 13:51:36,791 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 512]                  655,872
â”œâ”€ReLU: 1-2                              [1, 512]                  --
â”œâ”€Dropout: 1-3                           [1, 512]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    2,052
==========================================================================================
Total params: 657,924
Trainable params: 657,924
Non-trainable params: 0
Total mult-adds (M): 0.66
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 2.63
Estimated Total Size (MB): 2.64
==========================================================================================
[37m2024-08-01 13:51:36,793 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-01 13:51:36,797 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0001781801646893006, 'weight_decay': 0.0008455096188385833}
[37m2024-08-01 13:51:36,802 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-01 13:51:36,880 [INFO] - Caching datasets
[37m2024-08-01 13:51:36,881 [INFO] - Instantiate Trainer
[37m2024-08-01 13:51:36,889 [INFO] - Calling Trainer Fit
[37m2024-08-01 13:51:36,889 [INFO] - Dataset is cached after first epoch
[37m2024-08-01 13:51:36,893 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-01 13:51:36,898 [INFO] - Epoch: 1/50
[37m2024-08-01 13:51:36,903 [INFO] - Extracting training cells
[37m2024-08-01 14:05:00,911 [INFO] - Extraction detection metrics - F1: 0.759, Precision: 0.750, Recall: 0.796, Detected-Cells: 506137
[37m2024-08-01 14:05:00,915 [INFO] - Caching dataset 98f6630d45a4b5717e37807bcfdedd19e47f179ea6b0ca0dfccab12e27f2b723 to disk...
[37m2024-08-01 14:11:53,761 [INFO] - Training epoch stats:     Loss: 0.5050 - F1-Score: 0.8092 - Accuracy-Score: 0.8092 - AUROC: 0.9535 - AP: 0.8602
[37m2024-08-01 14:11:53,769 [INFO] - Extracting validation cells
[37m2024-08-01 14:16:25,073 [INFO] - Extraction detection metrics - F1: 0.721, Precision: 0.723, Recall: 0.756, Detected-Cells: 157791
[37m2024-08-01 14:16:25,077 [INFO] - Caching dataset 43d8760bbb33d5d0189dfcf01ef70878ab6135d2463b296505e4705f7dcd6101 to disk...
[37m2024-08-01 14:18:28,980 [INFO] - Validation epoch stats:   Loss: 0.5333 - F1-Score: 0.8249 - Accuracy-Score: 0.8249 - AUROC: 0.9498 - AP: 0.8425
[37m2024-08-01 14:18:28,983 [INFO] - New best model - save checkpoint
[37m2024-08-01 14:18:29,385 [INFO] - Epoch: 2/50
[37m2024-08-01 14:18:51,067 [INFO] - Training epoch stats:     Loss: 0.4090 - F1-Score: 0.8398 - Accuracy-Score: 0.8398 - AUROC: 0.9675 - AP: 0.8995
[37m2024-08-01 14:18:55,002 [INFO] - Validation epoch stats:   Loss: 0.5580 - F1-Score: 0.8156 - Accuracy-Score: 0.8156 - AUROC: 0.9474 - AP: 0.8343
[37m2024-08-01 14:18:55,218 [INFO] - Epoch: 3/50
[37m2024-08-01 14:19:17,132 [INFO] - Training epoch stats:     Loss: 0.3613 - F1-Score: 0.8539 - Accuracy-Score: 0.8539 - AUROC: 0.9732 - AP: 0.9177
[37m2024-08-01 14:19:20,596 [INFO] - Validation epoch stats:   Loss: 0.5774 - F1-Score: 0.8166 - Accuracy-Score: 0.8166 - AUROC: 0.9458 - AP: 0.8290
[37m2024-08-01 14:19:20,731 [INFO] - Epoch: 4/50
[37m2024-08-01 14:19:41,055 [INFO] - Training epoch stats:     Loss: 0.3248 - F1-Score: 0.8658 - Accuracy-Score: 0.8658 - AUROC: 0.9771 - AP: 0.9310
[37m2024-08-01 14:19:44,956 [INFO] - Validation epoch stats:   Loss: 0.6276 - F1-Score: 0.8247 - Accuracy-Score: 0.8247 - AUROC: 0.9441 - AP: 0.8287
[37m2024-08-01 14:19:45,099 [INFO] - Epoch: 5/50
[37m2024-08-01 14:20:05,597 [INFO] - Training epoch stats:     Loss: 0.2955 - F1-Score: 0.8754 - Accuracy-Score: 0.8754 - AUROC: 0.9800 - AP: 0.9411
[37m2024-08-01 14:20:09,158 [INFO] - Validation epoch stats:   Loss: 0.6754 - F1-Score: 0.8242 - Accuracy-Score: 0.8242 - AUROC: 0.9433 - AP: 0.8204
[37m2024-08-01 14:20:09,283 [INFO] - Epoch: 6/50
[37m2024-08-01 14:20:29,792 [INFO] - Training epoch stats:     Loss: 0.2691 - F1-Score: 0.8843 - Accuracy-Score: 0.8843 - AUROC: 0.9826 - AP: 0.9500
[37m2024-08-01 14:20:34,284 [INFO] - Validation epoch stats:   Loss: 0.6955 - F1-Score: 0.8194 - Accuracy-Score: 0.8194 - AUROC: 0.9424 - AP: 0.8214
[37m2024-08-01 14:20:34,415 [INFO] - Epoch: 7/50
[37m2024-08-01 14:20:56,017 [INFO] - Training epoch stats:     Loss: 0.2489 - F1-Score: 0.8918 - Accuracy-Score: 0.8918 - AUROC: 0.9844 - AP: 0.9564
[37m2024-08-01 14:20:59,892 [INFO] - Validation epoch stats:   Loss: 0.7370 - F1-Score: 0.8234 - Accuracy-Score: 0.8234 - AUROC: 0.9424 - AP: 0.8210
[37m2024-08-01 14:21:00,029 [INFO] - Epoch: 8/50
[37m2024-08-01 14:21:19,440 [INFO] - Training epoch stats:     Loss: 0.2310 - F1-Score: 0.8986 - Accuracy-Score: 0.8986 - AUROC: 0.9861 - AP: 0.9619
[37m2024-08-01 14:21:23,402 [INFO] - Validation epoch stats:   Loss: 0.7967 - F1-Score: 0.8192 - Accuracy-Score: 0.8192 - AUROC: 0.9400 - AP: 0.8151
[37m2024-08-01 14:21:23,580 [INFO] - Epoch: 9/50
[37m2024-08-01 14:21:44,410 [INFO] - Training epoch stats:     Loss: 0.2144 - F1-Score: 0.9056 - Accuracy-Score: 0.9056 - AUROC: 0.9876 - AP: 0.9668
[37m2024-08-01 14:21:48,581 [INFO] - Validation epoch stats:   Loss: 0.8422 - F1-Score: 0.8199 - Accuracy-Score: 0.8199 - AUROC: 0.9397 - AP: 0.8102
[37m2024-08-01 14:21:48,744 [INFO] - Epoch: 10/50
[37m2024-08-01 14:22:13,025 [INFO] - Training epoch stats:     Loss: 0.2012 - F1-Score: 0.9109 - Accuracy-Score: 0.9109 - AUROC: 0.9888 - AP: 0.9705
[37m2024-08-01 14:22:16,893 [INFO] - Validation epoch stats:   Loss: 0.9155 - F1-Score: 0.8177 - Accuracy-Score: 0.8177 - AUROC: 0.9374 - AP: 0.8128
[37m2024-08-01 14:22:17,052 [INFO] - Epoch: 11/50
[37m2024-08-01 14:22:40,307 [INFO] - Training epoch stats:     Loss: 0.1897 - F1-Score: 0.9164 - Accuracy-Score: 0.9164 - AUROC: 0.9900 - AP: 0.9736
[37m2024-08-01 14:22:44,483 [INFO] - Validation epoch stats:   Loss: 0.9772 - F1-Score: 0.8131 - Accuracy-Score: 0.8131 - AUROC: 0.9355 - AP: 0.8050
[37m2024-08-01 14:22:44,628 [INFO] - Epoch: 12/50
[37m2024-08-01 14:23:07,110 [INFO] - Training epoch stats:     Loss: 0.1783 - F1-Score: 0.9206 - Accuracy-Score: 0.9206 - AUROC: 0.9910 - AP: 0.9763
[37m2024-08-01 14:23:11,301 [INFO] - Validation epoch stats:   Loss: 0.9460 - F1-Score: 0.8142 - Accuracy-Score: 0.8142 - AUROC: 0.9365 - AP: 0.8055
[37m2024-08-01 14:23:11,506 [INFO] - Epoch: 13/50
[37m2024-08-01 14:23:35,267 [INFO] - Training epoch stats:     Loss: 0.1681 - F1-Score: 0.9253 - Accuracy-Score: 0.9253 - AUROC: 0.9919 - AP: 0.9790
[37m2024-08-01 14:23:39,573 [INFO] - Validation epoch stats:   Loss: 1.0107 - F1-Score: 0.8119 - Accuracy-Score: 0.8119 - AUROC: 0.9344 - AP: 0.7993
[37m2024-08-01 14:23:39,721 [INFO] - Epoch: 14/50
[37m2024-08-01 14:24:03,262 [INFO] - Training epoch stats:     Loss: 0.1593 - F1-Score: 0.9296 - Accuracy-Score: 0.9296 - AUROC: 0.9927 - AP: 0.9810
[37m2024-08-01 14:24:08,981 [INFO] - Validation epoch stats:   Loss: 1.1107 - F1-Score: 0.8142 - Accuracy-Score: 0.8142 - AUROC: 0.9348 - AP: 0.8037
[37m2024-08-01 14:24:09,107 [INFO] - Epoch: 15/50
[37m2024-08-01 14:24:32,210 [INFO] - Training epoch stats:     Loss: 0.1511 - F1-Score: 0.9332 - Accuracy-Score: 0.9332 - AUROC: 0.9934 - AP: 0.9828
[37m2024-08-01 14:24:36,302 [INFO] - Validation epoch stats:   Loss: 1.1669 - F1-Score: 0.8144 - Accuracy-Score: 0.8144 - AUROC: 0.9323 - AP: 0.7981
[37m2024-08-01 14:24:36,491 [INFO] - Epoch: 16/50
[37m2024-08-01 14:25:02,758 [INFO] - Training epoch stats:     Loss: 0.1443 - F1-Score: 0.9369 - Accuracy-Score: 0.9369 - AUROC: 0.9940 - AP: 0.9842
[37m2024-08-01 14:25:10,782 [INFO] - Validation epoch stats:   Loss: 1.1823 - F1-Score: 0.8098 - Accuracy-Score: 0.8098 - AUROC: 0.9318 - AP: 0.7933
[37m2024-08-01 14:25:10,908 [INFO] - Epoch: 17/50
[37m2024-08-01 14:25:38,858 [INFO] - Training epoch stats:     Loss: 0.1374 - F1-Score: 0.9397 - Accuracy-Score: 0.9397 - AUROC: 0.9945 - AP: 0.9857
[37m2024-08-01 14:25:45,473 [INFO] - Validation epoch stats:   Loss: 1.2173 - F1-Score: 0.8068 - Accuracy-Score: 0.8068 - AUROC: 0.9303 - AP: 0.7909
[37m2024-08-01 14:25:45,601 [INFO] - Epoch: 18/50
[37m2024-08-01 14:26:10,212 [INFO] - Training epoch stats:     Loss: 0.1300 - F1-Score: 0.9432 - Accuracy-Score: 0.9432 - AUROC: 0.9950 - AP: 0.9870
[37m2024-08-01 14:26:14,486 [INFO] - Validation epoch stats:   Loss: 1.3614 - F1-Score: 0.8149 - Accuracy-Score: 0.8149 - AUROC: 0.9311 - AP: 0.7900
[37m2024-08-01 14:26:14,665 [INFO] - Epoch: 19/50
[37m2024-08-01 14:26:38,105 [INFO] - Training epoch stats:     Loss: 0.1255 - F1-Score: 0.9453 - Accuracy-Score: 0.9453 - AUROC: 0.9954 - AP: 0.9879
[37m2024-08-01 14:26:43,081 [INFO] - Validation epoch stats:   Loss: 1.3727 - F1-Score: 0.8087 - Accuracy-Score: 0.8087 - AUROC: 0.9288 - AP: 0.7908
[37m2024-08-01 14:26:43,292 [INFO] - Epoch: 20/50
[37m2024-08-01 14:27:04,498 [INFO] - Training epoch stats:     Loss: 0.1197 - F1-Score: 0.9484 - Accuracy-Score: 0.9484 - AUROC: 0.9959 - AP: 0.9890
[37m2024-08-01 14:27:09,074 [INFO] - Validation epoch stats:   Loss: 1.4389 - F1-Score: 0.8094 - Accuracy-Score: 0.8094 - AUROC: 0.9290 - AP: 0.7892
[37m2024-08-01 14:27:09,201 [INFO] - Epoch: 21/50
[37m2024-08-01 14:27:32,402 [INFO] - Training epoch stats:     Loss: 0.1156 - F1-Score: 0.9502 - Accuracy-Score: 0.9502 - AUROC: 0.9962 - AP: 0.9896
[37m2024-08-01 14:27:36,800 [INFO] - Validation epoch stats:   Loss: 1.4656 - F1-Score: 0.8136 - Accuracy-Score: 0.8136 - AUROC: 0.9307 - AP: 0.7922
[37m2024-08-01 14:27:36,802 [INFO] - Performing early stopping!
[37m2024-08-01 14:27:36,903 [INFO] - Finished run f3c2kxak
