[37m2024-05-16 06:11:50,328 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-05-16 06:11:50,330 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/UNI/Setting-1-Aug/2024-05-16T061139_Fold-1
[37m2024-05-16 06:11:50,406 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f5599712710>]
[37m2024-05-16 06:11:50,416 [INFO] - Using GPU: cuda:0
[37m2024-05-16 06:11:50,426 [INFO] - Using device: cuda:0
[37m2024-05-16 06:11:50,435 [INFO] - Loss function:
[37m2024-05-16 06:11:50,444 [INFO] - CrossEntropyLoss()
[37m2024-05-16 06:11:57,049 [INFO] - <All keys matched successfully>
[37m2024-05-16 06:11:57,643 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 512]                  524,800
â”œâ”€ReLU: 1-2                              [1, 512]                  --
â”œâ”€Dropout: 1-3                           [1, 512]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    2,052
==========================================================================================
Total params: 526,852
Trainable params: 526,852
Non-trainable params: 0
Total mult-adds (M): 0.53
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 2.11
Estimated Total Size (MB): 2.12
==========================================================================================
[37m2024-05-16 06:11:57,644 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-05-16 06:11:57,654 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.001, 'weight_decay': 0.00035}
[37m2024-05-16 06:11:57,664 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-05-16 06:11:57,684 [INFO] - Caching datasets
[37m2024-05-16 06:11:58,591 [INFO] - Instantiate Trainer
[37m2024-05-16 06:11:58,595 [INFO] - Calling Trainer Fit
[37m2024-05-16 06:11:58,604 [INFO] - Starting training, total number of epochs: 50
[37m2024-05-16 06:11:58,613 [INFO] - Epoch: 1/50
[37m2024-05-16 06:11:58,621 [INFO] - Extracting training cells
[37m2024-05-16 06:12:18,734 [INFO] - Extraction detection metrics - F1: 0.722, Precision: 0.802, Recall: 0.688, Detected-Cells: 8232
[37m2024-05-16 06:12:19,072 [INFO] - Training epoch stats:     Loss: 0.4383 - F1-Score: 0.8226 - Accuracy-Score: 0.8226 - AUROC: 0.9460 - AP: 0.8137
[37m2024-05-16 06:12:19,282 [INFO] - Loaded dataset from cache: /Consep/cache/bb7c5cdfbd8677ecf696f2b62b6faec66719759a39e59ad3768317f9a1958050.h5
[37m2024-05-16 06:12:19,316 [INFO] - Validation epoch stats:   Loss: 0.4966 - F1-Score: 0.8005 - Accuracy-Score: 0.8005 - AUROC: 0.9489 - AP: 0.7154
[37m2024-05-16 06:12:19,317 [INFO] - New best model - save checkpoint
[37m2024-05-16 06:12:19,607 [INFO] - Epoch: 2/50
[37m2024-05-16 06:12:19,608 [INFO] - Extracting training cells
[37m2024-05-16 06:12:33,913 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.791, Recall: 0.670, Detected-Cells: 9114
[37m2024-05-16 06:12:34,253 [INFO] - Training epoch stats:     Loss: 0.2865 - F1-Score: 0.8755 - Accuracy-Score: 0.8755 - AUROC: 0.9770 - AP: 0.9295
[37m2024-05-16 06:12:34,320 [INFO] - Validation epoch stats:   Loss: 0.3401 - F1-Score: 0.8660 - Accuracy-Score: 0.8660 - AUROC: 0.9645 - AP: 0.7602
[37m2024-05-16 06:12:34,321 [INFO] - New best model - save checkpoint
[37m2024-05-16 06:12:34,616 [INFO] - Epoch: 3/50
[37m2024-05-16 06:12:34,616 [INFO] - Extracting training cells
[37m2024-05-16 06:12:47,896 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.793, Recall: 0.704, Detected-Cells: 9011
[37m2024-05-16 06:12:48,237 [INFO] - Training epoch stats:     Loss: 0.3117 - F1-Score: 0.8772 - Accuracy-Score: 0.8772 - AUROC: 0.9728 - AP: 0.9060
[37m2024-05-16 06:12:48,315 [INFO] - Validation epoch stats:   Loss: 0.3827 - F1-Score: 0.8605 - Accuracy-Score: 0.8605 - AUROC: 0.9612 - AP: 0.7306
[37m2024-05-16 06:12:48,418 [INFO] - Epoch: 4/50
[37m2024-05-16 06:12:48,418 [INFO] - Extracting training cells
[37m2024-05-16 06:13:01,724 [INFO] - Extraction detection metrics - F1: 0.732, Precision: 0.809, Recall: 0.701, Detected-Cells: 8972
[37m2024-05-16 06:13:02,052 [INFO] - Training epoch stats:     Loss: 0.2530 - F1-Score: 0.9015 - Accuracy-Score: 0.9015 - AUROC: 0.9812 - AP: 0.9354
[37m2024-05-16 06:13:02,123 [INFO] - Validation epoch stats:   Loss: 0.3348 - F1-Score: 0.8640 - Accuracy-Score: 0.8640 - AUROC: 0.9684 - AP: 0.7654
[37m2024-05-16 06:13:02,123 [INFO] - New best model - save checkpoint
[37m2024-05-16 06:13:02,383 [INFO] - Epoch: 5/50
[37m2024-05-16 06:13:02,384 [INFO] - Extracting training cells
[37m2024-05-16 06:13:16,171 [INFO] - Extraction detection metrics - F1: 0.679, Precision: 0.770, Recall: 0.641, Detected-Cells: 7898
[37m2024-05-16 06:13:16,445 [INFO] - Training epoch stats:     Loss: 0.3170 - F1-Score: 0.8793 - Accuracy-Score: 0.8793 - AUROC: 0.9716 - AP: 0.9117
[37m2024-05-16 06:13:16,518 [INFO] - Validation epoch stats:   Loss: 0.4498 - F1-Score: 0.8095 - Accuracy-Score: 0.8095 - AUROC: 0.9576 - AP: 0.7414
[37m2024-05-16 06:13:16,611 [INFO] - Epoch: 6/50
[37m2024-05-16 06:13:16,612 [INFO] - Extracting training cells
[37m2024-05-16 06:13:30,072 [INFO] - Extraction detection metrics - F1: 0.708, Precision: 0.779, Recall: 0.686, Detected-Cells: 7664
[37m2024-05-16 06:13:30,329 [INFO] - Training epoch stats:     Loss: 0.3118 - F1-Score: 0.8781 - Accuracy-Score: 0.8781 - AUROC: 0.9741 - AP: 0.8446
[37m2024-05-16 06:13:30,402 [INFO] - Validation epoch stats:   Loss: 0.3609 - F1-Score: 0.8605 - Accuracy-Score: 0.8605 - AUROC: 0.9617 - AP: 0.7422
[37m2024-05-16 06:13:30,486 [INFO] - Epoch: 7/50
[37m2024-05-16 06:13:30,487 [INFO] - Extracting training cells
[37m2024-05-16 06:13:44,556 [INFO] - Extraction detection metrics - F1: 0.724, Precision: 0.782, Recall: 0.701, Detected-Cells: 8809
[37m2024-05-16 06:13:44,890 [INFO] - Training epoch stats:     Loss: 0.3290 - F1-Score: 0.8639 - Accuracy-Score: 0.8639 - AUROC: 0.9729 - AP: 0.9288
[37m2024-05-16 06:13:44,963 [INFO] - Validation epoch stats:   Loss: 0.3608 - F1-Score: 0.8625 - Accuracy-Score: 0.8625 - AUROC: 0.9604 - AP: 0.7432
[37m2024-05-16 06:13:45,060 [INFO] - Epoch: 8/50
[37m2024-05-16 06:13:45,061 [INFO] - Extracting training cells
[37m2024-05-16 06:13:58,002 [INFO] - Extraction detection metrics - F1: 0.717, Precision: 0.802, Recall: 0.684, Detected-Cells: 8812
[37m2024-05-16 06:13:58,338 [INFO] - Training epoch stats:     Loss: 0.3018 - F1-Score: 0.8895 - Accuracy-Score: 0.8895 - AUROC: 0.9772 - AP: 0.9383
[37m2024-05-16 06:13:58,411 [INFO] - Validation epoch stats:   Loss: 0.3725 - F1-Score: 0.8525 - Accuracy-Score: 0.8525 - AUROC: 0.9620 - AP: 0.7536
[37m2024-05-16 06:13:58,520 [INFO] - Epoch: 9/50
[37m2024-05-16 06:13:58,521 [INFO] - Extracting training cells
[37m2024-05-16 06:14:12,411 [INFO] - Extraction detection metrics - F1: 0.722, Precision: 0.811, Recall: 0.676, Detected-Cells: 9121
[37m2024-05-16 06:14:12,729 [INFO] - Training epoch stats:     Loss: 0.2511 - F1-Score: 0.8933 - Accuracy-Score: 0.8933 - AUROC: 0.9830 - AP: 0.9527
[37m2024-05-16 06:14:12,807 [INFO] - Validation epoch stats:   Loss: 0.3418 - F1-Score: 0.8650 - Accuracy-Score: 0.8650 - AUROC: 0.9681 - AP: 0.7710
[37m2024-05-16 06:14:12,921 [INFO] - Epoch: 10/50
[37m2024-05-16 06:14:12,922 [INFO] - Extracting training cells
[37m2024-05-16 06:14:27,242 [INFO] - Extraction detection metrics - F1: 0.727, Precision: 0.798, Recall: 0.696, Detected-Cells: 9387
[37m2024-05-16 06:14:27,562 [INFO] - Training epoch stats:     Loss: 0.2114 - F1-Score: 0.9151 - Accuracy-Score: 0.9151 - AUROC: 0.9873 - AP: 0.9597
[37m2024-05-16 06:14:27,633 [INFO] - Validation epoch stats:   Loss: 0.3810 - F1-Score: 0.8405 - Accuracy-Score: 0.8405 - AUROC: 0.9643 - AP: 0.7537
[37m2024-05-16 06:14:27,738 [INFO] - Epoch: 11/50
[37m2024-05-16 06:14:27,738 [INFO] - Extracting training cells
[37m2024-05-16 06:14:41,914 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.788, Recall: 0.695, Detected-Cells: 8685
[37m2024-05-16 06:14:42,171 [INFO] - Training epoch stats:     Loss: 0.2334 - F1-Score: 0.9009 - Accuracy-Score: 0.9009 - AUROC: 0.9852 - AP: 0.9553
[37m2024-05-16 06:14:42,232 [INFO] - Validation epoch stats:   Loss: 0.3766 - F1-Score: 0.8565 - Accuracy-Score: 0.8565 - AUROC: 0.9600 - AP: 0.7488
[37m2024-05-16 06:14:42,333 [INFO] - Epoch: 12/50
[37m2024-05-16 06:14:42,334 [INFO] - Extracting training cells
[37m2024-05-16 06:14:55,700 [INFO] - Extraction detection metrics - F1: 0.730, Precision: 0.804, Recall: 0.695, Detected-Cells: 9548
[37m2024-05-16 06:14:55,992 [INFO] - Training epoch stats:     Loss: 0.2184 - F1-Score: 0.9145 - Accuracy-Score: 0.9145 - AUROC: 0.9877 - AP: 0.9641
[37m2024-05-16 06:14:56,058 [INFO] - Validation epoch stats:   Loss: 0.3780 - F1-Score: 0.8555 - Accuracy-Score: 0.8555 - AUROC: 0.9589 - AP: 0.7390
[37m2024-05-16 06:14:56,165 [INFO] - Epoch: 13/50
[37m2024-05-16 06:14:56,165 [INFO] - Extracting training cells
[37m2024-05-16 06:15:10,113 [INFO] - Extraction detection metrics - F1: 0.728, Precision: 0.803, Recall: 0.701, Detected-Cells: 9013
[37m2024-05-16 06:15:10,452 [INFO] - Training epoch stats:     Loss: 0.2743 - F1-Score: 0.8888 - Accuracy-Score: 0.8888 - AUROC: 0.9825 - AP: 0.9550
[37m2024-05-16 06:15:10,535 [INFO] - Validation epoch stats:   Loss: 0.4130 - F1-Score: 0.8370 - Accuracy-Score: 0.8370 - AUROC: 0.9494 - AP: 0.7374
[37m2024-05-16 06:15:10,644 [INFO] - Epoch: 14/50
[37m2024-05-16 06:15:10,645 [INFO] - Extracting training cells
[37m2024-05-16 06:15:25,083 [INFO] - Extraction detection metrics - F1: 0.714, Precision: 0.797, Recall: 0.681, Detected-Cells: 9357
[37m2024-05-16 06:15:25,464 [INFO] - Training epoch stats:     Loss: 0.2068 - F1-Score: 0.9160 - Accuracy-Score: 0.9160 - AUROC: 0.9881 - AP: 0.9645
[37m2024-05-16 06:15:25,555 [INFO] - Validation epoch stats:   Loss: 0.3530 - F1-Score: 0.8615 - Accuracy-Score: 0.8615 - AUROC: 0.9666 - AP: 0.7615
[37m2024-05-16 06:15:25,659 [INFO] - Epoch: 15/50
[37m2024-05-16 06:15:25,660 [INFO] - Extracting training cells
[37m2024-05-16 06:15:40,439 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.783, Recall: 0.686, Detected-Cells: 9215
[37m2024-05-16 06:15:40,716 [INFO] - Training epoch stats:     Loss: 0.2139 - F1-Score: 0.9118 - Accuracy-Score: 0.9118 - AUROC: 0.9866 - AP: 0.9614
[37m2024-05-16 06:15:40,777 [INFO] - Validation epoch stats:   Loss: 0.3611 - F1-Score: 0.8565 - Accuracy-Score: 0.8565 - AUROC: 0.9613 - AP: 0.7464
[37m2024-05-16 06:15:40,877 [INFO] - Epoch: 16/50
[37m2024-05-16 06:15:40,878 [INFO] - Extracting training cells
[37m2024-05-16 06:15:55,178 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.806, Recall: 0.693, Detected-Cells: 9449
[37m2024-05-16 06:15:55,514 [INFO] - Training epoch stats:     Loss: 0.1795 - F1-Score: 0.9248 - Accuracy-Score: 0.9248 - AUROC: 0.9912 - AP: 0.9758
[37m2024-05-16 06:15:55,585 [INFO] - Validation epoch stats:   Loss: 0.3574 - F1-Score: 0.8665 - Accuracy-Score: 0.8665 - AUROC: 0.9563 - AP: 0.7384
[37m2024-05-16 06:15:55,679 [INFO] - Epoch: 17/50
[37m2024-05-16 06:15:55,680 [INFO] - Extracting training cells
[37m2024-05-16 06:16:09,804 [INFO] - Extraction detection metrics - F1: 0.712, Precision: 0.794, Recall: 0.680, Detected-Cells: 8762
[37m2024-05-16 06:16:10,074 [INFO] - Training epoch stats:     Loss: 0.2447 - F1-Score: 0.9077 - Accuracy-Score: 0.9077 - AUROC: 0.9822 - AP: 0.9421
[37m2024-05-16 06:16:10,135 [INFO] - Validation epoch stats:   Loss: 0.3679 - F1-Score: 0.8590 - Accuracy-Score: 0.8590 - AUROC: 0.9507 - AP: 0.7376
[37m2024-05-16 06:16:10,238 [INFO] - Epoch: 18/50
[37m2024-05-16 06:16:10,239 [INFO] - Extracting training cells
[37m2024-05-16 06:16:23,860 [INFO] - Extraction detection metrics - F1: 0.729, Precision: 0.820, Recall: 0.684, Detected-Cells: 9175
[37m2024-05-16 06:16:24,176 [INFO] - Training epoch stats:     Loss: 0.2098 - F1-Score: 0.9098 - Accuracy-Score: 0.9098 - AUROC: 0.9874 - AP: 0.9653
[37m2024-05-16 06:16:24,248 [INFO] - Validation epoch stats:   Loss: 0.3678 - F1-Score: 0.8570 - Accuracy-Score: 0.8570 - AUROC: 0.9601 - AP: 0.7490
[37m2024-05-16 06:16:24,358 [INFO] - Epoch: 19/50
[37m2024-05-16 06:16:24,359 [INFO] - Extracting training cells
[37m2024-05-16 06:16:38,482 [INFO] - Extraction detection metrics - F1: 0.728, Precision: 0.808, Recall: 0.692, Detected-Cells: 9412
[37m2024-05-16 06:16:38,771 [INFO] - Training epoch stats:     Loss: 0.1788 - F1-Score: 0.9272 - Accuracy-Score: 0.9272 - AUROC: 0.9911 - AP: 0.9738
[37m2024-05-16 06:16:38,837 [INFO] - Validation epoch stats:   Loss: 0.4133 - F1-Score: 0.8320 - Accuracy-Score: 0.8320 - AUROC: 0.9586 - AP: 0.7341
[37m2024-05-16 06:16:38,940 [INFO] - Epoch: 20/50
[37m2024-05-16 06:16:38,940 [INFO] - Extracting training cells
[37m2024-05-16 06:16:52,612 [INFO] - Extraction detection metrics - F1: 0.729, Precision: 0.802, Recall: 0.704, Detected-Cells: 9306
[37m2024-05-16 06:16:52,932 [INFO] - Training epoch stats:     Loss: 0.1737 - F1-Score: 0.9268 - Accuracy-Score: 0.9268 - AUROC: 0.9912 - AP: 0.9777
[37m2024-05-16 06:16:53,005 [INFO] - Validation epoch stats:   Loss: 0.3689 - F1-Score: 0.8520 - Accuracy-Score: 0.8520 - AUROC: 0.9500 - AP: 0.7332
[37m2024-05-16 06:16:53,104 [INFO] - Epoch: 21/50
[37m2024-05-16 06:16:53,105 [INFO] - Extracting training cells
[37m2024-05-16 06:17:07,043 [INFO] - Extraction detection metrics - F1: 0.728, Precision: 0.805, Recall: 0.694, Detected-Cells: 9551
[37m2024-05-16 06:17:07,375 [INFO] - Training epoch stats:     Loss: 0.1563 - F1-Score: 0.9368 - Accuracy-Score: 0.9368 - AUROC: 0.9930 - AP: 0.9834
[37m2024-05-16 06:17:07,444 [INFO] - Validation epoch stats:   Loss: 0.3739 - F1-Score: 0.8640 - Accuracy-Score: 0.8640 - AUROC: 0.9513 - AP: 0.7235
[37m2024-05-16 06:17:07,553 [INFO] - Epoch: 22/50
[37m2024-05-16 06:17:07,553 [INFO] - Extracting training cells
[37m2024-05-16 06:17:22,585 [INFO] - Extraction detection metrics - F1: 0.733, Precision: 0.806, Recall: 0.704, Detected-Cells: 9194
[37m2024-05-16 06:17:22,962 [INFO] - Training epoch stats:     Loss: 0.1789 - F1-Score: 0.9296 - Accuracy-Score: 0.9296 - AUROC: 0.9903 - AP: 0.9787
[37m2024-05-16 06:17:23,023 [INFO] - Validation epoch stats:   Loss: 0.4428 - F1-Score: 0.8290 - Accuracy-Score: 0.8290 - AUROC: 0.9474 - AP: 0.7236
[37m2024-05-16 06:17:23,125 [INFO] - Epoch: 23/50
[37m2024-05-16 06:17:23,125 [INFO] - Extracting training cells
[37m2024-05-16 06:17:37,338 [INFO] - Extraction detection metrics - F1: 0.719, Precision: 0.801, Recall: 0.686, Detected-Cells: 9208
[37m2024-05-16 06:17:37,628 [INFO] - Training epoch stats:     Loss: 0.1612 - F1-Score: 0.9343 - Accuracy-Score: 0.9343 - AUROC: 0.9927 - AP: 0.9821
[37m2024-05-16 06:17:37,695 [INFO] - Validation epoch stats:   Loss: 0.4046 - F1-Score: 0.8435 - Accuracy-Score: 0.8435 - AUROC: 0.9478 - AP: 0.7242
[37m2024-05-16 06:17:37,800 [INFO] - Epoch: 24/50
[37m2024-05-16 06:17:37,801 [INFO] - Extracting training cells
[37m2024-05-16 06:17:52,395 [INFO] - Extraction detection metrics - F1: 0.709, Precision: 0.779, Recall: 0.683, Detected-Cells: 8061
[37m2024-05-16 06:17:52,649 [INFO] - Training epoch stats:     Loss: 0.2516 - F1-Score: 0.9076 - Accuracy-Score: 0.9076 - AUROC: 0.9824 - AP: 0.8967
[37m2024-05-16 06:17:52,708 [INFO] - Validation epoch stats:   Loss: 0.4548 - F1-Score: 0.8355 - Accuracy-Score: 0.8355 - AUROC: 0.9361 - AP: 0.7161
[37m2024-05-16 06:17:52,709 [INFO] - Performing early stopping!
[37m2024-05-16 06:17:52,720 [INFO] - Finished run tj3mzvae
