[37m2024-05-15 13:35:32,227 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-05-15 13:35:32,230 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/UNI/Setting-1/2024-05-15T133518_Fold-3
[37m2024-05-15 13:35:32,328 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f724c18e5f0>]
[37m2024-05-15 13:35:32,341 [INFO] - Using GPU: cuda:0
[37m2024-05-15 13:35:32,352 [INFO] - Using device: cuda:0
[37m2024-05-15 13:35:32,363 [INFO] - Loss function:
[37m2024-05-15 13:35:32,374 [INFO] - CrossEntropyLoss()
[37m2024-05-15 13:35:40,274 [INFO] - <All keys matched successfully>
[37m2024-05-15 13:35:40,779 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 512]                  524,800
â”œâ”€ReLU: 1-2                              [1, 512]                  --
â”œâ”€Dropout: 1-3                           [1, 512]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    2,052
==========================================================================================
Total params: 526,852
Trainable params: 526,852
Non-trainable params: 0
Total mult-adds (M): 0.53
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 2.11
Estimated Total Size (MB): 2.12
==========================================================================================
[37m2024-05-15 13:35:40,791 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-05-15 13:35:40,801 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.001, 'weight_decay': 0.00035}
[37m2024-05-15 13:35:40,812 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-05-15 13:35:40,837 [INFO] - Caching datasets
[37m2024-05-15 13:35:41,757 [INFO] - Instantiate Trainer
[37m2024-05-15 13:35:41,772 [INFO] - Calling Trainer Fit
[37m2024-05-15 13:35:41,782 [INFO] - Dataset is cached after first epoch
[37m2024-05-15 13:35:41,793 [INFO] - Starting training, total number of epochs: 50
[37m2024-05-15 13:35:41,804 [INFO] - Epoch: 1/50
[37m2024-05-15 13:35:43,902 [INFO] - Loaded dataset from cache: /Consep/cache/1e524054118d0b8076359710cc23659c9f64610abbe0506cb0aed75a69872b4e.h5
[37m2024-05-15 13:35:44,567 [INFO] - Training epoch stats:     Loss: 0.3848 - F1-Score: 0.8460 - Accuracy-Score: 0.8460 - AUROC: 0.9530 - AP: 0.8059
[37m2024-05-15 13:35:45,426 [INFO] - Loaded dataset from cache: /Consep/cache/5f23a809ca260dcb3aea1a87aab212e7e8f1e479f7e89ec602aa81162330a3c9.h5
[37m2024-05-15 13:35:45,513 [INFO] - Validation epoch stats:   Loss: 1.0406 - F1-Score: 0.5457 - Accuracy-Score: 0.5457 - AUROC: 0.8795 - AP: 0.6624
[37m2024-05-15 13:35:45,524 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:45,822 [INFO] - Epoch: 2/50
[37m2024-05-15 13:35:46,213 [INFO] - Training epoch stats:     Loss: 0.2317 - F1-Score: 0.9041 - Accuracy-Score: 0.9041 - AUROC: 0.9834 - AP: 0.9282
[37m2024-05-15 13:35:46,327 [INFO] - Validation epoch stats:   Loss: 0.7750 - F1-Score: 0.6903 - Accuracy-Score: 0.6903 - AUROC: 0.8930 - AP: 0.6716
[37m2024-05-15 13:35:46,338 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:46,632 [INFO] - Epoch: 3/50
[37m2024-05-15 13:35:47,295 [INFO] - Training epoch stats:     Loss: 0.2069 - F1-Score: 0.9138 - Accuracy-Score: 0.9138 - AUROC: 0.9867 - AP: 0.9418
[37m2024-05-15 13:35:47,385 [INFO] - Validation epoch stats:   Loss: 0.7057 - F1-Score: 0.7293 - Accuracy-Score: 0.7293 - AUROC: 0.9001 - AP: 0.6743
[37m2024-05-15 13:35:47,397 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:47,702 [INFO] - Epoch: 4/50
[37m2024-05-15 13:35:48,076 [INFO] - Training epoch stats:     Loss: 0.1863 - F1-Score: 0.9203 - Accuracy-Score: 0.9203 - AUROC: 0.9893 - AP: 0.9538
[37m2024-05-15 13:35:48,180 [INFO] - Validation epoch stats:   Loss: 0.7640 - F1-Score: 0.7145 - Accuracy-Score: 0.7145 - AUROC: 0.9065 - AP: 0.6644
[37m2024-05-15 13:35:48,196 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:48,496 [INFO] - Epoch: 5/50
[37m2024-05-15 13:35:48,873 [INFO] - Training epoch stats:     Loss: 0.1713 - F1-Score: 0.9272 - Accuracy-Score: 0.9272 - AUROC: 0.9909 - AP: 0.9620
[37m2024-05-15 13:35:48,968 [INFO] - Validation epoch stats:   Loss: 0.8757 - F1-Score: 0.6776 - Accuracy-Score: 0.6776 - AUROC: 0.9145 - AP: 0.6621
[37m2024-05-15 13:35:48,979 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:49,275 [INFO] - Epoch: 6/50
[37m2024-05-15 13:35:49,650 [INFO] - Training epoch stats:     Loss: 0.1576 - F1-Score: 0.9329 - Accuracy-Score: 0.9329 - AUROC: 0.9921 - AP: 0.9680
[37m2024-05-15 13:35:49,744 [INFO] - Validation epoch stats:   Loss: 0.7532 - F1-Score: 0.7253 - Accuracy-Score: 0.7253 - AUROC: 0.9141 - AP: 0.6575
[37m2024-05-15 13:35:49,861 [INFO] - Epoch: 7/50
[37m2024-05-15 13:35:50,248 [INFO] - Training epoch stats:     Loss: 0.1409 - F1-Score: 0.9396 - Accuracy-Score: 0.9396 - AUROC: 0.9936 - AP: 0.9750
[37m2024-05-15 13:35:50,343 [INFO] - Validation epoch stats:   Loss: 0.6941 - F1-Score: 0.7566 - Accuracy-Score: 0.7566 - AUROC: 0.9250 - AP: 0.6582
[37m2024-05-15 13:35:50,355 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:50,663 [INFO] - Epoch: 8/50
[37m2024-05-15 13:35:51,049 [INFO] - Training epoch stats:     Loss: 0.1300 - F1-Score: 0.9461 - Accuracy-Score: 0.9461 - AUROC: 0.9946 - AP: 0.9793
[37m2024-05-15 13:35:51,141 [INFO] - Validation epoch stats:   Loss: 0.6595 - F1-Score: 0.7814 - Accuracy-Score: 0.7814 - AUROC: 0.9284 - AP: 0.6631
[37m2024-05-15 13:35:51,152 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:51,465 [INFO] - Epoch: 9/50
[37m2024-05-15 13:35:51,845 [INFO] - Training epoch stats:     Loss: 0.1157 - F1-Score: 0.9500 - Accuracy-Score: 0.9500 - AUROC: 0.9956 - AP: 0.9826
[37m2024-05-15 13:35:51,934 [INFO] - Validation epoch stats:   Loss: 0.8552 - F1-Score: 0.7253 - Accuracy-Score: 0.7253 - AUROC: 0.9310 - AP: 0.6616
[37m2024-05-15 13:35:51,946 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:52,228 [INFO] - Epoch: 10/50
[37m2024-05-15 13:35:52,613 [INFO] - Training epoch stats:     Loss: 0.1046 - F1-Score: 0.9578 - Accuracy-Score: 0.9578 - AUROC: 0.9964 - AP: 0.9857
[37m2024-05-15 13:35:52,707 [INFO] - Validation epoch stats:   Loss: 0.8635 - F1-Score: 0.7386 - Accuracy-Score: 0.7386 - AUROC: 0.9319 - AP: 0.6645
[37m2024-05-15 13:35:52,718 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:53,011 [INFO] - Epoch: 11/50
[37m2024-05-15 13:35:53,412 [INFO] - Training epoch stats:     Loss: 0.0950 - F1-Score: 0.9602 - Accuracy-Score: 0.9602 - AUROC: 0.9970 - AP: 0.9889
[37m2024-05-15 13:35:53,512 [INFO] - Validation epoch stats:   Loss: 0.8620 - F1-Score: 0.7445 - Accuracy-Score: 0.7445 - AUROC: 0.9333 - AP: 0.6630
[37m2024-05-15 13:35:53,523 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:53,830 [INFO] - Epoch: 12/50
[37m2024-05-15 13:35:54,206 [INFO] - Training epoch stats:     Loss: 0.0851 - F1-Score: 0.9662 - Accuracy-Score: 0.9662 - AUROC: 0.9976 - AP: 0.9909
[37m2024-05-15 13:35:54,297 [INFO] - Validation epoch stats:   Loss: 0.9492 - F1-Score: 0.7411 - Accuracy-Score: 0.7411 - AUROC: 0.9320 - AP: 0.6592
[37m2024-05-15 13:35:54,443 [INFO] - Epoch: 13/50
[37m2024-05-15 13:35:54,821 [INFO] - Training epoch stats:     Loss: 0.0785 - F1-Score: 0.9682 - Accuracy-Score: 0.9682 - AUROC: 0.9979 - AP: 0.9920
[37m2024-05-15 13:35:54,918 [INFO] - Validation epoch stats:   Loss: 0.8130 - F1-Score: 0.7804 - Accuracy-Score: 0.7804 - AUROC: 0.9346 - AP: 0.6625
[37m2024-05-15 13:35:54,930 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:55,254 [INFO] - Epoch: 14/50
[37m2024-05-15 13:35:55,645 [INFO] - Training epoch stats:     Loss: 0.0752 - F1-Score: 0.9700 - Accuracy-Score: 0.9700 - AUROC: 0.9980 - AP: 0.9925
[37m2024-05-15 13:35:55,744 [INFO] - Validation epoch stats:   Loss: 0.8483 - F1-Score: 0.7736 - Accuracy-Score: 0.7736 - AUROC: 0.9352 - AP: 0.6636
[37m2024-05-15 13:35:55,755 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:56,034 [INFO] - Epoch: 15/50
[37m2024-05-15 13:35:56,406 [INFO] - Training epoch stats:     Loss: 0.0708 - F1-Score: 0.9724 - Accuracy-Score: 0.9724 - AUROC: 0.9982 - AP: 0.9925
[37m2024-05-15 13:35:56,501 [INFO] - Validation epoch stats:   Loss: 1.0531 - F1-Score: 0.7529 - Accuracy-Score: 0.7529 - AUROC: 0.9321 - AP: 0.6631
[37m2024-05-15 13:35:56,615 [INFO] - Epoch: 16/50
[37m2024-05-15 13:35:56,987 [INFO] - Training epoch stats:     Loss: 0.0619 - F1-Score: 0.9762 - Accuracy-Score: 0.9762 - AUROC: 0.9986 - AP: 0.9945
[37m2024-05-15 13:35:57,080 [INFO] - Validation epoch stats:   Loss: 0.9717 - F1-Score: 0.7783 - Accuracy-Score: 0.7783 - AUROC: 0.9315 - AP: 0.6587
[37m2024-05-15 13:35:57,191 [INFO] - Epoch: 17/50
[37m2024-05-15 13:35:57,567 [INFO] - Training epoch stats:     Loss: 0.0587 - F1-Score: 0.9772 - Accuracy-Score: 0.9772 - AUROC: 0.9987 - AP: 0.9952
[37m2024-05-15 13:35:57,659 [INFO] - Validation epoch stats:   Loss: 1.1246 - F1-Score: 0.7560 - Accuracy-Score: 0.7560 - AUROC: 0.9317 - AP: 0.6594
[37m2024-05-15 13:35:57,786 [INFO] - Epoch: 18/50
[37m2024-05-15 13:35:58,167 [INFO] - Training epoch stats:     Loss: 0.0553 - F1-Score: 0.9800 - Accuracy-Score: 0.9800 - AUROC: 0.9989 - AP: 0.9959
[37m2024-05-15 13:35:58,266 [INFO] - Validation epoch stats:   Loss: 1.0824 - F1-Score: 0.7674 - Accuracy-Score: 0.7674 - AUROC: 0.9386 - AP: 0.6715
[37m2024-05-15 13:35:58,277 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:35:58,571 [INFO] - Epoch: 19/50
[37m2024-05-15 13:35:58,952 [INFO] - Training epoch stats:     Loss: 0.0492 - F1-Score: 0.9816 - Accuracy-Score: 0.9816 - AUROC: 0.9992 - AP: 0.9971
[37m2024-05-15 13:35:59,047 [INFO] - Validation epoch stats:   Loss: 1.1609 - F1-Score: 0.7560 - Accuracy-Score: 0.7560 - AUROC: 0.9327 - AP: 0.6569
[37m2024-05-15 13:35:59,157 [INFO] - Epoch: 20/50
[37m2024-05-15 13:35:59,542 [INFO] - Training epoch stats:     Loss: 0.0459 - F1-Score: 0.9829 - Accuracy-Score: 0.9829 - AUROC: 0.9993 - AP: 0.9969
[37m2024-05-15 13:35:59,637 [INFO] - Validation epoch stats:   Loss: 1.2330 - F1-Score: 0.7587 - Accuracy-Score: 0.7587 - AUROC: 0.9263 - AP: 0.6515
[37m2024-05-15 13:35:59,747 [INFO] - Epoch: 21/50
[37m2024-05-15 13:36:00,128 [INFO] - Training epoch stats:     Loss: 0.0426 - F1-Score: 0.9840 - Accuracy-Score: 0.9840 - AUROC: 0.9994 - AP: 0.9977
[37m2024-05-15 13:36:00,229 [INFO] - Validation epoch stats:   Loss: 1.4344 - F1-Score: 0.7287 - Accuracy-Score: 0.7287 - AUROC: 0.9249 - AP: 0.6475
[37m2024-05-15 13:36:00,347 [INFO] - Epoch: 22/50
[37m2024-05-15 13:36:00,733 [INFO] - Training epoch stats:     Loss: 0.0398 - F1-Score: 0.9847 - Accuracy-Score: 0.9847 - AUROC: 0.9995 - AP: 0.9981
[37m2024-05-15 13:36:00,827 [INFO] - Validation epoch stats:   Loss: 1.4349 - F1-Score: 0.7380 - Accuracy-Score: 0.7380 - AUROC: 0.9304 - AP: 0.6530
[37m2024-05-15 13:36:00,941 [INFO] - Epoch: 23/50
[37m2024-05-15 13:36:01,318 [INFO] - Training epoch stats:     Loss: 0.0382 - F1-Score: 0.9874 - Accuracy-Score: 0.9874 - AUROC: 0.9995 - AP: 0.9978
[37m2024-05-15 13:36:01,412 [INFO] - Validation epoch stats:   Loss: 1.1667 - F1-Score: 0.7826 - Accuracy-Score: 0.7826 - AUROC: 0.9357 - AP: 0.6582
[37m2024-05-15 13:36:01,528 [INFO] - Epoch: 24/50
[37m2024-05-15 13:36:01,909 [INFO] - Training epoch stats:     Loss: 0.0338 - F1-Score: 0.9883 - Accuracy-Score: 0.9883 - AUROC: 0.9996 - AP: 0.9984
[37m2024-05-15 13:36:02,006 [INFO] - Validation epoch stats:   Loss: 1.4385 - F1-Score: 0.7541 - Accuracy-Score: 0.7541 - AUROC: 0.9294 - AP: 0.6541
[37m2024-05-15 13:36:02,129 [INFO] - Epoch: 25/50
[37m2024-05-15 13:36:02,509 [INFO] - Training epoch stats:     Loss: 0.0226 - F1-Score: 0.9935 - Accuracy-Score: 0.9935 - AUROC: 0.9999 - AP: 0.9996
[37m2024-05-15 13:36:02,602 [INFO] - Validation epoch stats:   Loss: 1.4135 - F1-Score: 0.7600 - Accuracy-Score: 0.7600 - AUROC: 0.9301 - AP: 0.6536
[37m2024-05-15 13:36:02,720 [INFO] - Epoch: 26/50
[37m2024-05-15 13:36:03,096 [INFO] - Training epoch stats:     Loss: 0.0182 - F1-Score: 0.9953 - Accuracy-Score: 0.9953 - AUROC: 0.9999 - AP: 0.9998
[37m2024-05-15 13:36:03,189 [INFO] - Validation epoch stats:   Loss: 1.3957 - F1-Score: 0.7646 - Accuracy-Score: 0.7646 - AUROC: 0.9295 - AP: 0.6516
[37m2024-05-15 13:36:03,308 [INFO] - Epoch: 27/50
[37m2024-05-15 13:36:03,686 [INFO] - Training epoch stats:     Loss: 0.0173 - F1-Score: 0.9950 - Accuracy-Score: 0.9950 - AUROC: 0.9999 - AP: 0.9998
[37m2024-05-15 13:36:03,781 [INFO] - Validation epoch stats:   Loss: 1.4319 - F1-Score: 0.7603 - Accuracy-Score: 0.7603 - AUROC: 0.9295 - AP: 0.6516
[37m2024-05-15 13:36:03,895 [INFO] - Epoch: 28/50
[37m2024-05-15 13:36:04,274 [INFO] - Training epoch stats:     Loss: 0.0158 - F1-Score: 0.9958 - Accuracy-Score: 0.9958 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:04,408 [INFO] - Validation epoch stats:   Loss: 1.4415 - F1-Score: 0.7609 - Accuracy-Score: 0.7609 - AUROC: 0.9297 - AP: 0.6518
[37m2024-05-15 13:36:04,539 [INFO] - Epoch: 29/50
[37m2024-05-15 13:36:04,922 [INFO] - Training epoch stats:     Loss: 0.0145 - F1-Score: 0.9967 - Accuracy-Score: 0.9967 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:05,011 [INFO] - Validation epoch stats:   Loss: 1.4343 - F1-Score: 0.7625 - Accuracy-Score: 0.7625 - AUROC: 0.9299 - AP: 0.6508
[37m2024-05-15 13:36:05,135 [INFO] - Epoch: 30/50
[37m2024-05-15 13:36:05,522 [INFO] - Training epoch stats:     Loss: 0.0141 - F1-Score: 0.9961 - Accuracy-Score: 0.9961 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:05,614 [INFO] - Validation epoch stats:   Loss: 1.4701 - F1-Score: 0.7603 - Accuracy-Score: 0.7603 - AUROC: 0.9297 - AP: 0.6517
[37m2024-05-15 13:36:05,746 [INFO] - Epoch: 31/50
[37m2024-05-15 13:36:06,138 [INFO] - Training epoch stats:     Loss: 0.0139 - F1-Score: 0.9965 - Accuracy-Score: 0.9965 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:06,231 [INFO] - Validation epoch stats:   Loss: 1.4546 - F1-Score: 0.7628 - Accuracy-Score: 0.7628 - AUROC: 0.9296 - AP: 0.6503
[37m2024-05-15 13:36:06,349 [INFO] - Epoch: 32/50
[37m2024-05-15 13:36:06,740 [INFO] - Training epoch stats:     Loss: 0.0134 - F1-Score: 0.9964 - Accuracy-Score: 0.9964 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:06,837 [INFO] - Validation epoch stats:   Loss: 1.4971 - F1-Score: 0.7587 - Accuracy-Score: 0.7587 - AUROC: 0.9301 - AP: 0.6512
[37m2024-05-15 13:36:06,957 [INFO] - Epoch: 33/50
[37m2024-05-15 13:36:07,337 [INFO] - Training epoch stats:     Loss: 0.0129 - F1-Score: 0.9970 - Accuracy-Score: 0.9970 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:07,471 [INFO] - Validation epoch stats:   Loss: 1.4774 - F1-Score: 0.7631 - Accuracy-Score: 0.7631 - AUROC: 0.9306 - AP: 0.6504
[37m2024-05-15 13:36:07,589 [INFO] - Epoch: 34/50
[37m2024-05-15 13:36:07,955 [INFO] - Training epoch stats:     Loss: 0.0124 - F1-Score: 0.9970 - Accuracy-Score: 0.9970 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:08,046 [INFO] - Validation epoch stats:   Loss: 1.4909 - F1-Score: 0.7646 - Accuracy-Score: 0.7646 - AUROC: 0.9304 - AP: 0.6495
[37m2024-05-15 13:36:08,162 [INFO] - Epoch: 35/50
[37m2024-05-15 13:36:08,531 [INFO] - Training epoch stats:     Loss: 0.0126 - F1-Score: 0.9965 - Accuracy-Score: 0.9965 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:08,627 [INFO] - Validation epoch stats:   Loss: 1.4836 - F1-Score: 0.7653 - Accuracy-Score: 0.7653 - AUROC: 0.9309 - AP: 0.6511
[37m2024-05-15 13:36:08,744 [INFO] - Epoch: 36/50
[37m2024-05-15 13:36:09,107 [INFO] - Training epoch stats:     Loss: 0.0119 - F1-Score: 0.9971 - Accuracy-Score: 0.9971 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:09,205 [INFO] - Validation epoch stats:   Loss: 1.4960 - F1-Score: 0.7643 - Accuracy-Score: 0.7643 - AUROC: 0.9305 - AP: 0.6496
[37m2024-05-15 13:36:09,325 [INFO] - Epoch: 37/50
[37m2024-05-15 13:36:09,692 [INFO] - Training epoch stats:     Loss: 0.0116 - F1-Score: 0.9974 - Accuracy-Score: 0.9974 - AUROC: 1.0000 - AP: 0.9999
[37m2024-05-15 13:36:09,786 [INFO] - Validation epoch stats:   Loss: 1.5339 - F1-Score: 0.7631 - Accuracy-Score: 0.7631 - AUROC: 0.9304 - AP: 0.6493
[37m2024-05-15 13:36:09,904 [INFO] - Epoch: 38/50
[37m2024-05-15 13:36:10,268 [INFO] - Training epoch stats:     Loss: 0.0111 - F1-Score: 0.9973 - Accuracy-Score: 0.9973 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-15 13:36:10,358 [INFO] - Validation epoch stats:   Loss: 1.5660 - F1-Score: 0.7591 - Accuracy-Score: 0.7591 - AUROC: 0.9299 - AP: 0.6504
[37m2024-05-15 13:36:10,367 [INFO] - Performing early stopping!
[37m2024-05-15 13:36:10,379 [INFO] - Finished run cm9fsmwt
