[37m2024-05-15 13:31:44,468 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-05-15 13:31:44,471 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/UNI/Setting-1/2024-05-15T133129_Fold-0
[37m2024-05-15 13:31:44,549 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f752347a5c0>]
[37m2024-05-15 13:31:44,560 [INFO] - Using GPU: cuda:0
[37m2024-05-15 13:31:44,570 [INFO] - Using device: cuda:0
[37m2024-05-15 13:31:44,580 [INFO] - Loss function:
[37m2024-05-15 13:31:44,590 [INFO] - CrossEntropyLoss()
[37m2024-05-15 13:32:08,969 [INFO] - <All keys matched successfully>
[37m2024-05-15 13:32:09,527 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 512]                  524,800
â”œâ”€ReLU: 1-2                              [1, 512]                  --
â”œâ”€Dropout: 1-3                           [1, 512]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    2,052
==========================================================================================
Total params: 526,852
Trainable params: 526,852
Non-trainable params: 0
Total mult-adds (M): 0.53
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 2.11
Estimated Total Size (MB): 2.12
==========================================================================================
[37m2024-05-15 13:32:09,538 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-05-15 13:32:09,549 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.001, 'weight_decay': 0.00035}
[37m2024-05-15 13:32:09,561 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-05-15 13:32:09,587 [INFO] - Caching datasets
[37m2024-05-15 13:32:10,571 [INFO] - Instantiate Trainer
[37m2024-05-15 13:32:10,577 [INFO] - Calling Trainer Fit
[37m2024-05-15 13:32:10,589 [INFO] - Dataset is cached after first epoch
[37m2024-05-15 13:32:10,600 [INFO] - Starting training, total number of epochs: 50
[37m2024-05-15 13:32:10,611 [INFO] - Epoch: 1/50
[37m2024-05-15 13:32:12,815 [INFO] - Loaded dataset from cache: /Consep/cache/02d044e9b65b76a1337f83cdf946400362894b8a05e331e7f1147e1d320147a5.h5
[37m2024-05-15 13:32:13,501 [INFO] - Training epoch stats:     Loss: 0.3845 - F1-Score: 0.8484 - Accuracy-Score: 0.8484 - AUROC: 0.9491 - AP: 0.7885
[37m2024-05-15 13:32:14,075 [INFO] - Loaded dataset from cache: /Consep/cache/21cf4fef25b39e6c59946eb9970afeefc3c9f5119c39ba6ac022d81508c1d76d.h5
[37m2024-05-15 13:32:14,142 [INFO] - Validation epoch stats:   Loss: 0.4013 - F1-Score: 0.8616 - Accuracy-Score: 0.8616 - AUROC: 0.9694 - AP: 0.8558
[37m2024-05-15 13:32:14,153 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:32:14,464 [INFO] - Epoch: 2/50
[37m2024-05-15 13:32:14,887 [INFO] - Training epoch stats:     Loss: 0.2512 - F1-Score: 0.8977 - Accuracy-Score: 0.8977 - AUROC: 0.9817 - AP: 0.9238
[37m2024-05-15 13:32:14,953 [INFO] - Validation epoch stats:   Loss: 0.3493 - F1-Score: 0.8785 - Accuracy-Score: 0.8785 - AUROC: 0.9727 - AP: 0.8763
[37m2024-05-15 13:32:14,965 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:32:15,272 [INFO] - Epoch: 3/50
[37m2024-05-15 13:32:15,987 [INFO] - Training epoch stats:     Loss: 0.2235 - F1-Score: 0.9080 - Accuracy-Score: 0.9080 - AUROC: 0.9860 - AP: 0.9423
[37m2024-05-15 13:32:16,049 [INFO] - Validation epoch stats:   Loss: 0.3650 - F1-Score: 0.8744 - Accuracy-Score: 0.8744 - AUROC: 0.9729 - AP: 0.8801
[37m2024-05-15 13:32:16,060 [INFO] - New best model - save checkpoint
[37m2024-05-15 13:32:16,368 [INFO] - Epoch: 4/50
[37m2024-05-15 13:32:16,790 [INFO] - Training epoch stats:     Loss: 0.2045 - F1-Score: 0.9145 - Accuracy-Score: 0.9145 - AUROC: 0.9885 - AP: 0.9566
[37m2024-05-15 13:32:16,855 [INFO] - Validation epoch stats:   Loss: 0.3328 - F1-Score: 0.8903 - Accuracy-Score: 0.8903 - AUROC: 0.9729 - AP: 0.8840
[37m2024-05-15 13:32:16,982 [INFO] - Epoch: 5/50
[37m2024-05-15 13:32:17,417 [INFO] - Training epoch stats:     Loss: 0.1904 - F1-Score: 0.9227 - Accuracy-Score: 0.9227 - AUROC: 0.9901 - AP: 0.9668
[37m2024-05-15 13:32:17,484 [INFO] - Validation epoch stats:   Loss: 0.3731 - F1-Score: 0.8858 - Accuracy-Score: 0.8858 - AUROC: 0.9728 - AP: 0.8826
[37m2024-05-15 13:32:17,615 [INFO] - Epoch: 6/50
[37m2024-05-15 13:32:18,048 [INFO] - Training epoch stats:     Loss: 0.1745 - F1-Score: 0.9275 - Accuracy-Score: 0.9275 - AUROC: 0.9916 - AP: 0.9746
[37m2024-05-15 13:32:18,114 [INFO] - Validation epoch stats:   Loss: 0.4217 - F1-Score: 0.8721 - Accuracy-Score: 0.8721 - AUROC: 0.9690 - AP: 0.8750
[37m2024-05-15 13:32:18,239 [INFO] - Epoch: 7/50
[37m2024-05-15 13:32:18,676 [INFO] - Training epoch stats:     Loss: 0.1565 - F1-Score: 0.9366 - Accuracy-Score: 0.9366 - AUROC: 0.9931 - AP: 0.9824
[37m2024-05-15 13:32:18,745 [INFO] - Validation epoch stats:   Loss: 0.3886 - F1-Score: 0.8858 - Accuracy-Score: 0.8858 - AUROC: 0.9714 - AP: 0.8819
[37m2024-05-15 13:32:18,863 [INFO] - Epoch: 8/50
[37m2024-05-15 13:32:19,290 [INFO] - Training epoch stats:     Loss: 0.1470 - F1-Score: 0.9389 - Accuracy-Score: 0.9389 - AUROC: 0.9939 - AP: 0.9853
[37m2024-05-15 13:32:19,357 [INFO] - Validation epoch stats:   Loss: 0.4507 - F1-Score: 0.8712 - Accuracy-Score: 0.8712 - AUROC: 0.9678 - AP: 0.8620
[37m2024-05-15 13:32:19,480 [INFO] - Epoch: 9/50
[37m2024-05-15 13:32:19,854 [INFO] - Training epoch stats:     Loss: 0.1315 - F1-Score: 0.9476 - Accuracy-Score: 0.9476 - AUROC: 0.9949 - AP: 0.9893
[37m2024-05-15 13:32:19,913 [INFO] - Validation epoch stats:   Loss: 0.4683 - F1-Score: 0.8748 - Accuracy-Score: 0.8748 - AUROC: 0.9700 - AP: 0.8735
[37m2024-05-15 13:32:20,028 [INFO] - Epoch: 10/50
[37m2024-05-15 13:32:20,445 [INFO] - Training epoch stats:     Loss: 0.1215 - F1-Score: 0.9489 - Accuracy-Score: 0.9489 - AUROC: 0.9957 - AP: 0.9914
[37m2024-05-15 13:32:20,512 [INFO] - Validation epoch stats:   Loss: 0.4675 - F1-Score: 0.8762 - Accuracy-Score: 0.8762 - AUROC: 0.9690 - AP: 0.8702
[37m2024-05-15 13:32:20,627 [INFO] - Epoch: 11/50
[37m2024-05-15 13:32:21,046 [INFO] - Training epoch stats:     Loss: 0.1104 - F1-Score: 0.9566 - Accuracy-Score: 0.9566 - AUROC: 0.9965 - AP: 0.9932
[37m2024-05-15 13:32:21,113 [INFO] - Validation epoch stats:   Loss: 0.4458 - F1-Score: 0.8853 - Accuracy-Score: 0.8853 - AUROC: 0.9690 - AP: 0.8757
[37m2024-05-15 13:32:21,219 [INFO] - Epoch: 12/50
[37m2024-05-15 13:32:21,636 [INFO] - Training epoch stats:     Loss: 0.1010 - F1-Score: 0.9602 - Accuracy-Score: 0.9602 - AUROC: 0.9970 - AP: 0.9942
[37m2024-05-15 13:32:21,703 [INFO] - Validation epoch stats:   Loss: 0.4954 - F1-Score: 0.8821 - Accuracy-Score: 0.8821 - AUROC: 0.9669 - AP: 0.8712
[37m2024-05-15 13:32:21,820 [INFO] - Epoch: 13/50
[37m2024-05-15 13:32:22,241 [INFO] - Training epoch stats:     Loss: 0.0965 - F1-Score: 0.9622 - Accuracy-Score: 0.9622 - AUROC: 0.9972 - AP: 0.9948
[37m2024-05-15 13:32:22,309 [INFO] - Validation epoch stats:   Loss: 0.5937 - F1-Score: 0.8648 - Accuracy-Score: 0.8648 - AUROC: 0.9648 - AP: 0.8663
[37m2024-05-15 13:32:22,430 [INFO] - Epoch: 14/50
[37m2024-05-15 13:32:22,840 [INFO] - Training epoch stats:     Loss: 0.0886 - F1-Score: 0.9651 - Accuracy-Score: 0.9651 - AUROC: 0.9977 - AP: 0.9957
[37m2024-05-15 13:32:22,906 [INFO] - Validation epoch stats:   Loss: 0.5318 - F1-Score: 0.8835 - Accuracy-Score: 0.8835 - AUROC: 0.9678 - AP: 0.8694
[37m2024-05-15 13:32:23,023 [INFO] - Epoch: 15/50
[37m2024-05-15 13:32:23,427 [INFO] - Training epoch stats:     Loss: 0.0829 - F1-Score: 0.9676 - Accuracy-Score: 0.9676 - AUROC: 0.9980 - AP: 0.9961
[37m2024-05-15 13:32:23,494 [INFO] - Validation epoch stats:   Loss: 0.6437 - F1-Score: 0.8639 - Accuracy-Score: 0.8639 - AUROC: 0.9640 - AP: 0.8640
[37m2024-05-15 13:32:23,613 [INFO] - Epoch: 16/50
[37m2024-05-15 13:32:24,032 [INFO] - Training epoch stats:     Loss: 0.0783 - F1-Score: 0.9698 - Accuracy-Score: 0.9698 - AUROC: 0.9981 - AP: 0.9964
[37m2024-05-15 13:32:24,099 [INFO] - Validation epoch stats:   Loss: 0.6313 - F1-Score: 0.8685 - Accuracy-Score: 0.8685 - AUROC: 0.9641 - AP: 0.8619
[37m2024-05-15 13:32:24,216 [INFO] - Epoch: 17/50
[37m2024-05-15 13:32:24,626 [INFO] - Training epoch stats:     Loss: 0.0692 - F1-Score: 0.9737 - Accuracy-Score: 0.9737 - AUROC: 0.9986 - AP: 0.9973
[37m2024-05-15 13:32:24,693 [INFO] - Validation epoch stats:   Loss: 0.5879 - F1-Score: 0.8635 - Accuracy-Score: 0.8635 - AUROC: 0.9637 - AP: 0.8596
[37m2024-05-15 13:32:24,812 [INFO] - Epoch: 18/50
[37m2024-05-15 13:32:25,226 [INFO] - Training epoch stats:     Loss: 0.0655 - F1-Score: 0.9758 - Accuracy-Score: 0.9758 - AUROC: 0.9987 - AP: 0.9975
[37m2024-05-15 13:32:25,293 [INFO] - Validation epoch stats:   Loss: 0.6036 - F1-Score: 0.8776 - Accuracy-Score: 0.8776 - AUROC: 0.9632 - AP: 0.8657
[37m2024-05-15 13:32:25,411 [INFO] - Epoch: 19/50
[37m2024-05-15 13:32:25,816 [INFO] - Training epoch stats:     Loss: 0.0598 - F1-Score: 0.9772 - Accuracy-Score: 0.9772 - AUROC: 0.9989 - AP: 0.9977
[37m2024-05-15 13:32:25,883 [INFO] - Validation epoch stats:   Loss: 0.6728 - F1-Score: 0.8726 - Accuracy-Score: 0.8726 - AUROC: 0.9633 - AP: 0.8633
[37m2024-05-15 13:32:26,002 [INFO] - Epoch: 20/50
[37m2024-05-15 13:32:26,407 [INFO] - Training epoch stats:     Loss: 0.0564 - F1-Score: 0.9799 - Accuracy-Score: 0.9799 - AUROC: 0.9991 - AP: 0.9983
[37m2024-05-15 13:32:26,475 [INFO] - Validation epoch stats:   Loss: 0.7336 - F1-Score: 0.8666 - Accuracy-Score: 0.8666 - AUROC: 0.9625 - AP: 0.8660
[37m2024-05-15 13:32:26,591 [INFO] - Epoch: 21/50
[37m2024-05-15 13:32:26,995 [INFO] - Training epoch stats:     Loss: 0.0518 - F1-Score: 0.9807 - Accuracy-Score: 0.9807 - AUROC: 0.9993 - AP: 0.9986
[37m2024-05-15 13:32:27,070 [INFO] - Validation epoch stats:   Loss: 0.6666 - F1-Score: 0.8735 - Accuracy-Score: 0.8735 - AUROC: 0.9608 - AP: 0.8525
[37m2024-05-15 13:32:27,195 [INFO] - Epoch: 22/50
[37m2024-05-15 13:32:27,596 [INFO] - Training epoch stats:     Loss: 0.0482 - F1-Score: 0.9822 - Accuracy-Score: 0.9822 - AUROC: 0.9993 - AP: 0.9988
[37m2024-05-15 13:32:27,663 [INFO] - Validation epoch stats:   Loss: 0.7671 - F1-Score: 0.8625 - Accuracy-Score: 0.8625 - AUROC: 0.9603 - AP: 0.8516
[37m2024-05-15 13:32:27,779 [INFO] - Epoch: 23/50
[37m2024-05-15 13:32:28,150 [INFO] - Training epoch stats:     Loss: 0.0449 - F1-Score: 0.9833 - Accuracy-Score: 0.9833 - AUROC: 0.9994 - AP: 0.9989
[37m2024-05-15 13:32:28,215 [INFO] - Validation epoch stats:   Loss: 0.7497 - F1-Score: 0.8744 - Accuracy-Score: 0.8744 - AUROC: 0.9639 - AP: 0.8705
[37m2024-05-15 13:32:28,227 [INFO] - Performing early stopping!
[37m2024-05-15 13:32:28,239 [INFO] - Finished run q9x92z7l
