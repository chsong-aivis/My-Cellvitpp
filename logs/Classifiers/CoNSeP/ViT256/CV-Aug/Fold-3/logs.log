[37m2024-05-16 06:24:32,901 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-05-16 06:24:32,902 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/ViT256/Setting-2-Aug/2024-05-16T062420_Fold-3
[37m2024-05-16 06:24:32,984 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f56a52ba7a0>]
[37m2024-05-16 06:24:32,995 [INFO] - Using GPU: cuda:0
[37m2024-05-16 06:24:33,005 [INFO] - Using device: cuda:0
[37m2024-05-16 06:24:33,015 [INFO] - Loss function:
[37m2024-05-16 06:24:33,025 [INFO] - CrossEntropyLoss()
[37m2024-05-16 06:24:34,278 [INFO] - <All keys matched successfully>
[37m2024-05-16 06:24:34,522 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  49,280
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 49,796
Trainable params: 49,796
Non-trainable params: 0
Total mult-adds (M): 0.05
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.20
Estimated Total Size (MB): 0.20
==========================================================================================
[37m2024-05-16 06:24:34,523 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-05-16 06:24:34,532 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.005, 'weight_decay': 0.0008}
[37m2024-05-16 06:24:34,542 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-05-16 06:24:34,566 [INFO] - Caching datasets
[37m2024-05-16 06:24:35,738 [INFO] - Instantiate Trainer
[37m2024-05-16 06:24:35,741 [INFO] - Calling Trainer Fit
[37m2024-05-16 06:24:35,748 [INFO] - Starting training, total number of epochs: 50
[37m2024-05-16 06:24:35,758 [INFO] - Epoch: 1/50
[37m2024-05-16 06:24:35,767 [INFO] - Extracting training cells
[37m2024-05-16 06:24:58,017 [INFO] - Extraction detection metrics - F1: 0.744, Precision: 0.841, Recall: 0.693, Detected-Cells: 8244
[37m2024-05-16 06:24:58,430 [INFO] - Training epoch stats:     Loss: 0.4907 - F1-Score: 0.8071 - Accuracy-Score: 0.8071 - AUROC: 0.9214 - AP: 0.7230
[37m2024-05-16 06:24:58,631 [INFO] - Loaded dataset from cache: /Consep/cache/4dd84cca526a7f6c5e3638b8d2fa106bbbd69a3b40c3586769052cf9ad3eb178.h5
[37m2024-05-16 06:24:58,703 [INFO] - Validation epoch stats:   Loss: 0.7541 - F1-Score: 0.7147 - Accuracy-Score: 0.7147 - AUROC: 0.8793 - AP: 0.5988
[37m2024-05-16 06:24:58,704 [INFO] - New best model - save checkpoint
[37m2024-05-16 06:24:58,863 [INFO] - Epoch: 2/50
[37m2024-05-16 06:24:58,865 [INFO] - Extracting training cells
[37m2024-05-16 06:25:11,326 [INFO] - Extraction detection metrics - F1: 0.727, Precision: 0.822, Recall: 0.679, Detected-Cells: 7225
[37m2024-05-16 06:25:11,726 [INFO] - Training epoch stats:     Loss: 0.3575 - F1-Score: 0.8538 - Accuracy-Score: 0.8538 - AUROC: 0.9628 - AP: 0.8496
[37m2024-05-16 06:25:11,869 [INFO] - Validation epoch stats:   Loss: 0.7912 - F1-Score: 0.6824 - Accuracy-Score: 0.6824 - AUROC: 0.8871 - AP: 0.5977
[37m2024-05-16 06:25:11,870 [INFO] - New best model - save checkpoint
[37m2024-05-16 06:25:12,018 [INFO] - Epoch: 3/50
[37m2024-05-16 06:25:12,018 [INFO] - Extracting training cells
[37m2024-05-16 06:25:25,651 [INFO] - Extraction detection metrics - F1: 0.742, Precision: 0.835, Recall: 0.695, Detected-Cells: 8329
[37m2024-05-16 06:25:26,087 [INFO] - Training epoch stats:     Loss: 0.3373 - F1-Score: 0.8667 - Accuracy-Score: 0.8667 - AUROC: 0.9683 - AP: 0.8595
[37m2024-05-16 06:25:26,242 [INFO] - Validation epoch stats:   Loss: 0.7109 - F1-Score: 0.7102 - Accuracy-Score: 0.7102 - AUROC: 0.8965 - AP: 0.6060
[37m2024-05-16 06:25:26,243 [INFO] - New best model - save checkpoint
[37m2024-05-16 06:25:26,407 [INFO] - Epoch: 4/50
[37m2024-05-16 06:25:26,408 [INFO] - Extracting training cells
[37m2024-05-16 06:25:39,556 [INFO] - Extraction detection metrics - F1: 0.740, Precision: 0.814, Recall: 0.702, Detected-Cells: 8018
[37m2024-05-16 06:25:40,001 [INFO] - Training epoch stats:     Loss: 0.3210 - F1-Score: 0.8734 - Accuracy-Score: 0.8734 - AUROC: 0.9706 - AP: 0.8777
[37m2024-05-16 06:25:40,148 [INFO] - Validation epoch stats:   Loss: 0.8632 - F1-Score: 0.6546 - Accuracy-Score: 0.6546 - AUROC: 0.8837 - AP: 0.5881
[37m2024-05-16 06:25:40,180 [INFO] - Epoch: 5/50
[37m2024-05-16 06:25:40,180 [INFO] - Extracting training cells
[37m2024-05-16 06:25:53,349 [INFO] - Extraction detection metrics - F1: 0.736, Precision: 0.839, Recall: 0.682, Detected-Cells: 8115
[37m2024-05-16 06:25:53,659 [INFO] - Training epoch stats:     Loss: 0.3007 - F1-Score: 0.8765 - Accuracy-Score: 0.8765 - AUROC: 0.9754 - AP: 0.8965
[37m2024-05-16 06:25:53,760 [INFO] - Validation epoch stats:   Loss: 0.9269 - F1-Score: 0.6391 - Accuracy-Score: 0.6391 - AUROC: 0.8736 - AP: 0.5703
[37m2024-05-16 06:25:53,793 [INFO] - Epoch: 6/50
[37m2024-05-16 06:25:53,793 [INFO] - Extracting training cells
[37m2024-05-16 06:26:07,907 [INFO] - Extraction detection metrics - F1: 0.741, Precision: 0.832, Recall: 0.700, Detected-Cells: 8326
[37m2024-05-16 06:26:08,188 [INFO] - Training epoch stats:     Loss: 0.2920 - F1-Score: 0.8837 - Accuracy-Score: 0.8837 - AUROC: 0.9770 - AP: 0.9016
[37m2024-05-16 06:26:08,287 [INFO] - Validation epoch stats:   Loss: 0.6960 - F1-Score: 0.7162 - Accuracy-Score: 0.7162 - AUROC: 0.8968 - AP: 0.6143
[37m2024-05-16 06:26:08,290 [INFO] - New best model - save checkpoint
[37m2024-05-16 06:26:08,443 [INFO] - Epoch: 7/50
[37m2024-05-16 06:26:08,444 [INFO] - Extracting training cells
[37m2024-05-16 06:26:22,007 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.813, Recall: 0.679, Detected-Cells: 7846
[37m2024-05-16 06:26:22,271 [INFO] - Training epoch stats:     Loss: 0.3223 - F1-Score: 0.8715 - Accuracy-Score: 0.8715 - AUROC: 0.9728 - AP: 0.9010
[37m2024-05-16 06:26:22,369 [INFO] - Validation epoch stats:   Loss: 0.7169 - F1-Score: 0.7066 - Accuracy-Score: 0.7066 - AUROC: 0.9117 - AP: 0.6344
[37m2024-05-16 06:26:22,370 [INFO] - New best model - save checkpoint
[37m2024-05-16 06:26:22,534 [INFO] - Epoch: 8/50
[37m2024-05-16 06:26:22,535 [INFO] - Extracting training cells
[37m2024-05-16 06:26:35,963 [INFO] - Extraction detection metrics - F1: 0.739, Precision: 0.836, Recall: 0.693, Detected-Cells: 8393
[37m2024-05-16 06:26:36,292 [INFO] - Training epoch stats:     Loss: 0.2848 - F1-Score: 0.8847 - Accuracy-Score: 0.8847 - AUROC: 0.9775 - AP: 0.9114
[37m2024-05-16 06:26:36,416 [INFO] - Validation epoch stats:   Loss: 0.7630 - F1-Score: 0.6941 - Accuracy-Score: 0.6941 - AUROC: 0.9050 - AP: 0.6226
[37m2024-05-16 06:26:36,452 [INFO] - Epoch: 9/50
[37m2024-05-16 06:26:36,452 [INFO] - Extracting training cells
[37m2024-05-16 06:26:49,895 [INFO] - Extraction detection metrics - F1: 0.733, Precision: 0.831, Recall: 0.685, Detected-Cells: 8238
[37m2024-05-16 06:26:50,210 [INFO] - Training epoch stats:     Loss: 0.2857 - F1-Score: 0.8858 - Accuracy-Score: 0.8858 - AUROC: 0.9780 - AP: 0.9153
[37m2024-05-16 06:26:50,328 [INFO] - Validation epoch stats:   Loss: 0.9860 - F1-Score: 0.6334 - Accuracy-Score: 0.6334 - AUROC: 0.8850 - AP: 0.5906
[37m2024-05-16 06:26:50,366 [INFO] - Epoch: 10/50
[37m2024-05-16 06:26:50,367 [INFO] - Extracting training cells
[37m2024-05-16 06:27:05,370 [INFO] - Extraction detection metrics - F1: 0.733, Precision: 0.812, Recall: 0.686, Detected-Cells: 8093
[37m2024-05-16 06:27:05,656 [INFO] - Training epoch stats:     Loss: 0.3132 - F1-Score: 0.8685 - Accuracy-Score: 0.8685 - AUROC: 0.9726 - AP: 0.8970
[37m2024-05-16 06:27:05,768 [INFO] - Validation epoch stats:   Loss: 1.0184 - F1-Score: 0.5996 - Accuracy-Score: 0.5996 - AUROC: 0.8724 - AP: 0.5717
[37m2024-05-16 06:27:05,804 [INFO] - Epoch: 11/50
[37m2024-05-16 06:27:05,805 [INFO] - Extracting training cells
[37m2024-05-16 06:27:19,069 [INFO] - Extraction detection metrics - F1: 0.742, Precision: 0.821, Recall: 0.704, Detected-Cells: 7579
[37m2024-05-16 06:27:19,318 [INFO] - Training epoch stats:     Loss: 0.3048 - F1-Score: 0.8725 - Accuracy-Score: 0.8725 - AUROC: 0.9757 - AP: 0.9194
[37m2024-05-16 06:27:19,393 [INFO] - Validation epoch stats:   Loss: 1.1774 - F1-Score: 0.5617 - Accuracy-Score: 0.5617 - AUROC: 0.8714 - AP: 0.5683
[37m2024-05-16 06:27:19,426 [INFO] - Epoch: 12/50
[37m2024-05-16 06:27:19,427 [INFO] - Extracting training cells
[37m2024-05-16 06:27:32,119 [INFO] - Extraction detection metrics - F1: 0.738, Precision: 0.818, Recall: 0.701, Detected-Cells: 8168
[37m2024-05-16 06:27:32,422 [INFO] - Training epoch stats:     Loss: 0.2812 - F1-Score: 0.8869 - Accuracy-Score: 0.8869 - AUROC: 0.9777 - AP: 0.8976
[37m2024-05-16 06:27:32,521 [INFO] - Validation epoch stats:   Loss: 1.0543 - F1-Score: 0.6125 - Accuracy-Score: 0.6125 - AUROC: 0.8765 - AP: 0.5721
[37m2024-05-16 06:27:32,559 [INFO] - Epoch: 13/50
[37m2024-05-16 06:27:32,559 [INFO] - Extracting training cells
[37m2024-05-16 06:27:46,329 [INFO] - Extraction detection metrics - F1: 0.741, Precision: 0.833, Recall: 0.693, Detected-Cells: 8276
[37m2024-05-16 06:27:46,641 [INFO] - Training epoch stats:     Loss: 0.2663 - F1-Score: 0.8905 - Accuracy-Score: 0.8905 - AUROC: 0.9808 - AP: 0.9145
[37m2024-05-16 06:27:46,749 [INFO] - Validation epoch stats:   Loss: 1.3677 - F1-Score: 0.5632 - Accuracy-Score: 0.5632 - AUROC: 0.8702 - AP: 0.5535
[37m2024-05-16 06:27:46,785 [INFO] - Epoch: 14/50
[37m2024-05-16 06:27:46,786 [INFO] - Extracting training cells
[37m2024-05-16 06:28:00,631 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.783, Recall: 0.668, Detected-Cells: 6973
[37m2024-05-16 06:28:00,909 [INFO] - Training epoch stats:     Loss: 0.3158 - F1-Score: 0.8727 - Accuracy-Score: 0.8727 - AUROC: 0.9737 - AP: 0.9139
[37m2024-05-16 06:28:01,009 [INFO] - Validation epoch stats:   Loss: 1.3940 - F1-Score: 0.5244 - Accuracy-Score: 0.5244 - AUROC: 0.8566 - AP: 0.5401
[37m2024-05-16 06:28:01,042 [INFO] - Epoch: 15/50
[37m2024-05-16 06:28:01,042 [INFO] - Extracting training cells
[37m2024-05-16 06:28:14,765 [INFO] - Extraction detection metrics - F1: 0.749, Precision: 0.830, Recall: 0.707, Detected-Cells: 8432
[37m2024-05-16 06:28:15,030 [INFO] - Training epoch stats:     Loss: 0.2569 - F1-Score: 0.8960 - Accuracy-Score: 0.8960 - AUROC: 0.9820 - AP: 0.9271
[37m2024-05-16 06:28:15,111 [INFO] - Validation epoch stats:   Loss: 1.7149 - F1-Score: 0.5142 - Accuracy-Score: 0.5142 - AUROC: 0.8363 - AP: 0.5138
[37m2024-05-16 06:28:15,145 [INFO] - Epoch: 16/50
[37m2024-05-16 06:28:15,145 [INFO] - Extracting training cells
[37m2024-05-16 06:28:29,838 [INFO] - Extraction detection metrics - F1: 0.726, Precision: 0.834, Recall: 0.673, Detected-Cells: 8218
[37m2024-05-16 06:28:30,116 [INFO] - Training epoch stats:     Loss: 0.2597 - F1-Score: 0.8913 - Accuracy-Score: 0.8913 - AUROC: 0.9820 - AP: 0.9254
[37m2024-05-16 06:28:30,222 [INFO] - Validation epoch stats:   Loss: 2.1346 - F1-Score: 0.4437 - Accuracy-Score: 0.4437 - AUROC: 0.8272 - AP: 0.4931
[37m2024-05-16 06:28:30,258 [INFO] - Epoch: 17/50
[37m2024-05-16 06:28:30,258 [INFO] - Extracting training cells
[37m2024-05-16 06:28:42,678 [INFO] - Extraction detection metrics - F1: 0.726, Precision: 0.807, Recall: 0.691, Detected-Cells: 7388
[37m2024-05-16 06:28:42,930 [INFO] - Training epoch stats:     Loss: 0.3521 - F1-Score: 0.8523 - Accuracy-Score: 0.8523 - AUROC: 0.9615 - AP: 0.8649
[37m2024-05-16 06:28:43,026 [INFO] - Validation epoch stats:   Loss: 1.1700 - F1-Score: 0.5378 - Accuracy-Score: 0.5378 - AUROC: 0.8591 - AP: 0.5428
[37m2024-05-16 06:28:43,060 [INFO] - Epoch: 18/50
[37m2024-05-16 06:28:43,060 [INFO] - Extracting training cells
[37m2024-05-16 06:28:56,255 [INFO] - Extraction detection metrics - F1: 0.746, Precision: 0.821, Recall: 0.708, Detected-Cells: 8433
[37m2024-05-16 06:28:56,530 [INFO] - Training epoch stats:     Loss: 0.2505 - F1-Score: 0.9019 - Accuracy-Score: 0.9019 - AUROC: 0.9820 - AP: 0.9276
[37m2024-05-16 06:28:56,627 [INFO] - Validation epoch stats:   Loss: 1.2931 - F1-Score: 0.5668 - Accuracy-Score: 0.5668 - AUROC: 0.8674 - AP: 0.5356
[37m2024-05-16 06:28:56,665 [INFO] - Epoch: 19/50
[37m2024-05-16 06:28:56,666 [INFO] - Extracting training cells
[37m2024-05-16 06:29:09,499 [INFO] - Extraction detection metrics - F1: 0.743, Precision: 0.823, Recall: 0.703, Detected-Cells: 8428
[37m2024-05-16 06:29:09,740 [INFO] - Training epoch stats:     Loss: 0.2369 - F1-Score: 0.9022 - Accuracy-Score: 0.9022 - AUROC: 0.9845 - AP: 0.9374
[37m2024-05-16 06:29:09,821 [INFO] - Validation epoch stats:   Loss: 1.5723 - F1-Score: 0.5190 - Accuracy-Score: 0.5190 - AUROC: 0.8551 - AP: 0.5278
[37m2024-05-16 06:29:09,857 [INFO] - Epoch: 20/50
[37m2024-05-16 06:29:09,857 [INFO] - Extracting training cells
[37m2024-05-16 06:29:23,234 [INFO] - Extraction detection metrics - F1: 0.712, Precision: 0.813, Recall: 0.663, Detected-Cells: 7530
[37m2024-05-16 06:29:23,453 [INFO] - Training epoch stats:     Loss: 0.2448 - F1-Score: 0.9028 - Accuracy-Score: 0.9028 - AUROC: 0.9825 - AP: 0.9301
[37m2024-05-16 06:29:23,531 [INFO] - Validation epoch stats:   Loss: 1.9950 - F1-Score: 0.4670 - Accuracy-Score: 0.4670 - AUROC: 0.8297 - AP: 0.4859
[37m2024-05-16 06:29:23,564 [INFO] - Epoch: 21/50
[37m2024-05-16 06:29:23,564 [INFO] - Extracting training cells
[37m2024-05-16 06:29:36,069 [INFO] - Extraction detection metrics - F1: 0.740, Precision: 0.821, Recall: 0.700, Detected-Cells: 7533
[37m2024-05-16 06:29:36,478 [INFO] - Training epoch stats:     Loss: 0.3019 - F1-Score: 0.8756 - Accuracy-Score: 0.8756 - AUROC: 0.9757 - AP: 0.9047
[37m2024-05-16 06:29:36,632 [INFO] - Validation epoch stats:   Loss: 2.0186 - F1-Score: 0.4401 - Accuracy-Score: 0.4401 - AUROC: 0.8287 - AP: 0.4687
[37m2024-05-16 06:29:36,667 [INFO] - Epoch: 22/50
[37m2024-05-16 06:29:36,667 [INFO] - Extracting training cells
[37m2024-05-16 06:29:52,632 [INFO] - Extraction detection metrics - F1: 0.727, Precision: 0.834, Recall: 0.680, Detected-Cells: 8326
[37m2024-05-16 06:29:53,050 [INFO] - Training epoch stats:     Loss: 0.2429 - F1-Score: 0.8994 - Accuracy-Score: 0.8994 - AUROC: 0.9838 - AP: 0.9340
[37m2024-05-16 06:29:53,128 [INFO] - Validation epoch stats:   Loss: 2.0474 - F1-Score: 0.4491 - Accuracy-Score: 0.4491 - AUROC: 0.8207 - AP: 0.4781
[37m2024-05-16 06:29:53,162 [INFO] - Epoch: 23/50
[37m2024-05-16 06:29:53,163 [INFO] - Extracting training cells
[37m2024-05-16 06:30:06,618 [INFO] - Extraction detection metrics - F1: 0.748, Precision: 0.830, Recall: 0.709, Detected-Cells: 8422
[37m2024-05-16 06:30:06,858 [INFO] - Training epoch stats:     Loss: 0.2301 - F1-Score: 0.9057 - Accuracy-Score: 0.9057 - AUROC: 0.9852 - AP: 0.9371
[37m2024-05-16 06:30:06,942 [INFO] - Validation epoch stats:   Loss: 1.8207 - F1-Score: 0.4966 - Accuracy-Score: 0.4966 - AUROC: 0.8338 - AP: 0.4942
[37m2024-05-16 06:30:06,973 [INFO] - Epoch: 24/50
[37m2024-05-16 06:30:06,973 [INFO] - Extracting training cells
[37m2024-05-16 06:30:21,306 [INFO] - Extraction detection metrics - F1: 0.739, Precision: 0.832, Recall: 0.687, Detected-Cells: 6912
[37m2024-05-16 06:30:21,532 [INFO] - Training epoch stats:     Loss: 0.2509 - F1-Score: 0.8903 - Accuracy-Score: 0.8903 - AUROC: 0.9818 - AP: 0.9244
[37m2024-05-16 06:30:21,623 [INFO] - Validation epoch stats:   Loss: 1.5151 - F1-Score: 0.5438 - Accuracy-Score: 0.5438 - AUROC: 0.8313 - AP: 0.4920
[37m2024-05-16 06:30:21,661 [INFO] - Epoch: 25/50
[37m2024-05-16 06:30:21,661 [INFO] - Extracting training cells
[37m2024-05-16 06:30:35,587 [INFO] - Extraction detection metrics - F1: 0.739, Precision: 0.845, Recall: 0.677, Detected-Cells: 7784
[37m2024-05-16 06:30:36,011 [INFO] - Training epoch stats:     Loss: 0.2507 - F1-Score: 0.9049 - Accuracy-Score: 0.9049 - AUROC: 0.9832 - AP: 0.9403
[37m2024-05-16 06:30:36,159 [INFO] - Validation epoch stats:   Loss: 2.0495 - F1-Score: 0.4514 - Accuracy-Score: 0.4514 - AUROC: 0.8281 - AP: 0.4874
[37m2024-05-16 06:30:36,195 [INFO] - Epoch: 26/50
[37m2024-05-16 06:30:36,196 [INFO] - Extracting training cells
[37m2024-05-16 06:30:50,765 [INFO] - Extraction detection metrics - F1: 0.745, Precision: 0.842, Recall: 0.697, Detected-Cells: 8117
[37m2024-05-16 06:30:51,070 [INFO] - Training epoch stats:     Loss: 0.3715 - F1-Score: 0.8805 - Accuracy-Score: 0.8805 - AUROC: 0.9685 - AP: 0.8546
[37m2024-05-16 06:30:51,168 [INFO] - Validation epoch stats:   Loss: 1.7539 - F1-Score: 0.4852 - Accuracy-Score: 0.4852 - AUROC: 0.8292 - AP: 0.4824
[37m2024-05-16 06:30:51,200 [INFO] - Epoch: 27/50
[37m2024-05-16 06:30:51,200 [INFO] - Extracting training cells
[37m2024-05-16 06:31:04,892 [INFO] - Extraction detection metrics - F1: 0.740, Precision: 0.856, Recall: 0.686, Detected-Cells: 8241
[37m2024-05-16 06:31:05,165 [INFO] - Training epoch stats:     Loss: 0.2151 - F1-Score: 0.9143 - Accuracy-Score: 0.9143 - AUROC: 0.9880 - AP: 0.9538
[37m2024-05-16 06:31:05,260 [INFO] - Validation epoch stats:   Loss: 1.8696 - F1-Score: 0.4825 - Accuracy-Score: 0.4825 - AUROC: 0.8344 - AP: 0.4883
[37m2024-05-16 06:31:05,261 [INFO] - Performing early stopping!
[37m2024-05-16 06:31:05,270 [INFO] - Finished run pxta0gvp
