[37m2024-08-14 08:32:07,527 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-14 08:32:07,528 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow2/CV-Aug/2024-08-14T083159_Fold-0
[37m2024-08-14 08:32:07,593 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fd408fd44f0>]
[37m2024-08-14 08:32:07,598 [INFO] - Using GPU: cuda:0
[37m2024-08-14 08:32:07,603 [INFO] - Using device: cuda:0
[37m2024-08-14 08:32:07,608 [INFO] - Loss function:
[37m2024-08-14 08:32:07,612 [INFO] - CrossEntropyLoss()
[37m2024-08-14 08:32:17,874 [INFO] - <All keys matched successfully>
[37m2024-08-14 08:32:20,124 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-14 08:32:20,130 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-14 08:32:20,135 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00568059820179996, 'weight_decay': 0.0004714549691487939}
[37m2024-08-14 08:32:20,140 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-14 08:32:20,156 [INFO] - Caching datasets
[37m2024-08-14 08:32:21,592 [INFO] - Instantiate Trainer
[37m2024-08-14 08:32:21,605 [INFO] - Calling Trainer Fit
[37m2024-08-14 08:32:21,611 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-14 08:32:21,617 [INFO] - Epoch: 1/50
[37m2024-08-14 08:32:21,622 [INFO] - Extracting training cells
[37m2024-08-14 08:33:05,586 [INFO] - Extraction detection metrics - F1: 0.697, Precision: 0.761, Recall: 0.680, Detected-Cells: 8347
[37m2024-08-14 08:33:06,164 [INFO] - Training epoch stats:     Loss: 0.3916 - F1-Score: 0.8429 - Accuracy-Score: 0.8429 - AUROC: 0.9484 - AP: 0.8262
[37m2024-08-14 08:33:06,682 [INFO] - Loaded dataset from cache: /Consep/cache/0e75821d52298e551780939bf7e8b1149736c0505386fad781a094a4d83b27cc.h5
[37m2024-08-14 08:33:07,069 [INFO] - Validation epoch stats:   Loss: 0.5259 - F1-Score: 0.8107 - Accuracy-Score: 0.8107 - AUROC: 0.9568 - AP: 0.8708
[37m2024-08-14 08:33:07,076 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:33:07,249 [INFO] - Epoch: 2/50
[37m2024-08-14 08:33:07,255 [INFO] - Extracting training cells
[37m2024-08-14 08:33:28,827 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.777, Recall: 0.678, Detected-Cells: 8609
[37m2024-08-14 08:33:29,292 [INFO] - Training epoch stats:     Loss: 0.2732 - F1-Score: 0.8921 - Accuracy-Score: 0.8921 - AUROC: 0.9756 - AP: 0.9150
[37m2024-08-14 08:33:29,431 [INFO] - Validation epoch stats:   Loss: 0.3680 - F1-Score: 0.8846 - Accuracy-Score: 0.8846 - AUROC: 0.9635 - AP: 0.8941
[37m2024-08-14 08:33:29,438 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:33:29,604 [INFO] - Epoch: 3/50
[37m2024-08-14 08:33:29,610 [INFO] - Extracting training cells
[37m2024-08-14 08:33:51,711 [INFO] - Extraction detection metrics - F1: 0.698, Precision: 0.769, Recall: 0.667, Detected-Cells: 8705
[37m2024-08-14 08:33:52,356 [INFO] - Training epoch stats:     Loss: 0.2554 - F1-Score: 0.8949 - Accuracy-Score: 0.8949 - AUROC: 0.9797 - AP: 0.9231
[37m2024-08-14 08:33:52,453 [INFO] - Validation epoch stats:   Loss: 0.3927 - F1-Score: 0.8668 - Accuracy-Score: 0.8668 - AUROC: 0.9696 - AP: 0.8880
[37m2024-08-14 08:33:52,461 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:33:52,615 [INFO] - Epoch: 4/50
[37m2024-08-14 08:33:52,621 [INFO] - Extracting training cells
[37m2024-08-14 08:34:15,212 [INFO] - Extraction detection metrics - F1: 0.687, Precision: 0.752, Recall: 0.653, Detected-Cells: 8118
[37m2024-08-14 08:34:15,510 [INFO] - Training epoch stats:     Loss: 0.3280 - F1-Score: 0.8651 - Accuracy-Score: 0.8651 - AUROC: 0.9713 - AP: 0.9130
[37m2024-08-14 08:34:15,581 [INFO] - Validation epoch stats:   Loss: 0.4322 - F1-Score: 0.8631 - Accuracy-Score: 0.8631 - AUROC: 0.9629 - AP: 0.8823
[37m2024-08-14 08:34:15,652 [INFO] - Epoch: 5/50
[37m2024-08-14 08:34:15,657 [INFO] - Extracting training cells
[37m2024-08-14 08:34:36,075 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.774, Recall: 0.695, Detected-Cells: 8537
[37m2024-08-14 08:34:36,333 [INFO] - Training epoch stats:     Loss: 0.2783 - F1-Score: 0.8894 - Accuracy-Score: 0.8894 - AUROC: 0.9795 - AP: 0.9266
[37m2024-08-14 08:34:36,404 [INFO] - Validation epoch stats:   Loss: 0.4975 - F1-Score: 0.8210 - Accuracy-Score: 0.8210 - AUROC: 0.9536 - AP: 0.8647
[37m2024-08-14 08:34:36,469 [INFO] - Epoch: 6/50
[37m2024-08-14 08:34:36,477 [INFO] - Extracting training cells
[37m2024-08-14 08:34:57,109 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.782, Recall: 0.669, Detected-Cells: 8646
[37m2024-08-14 08:34:57,372 [INFO] - Training epoch stats:     Loss: 0.2620 - F1-Score: 0.8969 - Accuracy-Score: 0.8969 - AUROC: 0.9797 - AP: 0.9385
[37m2024-08-14 08:34:57,437 [INFO] - Validation epoch stats:   Loss: 0.3805 - F1-Score: 0.8855 - Accuracy-Score: 0.8855 - AUROC: 0.9615 - AP: 0.8769
[37m2024-08-14 08:34:57,506 [INFO] - Epoch: 7/50
[37m2024-08-14 08:34:57,512 [INFO] - Extracting training cells
[37m2024-08-14 08:35:22,009 [INFO] - Extraction detection metrics - F1: 0.705, Precision: 0.771, Recall: 0.679, Detected-Cells: 8696
[37m2024-08-14 08:35:22,340 [INFO] - Training epoch stats:     Loss: 0.2517 - F1-Score: 0.8951 - Accuracy-Score: 0.8951 - AUROC: 0.9826 - AP: 0.9435
[37m2024-08-14 08:35:22,420 [INFO] - Validation epoch stats:   Loss: 0.4081 - F1-Score: 0.8822 - Accuracy-Score: 0.8822 - AUROC: 0.9606 - AP: 0.8415
[37m2024-08-14 08:35:22,487 [INFO] - Epoch: 8/50
[37m2024-08-14 08:35:22,492 [INFO] - Extracting training cells
[37m2024-08-14 08:35:45,738 [INFO] - Extraction detection metrics - F1: 0.696, Precision: 0.753, Recall: 0.680, Detected-Cells: 8643
[37m2024-08-14 08:35:46,053 [INFO] - Training epoch stats:     Loss: 0.3206 - F1-Score: 0.8793 - Accuracy-Score: 0.8793 - AUROC: 0.9728 - AP: 0.8552
[37m2024-08-14 08:35:46,133 [INFO] - Validation epoch stats:   Loss: 0.4386 - F1-Score: 0.8682 - Accuracy-Score: 0.8682 - AUROC: 0.9633 - AP: 0.8562
[37m2024-08-14 08:35:46,200 [INFO] - Epoch: 9/50
[37m2024-08-14 08:35:46,205 [INFO] - Extracting training cells
[37m2024-08-14 08:36:10,568 [INFO] - Extraction detection metrics - F1: 0.723, Precision: 0.779, Recall: 0.701, Detected-Cells: 8975
[37m2024-08-14 08:36:10,909 [INFO] - Training epoch stats:     Loss: 0.2281 - F1-Score: 0.9022 - Accuracy-Score: 0.9022 - AUROC: 0.9859 - AP: 0.9481
[37m2024-08-14 08:36:10,990 [INFO] - Validation epoch stats:   Loss: 0.4416 - F1-Score: 0.8734 - Accuracy-Score: 0.8734 - AUROC: 0.9654 - AP: 0.8683
[37m2024-08-14 08:36:11,052 [INFO] - Epoch: 10/50
[37m2024-08-14 08:36:11,058 [INFO] - Extracting training cells
[37m2024-08-14 08:36:33,187 [INFO] - Extraction detection metrics - F1: 0.702, Precision: 0.773, Recall: 0.669, Detected-Cells: 8953
[37m2024-08-14 08:36:33,659 [INFO] - Training epoch stats:     Loss: 0.2189 - F1-Score: 0.9087 - Accuracy-Score: 0.9087 - AUROC: 0.9869 - AP: 0.9486
[37m2024-08-14 08:36:33,776 [INFO] - Validation epoch stats:   Loss: 0.3821 - F1-Score: 0.8776 - Accuracy-Score: 0.8776 - AUROC: 0.9664 - AP: 0.8904
[37m2024-08-14 08:36:33,844 [INFO] - Epoch: 11/50
[37m2024-08-14 08:36:33,849 [INFO] - Extracting training cells
[37m2024-08-14 08:36:54,966 [INFO] - Extraction detection metrics - F1: 0.705, Precision: 0.769, Recall: 0.687, Detected-Cells: 7169
[37m2024-08-14 08:36:55,229 [INFO] - Training epoch stats:     Loss: 0.3961 - F1-Score: 0.8570 - Accuracy-Score: 0.8570 - AUROC: 0.9598 - AP: 0.8089
[37m2024-08-14 08:36:55,306 [INFO] - Validation epoch stats:   Loss: 0.5050 - F1-Score: 0.8654 - Accuracy-Score: 0.8654 - AUROC: 0.9523 - AP: 0.7981
[37m2024-08-14 08:36:55,371 [INFO] - Epoch: 12/50
[37m2024-08-14 08:36:55,376 [INFO] - Extracting training cells
[37m2024-08-14 08:37:17,161 [INFO] - Extraction detection metrics - F1: 0.680, Precision: 0.763, Recall: 0.651, Detected-Cells: 7857
[37m2024-08-14 08:37:17,445 [INFO] - Training epoch stats:     Loss: 0.2540 - F1-Score: 0.9062 - Accuracy-Score: 0.9062 - AUROC: 0.9834 - AP: 0.9305
[37m2024-08-14 08:37:17,525 [INFO] - Validation epoch stats:   Loss: 0.4396 - F1-Score: 0.8607 - Accuracy-Score: 0.8607 - AUROC: 0.9602 - AP: 0.8434
[37m2024-08-14 08:37:17,600 [INFO] - Epoch: 13/50
[37m2024-08-14 08:37:17,605 [INFO] - Extracting training cells
[37m2024-08-14 08:37:38,051 [INFO] - Extraction detection metrics - F1: 0.693, Precision: 0.756, Recall: 0.671, Detected-Cells: 8229
[37m2024-08-14 08:37:38,304 [INFO] - Training epoch stats:     Loss: 0.2469 - F1-Score: 0.9045 - Accuracy-Score: 0.9045 - AUROC: 0.9846 - AP: 0.9536
[37m2024-08-14 08:37:38,370 [INFO] - Validation epoch stats:   Loss: 0.5441 - F1-Score: 0.8397 - Accuracy-Score: 0.8397 - AUROC: 0.9507 - AP: 0.7966
[37m2024-08-14 08:37:38,439 [INFO] - Epoch: 14/50
[37m2024-08-14 08:37:38,444 [INFO] - Extracting training cells
[37m2024-08-14 08:37:59,538 [INFO] - Extraction detection metrics - F1: 0.703, Precision: 0.779, Recall: 0.674, Detected-Cells: 8884
[37m2024-08-14 08:38:00,059 [INFO] - Training epoch stats:     Loss: 0.2228 - F1-Score: 0.9075 - Accuracy-Score: 0.9075 - AUROC: 0.9871 - AP: 0.9626
[37m2024-08-14 08:38:00,137 [INFO] - Validation epoch stats:   Loss: 0.6084 - F1-Score: 0.8070 - Accuracy-Score: 0.8070 - AUROC: 0.9631 - AP: 0.8452
[37m2024-08-14 08:38:00,208 [INFO] - Epoch: 15/50
[37m2024-08-14 08:38:00,213 [INFO] - Extracting training cells
[37m2024-08-14 08:38:20,446 [INFO] - Extraction detection metrics - F1: 0.686, Precision: 0.731, Recall: 0.682, Detected-Cells: 8426
[37m2024-08-14 08:38:20,775 [INFO] - Training epoch stats:     Loss: 0.2378 - F1-Score: 0.8911 - Accuracy-Score: 0.8911 - AUROC: 0.9844 - AP: 0.9564
[37m2024-08-14 08:38:20,844 [INFO] - Validation epoch stats:   Loss: 0.4826 - F1-Score: 0.8617 - Accuracy-Score: 0.8617 - AUROC: 0.9647 - AP: 0.8581
[37m2024-08-14 08:38:20,910 [INFO] - Epoch: 16/50
[37m2024-08-14 08:38:20,915 [INFO] - Extracting training cells
[37m2024-08-14 08:38:41,839 [INFO] - Extraction detection metrics - F1: 0.672, Precision: 0.747, Recall: 0.644, Detected-Cells: 7835
[37m2024-08-14 08:38:42,124 [INFO] - Training epoch stats:     Loss: 0.3284 - F1-Score: 0.8687 - Accuracy-Score: 0.8687 - AUROC: 0.9774 - AP: 0.9440
[37m2024-08-14 08:38:42,201 [INFO] - Validation epoch stats:   Loss: 0.6665 - F1-Score: 0.7341 - Accuracy-Score: 0.7341 - AUROC: 0.9246 - AP: 0.7639
[37m2024-08-14 08:38:42,264 [INFO] - Epoch: 17/50
[37m2024-08-14 08:38:42,269 [INFO] - Extracting training cells
[37m2024-08-14 08:39:03,091 [INFO] - Extraction detection metrics - F1: 0.714, Precision: 0.767, Recall: 0.689, Detected-Cells: 8777
[37m2024-08-14 08:39:03,461 [INFO] - Training epoch stats:     Loss: 0.3212 - F1-Score: 0.8763 - Accuracy-Score: 0.8763 - AUROC: 0.9705 - AP: 0.8538
[37m2024-08-14 08:39:03,558 [INFO] - Validation epoch stats:   Loss: 0.5182 - F1-Score: 0.8154 - Accuracy-Score: 0.8154 - AUROC: 0.9535 - AP: 0.8344
[37m2024-08-14 08:39:03,628 [INFO] - Epoch: 18/50
[37m2024-08-14 08:39:03,634 [INFO] - Extracting training cells
[37m2024-08-14 08:39:25,576 [INFO] - Extraction detection metrics - F1: 0.718, Precision: 0.793, Recall: 0.680, Detected-Cells: 8905
[37m2024-08-14 08:39:25,924 [INFO] - Training epoch stats:     Loss: 0.2198 - F1-Score: 0.9076 - Accuracy-Score: 0.9076 - AUROC: 0.9861 - AP: 0.9578
[37m2024-08-14 08:39:26,019 [INFO] - Validation epoch stats:   Loss: 0.4393 - F1-Score: 0.8687 - Accuracy-Score: 0.8687 - AUROC: 0.9626 - AP: 0.8706
[37m2024-08-14 08:39:26,086 [INFO] - Epoch: 19/50
[37m2024-08-14 08:39:26,092 [INFO] - Extracting training cells
[37m2024-08-14 08:39:47,605 [INFO] - Extraction detection metrics - F1: 0.702, Precision: 0.778, Recall: 0.669, Detected-Cells: 8525
[37m2024-08-14 08:39:47,925 [INFO] - Training epoch stats:     Loss: 0.2610 - F1-Score: 0.8951 - Accuracy-Score: 0.8951 - AUROC: 0.9839 - AP: 0.9547
[37m2024-08-14 08:39:48,018 [INFO] - Validation epoch stats:   Loss: 0.5042 - F1-Score: 0.8402 - Accuracy-Score: 0.8402 - AUROC: 0.9593 - AP: 0.8375
[37m2024-08-14 08:39:48,089 [INFO] - Epoch: 20/50
[37m2024-08-14 08:39:48,094 [INFO] - Extracting training cells
[37m2024-08-14 08:40:10,641 [INFO] - Extraction detection metrics - F1: 0.704, Precision: 0.759, Recall: 0.687, Detected-Cells: 8596
[37m2024-08-14 08:40:10,946 [INFO] - Training epoch stats:     Loss: 0.2476 - F1-Score: 0.8950 - Accuracy-Score: 0.8950 - AUROC: 0.9830 - AP: 0.9232
[37m2024-08-14 08:40:11,022 [INFO] - Validation epoch stats:   Loss: 0.5758 - F1-Score: 0.8472 - Accuracy-Score: 0.8472 - AUROC: 0.9528 - AP: 0.8104
[37m2024-08-14 08:40:11,085 [INFO] - Epoch: 21/50
[37m2024-08-14 08:40:11,090 [INFO] - Extracting training cells
[37m2024-08-14 08:40:33,881 [INFO] - Extraction detection metrics - F1: 0.695, Precision: 0.769, Recall: 0.666, Detected-Cells: 8325
[37m2024-08-14 08:40:34,230 [INFO] - Training epoch stats:     Loss: 0.2224 - F1-Score: 0.9108 - Accuracy-Score: 0.9108 - AUROC: 0.9874 - AP: 0.9597
[37m2024-08-14 08:40:34,315 [INFO] - Validation epoch stats:   Loss: 0.5568 - F1-Score: 0.8449 - Accuracy-Score: 0.8449 - AUROC: 0.9414 - AP: 0.7850
[37m2024-08-14 08:40:34,381 [INFO] - Epoch: 22/50
[37m2024-08-14 08:40:34,387 [INFO] - Extracting training cells
[37m2024-08-14 08:40:57,032 [INFO] - Extraction detection metrics - F1: 0.688, Precision: 0.762, Recall: 0.657, Detected-Cells: 8613
[37m2024-08-14 08:40:57,362 [INFO] - Training epoch stats:     Loss: 0.2215 - F1-Score: 0.9096 - Accuracy-Score: 0.9096 - AUROC: 0.9860 - AP: 0.9676
[37m2024-08-14 08:40:57,458 [INFO] - Validation epoch stats:   Loss: 0.5236 - F1-Score: 0.8519 - Accuracy-Score: 0.8519 - AUROC: 0.9544 - AP: 0.8187
[37m2024-08-14 08:40:57,523 [INFO] - Epoch: 23/50
[37m2024-08-14 08:40:57,528 [INFO] - Extracting training cells
[37m2024-08-14 08:41:18,835 [INFO] - Extraction detection metrics - F1: 0.687, Precision: 0.757, Recall: 0.656, Detected-Cells: 8723
[37m2024-08-14 08:41:19,149 [INFO] - Training epoch stats:     Loss: 0.2141 - F1-Score: 0.9110 - Accuracy-Score: 0.9110 - AUROC: 0.9874 - AP: 0.9554
[37m2024-08-14 08:41:19,235 [INFO] - Validation epoch stats:   Loss: 0.8312 - F1-Score: 0.8079 - Accuracy-Score: 0.8079 - AUROC: 0.9216 - AP: 0.7009
[37m2024-08-14 08:41:19,240 [INFO] - Performing early stopping!
[37m2024-08-14 08:41:19,246 [INFO] - Finished run u2abzsu7
