[37m2024-08-14 08:41:47,003 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-14 08:41:47,004 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow2/CV-Aug/2024-08-14T084137_Fold-1
[37m2024-08-14 08:41:47,071 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f9f57f50520>]
[37m2024-08-14 08:41:47,072 [INFO] - Using GPU: cuda:0
[37m2024-08-14 08:41:47,077 [INFO] - Using device: cuda:0
[37m2024-08-14 08:41:47,083 [INFO] - Loss function:
[37m2024-08-14 08:41:47,088 [INFO] - CrossEntropyLoss()
[37m2024-08-14 08:41:55,677 [INFO] - <All keys matched successfully>
[37m2024-08-14 08:41:56,665 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-14 08:41:56,666 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-14 08:41:56,671 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00568059820179996, 'weight_decay': 0.0004714549691487939}
[37m2024-08-14 08:41:56,677 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-14 08:41:56,690 [INFO] - Caching datasets
[37m2024-08-14 08:41:57,851 [INFO] - Instantiate Trainer
[37m2024-08-14 08:41:57,857 [INFO] - Calling Trainer Fit
[37m2024-08-14 08:41:57,858 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-14 08:41:57,863 [INFO] - Epoch: 1/50
[37m2024-08-14 08:41:57,872 [INFO] - Extracting training cells
[37m2024-08-14 08:42:29,268 [INFO] - Extraction detection metrics - F1: 0.702, Precision: 0.751, Recall: 0.702, Detected-Cells: 8646
[37m2024-08-14 08:42:29,700 [INFO] - Training epoch stats:     Loss: 0.3859 - F1-Score: 0.8516 - Accuracy-Score: 0.8516 - AUROC: 0.9595 - AP: 0.8424
[37m2024-08-14 08:42:30,094 [INFO] - Loaded dataset from cache: /Consep/cache/8a420a0b00820527f644002c99677ddcb9e714c79e14466f3932b3e64a975b8a.h5
[37m2024-08-14 08:42:30,373 [INFO] - Validation epoch stats:   Loss: 0.4389 - F1-Score: 0.8549 - Accuracy-Score: 0.8549 - AUROC: 0.9495 - AP: 0.7067
[37m2024-08-14 08:42:30,374 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:42:30,570 [INFO] - Epoch: 2/50
[37m2024-08-14 08:42:30,571 [INFO] - Extracting training cells
[37m2024-08-14 08:42:52,922 [INFO] - Extraction detection metrics - F1: 0.720, Precision: 0.776, Recall: 0.702, Detected-Cells: 9090
[37m2024-08-14 08:42:53,281 [INFO] - Training epoch stats:     Loss: 0.2597 - F1-Score: 0.8986 - Accuracy-Score: 0.8986 - AUROC: 0.9806 - AP: 0.9363
[37m2024-08-14 08:42:53,353 [INFO] - Validation epoch stats:   Loss: 0.3911 - F1-Score: 0.8766 - Accuracy-Score: 0.8766 - AUROC: 0.9516 - AP: 0.7347
[37m2024-08-14 08:42:53,354 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:42:53,585 [INFO] - Epoch: 3/50
[37m2024-08-14 08:42:53,586 [INFO] - Extracting training cells
[37m2024-08-14 08:43:15,301 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.764, Recall: 0.688, Detected-Cells: 8787
[37m2024-08-14 08:43:15,623 [INFO] - Training epoch stats:     Loss: 0.2548 - F1-Score: 0.8992 - Accuracy-Score: 0.8992 - AUROC: 0.9807 - AP: 0.9452
[37m2024-08-14 08:43:15,691 [INFO] - Validation epoch stats:   Loss: 0.4169 - F1-Score: 0.8457 - Accuracy-Score: 0.8457 - AUROC: 0.9330 - AP: 0.7090
[37m2024-08-14 08:43:15,762 [INFO] - Epoch: 4/50
[37m2024-08-14 08:43:15,763 [INFO] - Extracting training cells
[37m2024-08-14 08:43:38,130 [INFO] - Extraction detection metrics - F1: 0.705, Precision: 0.756, Recall: 0.685, Detected-Cells: 7959
[37m2024-08-14 08:43:38,420 [INFO] - Training epoch stats:     Loss: 0.3167 - F1-Score: 0.8666 - Accuracy-Score: 0.8666 - AUROC: 0.9712 - AP: 0.9167
[37m2024-08-14 08:43:38,487 [INFO] - Validation epoch stats:   Loss: 0.4349 - F1-Score: 0.8446 - Accuracy-Score: 0.8446 - AUROC: 0.9315 - AP: 0.7135
[37m2024-08-14 08:43:38,551 [INFO] - Epoch: 5/50
[37m2024-08-14 08:43:38,551 [INFO] - Extracting training cells
[37m2024-08-14 08:44:00,649 [INFO] - Extraction detection metrics - F1: 0.719, Precision: 0.769, Recall: 0.704, Detected-Cells: 8769
[37m2024-08-14 08:44:00,960 [INFO] - Training epoch stats:     Loss: 0.2635 - F1-Score: 0.8978 - Accuracy-Score: 0.8978 - AUROC: 0.9794 - AP: 0.9421
[37m2024-08-14 08:44:01,028 [INFO] - Validation epoch stats:   Loss: 0.3873 - F1-Score: 0.8738 - Accuracy-Score: 0.8738 - AUROC: 0.9336 - AP: 0.7079
[37m2024-08-14 08:44:01,089 [INFO] - Epoch: 6/50
[37m2024-08-14 08:44:01,089 [INFO] - Extracting training cells
[37m2024-08-14 08:44:21,098 [INFO] - Extraction detection metrics - F1: 0.686, Precision: 0.753, Recall: 0.662, Detected-Cells: 7539
[37m2024-08-14 08:44:21,349 [INFO] - Training epoch stats:     Loss: 0.2572 - F1-Score: 0.9024 - Accuracy-Score: 0.9024 - AUROC: 0.9813 - AP: 0.9401
[37m2024-08-14 08:44:21,417 [INFO] - Validation epoch stats:   Loss: 0.3532 - F1-Score: 0.8803 - Accuracy-Score: 0.8803 - AUROC: 0.9407 - AP: 0.7286
[37m2024-08-14 08:44:21,470 [INFO] - Epoch: 7/50
[37m2024-08-14 08:44:21,471 [INFO] - Extracting training cells
[37m2024-08-14 08:44:45,804 [INFO] - Extraction detection metrics - F1: 0.700, Precision: 0.751, Recall: 0.684, Detected-Cells: 8933
[37m2024-08-14 08:44:46,080 [INFO] - Training epoch stats:     Loss: 0.2354 - F1-Score: 0.9059 - Accuracy-Score: 0.9059 - AUROC: 0.9840 - AP: 0.9547
[37m2024-08-14 08:44:46,139 [INFO] - Validation epoch stats:   Loss: 0.4106 - F1-Score: 0.8625 - Accuracy-Score: 0.8625 - AUROC: 0.9491 - AP: 0.7510
[37m2024-08-14 08:44:46,203 [INFO] - Epoch: 8/50
[37m2024-08-14 08:44:46,204 [INFO] - Extracting training cells
[37m2024-08-14 08:45:10,263 [INFO] - Extraction detection metrics - F1: 0.690, Precision: 0.739, Recall: 0.679, Detected-Cells: 8506
[37m2024-08-14 08:45:10,558 [INFO] - Training epoch stats:     Loss: 0.3250 - F1-Score: 0.8728 - Accuracy-Score: 0.8728 - AUROC: 0.9774 - AP: 0.9449
[37m2024-08-14 08:45:10,628 [INFO] - Validation epoch stats:   Loss: 0.4674 - F1-Score: 0.8262 - Accuracy-Score: 0.8262 - AUROC: 0.9347 - AP: 0.7196
[37m2024-08-14 08:45:10,703 [INFO] - Epoch: 9/50
[37m2024-08-14 08:45:10,703 [INFO] - Extracting training cells
[37m2024-08-14 08:45:32,263 [INFO] - Extraction detection metrics - F1: 0.719, Precision: 0.763, Recall: 0.705, Detected-Cells: 9353
[37m2024-08-14 08:45:32,585 [INFO] - Training epoch stats:     Loss: 0.2325 - F1-Score: 0.9053 - Accuracy-Score: 0.9053 - AUROC: 0.9864 - AP: 0.9570
[37m2024-08-14 08:45:32,655 [INFO] - Validation epoch stats:   Loss: 0.4043 - F1-Score: 0.8663 - Accuracy-Score: 0.8663 - AUROC: 0.9466 - AP: 0.7249
[37m2024-08-14 08:45:32,728 [INFO] - Epoch: 10/50
[37m2024-08-14 08:45:32,729 [INFO] - Extracting training cells
[37m2024-08-14 08:45:55,277 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.759, Recall: 0.681, Detected-Cells: 9145
[37m2024-08-14 08:45:55,554 [INFO] - Training epoch stats:     Loss: 0.2113 - F1-Score: 0.9141 - Accuracy-Score: 0.9141 - AUROC: 0.9882 - AP: 0.9649
[37m2024-08-14 08:45:55,611 [INFO] - Validation epoch stats:   Loss: 0.4150 - F1-Score: 0.8679 - Accuracy-Score: 0.8679 - AUROC: 0.9360 - AP: 0.7096
[37m2024-08-14 08:45:55,673 [INFO] - Epoch: 11/50
[37m2024-08-14 08:45:55,674 [INFO] - Extracting training cells
[37m2024-08-14 08:46:16,321 [INFO] - Extraction detection metrics - F1: 0.682, Precision: 0.727, Recall: 0.678, Detected-Cells: 8376
[37m2024-08-14 08:46:16,609 [INFO] - Training epoch stats:     Loss: 0.3692 - F1-Score: 0.8658 - Accuracy-Score: 0.8658 - AUROC: 0.9680 - AP: 0.9177
[37m2024-08-14 08:46:16,677 [INFO] - Validation epoch stats:   Loss: 0.6091 - F1-Score: 0.8424 - Accuracy-Score: 0.8424 - AUROC: 0.9103 - AP: 0.6949
[37m2024-08-14 08:46:16,742 [INFO] - Epoch: 12/50
[37m2024-08-14 08:46:16,743 [INFO] - Extracting training cells
[37m2024-08-14 08:46:39,780 [INFO] - Extraction detection metrics - F1: 0.680, Precision: 0.748, Recall: 0.656, Detected-Cells: 8496
[37m2024-08-14 08:46:40,054 [INFO] - Training epoch stats:     Loss: 0.2672 - F1-Score: 0.8901 - Accuracy-Score: 0.8901 - AUROC: 0.9827 - AP: 0.9370
[37m2024-08-14 08:46:40,123 [INFO] - Validation epoch stats:   Loss: 0.4271 - F1-Score: 0.8646 - Accuracy-Score: 0.8646 - AUROC: 0.9243 - AP: 0.7497
[37m2024-08-14 08:46:40,186 [INFO] - Epoch: 13/50
[37m2024-08-14 08:46:40,186 [INFO] - Extracting training cells
[37m2024-08-14 08:47:01,912 [INFO] - Extraction detection metrics - F1: 0.702, Precision: 0.752, Recall: 0.686, Detected-Cells: 8225
[37m2024-08-14 08:47:02,198 [INFO] - Training epoch stats:     Loss: 0.2183 - F1-Score: 0.9097 - Accuracy-Score: 0.9097 - AUROC: 0.9871 - AP: 0.9582
[37m2024-08-14 08:47:02,268 [INFO] - Validation epoch stats:   Loss: 0.4244 - F1-Score: 0.8560 - Accuracy-Score: 0.8560 - AUROC: 0.9200 - AP: 0.7382
[37m2024-08-14 08:47:02,334 [INFO] - Epoch: 14/50
[37m2024-08-14 08:47:02,334 [INFO] - Extracting training cells
[37m2024-08-14 08:47:23,999 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.774, Recall: 0.693, Detected-Cells: 9221
[37m2024-08-14 08:47:24,334 [INFO] - Training epoch stats:     Loss: 0.2219 - F1-Score: 0.9102 - Accuracy-Score: 0.9102 - AUROC: 0.9869 - AP: 0.9625
[37m2024-08-14 08:47:24,420 [INFO] - Validation epoch stats:   Loss: 0.4510 - F1-Score: 0.8598 - Accuracy-Score: 0.8598 - AUROC: 0.9390 - AP: 0.7554
[37m2024-08-14 08:47:24,483 [INFO] - Epoch: 15/50
[37m2024-08-14 08:47:24,483 [INFO] - Extracting training cells
[37m2024-08-14 08:47:46,353 [INFO] - Extraction detection metrics - F1: 0.683, Precision: 0.719, Recall: 0.684, Detected-Cells: 8463
[37m2024-08-14 08:47:46,644 [INFO] - Training epoch stats:     Loss: 0.2550 - F1-Score: 0.8959 - Accuracy-Score: 0.8959 - AUROC: 0.9841 - AP: 0.9467
[37m2024-08-14 08:47:46,718 [INFO] - Validation epoch stats:   Loss: 0.5509 - F1-Score: 0.8289 - Accuracy-Score: 0.8289 - AUROC: 0.8915 - AP: 0.6804
[37m2024-08-14 08:47:46,783 [INFO] - Epoch: 16/50
[37m2024-08-14 08:47:46,784 [INFO] - Extracting training cells
[37m2024-08-14 08:48:08,145 [INFO] - Extraction detection metrics - F1: 0.696, Precision: 0.760, Recall: 0.680, Detected-Cells: 8527
[37m2024-08-14 08:48:08,453 [INFO] - Training epoch stats:     Loss: 0.2732 - F1-Score: 0.8811 - Accuracy-Score: 0.8811 - AUROC: 0.9800 - AP: 0.9419
[37m2024-08-14 08:48:08,521 [INFO] - Validation epoch stats:   Loss: 0.5853 - F1-Score: 0.7937 - Accuracy-Score: 0.7937 - AUROC: 0.8963 - AP: 0.6708
[37m2024-08-14 08:48:08,580 [INFO] - Epoch: 17/50
[37m2024-08-14 08:48:08,580 [INFO] - Extracting training cells
[37m2024-08-14 08:48:30,059 [INFO] - Extraction detection metrics - F1: 0.730, Precision: 0.777, Recall: 0.714, Detected-Cells: 9142
[37m2024-08-14 08:48:30,367 [INFO] - Training epoch stats:     Loss: 0.2545 - F1-Score: 0.9084 - Accuracy-Score: 0.9084 - AUROC: 0.9817 - AP: 0.9122
[37m2024-08-14 08:48:30,437 [INFO] - Validation epoch stats:   Loss: 0.5028 - F1-Score: 0.8273 - Accuracy-Score: 0.8273 - AUROC: 0.8808 - AP: 0.6821
[37m2024-08-14 08:48:30,501 [INFO] - Epoch: 18/50
[37m2024-08-14 08:48:30,501 [INFO] - Extracting training cells
[37m2024-08-14 08:48:52,809 [INFO] - Extraction detection metrics - F1: 0.708, Precision: 0.763, Recall: 0.686, Detected-Cells: 8912
[37m2024-08-14 08:48:53,155 [INFO] - Training epoch stats:     Loss: 0.2078 - F1-Score: 0.9174 - Accuracy-Score: 0.9174 - AUROC: 0.9888 - AP: 0.9615
[37m2024-08-14 08:48:53,232 [INFO] - Validation epoch stats:   Loss: 0.4317 - F1-Score: 0.8554 - Accuracy-Score: 0.8554 - AUROC: 0.9304 - AP: 0.7247
[37m2024-08-14 08:48:53,293 [INFO] - Epoch: 19/50
[37m2024-08-14 08:48:53,293 [INFO] - Extracting training cells
[37m2024-08-14 08:49:16,266 [INFO] - Extraction detection metrics - F1: 0.698, Precision: 0.756, Recall: 0.674, Detected-Cells: 8431
[37m2024-08-14 08:49:16,548 [INFO] - Training epoch stats:     Loss: 0.2295 - F1-Score: 0.8985 - Accuracy-Score: 0.8985 - AUROC: 0.9853 - AP: 0.9589
[37m2024-08-14 08:49:16,616 [INFO] - Validation epoch stats:   Loss: 0.4591 - F1-Score: 0.8462 - Accuracy-Score: 0.8462 - AUROC: 0.9177 - AP: 0.7131
[37m2024-08-14 08:49:16,676 [INFO] - Epoch: 20/50
[37m2024-08-14 08:49:16,676 [INFO] - Extracting training cells
[37m2024-08-14 08:49:37,742 [INFO] - Extraction detection metrics - F1: 0.718, Precision: 0.763, Recall: 0.698, Detected-Cells: 8925
[37m2024-08-14 08:49:38,296 [INFO] - Training epoch stats:     Loss: 0.2183 - F1-Score: 0.8969 - Accuracy-Score: 0.8969 - AUROC: 0.9867 - AP: 0.9641
[37m2024-08-14 08:49:38,370 [INFO] - Validation epoch stats:   Loss: 0.4869 - F1-Score: 0.8284 - Accuracy-Score: 0.8284 - AUROC: 0.9095 - AP: 0.7225
[37m2024-08-14 08:49:38,437 [INFO] - Epoch: 21/50
[37m2024-08-14 08:49:38,438 [INFO] - Extracting training cells
[37m2024-08-14 08:49:59,467 [INFO] - Extraction detection metrics - F1: 0.689, Precision: 0.747, Recall: 0.672, Detected-Cells: 8808
[37m2024-08-14 08:49:59,746 [INFO] - Training epoch stats:     Loss: 0.2128 - F1-Score: 0.9086 - Accuracy-Score: 0.9086 - AUROC: 0.9868 - AP: 0.9662
[37m2024-08-14 08:49:59,805 [INFO] - Validation epoch stats:   Loss: 0.4455 - F1-Score: 0.8544 - Accuracy-Score: 0.8544 - AUROC: 0.9160 - AP: 0.7202
[37m2024-08-14 08:49:59,866 [INFO] - Epoch: 22/50
[37m2024-08-14 08:49:59,866 [INFO] - Extracting training cells
[37m2024-08-14 08:50:20,088 [INFO] - Extraction detection metrics - F1: 0.688, Precision: 0.745, Recall: 0.666, Detected-Cells: 8600
[37m2024-08-14 08:50:20,409 [INFO] - Training epoch stats:     Loss: 0.2846 - F1-Score: 0.8830 - Accuracy-Score: 0.8830 - AUROC: 0.9815 - AP: 0.9556
[37m2024-08-14 08:50:20,480 [INFO] - Validation epoch stats:   Loss: 0.4961 - F1-Score: 0.8213 - Accuracy-Score: 0.8213 - AUROC: 0.9184 - AP: 0.7323
[37m2024-08-14 08:50:20,480 [INFO] - Performing early stopping!
[37m2024-08-14 08:50:20,486 [INFO] - Finished run lppzvwv1
