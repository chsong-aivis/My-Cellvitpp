[37m2024-08-14 09:11:49,543 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-14 09:11:49,544 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow2/CV-Aug/2024-08-14T091139_Fold-4
[37m2024-08-14 09:11:49,612 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fe8a6c404c0>]
[37m2024-08-14 09:11:49,613 [INFO] - Using GPU: cuda:0
[37m2024-08-14 09:11:49,618 [INFO] - Using device: cuda:0
[37m2024-08-14 09:11:49,624 [INFO] - Loss function:
[37m2024-08-14 09:11:49,628 [INFO] - CrossEntropyLoss()
[37m2024-08-14 09:11:58,157 [INFO] - <All keys matched successfully>
[37m2024-08-14 09:11:59,430 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-14 09:11:59,432 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-14 09:11:59,436 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.008654182430904838, 'weight_decay': 7.674533159811504e-05}
[37m2024-08-14 09:11:59,441 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-14 09:11:59,456 [INFO] - Caching datasets
[37m2024-08-14 09:12:00,673 [INFO] - Instantiate Trainer
[37m2024-08-14 09:12:00,680 [INFO] - Calling Trainer Fit
[37m2024-08-14 09:12:00,680 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-14 09:12:00,686 [INFO] - Epoch: 1/50
[37m2024-08-14 09:12:00,692 [INFO] - Extracting training cells
[37m2024-08-14 09:12:30,739 [INFO] - Extraction detection metrics - F1: 0.714, Precision: 0.754, Recall: 0.691, Detected-Cells: 8986
[37m2024-08-14 09:12:31,153 [INFO] - Training epoch stats:     Loss: 0.4652 - F1-Score: 0.8276 - Accuracy-Score: 0.8276 - AUROC: 0.9388 - AP: 0.7962
[37m2024-08-14 09:12:31,566 [INFO] - Loaded dataset from cache: /Consep/cache/abc73e4aded376298e5ea211491273d10422739f2df67bd1d5b284fc12f4fa27.h5
[37m2024-08-14 09:12:31,607 [INFO] - Validation epoch stats:   Loss: 0.5657 - F1-Score: 0.7805 - Accuracy-Score: 0.7805 - AUROC: 0.9526 - AP: 0.8029
[37m2024-08-14 09:12:31,608 [INFO] - New best model - save checkpoint
[37m2024-08-14 09:12:31,787 [INFO] - Epoch: 2/50
[37m2024-08-14 09:12:31,788 [INFO] - Extracting training cells
[37m2024-08-14 09:12:53,611 [INFO] - Extraction detection metrics - F1: 0.724, Precision: 0.771, Recall: 0.698, Detected-Cells: 9311
[37m2024-08-14 09:12:53,958 [INFO] - Training epoch stats:     Loss: 0.2816 - F1-Score: 0.8876 - Accuracy-Score: 0.8876 - AUROC: 0.9761 - AP: 0.9193
[37m2024-08-14 09:12:54,034 [INFO] - Validation epoch stats:   Loss: 0.4398 - F1-Score: 0.8330 - Accuracy-Score: 0.8330 - AUROC: 0.9582 - AP: 0.8147
[37m2024-08-14 09:12:54,034 [INFO] - New best model - save checkpoint
[37m2024-08-14 09:12:54,213 [INFO] - Epoch: 3/50
[37m2024-08-14 09:12:54,214 [INFO] - Extracting training cells
[37m2024-08-14 09:13:16,483 [INFO] - Extraction detection metrics - F1: 0.697, Precision: 0.772, Recall: 0.669, Detected-Cells: 8752
[37m2024-08-14 09:13:16,818 [INFO] - Training epoch stats:     Loss: 0.2987 - F1-Score: 0.8819 - Accuracy-Score: 0.8819 - AUROC: 0.9741 - AP: 0.9250
[37m2024-08-14 09:13:16,889 [INFO] - Validation epoch stats:   Loss: 0.4335 - F1-Score: 0.8392 - Accuracy-Score: 0.8392 - AUROC: 0.9528 - AP: 0.8032
[37m2024-08-14 09:13:16,952 [INFO] - Epoch: 4/50
[37m2024-08-14 09:13:16,952 [INFO] - Extracting training cells
[37m2024-08-14 09:13:38,359 [INFO] - Extraction detection metrics - F1: 0.685, Precision: 0.744, Recall: 0.675, Detected-Cells: 8577
[37m2024-08-14 09:13:38,694 [INFO] - Training epoch stats:     Loss: 0.3250 - F1-Score: 0.8593 - Accuracy-Score: 0.8593 - AUROC: 0.9704 - AP: 0.9217
[37m2024-08-14 09:13:38,765 [INFO] - Validation epoch stats:   Loss: 0.5314 - F1-Score: 0.7991 - Accuracy-Score: 0.7991 - AUROC: 0.9392 - AP: 0.7713
[37m2024-08-14 09:13:38,837 [INFO] - Epoch: 5/50
[37m2024-08-14 09:13:38,838 [INFO] - Extracting training cells
[37m2024-08-14 09:14:00,821 [INFO] - Extraction detection metrics - F1: 0.713, Precision: 0.759, Recall: 0.691, Detected-Cells: 8680
[37m2024-08-14 09:14:01,130 [INFO] - Training epoch stats:     Loss: 0.2611 - F1-Score: 0.8933 - Accuracy-Score: 0.8933 - AUROC: 0.9796 - AP: 0.9348
[37m2024-08-14 09:14:01,199 [INFO] - Validation epoch stats:   Loss: 0.7116 - F1-Score: 0.7297 - Accuracy-Score: 0.7297 - AUROC: 0.9355 - AP: 0.7826
[37m2024-08-14 09:14:01,258 [INFO] - Epoch: 6/50
[37m2024-08-14 09:14:01,258 [INFO] - Extracting training cells
[37m2024-08-14 09:14:22,862 [INFO] - Extraction detection metrics - F1: 0.689, Precision: 0.765, Recall: 0.655, Detected-Cells: 8579
[37m2024-08-14 09:14:23,180 [INFO] - Training epoch stats:     Loss: 0.2684 - F1-Score: 0.8929 - Accuracy-Score: 0.8929 - AUROC: 0.9777 - AP: 0.9329
[37m2024-08-14 09:14:23,252 [INFO] - Validation epoch stats:   Loss: 0.6031 - F1-Score: 0.7737 - Accuracy-Score: 0.7737 - AUROC: 0.9282 - AP: 0.7527
[37m2024-08-14 09:14:23,314 [INFO] - Epoch: 7/50
[37m2024-08-14 09:14:23,315 [INFO] - Extracting training cells
[37m2024-08-14 09:14:45,988 [INFO] - Extraction detection metrics - F1: 0.691, Precision: 0.768, Recall: 0.658, Detected-Cells: 8877
[37m2024-08-14 09:14:46,323 [INFO] - Training epoch stats:     Loss: 0.2538 - F1-Score: 0.8977 - Accuracy-Score: 0.8977 - AUROC: 0.9821 - AP: 0.9437
[37m2024-08-14 09:14:46,401 [INFO] - Validation epoch stats:   Loss: 0.6751 - F1-Score: 0.7551 - Accuracy-Score: 0.7551 - AUROC: 0.9272 - AP: 0.7719
[37m2024-08-14 09:14:46,469 [INFO] - Epoch: 8/50
[37m2024-08-14 09:14:46,470 [INFO] - Extracting training cells
[37m2024-08-14 09:15:09,472 [INFO] - Extraction detection metrics - F1: 0.683, Precision: 0.737, Recall: 0.684, Detected-Cells: 8750
[37m2024-08-14 09:15:09,821 [INFO] - Training epoch stats:     Loss: 0.3295 - F1-Score: 0.8739 - Accuracy-Score: 0.8739 - AUROC: 0.9747 - AP: 0.9298
[37m2024-08-14 09:15:09,905 [INFO] - Validation epoch stats:   Loss: 0.5531 - F1-Score: 0.8217 - Accuracy-Score: 0.8217 - AUROC: 0.9360 - AP: 0.7869
[37m2024-08-14 09:15:09,970 [INFO] - Epoch: 9/50
[37m2024-08-14 09:15:09,970 [INFO] - Extracting training cells
[37m2024-08-14 09:15:32,187 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.757, Recall: 0.687, Detected-Cells: 9224
[37m2024-08-14 09:15:32,468 [INFO] - Training epoch stats:     Loss: 0.2396 - F1-Score: 0.9005 - Accuracy-Score: 0.9005 - AUROC: 0.9845 - AP: 0.9502
[37m2024-08-14 09:15:32,526 [INFO] - Validation epoch stats:   Loss: 0.6610 - F1-Score: 0.7686 - Accuracy-Score: 0.7686 - AUROC: 0.9338 - AP: 0.7854
[37m2024-08-14 09:15:32,589 [INFO] - Epoch: 10/50
[37m2024-08-14 09:15:32,590 [INFO] - Extracting training cells
[37m2024-08-14 09:15:54,568 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.781, Recall: 0.680, Detected-Cells: 9318
[37m2024-08-14 09:15:54,840 [INFO] - Training epoch stats:     Loss: 0.2344 - F1-Score: 0.9019 - Accuracy-Score: 0.9019 - AUROC: 0.9852 - AP: 0.9531
[37m2024-08-14 09:15:54,910 [INFO] - Validation epoch stats:   Loss: 0.5844 - F1-Score: 0.7974 - Accuracy-Score: 0.7974 - AUROC: 0.9309 - AP: 0.8031
[37m2024-08-14 09:15:54,972 [INFO] - Epoch: 11/50
[37m2024-08-14 09:15:54,973 [INFO] - Extracting training cells
[37m2024-08-14 09:16:15,143 [INFO] - Extraction detection metrics - F1: 0.708, Precision: 0.771, Recall: 0.692, Detected-Cells: 7482
[37m2024-08-14 09:16:15,398 [INFO] - Training epoch stats:     Loss: 0.4332 - F1-Score: 0.8410 - Accuracy-Score: 0.8410 - AUROC: 0.9567 - AP: 0.8865
[37m2024-08-14 09:16:15,471 [INFO] - Validation epoch stats:   Loss: 0.5479 - F1-Score: 0.8358 - Accuracy-Score: 0.8358 - AUROC: 0.9305 - AP: 0.7554
[37m2024-08-14 09:16:15,533 [INFO] - Epoch: 12/50
[37m2024-08-14 09:16:15,533 [INFO] - Extracting training cells
[37m2024-08-14 09:16:36,762 [INFO] - Extraction detection metrics - F1: 0.690, Precision: 0.760, Recall: 0.659, Detected-Cells: 8352
[37m2024-08-14 09:16:37,029 [INFO] - Training epoch stats:     Loss: 0.2887 - F1-Score: 0.8902 - Accuracy-Score: 0.8902 - AUROC: 0.9773 - AP: 0.8817
[37m2024-08-14 09:16:37,085 [INFO] - Validation epoch stats:   Loss: 0.7102 - F1-Score: 0.7466 - Accuracy-Score: 0.7466 - AUROC: 0.8992 - AP: 0.7255
[37m2024-08-14 09:16:37,143 [INFO] - Epoch: 13/50
[37m2024-08-14 09:16:37,144 [INFO] - Extracting training cells
[37m2024-08-14 09:16:58,307 [INFO] - Extraction detection metrics - F1: 0.691, Precision: 0.746, Recall: 0.669, Detected-Cells: 7923
[37m2024-08-14 09:16:58,602 [INFO] - Training epoch stats:     Loss: 0.2553 - F1-Score: 0.8945 - Accuracy-Score: 0.8945 - AUROC: 0.9835 - AP: 0.9431
[37m2024-08-14 09:16:58,670 [INFO] - Validation epoch stats:   Loss: 0.7214 - F1-Score: 0.7460 - Accuracy-Score: 0.7460 - AUROC: 0.9066 - AP: 0.7368
[37m2024-08-14 09:16:58,732 [INFO] - Epoch: 14/50
[37m2024-08-14 09:16:58,732 [INFO] - Extracting training cells
[37m2024-08-14 09:17:20,207 [INFO] - Extraction detection metrics - F1: 0.695, Precision: 0.757, Recall: 0.666, Detected-Cells: 8951
[37m2024-08-14 09:17:20,490 [INFO] - Training epoch stats:     Loss: 0.2427 - F1-Score: 0.8993 - Accuracy-Score: 0.8993 - AUROC: 0.9823 - AP: 0.9436
[37m2024-08-14 09:17:20,559 [INFO] - Validation epoch stats:   Loss: 0.6164 - F1-Score: 0.7884 - Accuracy-Score: 0.7884 - AUROC: 0.9122 - AP: 0.7770
[37m2024-08-14 09:17:20,617 [INFO] - Epoch: 15/50
[37m2024-08-14 09:17:20,617 [INFO] - Extracting training cells
[37m2024-08-14 09:17:41,476 [INFO] - Extraction detection metrics - F1: 0.699, Precision: 0.752, Recall: 0.696, Detected-Cells: 8411
[37m2024-08-14 09:17:41,790 [INFO] - Training epoch stats:     Loss: 0.3509 - F1-Score: 0.8541 - Accuracy-Score: 0.8541 - AUROC: 0.9702 - AP: 0.8939
[37m2024-08-14 09:17:41,858 [INFO] - Validation epoch stats:   Loss: 0.7399 - F1-Score: 0.7218 - Accuracy-Score: 0.7218 - AUROC: 0.8681 - AP: 0.7125
[37m2024-08-14 09:17:41,924 [INFO] - Epoch: 16/50
[37m2024-08-14 09:17:41,924 [INFO] - Extracting training cells
[37m2024-08-14 09:18:04,005 [INFO] - Extraction detection metrics - F1: 0.690, Precision: 0.749, Recall: 0.673, Detected-Cells: 8371
[37m2024-08-14 09:18:04,272 [INFO] - Training epoch stats:     Loss: 0.3869 - F1-Score: 0.8383 - Accuracy-Score: 0.8383 - AUROC: 0.9647 - AP: 0.9019
[37m2024-08-14 09:18:04,329 [INFO] - Validation epoch stats:   Loss: 0.7536 - F1-Score: 0.7065 - Accuracy-Score: 0.7065 - AUROC: 0.8819 - AP: 0.7293
[37m2024-08-14 09:18:04,386 [INFO] - Epoch: 17/50
[37m2024-08-14 09:18:04,386 [INFO] - Extracting training cells
[37m2024-08-14 09:18:25,438 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.770, Recall: 0.689, Detected-Cells: 9058
[37m2024-08-14 09:18:25,775 [INFO] - Training epoch stats:     Loss: 0.2939 - F1-Score: 0.8815 - Accuracy-Score: 0.8815 - AUROC: 0.9794 - AP: 0.9403
[37m2024-08-14 09:18:25,847 [INFO] - Validation epoch stats:   Loss: 0.7012 - F1-Score: 0.7884 - Accuracy-Score: 0.7884 - AUROC: 0.9038 - AP: 0.7561
[37m2024-08-14 09:18:25,906 [INFO] - Epoch: 18/50
[37m2024-08-14 09:18:25,907 [INFO] - Extracting training cells
[37m2024-08-14 09:18:48,806 [INFO] - Extraction detection metrics - F1: 0.720, Precision: 0.782, Recall: 0.688, Detected-Cells: 9263
[37m2024-08-14 09:18:49,153 [INFO] - Training epoch stats:     Loss: 0.2228 - F1-Score: 0.9108 - Accuracy-Score: 0.9108 - AUROC: 0.9874 - AP: 0.9639
[37m2024-08-14 09:18:49,223 [INFO] - Validation epoch stats:   Loss: 0.8760 - F1-Score: 0.7201 - Accuracy-Score: 0.7201 - AUROC: 0.9031 - AP: 0.7540
[37m2024-08-14 09:18:49,280 [INFO] - Epoch: 19/50
[37m2024-08-14 09:18:49,280 [INFO] - Extracting training cells
[37m2024-08-14 09:19:10,812 [INFO] - Extraction detection metrics - F1: 0.696, Precision: 0.765, Recall: 0.663, Detected-Cells: 8544
[37m2024-08-14 09:19:11,135 [INFO] - Training epoch stats:     Loss: 0.2339 - F1-Score: 0.8960 - Accuracy-Score: 0.8960 - AUROC: 0.9856 - AP: 0.9610
[37m2024-08-14 09:19:11,206 [INFO] - Validation epoch stats:   Loss: 0.9308 - F1-Score: 0.7071 - Accuracy-Score: 0.7071 - AUROC: 0.9041 - AP: 0.7528
[37m2024-08-14 09:19:11,265 [INFO] - Epoch: 20/50
[37m2024-08-14 09:19:11,265 [INFO] - Extracting training cells
[37m2024-08-14 09:19:33,401 [INFO] - Extraction detection metrics - F1: 0.699, Precision: 0.762, Recall: 0.682, Detected-Cells: 8522
[37m2024-08-14 09:19:33,844 [INFO] - Training epoch stats:     Loss: 0.3478 - F1-Score: 0.8512 - Accuracy-Score: 0.8512 - AUROC: 0.9729 - AP: 0.9391
[37m2024-08-14 09:19:33,913 [INFO] - Validation epoch stats:   Loss: 0.7241 - F1-Score: 0.7714 - Accuracy-Score: 0.7714 - AUROC: 0.8936 - AP: 0.7465
[37m2024-08-14 09:19:33,979 [INFO] - Epoch: 21/50
[37m2024-08-14 09:19:33,979 [INFO] - Extracting training cells
[37m2024-08-14 09:19:55,136 [INFO] - Extraction detection metrics - F1: 0.692, Precision: 0.766, Recall: 0.664, Detected-Cells: 8308
[37m2024-08-14 09:19:55,455 [INFO] - Training epoch stats:     Loss: 0.2395 - F1-Score: 0.8977 - Accuracy-Score: 0.8977 - AUROC: 0.9846 - AP: 0.9589
[37m2024-08-14 09:19:55,530 [INFO] - Validation epoch stats:   Loss: 0.7670 - F1-Score: 0.7573 - Accuracy-Score: 0.7573 - AUROC: 0.8952 - AP: 0.7484
[37m2024-08-14 09:19:55,595 [INFO] - Epoch: 22/50
[37m2024-08-14 09:19:55,596 [INFO] - Extracting training cells
[37m2024-08-14 09:20:16,798 [INFO] - Extraction detection metrics - F1: 0.685, Precision: 0.768, Recall: 0.652, Detected-Cells: 8882
[37m2024-08-14 09:20:17,143 [INFO] - Training epoch stats:     Loss: 0.2316 - F1-Score: 0.9006 - Accuracy-Score: 0.9006 - AUROC: 0.9851 - AP: 0.9587
[37m2024-08-14 09:20:17,220 [INFO] - Validation epoch stats:   Loss: 0.9018 - F1-Score: 0.7128 - Accuracy-Score: 0.7128 - AUROC: 0.9033 - AP: 0.7543
[37m2024-08-14 09:20:17,220 [INFO] - Performing early stopping!
[37m2024-08-14 09:20:17,227 [INFO] - Finished run rax10gwo
