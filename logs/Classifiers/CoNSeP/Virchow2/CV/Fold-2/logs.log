[37m2024-08-14 08:30:52,557 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-14 08:30:52,558 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow2/CV/2024-08-14T083041_Fold-2
[37m2024-08-14 08:30:52,634 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f97ccf871c0>]
[37m2024-08-14 08:30:52,640 [INFO] - Using GPU: cuda:0
[37m2024-08-14 08:30:52,646 [INFO] - Using device: cuda:0
[37m2024-08-14 08:30:52,652 [INFO] - Loss function:
[37m2024-08-14 08:30:52,657 [INFO] - CrossEntropyLoss()
[37m2024-08-14 08:31:22,676 [INFO] - <All keys matched successfully>
[37m2024-08-14 08:31:26,102 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-14 08:31:26,105 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-14 08:31:26,109 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.008654182430904838, 'weight_decay': 7.674533159811504e-05}
[37m2024-08-14 08:31:26,115 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-14 08:31:26,134 [INFO] - Caching datasets
[37m2024-08-14 08:31:27,349 [INFO] - Instantiate Trainer
[37m2024-08-14 08:31:27,356 [INFO] - Calling Trainer Fit
[37m2024-08-14 08:31:27,356 [INFO] - Dataset is cached after first epoch
[37m2024-08-14 08:31:27,362 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-14 08:31:27,368 [INFO] - Epoch: 1/50
[37m2024-08-14 08:31:27,375 [INFO] - Extracting training cells
[37m2024-08-14 08:32:09,394 [INFO] - Extraction detection metrics - F1: 0.732, Precision: 0.767, Recall: 0.715, Detected-Cells: 8981
[37m2024-08-14 08:32:09,396 [INFO] - Caching dataset 8c0ac10ad5c2f656d898f15f0ac3a61eb884e6ad35174646bd224096f5e5b14b to disk...
[37m2024-08-14 08:32:23,271 [INFO] - Training epoch stats:     Loss: 0.3938 - F1-Score: 0.8571 - Accuracy-Score: 0.8571 - AUROC: 0.9616 - AP: 0.8625
[37m2024-08-14 08:32:23,457 [INFO] - Extracting validation cells
[37m2024-08-14 08:32:36,456 [INFO] - Extraction detection metrics - F1: 0.701, Precision: 0.837, Recall: 0.650, Detected-Cells: 2272
[37m2024-08-14 08:32:36,459 [INFO] - Caching dataset 6b4e67db5f7c0770c4fbab8e9ae779f1e63793f0c37a3ad161be11202e992345 to disk...
[37m2024-08-14 08:32:39,359 [INFO] - Validation epoch stats:   Loss: 0.3475 - F1-Score: 0.8614 - Accuracy-Score: 0.8614 - AUROC: 0.9239 - AP: 0.7884
[37m2024-08-14 08:32:39,360 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:32:39,531 [INFO] - Epoch: 2/50
[37m2024-08-14 08:32:39,886 [INFO] - Training epoch stats:     Loss: 0.2418 - F1-Score: 0.9079 - Accuracy-Score: 0.9079 - AUROC: 0.9853 - AP: 0.9459
[37m2024-08-14 08:32:39,935 [INFO] - Validation epoch stats:   Loss: 0.3621 - F1-Score: 0.8614 - Accuracy-Score: 0.8614 - AUROC: 0.9251 - AP: 0.7741
[37m2024-08-14 08:32:39,936 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:32:40,091 [INFO] - Epoch: 3/50
[37m2024-08-14 08:32:40,405 [INFO] - Training epoch stats:     Loss: 0.2349 - F1-Score: 0.9100 - Accuracy-Score: 0.9100 - AUROC: 0.9866 - AP: 0.9530
[37m2024-08-14 08:32:40,509 [INFO] - Validation epoch stats:   Loss: 0.4497 - F1-Score: 0.8460 - Accuracy-Score: 0.8460 - AUROC: 0.9269 - AP: 0.7773
[37m2024-08-14 08:32:40,509 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:32:40,668 [INFO] - Epoch: 4/50
[37m2024-08-14 08:32:41,044 [INFO] - Training epoch stats:     Loss: 0.2062 - F1-Score: 0.9187 - Accuracy-Score: 0.9187 - AUROC: 0.9896 - AP: 0.9695
[37m2024-08-14 08:32:41,095 [INFO] - Validation epoch stats:   Loss: 0.3382 - F1-Score: 0.8600 - Accuracy-Score: 0.8600 - AUROC: 0.9118 - AP: 0.7684
[37m2024-08-14 08:32:41,151 [INFO] - Epoch: 5/50
[37m2024-08-14 08:32:41,490 [INFO] - Training epoch stats:     Loss: 0.1865 - F1-Score: 0.9264 - Accuracy-Score: 0.9264 - AUROC: 0.9910 - AP: 0.9695
[37m2024-08-14 08:32:41,538 [INFO] - Validation epoch stats:   Loss: 0.3907 - F1-Score: 0.8587 - Accuracy-Score: 0.8587 - AUROC: 0.9232 - AP: 0.7677
[37m2024-08-14 08:32:41,599 [INFO] - Epoch: 6/50
[37m2024-08-14 08:32:42,103 [INFO] - Training epoch stats:     Loss: 0.1747 - F1-Score: 0.9314 - Accuracy-Score: 0.9314 - AUROC: 0.9921 - AP: 0.9753
[37m2024-08-14 08:32:42,186 [INFO] - Validation epoch stats:   Loss: 0.3900 - F1-Score: 0.8666 - Accuracy-Score: 0.8666 - AUROC: 0.9236 - AP: 0.7743
[37m2024-08-14 08:32:42,248 [INFO] - Epoch: 7/50
[37m2024-08-14 08:32:42,734 [INFO] - Training epoch stats:     Loss: 0.1617 - F1-Score: 0.9341 - Accuracy-Score: 0.9341 - AUROC: 0.9932 - AP: 0.9820
[37m2024-08-14 08:32:42,816 [INFO] - Validation epoch stats:   Loss: 0.3932 - F1-Score: 0.8658 - Accuracy-Score: 0.8658 - AUROC: 0.9283 - AP: 0.7947
[37m2024-08-14 08:32:42,817 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:32:43,002 [INFO] - Epoch: 8/50
[37m2024-08-14 08:32:43,470 [INFO] - Training epoch stats:     Loss: 0.1565 - F1-Score: 0.9380 - Accuracy-Score: 0.9380 - AUROC: 0.9933 - AP: 0.9799
[37m2024-08-14 08:32:43,559 [INFO] - Validation epoch stats:   Loss: 0.4125 - F1-Score: 0.8702 - Accuracy-Score: 0.8702 - AUROC: 0.9268 - AP: 0.7909
[37m2024-08-14 08:32:43,616 [INFO] - Epoch: 9/50
[37m2024-08-14 08:32:44,061 [INFO] - Training epoch stats:     Loss: 0.1427 - F1-Score: 0.9427 - Accuracy-Score: 0.9427 - AUROC: 0.9945 - AP: 0.9845
[37m2024-08-14 08:32:44,117 [INFO] - Validation epoch stats:   Loss: 0.5185 - F1-Score: 0.8592 - Accuracy-Score: 0.8592 - AUROC: 0.9249 - AP: 0.7675
[37m2024-08-14 08:32:44,177 [INFO] - Epoch: 10/50
[37m2024-08-14 08:32:44,673 [INFO] - Training epoch stats:     Loss: 0.1344 - F1-Score: 0.9452 - Accuracy-Score: 0.9452 - AUROC: 0.9950 - AP: 0.9882
[37m2024-08-14 08:32:44,757 [INFO] - Validation epoch stats:   Loss: 0.5420 - F1-Score: 0.8526 - Accuracy-Score: 0.8526 - AUROC: 0.9033 - AP: 0.7874
[37m2024-08-14 08:32:44,811 [INFO] - Epoch: 11/50
[37m2024-08-14 08:32:45,292 [INFO] - Training epoch stats:     Loss: 0.1237 - F1-Score: 0.9483 - Accuracy-Score: 0.9483 - AUROC: 0.9956 - AP: 0.9902
[37m2024-08-14 08:32:45,351 [INFO] - Validation epoch stats:   Loss: 0.5012 - F1-Score: 0.8605 - Accuracy-Score: 0.8605 - AUROC: 0.9129 - AP: 0.8001
[37m2024-08-14 08:32:45,404 [INFO] - Epoch: 12/50
[37m2024-08-14 08:32:45,760 [INFO] - Training epoch stats:     Loss: 0.1186 - F1-Score: 0.9521 - Accuracy-Score: 0.9521 - AUROC: 0.9958 - AP: 0.9894
[37m2024-08-14 08:32:45,818 [INFO] - Validation epoch stats:   Loss: 0.5501 - F1-Score: 0.8495 - Accuracy-Score: 0.8495 - AUROC: 0.9107 - AP: 0.7856
[37m2024-08-14 08:32:45,878 [INFO] - Epoch: 13/50
[37m2024-08-14 08:32:46,306 [INFO] - Training epoch stats:     Loss: 0.1161 - F1-Score: 0.9529 - Accuracy-Score: 0.9529 - AUROC: 0.9962 - AP: 0.9907
[37m2024-08-14 08:32:46,360 [INFO] - Validation epoch stats:   Loss: 0.6300 - F1-Score: 0.8526 - Accuracy-Score: 0.8526 - AUROC: 0.9238 - AP: 0.7799
[37m2024-08-14 08:32:46,418 [INFO] - Epoch: 14/50
[37m2024-08-14 08:32:46,757 [INFO] - Training epoch stats:     Loss: 0.1045 - F1-Score: 0.9546 - Accuracy-Score: 0.9546 - AUROC: 0.9969 - AP: 0.9935
[37m2024-08-14 08:32:46,830 [INFO] - Validation epoch stats:   Loss: 0.6168 - F1-Score: 0.8587 - Accuracy-Score: 0.8587 - AUROC: 0.9276 - AP: 0.7966
[37m2024-08-14 08:32:46,886 [INFO] - Epoch: 15/50
[37m2024-08-14 08:32:47,251 [INFO] - Training epoch stats:     Loss: 0.0972 - F1-Score: 0.9582 - Accuracy-Score: 0.9582 - AUROC: 0.9972 - AP: 0.9936
[37m2024-08-14 08:32:47,298 [INFO] - Validation epoch stats:   Loss: 0.6129 - F1-Score: 0.8596 - Accuracy-Score: 0.8596 - AUROC: 0.9248 - AP: 0.7541
[37m2024-08-14 08:32:47,355 [INFO] - Epoch: 16/50
[37m2024-08-14 08:32:47,932 [INFO] - Training epoch stats:     Loss: 0.0879 - F1-Score: 0.9608 - Accuracy-Score: 0.9608 - AUROC: 0.9976 - AP: 0.9942
[37m2024-08-14 08:32:48,047 [INFO] - Validation epoch stats:   Loss: 0.6315 - F1-Score: 0.8600 - Accuracy-Score: 0.8600 - AUROC: 0.9350 - AP: 0.7895
[37m2024-08-14 08:32:48,047 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:32:48,203 [INFO] - Epoch: 17/50
[37m2024-08-14 08:32:48,707 [INFO] - Training epoch stats:     Loss: 0.0864 - F1-Score: 0.9639 - Accuracy-Score: 0.9639 - AUROC: 0.9977 - AP: 0.9949
[37m2024-08-14 08:32:48,788 [INFO] - Validation epoch stats:   Loss: 0.6622 - F1-Score: 0.8587 - Accuracy-Score: 0.8587 - AUROC: 0.9134 - AP: 0.7768
[37m2024-08-14 08:32:48,851 [INFO] - Epoch: 18/50
[37m2024-08-14 08:32:49,428 [INFO] - Training epoch stats:     Loss: 0.0757 - F1-Score: 0.9677 - Accuracy-Score: 0.9677 - AUROC: 0.9983 - AP: 0.9963
[37m2024-08-14 08:32:49,527 [INFO] - Validation epoch stats:   Loss: 0.7619 - F1-Score: 0.8570 - Accuracy-Score: 0.8570 - AUROC: 0.9244 - AP: 0.7677
[37m2024-08-14 08:32:49,583 [INFO] - Epoch: 19/50
[37m2024-08-14 08:32:50,163 [INFO] - Training epoch stats:     Loss: 0.0736 - F1-Score: 0.9704 - Accuracy-Score: 0.9704 - AUROC: 0.9983 - AP: 0.9962
[37m2024-08-14 08:32:50,281 [INFO] - Validation epoch stats:   Loss: 0.8439 - F1-Score: 0.8587 - Accuracy-Score: 0.8587 - AUROC: 0.9102 - AP: 0.7548
[37m2024-08-14 08:32:50,333 [INFO] - Epoch: 20/50
[37m2024-08-14 08:32:50,924 [INFO] - Training epoch stats:     Loss: 0.0692 - F1-Score: 0.9702 - Accuracy-Score: 0.9702 - AUROC: 0.9985 - AP: 0.9968
[37m2024-08-14 08:32:51,012 [INFO] - Validation epoch stats:   Loss: 0.7660 - F1-Score: 0.8539 - Accuracy-Score: 0.8539 - AUROC: 0.9153 - AP: 0.7394
[37m2024-08-14 08:32:51,078 [INFO] - Epoch: 21/50
[37m2024-08-14 08:32:51,647 [INFO] - Training epoch stats:     Loss: 0.0682 - F1-Score: 0.9700 - Accuracy-Score: 0.9700 - AUROC: 0.9986 - AP: 0.9965
[37m2024-08-14 08:32:51,758 [INFO] - Validation epoch stats:   Loss: 0.8159 - F1-Score: 0.8556 - Accuracy-Score: 0.8556 - AUROC: 0.9161 - AP: 0.7726
[37m2024-08-14 08:32:51,821 [INFO] - Epoch: 22/50
[37m2024-08-14 08:32:52,372 [INFO] - Training epoch stats:     Loss: 0.0657 - F1-Score: 0.9716 - Accuracy-Score: 0.9716 - AUROC: 0.9987 - AP: 0.9967
[37m2024-08-14 08:32:52,483 [INFO] - Validation epoch stats:   Loss: 0.9566 - F1-Score: 0.8495 - Accuracy-Score: 0.8495 - AUROC: 0.9137 - AP: 0.7471
[37m2024-08-14 08:32:52,544 [INFO] - Epoch: 23/50
[37m2024-08-14 08:32:52,869 [INFO] - Training epoch stats:     Loss: 0.0585 - F1-Score: 0.9736 - Accuracy-Score: 0.9736 - AUROC: 0.9989 - AP: 0.9976
[37m2024-08-14 08:32:52,924 [INFO] - Validation epoch stats:   Loss: 1.0252 - F1-Score: 0.8460 - Accuracy-Score: 0.8460 - AUROC: 0.9055 - AP: 0.7282
[37m2024-08-14 08:32:52,981 [INFO] - Epoch: 24/50
[37m2024-08-14 08:32:53,357 [INFO] - Training epoch stats:     Loss: 0.0552 - F1-Score: 0.9759 - Accuracy-Score: 0.9759 - AUROC: 0.9991 - AP: 0.9980
[37m2024-08-14 08:32:53,436 [INFO] - Validation epoch stats:   Loss: 1.0319 - F1-Score: 0.8468 - Accuracy-Score: 0.8468 - AUROC: 0.9119 - AP: 0.7328
[37m2024-08-14 08:32:53,498 [INFO] - Epoch: 25/50
[37m2024-08-14 08:32:53,987 [INFO] - Training epoch stats:     Loss: 0.0538 - F1-Score: 0.9781 - Accuracy-Score: 0.9781 - AUROC: 0.9991 - AP: 0.9981
[37m2024-08-14 08:32:54,052 [INFO] - Validation epoch stats:   Loss: 1.1275 - F1-Score: 0.8482 - Accuracy-Score: 0.8482 - AUROC: 0.9119 - AP: 0.7400
[37m2024-08-14 08:32:54,112 [INFO] - Epoch: 26/50
[37m2024-08-14 08:32:54,476 [INFO] - Training epoch stats:     Loss: 0.0508 - F1-Score: 0.9803 - Accuracy-Score: 0.9803 - AUROC: 0.9993 - AP: 0.9983
[37m2024-08-14 08:32:54,531 [INFO] - Validation epoch stats:   Loss: 1.0804 - F1-Score: 0.8464 - Accuracy-Score: 0.8464 - AUROC: 0.9124 - AP: 0.7229
[37m2024-08-14 08:32:54,593 [INFO] - Epoch: 27/50
[37m2024-08-14 08:32:55,031 [INFO] - Training epoch stats:     Loss: 0.0500 - F1-Score: 0.9781 - Accuracy-Score: 0.9781 - AUROC: 0.9992 - AP: 0.9981
[37m2024-08-14 08:32:55,112 [INFO] - Validation epoch stats:   Loss: 1.1243 - F1-Score: 0.8464 - Accuracy-Score: 0.8464 - AUROC: 0.9117 - AP: 0.7256
[37m2024-08-14 08:32:55,174 [INFO] - Epoch: 28/50
[37m2024-08-14 08:32:55,589 [INFO] - Training epoch stats:     Loss: 0.0425 - F1-Score: 0.9824 - Accuracy-Score: 0.9824 - AUROC: 0.9994 - AP: 0.9985
[37m2024-08-14 08:32:55,667 [INFO] - Validation epoch stats:   Loss: 1.1799 - F1-Score: 0.8486 - Accuracy-Score: 0.8486 - AUROC: 0.9132 - AP: 0.7444
[37m2024-08-14 08:32:55,723 [INFO] - Epoch: 29/50
[37m2024-08-14 08:32:56,188 [INFO] - Training epoch stats:     Loss: 0.0402 - F1-Score: 0.9825 - Accuracy-Score: 0.9825 - AUROC: 0.9995 - AP: 0.9988
[37m2024-08-14 08:32:56,242 [INFO] - Validation epoch stats:   Loss: 1.1618 - F1-Score: 0.8512 - Accuracy-Score: 0.8512 - AUROC: 0.9148 - AP: 0.7177
[37m2024-08-14 08:32:56,299 [INFO] - Epoch: 30/50
[37m2024-08-14 08:32:56,791 [INFO] - Training epoch stats:     Loss: 0.0422 - F1-Score: 0.9827 - Accuracy-Score: 0.9827 - AUROC: 0.9995 - AP: 0.9987
[37m2024-08-14 08:32:56,872 [INFO] - Validation epoch stats:   Loss: 1.2189 - F1-Score: 0.8486 - Accuracy-Score: 0.8486 - AUROC: 0.9113 - AP: 0.7243
[37m2024-08-14 08:32:56,932 [INFO] - Epoch: 31/50
[37m2024-08-14 08:32:57,332 [INFO] - Training epoch stats:     Loss: 0.0377 - F1-Score: 0.9834 - Accuracy-Score: 0.9834 - AUROC: 0.9996 - AP: 0.9991
[37m2024-08-14 08:32:57,388 [INFO] - Validation epoch stats:   Loss: 1.3967 - F1-Score: 0.8486 - Accuracy-Score: 0.8486 - AUROC: 0.8906 - AP: 0.7516
[37m2024-08-14 08:32:57,442 [INFO] - Epoch: 32/50
[37m2024-08-14 08:32:57,777 [INFO] - Training epoch stats:     Loss: 0.0332 - F1-Score: 0.9859 - Accuracy-Score: 0.9859 - AUROC: 0.9997 - AP: 0.9992
[37m2024-08-14 08:32:57,826 [INFO] - Validation epoch stats:   Loss: 1.4228 - F1-Score: 0.8433 - Accuracy-Score: 0.8433 - AUROC: 0.8893 - AP: 0.7044
[37m2024-08-14 08:32:57,884 [INFO] - Epoch: 33/50
[37m2024-08-14 08:32:58,186 [INFO] - Training epoch stats:     Loss: 0.0349 - F1-Score: 0.9847 - Accuracy-Score: 0.9847 - AUROC: 0.9996 - AP: 0.9992
[37m2024-08-14 08:32:58,239 [INFO] - Validation epoch stats:   Loss: 1.3504 - F1-Score: 0.8543 - Accuracy-Score: 0.8543 - AUROC: 0.9114 - AP: 0.7265
[37m2024-08-14 08:32:58,293 [INFO] - Epoch: 34/50
[37m2024-08-14 08:32:58,609 [INFO] - Training epoch stats:     Loss: 0.0348 - F1-Score: 0.9864 - Accuracy-Score: 0.9864 - AUROC: 0.9997 - AP: 0.9992
[37m2024-08-14 08:32:58,657 [INFO] - Validation epoch stats:   Loss: 1.3215 - F1-Score: 0.8482 - Accuracy-Score: 0.8482 - AUROC: 0.9118 - AP: 0.7128
[37m2024-08-14 08:32:58,716 [INFO] - Epoch: 35/50
[37m2024-08-14 08:32:58,999 [INFO] - Training epoch stats:     Loss: 0.0312 - F1-Score: 0.9867 - Accuracy-Score: 0.9867 - AUROC: 0.9997 - AP: 0.9994
[37m2024-08-14 08:32:59,038 [INFO] - Validation epoch stats:   Loss: 1.4395 - F1-Score: 0.8508 - Accuracy-Score: 0.8508 - AUROC: 0.9118 - AP: 0.7099
[37m2024-08-14 08:32:59,099 [INFO] - Epoch: 36/50
[37m2024-08-14 08:32:59,371 [INFO] - Training epoch stats:     Loss: 0.0286 - F1-Score: 0.9891 - Accuracy-Score: 0.9891 - AUROC: 0.9998 - AP: 0.9994
[37m2024-08-14 08:32:59,410 [INFO] - Validation epoch stats:   Loss: 1.4449 - F1-Score: 0.8468 - Accuracy-Score: 0.8468 - AUROC: 0.9098 - AP: 0.7062
[37m2024-08-14 08:32:59,411 [INFO] - Performing early stopping!
[37m2024-08-14 08:32:59,416 [INFO] - Finished run w0tmf4ov
