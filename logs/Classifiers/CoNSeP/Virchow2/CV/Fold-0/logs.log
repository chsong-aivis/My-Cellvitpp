[37m2024-08-14 08:28:21,830 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-14 08:28:21,832 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow2/CV/2024-08-14T082811_Fold-0
[37m2024-08-14 08:28:21,897 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f9b86fef220>]
[37m2024-08-14 08:28:21,903 [INFO] - Using GPU: cuda:0
[37m2024-08-14 08:28:21,908 [INFO] - Using device: cuda:0
[37m2024-08-14 08:28:21,912 [INFO] - Loss function:
[37m2024-08-14 08:28:21,917 [INFO] - CrossEntropyLoss()
[37m2024-08-14 08:28:56,760 [INFO] - <All keys matched successfully>
[37m2024-08-14 08:29:08,667 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-14 08:29:08,670 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-14 08:29:08,676 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.008654182430904838, 'weight_decay': 7.674533159811504e-05}
[37m2024-08-14 08:29:08,681 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-14 08:29:08,759 [INFO] - Caching datasets
[37m2024-08-14 08:29:11,081 [INFO] - Instantiate Trainer
[37m2024-08-14 08:29:11,100 [INFO] - Calling Trainer Fit
[37m2024-08-14 08:29:11,105 [INFO] - Dataset is cached after first epoch
[37m2024-08-14 08:29:11,110 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-14 08:29:11,155 [INFO] - Epoch: 1/50
[37m2024-08-14 08:29:14,419 [INFO] - Loaded dataset from cache: /Consep/cache/a88534d44301f7560ceb1aa5731cd271affc05b308dcf1ac8e37ff54a558a950.h5
[37m2024-08-14 08:29:16,970 [INFO] - Training epoch stats:     Loss: 0.4614 - F1-Score: 0.8379 - Accuracy-Score: 0.8379 - AUROC: 0.9378 - AP: 0.7764
[37m2024-08-14 08:29:19,078 [INFO] - Loaded dataset from cache: /Consep/cache/0e75821d52298e551780939bf7e8b1149736c0505386fad781a094a4d83b27cc.h5
[37m2024-08-14 08:29:21,570 [INFO] - Validation epoch stats:   Loss: 0.5593 - F1-Score: 0.8224 - Accuracy-Score: 0.8224 - AUROC: 0.9483 - AP: 0.8476
[37m2024-08-14 08:29:21,655 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:29:21,834 [INFO] - Epoch: 2/50
[37m2024-08-14 08:29:23,173 [INFO] - Training epoch stats:     Loss: 0.2635 - F1-Score: 0.8944 - Accuracy-Score: 0.8944 - AUROC: 0.9807 - AP: 0.9154
[37m2024-08-14 08:29:23,414 [INFO] - Validation epoch stats:   Loss: 0.4689 - F1-Score: 0.8491 - Accuracy-Score: 0.8491 - AUROC: 0.9531 - AP: 0.8749
[37m2024-08-14 08:29:23,420 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:29:23,628 [INFO] - Epoch: 3/50
[37m2024-08-14 08:29:24,676 [INFO] - Training epoch stats:     Loss: 0.2305 - F1-Score: 0.9077 - Accuracy-Score: 0.9077 - AUROC: 0.9855 - AP: 0.9438
[37m2024-08-14 08:29:24,896 [INFO] - Validation epoch stats:   Loss: 0.4213 - F1-Score: 0.8813 - Accuracy-Score: 0.8813 - AUROC: 0.9543 - AP: 0.8627
[37m2024-08-14 08:29:24,902 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:29:25,065 [INFO] - Epoch: 4/50
[37m2024-08-14 08:29:26,267 [INFO] - Training epoch stats:     Loss: 0.2182 - F1-Score: 0.9107 - Accuracy-Score: 0.9107 - AUROC: 0.9873 - AP: 0.9504
[37m2024-08-14 08:29:26,444 [INFO] - Validation epoch stats:   Loss: 0.4227 - F1-Score: 0.8785 - Accuracy-Score: 0.8785 - AUROC: 0.9570 - AP: 0.8683
[37m2024-08-14 08:29:26,450 [INFO] - New best model - save checkpoint
[37m2024-08-14 08:29:26,627 [INFO] - Epoch: 5/50
[37m2024-08-14 08:29:28,864 [INFO] - Training epoch stats:     Loss: 0.2062 - F1-Score: 0.9168 - Accuracy-Score: 0.9168 - AUROC: 0.9883 - AP: 0.9657
[37m2024-08-14 08:29:29,367 [INFO] - Validation epoch stats:   Loss: 0.5640 - F1-Score: 0.8308 - Accuracy-Score: 0.8308 - AUROC: 0.9503 - AP: 0.8441
[37m2024-08-14 08:29:29,519 [INFO] - Epoch: 6/50
[37m2024-08-14 08:29:32,001 [INFO] - Training epoch stats:     Loss: 0.1928 - F1-Score: 0.9202 - Accuracy-Score: 0.9202 - AUROC: 0.9900 - AP: 0.9736
[37m2024-08-14 08:29:32,166 [INFO] - Validation epoch stats:   Loss: 0.7458 - F1-Score: 0.7673 - Accuracy-Score: 0.7673 - AUROC: 0.9448 - AP: 0.8541
[37m2024-08-14 08:29:32,240 [INFO] - Epoch: 7/50
[37m2024-08-14 08:29:32,874 [INFO] - Training epoch stats:     Loss: 0.1837 - F1-Score: 0.9208 - Accuracy-Score: 0.9208 - AUROC: 0.9909 - AP: 0.9759
[37m2024-08-14 08:29:33,032 [INFO] - Validation epoch stats:   Loss: 0.5213 - F1-Score: 0.8841 - Accuracy-Score: 0.8841 - AUROC: 0.9528 - AP: 0.8591
[37m2024-08-14 08:29:33,106 [INFO] - Epoch: 8/50
[37m2024-08-14 08:29:34,071 [INFO] - Training epoch stats:     Loss: 0.1793 - F1-Score: 0.9246 - Accuracy-Score: 0.9246 - AUROC: 0.9913 - AP: 0.9808
[37m2024-08-14 08:29:34,174 [INFO] - Validation epoch stats:   Loss: 0.6351 - F1-Score: 0.8383 - Accuracy-Score: 0.8383 - AUROC: 0.9454 - AP: 0.8478
[37m2024-08-14 08:29:34,243 [INFO] - Epoch: 9/50
[37m2024-08-14 08:29:35,074 [INFO] - Training epoch stats:     Loss: 0.1630 - F1-Score: 0.9292 - Accuracy-Score: 0.9292 - AUROC: 0.9926 - AP: 0.9801
[37m2024-08-14 08:29:35,186 [INFO] - Validation epoch stats:   Loss: 0.6162 - F1-Score: 0.8584 - Accuracy-Score: 0.8584 - AUROC: 0.9471 - AP: 0.8461
[37m2024-08-14 08:29:35,257 [INFO] - Epoch: 10/50
[37m2024-08-14 08:29:35,823 [INFO] - Training epoch stats:     Loss: 0.1532 - F1-Score: 0.9346 - Accuracy-Score: 0.9346 - AUROC: 0.9933 - AP: 0.9823
[37m2024-08-14 08:29:35,944 [INFO] - Validation epoch stats:   Loss: 0.7274 - F1-Score: 0.8491 - Accuracy-Score: 0.8491 - AUROC: 0.9376 - AP: 0.8099
[37m2024-08-14 08:29:36,005 [INFO] - Epoch: 11/50
[37m2024-08-14 08:29:36,615 [INFO] - Training epoch stats:     Loss: 0.1452 - F1-Score: 0.9370 - Accuracy-Score: 0.9370 - AUROC: 0.9938 - AP: 0.9863
[37m2024-08-14 08:29:36,752 [INFO] - Validation epoch stats:   Loss: 0.8163 - F1-Score: 0.8313 - Accuracy-Score: 0.8313 - AUROC: 0.9388 - AP: 0.8202
[37m2024-08-14 08:29:36,817 [INFO] - Epoch: 12/50
[37m2024-08-14 08:29:37,493 [INFO] - Training epoch stats:     Loss: 0.1357 - F1-Score: 0.9418 - Accuracy-Score: 0.9418 - AUROC: 0.9946 - AP: 0.9897
[37m2024-08-14 08:29:37,668 [INFO] - Validation epoch stats:   Loss: 0.7039 - F1-Score: 0.8509 - Accuracy-Score: 0.8509 - AUROC: 0.9451 - AP: 0.8376
[37m2024-08-14 08:29:37,744 [INFO] - Epoch: 13/50
[37m2024-08-14 08:29:38,495 [INFO] - Training epoch stats:     Loss: 0.1311 - F1-Score: 0.9430 - Accuracy-Score: 0.9430 - AUROC: 0.9951 - AP: 0.9898
[37m2024-08-14 08:29:38,620 [INFO] - Validation epoch stats:   Loss: 0.9003 - F1-Score: 0.8266 - Accuracy-Score: 0.8266 - AUROC: 0.9299 - AP: 0.8110
[37m2024-08-14 08:29:38,693 [INFO] - Epoch: 14/50
[37m2024-08-14 08:29:39,511 [INFO] - Training epoch stats:     Loss: 0.1156 - F1-Score: 0.9483 - Accuracy-Score: 0.9483 - AUROC: 0.9959 - AP: 0.9921
[37m2024-08-14 08:29:39,591 [INFO] - Validation epoch stats:   Loss: 1.0584 - F1-Score: 0.8079 - Accuracy-Score: 0.8079 - AUROC: 0.9306 - AP: 0.7882
[37m2024-08-14 08:29:39,664 [INFO] - Epoch: 15/50
[37m2024-08-14 08:29:40,180 [INFO] - Training epoch stats:     Loss: 0.1108 - F1-Score: 0.9523 - Accuracy-Score: 0.9523 - AUROC: 0.9963 - AP: 0.9931
[37m2024-08-14 08:29:40,308 [INFO] - Validation epoch stats:   Loss: 0.9869 - F1-Score: 0.8187 - Accuracy-Score: 0.8187 - AUROC: 0.9345 - AP: 0.8217
[37m2024-08-14 08:29:40,370 [INFO] - Epoch: 16/50
[37m2024-08-14 08:29:40,883 [INFO] - Training epoch stats:     Loss: 0.1055 - F1-Score: 0.9538 - Accuracy-Score: 0.9538 - AUROC: 0.9966 - AP: 0.9939
[37m2024-08-14 08:29:40,984 [INFO] - Validation epoch stats:   Loss: 1.1049 - F1-Score: 0.7902 - Accuracy-Score: 0.7902 - AUROC: 0.9372 - AP: 0.8161
[37m2024-08-14 08:29:41,055 [INFO] - Epoch: 17/50
[37m2024-08-14 08:29:41,638 [INFO] - Training epoch stats:     Loss: 0.0971 - F1-Score: 0.9585 - Accuracy-Score: 0.9585 - AUROC: 0.9971 - AP: 0.9946
[37m2024-08-14 08:29:41,727 [INFO] - Validation epoch stats:   Loss: 0.9792 - F1-Score: 0.8294 - Accuracy-Score: 0.8294 - AUROC: 0.9345 - AP: 0.8163
[37m2024-08-14 08:29:41,790 [INFO] - Epoch: 18/50
[37m2024-08-14 08:29:42,236 [INFO] - Training epoch stats:     Loss: 0.0936 - F1-Score: 0.9588 - Accuracy-Score: 0.9588 - AUROC: 0.9973 - AP: 0.9949
[37m2024-08-14 08:29:42,332 [INFO] - Validation epoch stats:   Loss: 1.0191 - F1-Score: 0.8238 - Accuracy-Score: 0.8238 - AUROC: 0.9332 - AP: 0.8218
[37m2024-08-14 08:29:42,398 [INFO] - Epoch: 19/50
[37m2024-08-14 08:29:43,122 [INFO] - Training epoch stats:     Loss: 0.0888 - F1-Score: 0.9610 - Accuracy-Score: 0.9610 - AUROC: 0.9976 - AP: 0.9936
[37m2024-08-14 08:29:43,209 [INFO] - Validation epoch stats:   Loss: 1.1717 - F1-Score: 0.8285 - Accuracy-Score: 0.8285 - AUROC: 0.9272 - AP: 0.7871
[37m2024-08-14 08:29:43,278 [INFO] - Epoch: 20/50
[37m2024-08-14 08:29:44,031 [INFO] - Training epoch stats:     Loss: 0.0818 - F1-Score: 0.9632 - Accuracy-Score: 0.9632 - AUROC: 0.9979 - AP: 0.9963
[37m2024-08-14 08:29:44,090 [INFO] - Validation epoch stats:   Loss: 1.2552 - F1-Score: 0.7977 - Accuracy-Score: 0.7977 - AUROC: 0.9275 - AP: 0.8106
[37m2024-08-14 08:29:44,157 [INFO] - Epoch: 21/50
[37m2024-08-14 08:29:44,818 [INFO] - Training epoch stats:     Loss: 0.0833 - F1-Score: 0.9637 - Accuracy-Score: 0.9637 - AUROC: 0.9978 - AP: 0.9957
[37m2024-08-14 08:29:44,897 [INFO] - Validation epoch stats:   Loss: 1.2508 - F1-Score: 0.8224 - Accuracy-Score: 0.8224 - AUROC: 0.9264 - AP: 0.7970
[37m2024-08-14 08:29:44,959 [INFO] - Epoch: 22/50
[37m2024-08-14 08:29:45,636 [INFO] - Training epoch stats:     Loss: 0.0758 - F1-Score: 0.9640 - Accuracy-Score: 0.9640 - AUROC: 0.9982 - AP: 0.9964
[37m2024-08-14 08:29:45,725 [INFO] - Validation epoch stats:   Loss: 1.3025 - F1-Score: 0.8084 - Accuracy-Score: 0.8084 - AUROC: 0.9219 - AP: 0.7942
[37m2024-08-14 08:29:45,787 [INFO] - Epoch: 23/50
[37m2024-08-14 08:29:46,346 [INFO] - Training epoch stats:     Loss: 0.0726 - F1-Score: 0.9671 - Accuracy-Score: 0.9671 - AUROC: 0.9984 - AP: 0.9971
[37m2024-08-14 08:29:46,438 [INFO] - Validation epoch stats:   Loss: 1.2763 - F1-Score: 0.8280 - Accuracy-Score: 0.8280 - AUROC: 0.9254 - AP: 0.8042
[37m2024-08-14 08:29:46,503 [INFO] - Epoch: 24/50
[37m2024-08-14 08:29:46,925 [INFO] - Training epoch stats:     Loss: 0.0709 - F1-Score: 0.9696 - Accuracy-Score: 0.9696 - AUROC: 0.9984 - AP: 0.9970
[37m2024-08-14 08:29:46,991 [INFO] - Validation epoch stats:   Loss: 1.2335 - F1-Score: 0.8439 - Accuracy-Score: 0.8439 - AUROC: 0.9280 - AP: 0.8046
[37m2024-08-14 08:29:46,998 [INFO] - Performing early stopping!
[37m2024-08-14 08:29:47,004 [INFO] - Finished run 29jk6ih2
