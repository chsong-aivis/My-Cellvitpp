[37m2024-08-11 09:54:44,903 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 09:54:44,904 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow/Setting-2-Aug/2024-08-11T095436_Fold-2
[37m2024-08-11 09:54:44,970 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f3182730040>]
[37m2024-08-11 09:54:44,971 [INFO] - Using GPU: cuda:0
[37m2024-08-11 09:54:44,976 [INFO] - Using device: cuda:0
[37m2024-08-11 09:54:44,981 [INFO] - Loss function:
[37m2024-08-11 09:54:44,987 [INFO] - CrossEntropyLoss()
[37m2024-08-11 09:54:54,067 [INFO] - <All keys matched successfully>
[37m2024-08-11 09:54:55,264 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 09:54:55,265 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 09:54:55,271 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00568059820179996, 'weight_decay': 0.0004714549691487939}
[37m2024-08-11 09:54:55,276 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 09:54:55,292 [INFO] - Caching datasets
[37m2024-08-11 09:54:56,485 [INFO] - Instantiate Trainer
[37m2024-08-11 09:54:56,491 [INFO] - Calling Trainer Fit
[37m2024-08-11 09:54:56,492 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 09:54:56,498 [INFO] - Epoch: 1/50
[37m2024-08-11 09:54:56,503 [INFO] - Extracting training cells
[37m2024-08-11 09:55:26,024 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.766, Recall: 0.696, Detected-Cells: 7660
[37m2024-08-11 09:55:26,462 [INFO] - Training epoch stats:     Loss: 0.3676 - F1-Score: 0.8587 - Accuracy-Score: 0.8587 - AUROC: 0.9617 - AP: 0.8393
[37m2024-08-11 09:55:27,030 [INFO] - Loaded dataset from cache: /Consep/cache/d4e8ea73f4c91488644bdee9c7f5133c5e4b86594c668c2613d537d65f9b0c96.h5
[37m2024-08-11 09:55:27,090 [INFO] - Validation epoch stats:   Loss: 0.3931 - F1-Score: 0.8442 - Accuracy-Score: 0.8442 - AUROC: 0.9501 - AP: 0.8079
[37m2024-08-11 09:55:27,090 [INFO] - New best model - save checkpoint
[37m2024-08-11 09:55:27,270 [INFO] - Epoch: 2/50
[37m2024-08-11 09:55:27,272 [INFO] - Extracting training cells
[37m2024-08-11 09:55:49,439 [INFO] - Extraction detection metrics - F1: 0.709, Precision: 0.749, Recall: 0.697, Detected-Cells: 8757
[37m2024-08-11 09:55:49,764 [INFO] - Training epoch stats:     Loss: 0.3419 - F1-Score: 0.8754 - Accuracy-Score: 0.8754 - AUROC: 0.9687 - AP: 0.8781
[37m2024-08-11 09:55:49,855 [INFO] - Validation epoch stats:   Loss: 0.3255 - F1-Score: 0.8631 - Accuracy-Score: 0.8631 - AUROC: 0.9629 - AP: 0.8189
[37m2024-08-11 09:55:49,856 [INFO] - New best model - save checkpoint
[37m2024-08-11 09:55:50,042 [INFO] - Epoch: 3/50
[37m2024-08-11 09:55:50,043 [INFO] - Extracting training cells
[37m2024-08-11 09:56:11,669 [INFO] - Extraction detection metrics - F1: 0.730, Precision: 0.758, Recall: 0.735, Detected-Cells: 8829
[37m2024-08-11 09:56:12,005 [INFO] - Training epoch stats:     Loss: 0.2716 - F1-Score: 0.9008 - Accuracy-Score: 0.9008 - AUROC: 0.9796 - AP: 0.9199
[37m2024-08-11 09:56:12,103 [INFO] - Validation epoch stats:   Loss: 0.2989 - F1-Score: 0.8747 - Accuracy-Score: 0.8747 - AUROC: 0.9678 - AP: 0.8063
[37m2024-08-11 09:56:12,104 [INFO] - New best model - save checkpoint
[37m2024-08-11 09:56:12,280 [INFO] - Epoch: 4/50
[37m2024-08-11 09:56:12,280 [INFO] - Extracting training cells
[37m2024-08-11 09:56:33,771 [INFO] - Extraction detection metrics - F1: 0.709, Precision: 0.746, Recall: 0.715, Detected-Cells: 8184
[37m2024-08-11 09:56:34,075 [INFO] - Training epoch stats:     Loss: 0.2781 - F1-Score: 0.8886 - Accuracy-Score: 0.8886 - AUROC: 0.9809 - AP: 0.9354
[37m2024-08-11 09:56:34,154 [INFO] - Validation epoch stats:   Loss: 0.3532 - F1-Score: 0.8579 - Accuracy-Score: 0.8579 - AUROC: 0.9664 - AP: 0.8029
[37m2024-08-11 09:56:34,225 [INFO] - Epoch: 5/50
[37m2024-08-11 09:56:34,225 [INFO] - Extracting training cells
[37m2024-08-11 09:56:54,846 [INFO] - Extraction detection metrics - F1: 0.706, Precision: 0.734, Recall: 0.705, Detected-Cells: 8350
[37m2024-08-11 09:56:55,134 [INFO] - Training epoch stats:     Loss: 0.3438 - F1-Score: 0.8665 - Accuracy-Score: 0.8665 - AUROC: 0.9663 - AP: 0.8694
[37m2024-08-11 09:56:55,213 [INFO] - Validation epoch stats:   Loss: 0.2979 - F1-Score: 0.8752 - Accuracy-Score: 0.8752 - AUROC: 0.9672 - AP: 0.8119
[37m2024-08-11 09:56:55,275 [INFO] - Epoch: 6/50
[37m2024-08-11 09:56:55,276 [INFO] - Extracting training cells
[37m2024-08-11 09:57:16,780 [INFO] - Extraction detection metrics - F1: 0.721, Precision: 0.750, Recall: 0.712, Detected-Cells: 9159
[37m2024-08-11 09:57:17,064 [INFO] - Training epoch stats:     Loss: 0.2217 - F1-Score: 0.9159 - Accuracy-Score: 0.9159 - AUROC: 0.9876 - AP: 0.9561
[37m2024-08-11 09:57:17,130 [INFO] - Validation epoch stats:   Loss: 0.3493 - F1-Score: 0.8765 - Accuracy-Score: 0.8765 - AUROC: 0.9670 - AP: 0.8053
[37m2024-08-11 09:57:17,192 [INFO] - Epoch: 7/50
[37m2024-08-11 09:57:17,193 [INFO] - Extracting training cells
[37m2024-08-11 09:57:38,484 [INFO] - Extraction detection metrics - F1: 0.742, Precision: 0.767, Recall: 0.739, Detected-Cells: 9254
[37m2024-08-11 09:57:38,821 [INFO] - Training epoch stats:     Loss: 0.2519 - F1-Score: 0.9033 - Accuracy-Score: 0.9033 - AUROC: 0.9855 - AP: 0.9556
[37m2024-08-11 09:57:38,899 [INFO] - Validation epoch stats:   Loss: 0.3198 - F1-Score: 0.8747 - Accuracy-Score: 0.8747 - AUROC: 0.9618 - AP: 0.7970
[37m2024-08-11 09:57:38,968 [INFO] - Epoch: 8/50
[37m2024-08-11 09:57:38,969 [INFO] - Extracting training cells
[37m2024-08-11 09:57:59,963 [INFO] - Extraction detection metrics - F1: 0.701, Precision: 0.751, Recall: 0.688, Detected-Cells: 8232
[37m2024-08-11 09:58:00,218 [INFO] - Training epoch stats:     Loss: 0.1886 - F1-Score: 0.9218 - Accuracy-Score: 0.9218 - AUROC: 0.9909 - AP: 0.9745
[37m2024-08-11 09:58:00,284 [INFO] - Validation epoch stats:   Loss: 0.3373 - F1-Score: 0.8739 - Accuracy-Score: 0.8739 - AUROC: 0.9615 - AP: 0.8158
[37m2024-08-11 09:58:00,352 [INFO] - Epoch: 9/50
[37m2024-08-11 09:58:00,353 [INFO] - Extracting training cells
[37m2024-08-11 09:58:21,770 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.749, Recall: 0.718, Detected-Cells: 8724
[37m2024-08-11 09:58:22,038 [INFO] - Training epoch stats:     Loss: 0.2708 - F1-Score: 0.9018 - Accuracy-Score: 0.9018 - AUROC: 0.9793 - AP: 0.9328
[37m2024-08-11 09:58:22,103 [INFO] - Validation epoch stats:   Loss: 0.3479 - F1-Score: 0.8614 - Accuracy-Score: 0.8614 - AUROC: 0.9587 - AP: 0.7926
[37m2024-08-11 09:58:22,182 [INFO] - Epoch: 10/50
[37m2024-08-11 09:58:22,183 [INFO] - Extracting training cells
[37m2024-08-11 09:58:43,271 [INFO] - Extraction detection metrics - F1: 0.728, Precision: 0.755, Recall: 0.724, Detected-Cells: 9080
[37m2024-08-11 09:58:43,663 [INFO] - Training epoch stats:     Loss: 0.1896 - F1-Score: 0.9246 - Accuracy-Score: 0.9246 - AUROC: 0.9899 - AP: 0.9698
[37m2024-08-11 09:58:43,772 [INFO] - Validation epoch stats:   Loss: 0.3287 - F1-Score: 0.8700 - Accuracy-Score: 0.8700 - AUROC: 0.9629 - AP: 0.8200
[37m2024-08-11 09:58:43,842 [INFO] - Epoch: 11/50
[37m2024-08-11 09:58:43,842 [INFO] - Extracting training cells
[37m2024-08-11 09:59:06,276 [INFO] - Extraction detection metrics - F1: 0.726, Precision: 0.758, Recall: 0.716, Detected-Cells: 9134
[37m2024-08-11 09:59:06,651 [INFO] - Training epoch stats:     Loss: 0.2300 - F1-Score: 0.9172 - Accuracy-Score: 0.9172 - AUROC: 0.9853 - AP: 0.9355
[37m2024-08-11 09:59:06,752 [INFO] - Validation epoch stats:   Loss: 0.3711 - F1-Score: 0.8678 - Accuracy-Score: 0.8678 - AUROC: 0.9612 - AP: 0.7892
[37m2024-08-11 09:59:06,821 [INFO] - Epoch: 12/50
[37m2024-08-11 09:59:06,821 [INFO] - Extracting training cells
[37m2024-08-11 09:59:28,334 [INFO] - Extraction detection metrics - F1: 0.730, Precision: 0.772, Recall: 0.714, Detected-Cells: 8911
[37m2024-08-11 09:59:28,696 [INFO] - Training epoch stats:     Loss: 0.1920 - F1-Score: 0.9240 - Accuracy-Score: 0.9240 - AUROC: 0.9906 - AP: 0.9675
[37m2024-08-11 09:59:28,796 [INFO] - Validation epoch stats:   Loss: 0.4350 - F1-Score: 0.8678 - Accuracy-Score: 0.8678 - AUROC: 0.9608 - AP: 0.8056
[37m2024-08-11 09:59:28,870 [INFO] - Epoch: 13/50
[37m2024-08-11 09:59:28,870 [INFO] - Extracting training cells
[37m2024-08-11 09:59:49,968 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.764, Recall: 0.696, Detected-Cells: 9136
[37m2024-08-11 09:59:50,294 [INFO] - Training epoch stats:     Loss: 0.1738 - F1-Score: 0.9307 - Accuracy-Score: 0.9307 - AUROC: 0.9918 - AP: 0.9720
[37m2024-08-11 09:59:50,375 [INFO] - Validation epoch stats:   Loss: 0.3980 - F1-Score: 0.8670 - Accuracy-Score: 0.8670 - AUROC: 0.9629 - AP: 0.8012
[37m2024-08-11 09:59:50,453 [INFO] - Epoch: 14/50
[37m2024-08-11 09:59:50,454 [INFO] - Extracting training cells
[37m2024-08-11 10:00:11,315 [INFO] - Extraction detection metrics - F1: 0.726, Precision: 0.772, Recall: 0.722, Detected-Cells: 8401
[37m2024-08-11 10:00:11,633 [INFO] - Training epoch stats:     Loss: 0.3600 - F1-Score: 0.8633 - Accuracy-Score: 0.8633 - AUROC: 0.9689 - AP: 0.9011
[37m2024-08-11 10:00:11,723 [INFO] - Validation epoch stats:   Loss: 0.3943 - F1-Score: 0.8584 - Accuracy-Score: 0.8584 - AUROC: 0.9589 - AP: 0.8073
[37m2024-08-11 10:00:11,795 [INFO] - Epoch: 15/50
[37m2024-08-11 10:00:11,795 [INFO] - Extracting training cells
[37m2024-08-11 10:00:33,697 [INFO] - Extraction detection metrics - F1: 0.703, Precision: 0.733, Recall: 0.700, Detected-Cells: 8110
[37m2024-08-11 10:00:34,005 [INFO] - Training epoch stats:     Loss: 0.1863 - F1-Score: 0.9258 - Accuracy-Score: 0.9258 - AUROC: 0.9920 - AP: 0.9697
[37m2024-08-11 10:00:34,079 [INFO] - Validation epoch stats:   Loss: 0.4360 - F1-Score: 0.8627 - Accuracy-Score: 0.8627 - AUROC: 0.9600 - AP: 0.7955
[37m2024-08-11 10:00:34,142 [INFO] - Epoch: 16/50
[37m2024-08-11 10:00:34,143 [INFO] - Extracting training cells
[37m2024-08-11 10:00:54,488 [INFO] - Extraction detection metrics - F1: 0.717, Precision: 0.737, Recall: 0.716, Detected-Cells: 8467
[37m2024-08-11 10:00:54,842 [INFO] - Training epoch stats:     Loss: 0.2431 - F1-Score: 0.9086 - Accuracy-Score: 0.9086 - AUROC: 0.9837 - AP: 0.9400
[37m2024-08-11 10:00:54,941 [INFO] - Validation epoch stats:   Loss: 0.4074 - F1-Score: 0.8592 - Accuracy-Score: 0.8592 - AUROC: 0.9540 - AP: 0.7911
[37m2024-08-11 10:00:55,014 [INFO] - Epoch: 17/50
[37m2024-08-11 10:00:55,015 [INFO] - Extracting training cells
[37m2024-08-11 10:01:16,615 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.766, Recall: 0.692, Detected-Cells: 8889
[37m2024-08-11 10:01:16,959 [INFO] - Training epoch stats:     Loss: 0.1627 - F1-Score: 0.9337 - Accuracy-Score: 0.9337 - AUROC: 0.9933 - AP: 0.9760
[37m2024-08-11 10:01:17,050 [INFO] - Validation epoch stats:   Loss: 0.3996 - F1-Score: 0.8648 - Accuracy-Score: 0.8648 - AUROC: 0.9601 - AP: 0.7881
[37m2024-08-11 10:01:17,127 [INFO] - Epoch: 18/50
[37m2024-08-11 10:01:17,128 [INFO] - Extracting training cells
[37m2024-08-11 10:01:38,976 [INFO] - Extraction detection metrics - F1: 0.728, Precision: 0.763, Recall: 0.716, Detected-Cells: 9177
[37m2024-08-11 10:01:39,356 [INFO] - Training epoch stats:     Loss: 0.1623 - F1-Score: 0.9337 - Accuracy-Score: 0.9337 - AUROC: 0.9933 - AP: 0.9774
[37m2024-08-11 10:01:39,457 [INFO] - Validation epoch stats:   Loss: 0.4673 - F1-Score: 0.8558 - Accuracy-Score: 0.8558 - AUROC: 0.9623 - AP: 0.7699
[37m2024-08-11 10:01:39,527 [INFO] - Epoch: 19/50
[37m2024-08-11 10:01:39,528 [INFO] - Extracting training cells
[37m2024-08-11 10:02:01,942 [INFO] - Extraction detection metrics - F1: 0.723, Precision: 0.766, Recall: 0.710, Detected-Cells: 9394
[37m2024-08-11 10:02:02,244 [INFO] - Training epoch stats:     Loss: 0.1528 - F1-Score: 0.9374 - Accuracy-Score: 0.9374 - AUROC: 0.9932 - AP: 0.9794
[37m2024-08-11 10:02:02,311 [INFO] - Validation epoch stats:   Loss: 0.4635 - F1-Score: 0.8571 - Accuracy-Score: 0.8571 - AUROC: 0.9563 - AP: 0.7895
[37m2024-08-11 10:02:02,377 [INFO] - Epoch: 20/50
[37m2024-08-11 10:02:02,377 [INFO] - Extracting training cells
[37m2024-08-11 10:02:23,317 [INFO] - Extraction detection metrics - F1: 0.719, Precision: 0.755, Recall: 0.712, Detected-Cells: 8581
[37m2024-08-11 10:02:23,637 [INFO] - Training epoch stats:     Loss: 0.3203 - F1-Score: 0.8739 - Accuracy-Score: 0.8739 - AUROC: 0.9799 - AP: 0.9451
[37m2024-08-11 10:02:23,732 [INFO] - Validation epoch stats:   Loss: 0.4866 - F1-Score: 0.8532 - Accuracy-Score: 0.8532 - AUROC: 0.9486 - AP: 0.7900
[37m2024-08-11 10:02:23,801 [INFO] - Epoch: 21/50
[37m2024-08-11 10:02:23,802 [INFO] - Extracting training cells
[37m2024-08-11 10:02:46,179 [INFO] - Extraction detection metrics - F1: 0.703, Precision: 0.720, Recall: 0.734, Detected-Cells: 8036
[37m2024-08-11 10:02:46,439 [INFO] - Training epoch stats:     Loss: 0.2108 - F1-Score: 0.9200 - Accuracy-Score: 0.9200 - AUROC: 0.9884 - AP: 0.9593
[37m2024-08-11 10:02:46,507 [INFO] - Validation epoch stats:   Loss: 0.4467 - F1-Score: 0.8506 - Accuracy-Score: 0.8506 - AUROC: 0.9487 - AP: 0.7877
[37m2024-08-11 10:02:46,575 [INFO] - Epoch: 22/50
[37m2024-08-11 10:02:46,576 [INFO] - Extracting training cells
[37m2024-08-11 10:03:08,483 [INFO] - Extraction detection metrics - F1: 0.709, Precision: 0.758, Recall: 0.696, Detected-Cells: 8701
[37m2024-08-11 10:03:08,802 [INFO] - Training epoch stats:     Loss: 0.1816 - F1-Score: 0.9277 - Accuracy-Score: 0.9277 - AUROC: 0.9919 - AP: 0.9686
[37m2024-08-11 10:03:08,880 [INFO] - Validation epoch stats:   Loss: 0.4514 - F1-Score: 0.8511 - Accuracy-Score: 0.8511 - AUROC: 0.9542 - AP: 0.8049
[37m2024-08-11 10:03:08,950 [INFO] - Epoch: 23/50
[37m2024-08-11 10:03:08,951 [INFO] - Extracting training cells
[37m2024-08-11 10:03:31,055 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.755, Recall: 0.705, Detected-Cells: 9007
[37m2024-08-11 10:03:31,426 [INFO] - Training epoch stats:     Loss: 0.1437 - F1-Score: 0.9407 - Accuracy-Score: 0.9407 - AUROC: 0.9947 - AP: 0.9842
[37m2024-08-11 10:03:31,531 [INFO] - Validation epoch stats:   Loss: 0.4860 - F1-Score: 0.8545 - Accuracy-Score: 0.8545 - AUROC: 0.9467 - AP: 0.7868
[37m2024-08-11 10:03:31,532 [INFO] - Performing early stopping!
[37m2024-08-11 10:03:31,540 [INFO] - Finished run 7oxl3dcj
