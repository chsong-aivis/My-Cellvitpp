[37m2024-08-11 10:04:04,625 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 10:04:04,627 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow/Setting-2-Aug/2024-08-11T100354_Fold-3
[37m2024-08-11 10:04:04,701 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fb56f048070>]
[37m2024-08-11 10:04:04,702 [INFO] - Using GPU: cuda:0
[37m2024-08-11 10:04:04,708 [INFO] - Using device: cuda:0
[37m2024-08-11 10:04:04,713 [INFO] - Loss function:
[37m2024-08-11 10:04:04,717 [INFO] - CrossEntropyLoss()
[37m2024-08-11 10:04:13,165 [INFO] - <All keys matched successfully>
[37m2024-08-11 10:04:14,163 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 10:04:14,165 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 10:04:14,169 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00568059820179996, 'weight_decay': 0.0004714549691487939}
[37m2024-08-11 10:04:14,174 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 10:04:14,187 [INFO] - Caching datasets
[37m2024-08-11 10:04:15,066 [INFO] - Instantiate Trainer
[37m2024-08-11 10:04:15,070 [INFO] - Calling Trainer Fit
[37m2024-08-11 10:04:15,072 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 10:04:15,077 [INFO] - Epoch: 1/50
[37m2024-08-11 10:04:15,083 [INFO] - Extracting training cells
[37m2024-08-11 10:04:43,508 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.784, Recall: 0.682, Detected-Cells: 7787
[37m2024-08-11 10:04:43,846 [INFO] - Training epoch stats:     Loss: 0.3680 - F1-Score: 0.8549 - Accuracy-Score: 0.8549 - AUROC: 0.9587 - AP: 0.8336
[37m2024-08-11 10:04:44,575 [INFO] - Loaded dataset from cache: /Consep/cache/9791311761326234490ab8c48c2c524af9470472c837eadab609878360cc5465.h5
[37m2024-08-11 10:04:44,967 [INFO] - Validation epoch stats:   Loss: 0.6082 - F1-Score: 0.7759 - Accuracy-Score: 0.7759 - AUROC: 0.9318 - AP: 0.7116
[37m2024-08-11 10:04:44,968 [INFO] - New best model - save checkpoint
[37m2024-08-11 10:04:45,132 [INFO] - Epoch: 2/50
[37m2024-08-11 10:04:45,133 [INFO] - Extracting training cells
[37m2024-08-11 10:05:05,311 [INFO] - Extraction detection metrics - F1: 0.697, Precision: 0.760, Recall: 0.679, Detected-Cells: 7630
[37m2024-08-11 10:05:05,608 [INFO] - Training epoch stats:     Loss: 0.3151 - F1-Score: 0.8672 - Accuracy-Score: 0.8672 - AUROC: 0.9695 - AP: 0.8764
[37m2024-08-11 10:05:05,728 [INFO] - Validation epoch stats:   Loss: 0.6744 - F1-Score: 0.6993 - Accuracy-Score: 0.6993 - AUROC: 0.9386 - AP: 0.7167
[37m2024-08-11 10:05:05,729 [INFO] - New best model - save checkpoint
[37m2024-08-11 10:05:05,884 [INFO] - Epoch: 3/50
[37m2024-08-11 10:05:05,885 [INFO] - Extracting training cells
[37m2024-08-11 10:05:25,982 [INFO] - Extraction detection metrics - F1: 0.731, Precision: 0.773, Recall: 0.725, Detected-Cells: 7904
[37m2024-08-11 10:05:26,266 [INFO] - Training epoch stats:     Loss: 0.3173 - F1-Score: 0.8760 - Accuracy-Score: 0.8760 - AUROC: 0.9731 - AP: 0.9051
[37m2024-08-11 10:05:26,361 [INFO] - Validation epoch stats:   Loss: 0.9009 - F1-Score: 0.6402 - Accuracy-Score: 0.6402 - AUROC: 0.9032 - AP: 0.6904
[37m2024-08-11 10:05:26,426 [INFO] - Epoch: 4/50
[37m2024-08-11 10:05:26,427 [INFO] - Extracting training cells
[37m2024-08-11 10:05:46,998 [INFO] - Extraction detection metrics - F1: 0.695, Precision: 0.740, Recall: 0.694, Detected-Cells: 7756
[37m2024-08-11 10:05:47,311 [INFO] - Training epoch stats:     Loss: 0.2586 - F1-Score: 0.8974 - Accuracy-Score: 0.8974 - AUROC: 0.9788 - AP: 0.9151
[37m2024-08-11 10:05:47,437 [INFO] - Validation epoch stats:   Loss: 0.7556 - F1-Score: 0.7266 - Accuracy-Score: 0.7266 - AUROC: 0.9103 - AP: 0.7185
[37m2024-08-11 10:05:47,510 [INFO] - Epoch: 5/50
[37m2024-08-11 10:05:47,510 [INFO] - Extracting training cells
[37m2024-08-11 10:06:08,238 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.750, Recall: 0.700, Detected-Cells: 7651
[37m2024-08-11 10:06:08,570 [INFO] - Training epoch stats:     Loss: 0.4053 - F1-Score: 0.8407 - Accuracy-Score: 0.8407 - AUROC: 0.9539 - AP: 0.8231
[37m2024-08-11 10:06:08,697 [INFO] - Validation epoch stats:   Loss: 0.6701 - F1-Score: 0.7431 - Accuracy-Score: 0.7431 - AUROC: 0.8897 - AP: 0.7096
[37m2024-08-11 10:06:08,757 [INFO] - Epoch: 6/50
[37m2024-08-11 10:06:08,758 [INFO] - Extracting training cells
[37m2024-08-11 10:06:29,518 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.772, Recall: 0.699, Detected-Cells: 8380
[37m2024-08-11 10:06:29,771 [INFO] - Training epoch stats:     Loss: 0.2220 - F1-Score: 0.9091 - Accuracy-Score: 0.9091 - AUROC: 0.9859 - AP: 0.9439
[37m2024-08-11 10:06:29,853 [INFO] - Validation epoch stats:   Loss: 0.7054 - F1-Score: 0.7489 - Accuracy-Score: 0.7489 - AUROC: 0.9015 - AP: 0.7142
[37m2024-08-11 10:06:29,914 [INFO] - Epoch: 7/50
[37m2024-08-11 10:06:29,915 [INFO] - Extracting training cells
[37m2024-08-11 10:06:50,595 [INFO] - Extraction detection metrics - F1: 0.713, Precision: 0.769, Recall: 0.704, Detected-Cells: 8185
[37m2024-08-11 10:06:50,924 [INFO] - Training epoch stats:     Loss: 0.2588 - F1-Score: 0.8982 - Accuracy-Score: 0.8982 - AUROC: 0.9827 - AP: 0.9442
[37m2024-08-11 10:06:51,049 [INFO] - Validation epoch stats:   Loss: 0.6378 - F1-Score: 0.7750 - Accuracy-Score: 0.7750 - AUROC: 0.9229 - AP: 0.7079
[37m2024-08-11 10:06:51,115 [INFO] - Epoch: 8/50
[37m2024-08-11 10:06:51,116 [INFO] - Extracting training cells
[37m2024-08-11 10:07:12,819 [INFO] - Extraction detection metrics - F1: 0.699, Precision: 0.757, Recall: 0.688, Detected-Cells: 7618
[37m2024-08-11 10:07:13,101 [INFO] - Training epoch stats:     Loss: 0.2023 - F1-Score: 0.9140 - Accuracy-Score: 0.9140 - AUROC: 0.9883 - AP: 0.9585
[37m2024-08-11 10:07:13,216 [INFO] - Validation epoch stats:   Loss: 0.9273 - F1-Score: 0.7061 - Accuracy-Score: 0.7061 - AUROC: 0.8976 - AP: 0.7136
[37m2024-08-11 10:07:13,282 [INFO] - Epoch: 9/50
[37m2024-08-11 10:07:13,283 [INFO] - Extracting training cells
[37m2024-08-11 10:07:34,466 [INFO] - Extraction detection metrics - F1: 0.706, Precision: 0.755, Recall: 0.687, Detected-Cells: 7544
[37m2024-08-11 10:07:34,709 [INFO] - Training epoch stats:     Loss: 0.3460 - F1-Score: 0.8625 - Accuracy-Score: 0.8625 - AUROC: 0.9697 - AP: 0.9067
[37m2024-08-11 10:07:34,788 [INFO] - Validation epoch stats:   Loss: 0.7099 - F1-Score: 0.7373 - Accuracy-Score: 0.7373 - AUROC: 0.9098 - AP: 0.7081
[37m2024-08-11 10:07:34,845 [INFO] - Epoch: 10/50
[37m2024-08-11 10:07:34,845 [INFO] - Extracting training cells
[37m2024-08-11 10:07:56,127 [INFO] - Extraction detection metrics - F1: 0.712, Precision: 0.784, Recall: 0.692, Detected-Cells: 8036
[37m2024-08-11 10:07:56,462 [INFO] - Training epoch stats:     Loss: 0.2352 - F1-Score: 0.8996 - Accuracy-Score: 0.8996 - AUROC: 0.9845 - AP: 0.9423
[37m2024-08-11 10:07:56,586 [INFO] - Validation epoch stats:   Loss: 0.8479 - F1-Score: 0.7174 - Accuracy-Score: 0.7174 - AUROC: 0.9102 - AP: 0.7166
[37m2024-08-11 10:07:56,647 [INFO] - Epoch: 11/50
[37m2024-08-11 10:07:56,648 [INFO] - Extracting training cells
[37m2024-08-11 10:08:17,065 [INFO] - Extraction detection metrics - F1: 0.710, Precision: 0.764, Recall: 0.697, Detected-Cells: 8218
[37m2024-08-11 10:08:17,418 [INFO] - Training epoch stats:     Loss: 0.2533 - F1-Score: 0.9103 - Accuracy-Score: 0.9103 - AUROC: 0.9816 - AP: 0.9107
[37m2024-08-11 10:08:17,540 [INFO] - Validation epoch stats:   Loss: 0.6591 - F1-Score: 0.7750 - Accuracy-Score: 0.7750 - AUROC: 0.9027 - AP: 0.7056
[37m2024-08-11 10:08:17,604 [INFO] - Epoch: 12/50
[37m2024-08-11 10:08:17,604 [INFO] - Extracting training cells
[37m2024-08-11 10:08:39,049 [INFO] - Extraction detection metrics - F1: 0.701, Precision: 0.776, Recall: 0.674, Detected-Cells: 7802
[37m2024-08-11 10:08:39,367 [INFO] - Training epoch stats:     Loss: 0.1803 - F1-Score: 0.9268 - Accuracy-Score: 0.9268 - AUROC: 0.9903 - AP: 0.9511
[37m2024-08-11 10:08:39,491 [INFO] - Validation epoch stats:   Loss: 0.7348 - F1-Score: 0.7740 - Accuracy-Score: 0.7740 - AUROC: 0.9116 - AP: 0.7022
[37m2024-08-11 10:08:39,557 [INFO] - Epoch: 13/50
[37m2024-08-11 10:08:39,557 [INFO] - Extracting training cells
[37m2024-08-11 10:09:00,395 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.793, Recall: 0.688, Detected-Cells: 8201
[37m2024-08-11 10:09:00,654 [INFO] - Training epoch stats:     Loss: 0.2159 - F1-Score: 0.9057 - Accuracy-Score: 0.9057 - AUROC: 0.9856 - AP: 0.9427
[37m2024-08-11 10:09:00,744 [INFO] - Validation epoch stats:   Loss: 0.6851 - F1-Score: 0.7676 - Accuracy-Score: 0.7676 - AUROC: 0.9059 - AP: 0.7058
[37m2024-08-11 10:09:00,801 [INFO] - Epoch: 14/50
[37m2024-08-11 10:09:00,801 [INFO] - Extracting training cells
[37m2024-08-11 10:09:20,624 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.784, Recall: 0.705, Detected-Cells: 7594
[37m2024-08-11 10:09:20,909 [INFO] - Training epoch stats:     Loss: 0.3406 - F1-Score: 0.8516 - Accuracy-Score: 0.8516 - AUROC: 0.9698 - AP: 0.9101
[37m2024-08-11 10:09:21,206 [INFO] - Validation epoch stats:   Loss: 0.6867 - F1-Score: 0.7232 - Accuracy-Score: 0.7232 - AUROC: 0.8863 - AP: 0.6636
[37m2024-08-11 10:09:21,266 [INFO] - Epoch: 15/50
[37m2024-08-11 10:09:21,267 [INFO] - Extracting training cells
[37m2024-08-11 10:09:41,818 [INFO] - Extraction detection metrics - F1: 0.679, Precision: 0.752, Recall: 0.662, Detected-Cells: 7201
[37m2024-08-11 10:09:42,085 [INFO] - Training epoch stats:     Loss: 0.1874 - F1-Score: 0.9229 - Accuracy-Score: 0.9229 - AUROC: 0.9892 - AP: 0.9575
[37m2024-08-11 10:09:42,184 [INFO] - Validation epoch stats:   Loss: 0.8911 - F1-Score: 0.7027 - Accuracy-Score: 0.7027 - AUROC: 0.9040 - AP: 0.6945
[37m2024-08-11 10:09:42,245 [INFO] - Epoch: 16/50
[37m2024-08-11 10:09:42,246 [INFO] - Extracting training cells
[37m2024-08-11 10:10:03,312 [INFO] - Extraction detection metrics - F1: 0.708, Precision: 0.752, Recall: 0.699, Detected-Cells: 7706
[37m2024-08-11 10:10:03,557 [INFO] - Training epoch stats:     Loss: 0.2053 - F1-Score: 0.9199 - Accuracy-Score: 0.9199 - AUROC: 0.9857 - AP: 0.9403
[37m2024-08-11 10:10:03,638 [INFO] - Validation epoch stats:   Loss: 0.6502 - F1-Score: 0.7759 - Accuracy-Score: 0.7759 - AUROC: 0.8949 - AP: 0.6649
[37m2024-08-11 10:10:03,701 [INFO] - Epoch: 17/50
[37m2024-08-11 10:10:03,702 [INFO] - Extracting training cells
[37m2024-08-11 10:10:24,837 [INFO] - Extraction detection metrics - F1: 0.722, Precision: 0.785, Recall: 0.699, Detected-Cells: 8329
[37m2024-08-11 10:10:25,105 [INFO] - Training epoch stats:     Loss: 0.1605 - F1-Score: 0.9310 - Accuracy-Score: 0.9310 - AUROC: 0.9920 - AP: 0.9675
[37m2024-08-11 10:10:25,195 [INFO] - Validation epoch stats:   Loss: 0.8270 - F1-Score: 0.7364 - Accuracy-Score: 0.7364 - AUROC: 0.9020 - AP: 0.6656
[37m2024-08-11 10:10:25,262 [INFO] - Epoch: 18/50
[37m2024-08-11 10:10:25,263 [INFO] - Extracting training cells
[37m2024-08-11 10:10:46,072 [INFO] - Extraction detection metrics - F1: 0.714, Precision: 0.773, Recall: 0.693, Detected-Cells: 8267
[37m2024-08-11 10:10:46,428 [INFO] - Training epoch stats:     Loss: 0.1702 - F1-Score: 0.9283 - Accuracy-Score: 0.9283 - AUROC: 0.9910 - AP: 0.9626
[37m2024-08-11 10:10:46,560 [INFO] - Validation epoch stats:   Loss: 0.9867 - F1-Score: 0.7128 - Accuracy-Score: 0.7128 - AUROC: 0.8978 - AP: 0.7068
[37m2024-08-11 10:10:46,623 [INFO] - Epoch: 19/50
[37m2024-08-11 10:10:46,624 [INFO] - Extracting training cells
[37m2024-08-11 10:11:07,961 [INFO] - Extraction detection metrics - F1: 0.714, Precision: 0.762, Recall: 0.693, Detected-Cells: 8242
[37m2024-08-11 10:11:08,281 [INFO] - Training epoch stats:     Loss: 0.1677 - F1-Score: 0.9310 - Accuracy-Score: 0.9310 - AUROC: 0.9912 - AP: 0.9661
[37m2024-08-11 10:11:08,402 [INFO] - Validation epoch stats:   Loss: 1.1590 - F1-Score: 0.6696 - Accuracy-Score: 0.6696 - AUROC: 0.8873 - AP: 0.6765
[37m2024-08-11 10:11:08,467 [INFO] - Epoch: 20/50
[37m2024-08-11 10:11:08,468 [INFO] - Extracting training cells
[37m2024-08-11 10:11:29,219 [INFO] - Extraction detection metrics - F1: 0.701, Precision: 0.755, Recall: 0.685, Detected-Cells: 7642
[37m2024-08-11 10:11:29,525 [INFO] - Training epoch stats:     Loss: 0.3057 - F1-Score: 0.8858 - Accuracy-Score: 0.8858 - AUROC: 0.9753 - AP: 0.8876
[37m2024-08-11 10:11:29,648 [INFO] - Validation epoch stats:   Loss: 1.1919 - F1-Score: 0.6347 - Accuracy-Score: 0.6347 - AUROC: 0.8682 - AP: 0.6376
[37m2024-08-11 10:11:29,715 [INFO] - Epoch: 21/50
[37m2024-08-11 10:11:29,716 [INFO] - Extracting training cells
[37m2024-08-11 10:11:49,325 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.747, Recall: 0.733, Detected-Cells: 7075
[37m2024-08-11 10:11:49,553 [INFO] - Training epoch stats:     Loss: 0.2988 - F1-Score: 0.8724 - Accuracy-Score: 0.8724 - AUROC: 0.9761 - AP: 0.9163
[37m2024-08-11 10:11:49,632 [INFO] - Validation epoch stats:   Loss: 1.1218 - F1-Score: 0.6381 - Accuracy-Score: 0.6381 - AUROC: 0.8672 - AP: 0.6394
[37m2024-08-11 10:11:49,692 [INFO] - Epoch: 22/50
[37m2024-08-11 10:11:49,693 [INFO] - Extracting training cells
[37m2024-08-11 10:12:10,897 [INFO] - Extraction detection metrics - F1: 0.700, Precision: 0.763, Recall: 0.680, Detected-Cells: 7472
[37m2024-08-11 10:12:11,196 [INFO] - Training epoch stats:     Loss: 0.1822 - F1-Score: 0.9218 - Accuracy-Score: 0.9218 - AUROC: 0.9886 - AP: 0.9558
[37m2024-08-11 10:12:11,321 [INFO] - Validation epoch stats:   Loss: 1.6105 - F1-Score: 0.5686 - Accuracy-Score: 0.5686 - AUROC: 0.8584 - AP: 0.6342
[37m2024-08-11 10:12:11,322 [INFO] - Performing early stopping!
[37m2024-08-11 10:12:11,328 [INFO] - Finished run mmt31tga
