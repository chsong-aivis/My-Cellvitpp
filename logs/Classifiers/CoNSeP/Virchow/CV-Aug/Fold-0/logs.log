[37m2024-08-11 09:33:58,202 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 09:33:58,204 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow/Setting-2-Aug/2024-08-11T093346_Fold-0
[37m2024-08-11 09:33:58,274 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f0b5b443eb0>]
[37m2024-08-11 09:33:58,276 [INFO] - Using GPU: cuda:0
[37m2024-08-11 09:33:58,283 [INFO] - Using device: cuda:0
[37m2024-08-11 09:33:58,289 [INFO] - Loss function:
[37m2024-08-11 09:33:58,294 [INFO] - CrossEntropyLoss()
[37m2024-08-11 09:34:06,477 [INFO] - <All keys matched successfully>
[37m2024-08-11 09:34:07,522 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 09:34:07,523 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 09:34:07,529 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00568059820179996, 'weight_decay': 0.0004714549691487939}
[37m2024-08-11 09:34:07,534 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 09:34:07,549 [INFO] - Caching datasets
[37m2024-08-11 09:34:08,472 [INFO] - Instantiate Trainer
[37m2024-08-11 09:34:08,476 [INFO] - Calling Trainer Fit
[37m2024-08-11 09:34:08,479 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 09:34:08,486 [INFO] - Epoch: 1/50
[37m2024-08-11 09:34:08,492 [INFO] - Extracting training cells
[37m2024-08-11 09:34:37,243 [INFO] - Extraction detection metrics - F1: 0.703, Precision: 0.757, Recall: 0.690, Detected-Cells: 8846
[37m2024-08-11 09:34:37,611 [INFO] - Training epoch stats:     Loss: 0.3621 - F1-Score: 0.8562 - Accuracy-Score: 0.8562 - AUROC: 0.9553 - AP: 0.8349
[37m2024-08-11 09:34:38,028 [INFO] - Loaded dataset from cache: /Consep/cache/215a658570081ed1f44bf19fe9b39f35e989676a454fa7fe1efb192edbd6db24.h5
[37m2024-08-11 09:34:38,294 [INFO] - Validation epoch stats:   Loss: 0.5704 - F1-Score: 0.7893 - Accuracy-Score: 0.7893 - AUROC: 0.9485 - AP: 0.8279
[37m2024-08-11 09:34:38,296 [INFO] - New best model - save checkpoint
[37m2024-08-11 09:34:38,461 [INFO] - Epoch: 2/50
[37m2024-08-11 09:34:38,462 [INFO] - Extracting training cells
[37m2024-08-11 09:34:59,778 [INFO] - Extraction detection metrics - F1: 0.713, Precision: 0.765, Recall: 0.704, Detected-Cells: 8874
[37m2024-08-11 09:35:00,062 [INFO] - Training epoch stats:     Loss: 0.3471 - F1-Score: 0.8580 - Accuracy-Score: 0.8580 - AUROC: 0.9706 - AP: 0.9064
[37m2024-08-11 09:35:00,125 [INFO] - Validation epoch stats:   Loss: 0.4760 - F1-Score: 0.8761 - Accuracy-Score: 0.8761 - AUROC: 0.9539 - AP: 0.7959
[37m2024-08-11 09:35:00,126 [INFO] - New best model - save checkpoint
[37m2024-08-11 09:35:00,314 [INFO] - Epoch: 3/50
[37m2024-08-11 09:35:00,315 [INFO] - Extracting training cells
[37m2024-08-11 09:35:21,027 [INFO] - Extraction detection metrics - F1: 0.710, Precision: 0.750, Recall: 0.710, Detected-Cells: 9069
[37m2024-08-11 09:35:21,405 [INFO] - Training epoch stats:     Loss: 0.2845 - F1-Score: 0.8842 - Accuracy-Score: 0.8842 - AUROC: 0.9769 - AP: 0.8829
[37m2024-08-11 09:35:21,499 [INFO] - Validation epoch stats:   Loss: 0.5692 - F1-Score: 0.8215 - Accuracy-Score: 0.8215 - AUROC: 0.9442 - AP: 0.7647
[37m2024-08-11 09:35:21,563 [INFO] - Epoch: 4/50
[37m2024-08-11 09:35:21,564 [INFO] - Extracting training cells
[37m2024-08-11 09:35:43,931 [INFO] - Extraction detection metrics - F1: 0.700, Precision: 0.722, Recall: 0.707, Detected-Cells: 8677
[37m2024-08-11 09:35:44,245 [INFO] - Training epoch stats:     Loss: 0.2876 - F1-Score: 0.8808 - Accuracy-Score: 0.8808 - AUROC: 0.9787 - AP: 0.9126
[37m2024-08-11 09:35:44,319 [INFO] - Validation epoch stats:   Loss: 0.6388 - F1-Score: 0.8481 - Accuracy-Score: 0.8481 - AUROC: 0.9450 - AP: 0.7812
[37m2024-08-11 09:35:44,390 [INFO] - Epoch: 5/50
[37m2024-08-11 09:35:44,390 [INFO] - Extracting training cells
[37m2024-08-11 09:36:05,255 [INFO] - Extraction detection metrics - F1: 0.696, Precision: 0.748, Recall: 0.693, Detected-Cells: 8598
[37m2024-08-11 09:36:05,578 [INFO] - Training epoch stats:     Loss: 0.3293 - F1-Score: 0.8743 - Accuracy-Score: 0.8743 - AUROC: 0.9705 - AP: 0.8994
[37m2024-08-11 09:36:05,653 [INFO] - Validation epoch stats:   Loss: 0.4648 - F1-Score: 0.8552 - Accuracy-Score: 0.8552 - AUROC: 0.9573 - AP: 0.8031
[37m2024-08-11 09:36:05,654 [INFO] - New best model - save checkpoint
[37m2024-08-11 09:36:05,800 [INFO] - Epoch: 6/50
[37m2024-08-11 09:36:05,801 [INFO] - Extracting training cells
[37m2024-08-11 09:36:26,209 [INFO] - Extraction detection metrics - F1: 0.718, Precision: 0.762, Recall: 0.707, Detected-Cells: 9435
[37m2024-08-11 09:36:26,500 [INFO] - Training epoch stats:     Loss: 0.2365 - F1-Score: 0.9061 - Accuracy-Score: 0.9061 - AUROC: 0.9855 - AP: 0.9441
[37m2024-08-11 09:36:26,562 [INFO] - Validation epoch stats:   Loss: 0.6044 - F1-Score: 0.8529 - Accuracy-Score: 0.8529 - AUROC: 0.9397 - AP: 0.7553
[37m2024-08-11 09:36:26,628 [INFO] - Epoch: 7/50
[37m2024-08-11 09:36:26,628 [INFO] - Extracting training cells
[37m2024-08-11 09:36:47,881 [INFO] - Extraction detection metrics - F1: 0.718, Precision: 0.763, Recall: 0.715, Detected-Cells: 9378
[37m2024-08-11 09:36:48,337 [INFO] - Training epoch stats:     Loss: 0.2571 - F1-Score: 0.8969 - Accuracy-Score: 0.8969 - AUROC: 0.9843 - AP: 0.9561
[37m2024-08-11 09:36:48,398 [INFO] - Validation epoch stats:   Loss: 0.6622 - F1-Score: 0.8524 - Accuracy-Score: 0.8524 - AUROC: 0.9278 - AP: 0.7167
[37m2024-08-11 09:36:48,461 [INFO] - Epoch: 8/50
[37m2024-08-11 09:36:48,462 [INFO] - Extracting training cells
[37m2024-08-11 09:37:09,070 [INFO] - Extraction detection metrics - F1: 0.685, Precision: 0.743, Recall: 0.669, Detected-Cells: 8601
[37m2024-08-11 09:37:09,407 [INFO] - Training epoch stats:     Loss: 0.2176 - F1-Score: 0.9078 - Accuracy-Score: 0.9078 - AUROC: 0.9878 - AP: 0.9659
[37m2024-08-11 09:37:09,498 [INFO] - Validation epoch stats:   Loss: 0.7923 - F1-Score: 0.8287 - Accuracy-Score: 0.8287 - AUROC: 0.9384 - AP: 0.7621
[37m2024-08-11 09:37:09,572 [INFO] - Epoch: 9/50
[37m2024-08-11 09:37:09,572 [INFO] - Extracting training cells
[37m2024-08-11 09:37:31,517 [INFO] - Extraction detection metrics - F1: 0.695, Precision: 0.737, Recall: 0.687, Detected-Cells: 8828
[37m2024-08-11 09:37:31,839 [INFO] - Training epoch stats:     Loss: 0.3726 - F1-Score: 0.8567 - Accuracy-Score: 0.8567 - AUROC: 0.9662 - AP: 0.9243
[37m2024-08-11 09:37:31,931 [INFO] - Validation epoch stats:   Loss: 1.0233 - F1-Score: 0.7845 - Accuracy-Score: 0.7845 - AUROC: 0.8492 - AP: 0.6288
[37m2024-08-11 09:37:31,996 [INFO] - Epoch: 10/50
[37m2024-08-11 09:37:31,997 [INFO] - Extracting training cells
[37m2024-08-11 09:38:16,849 [INFO] - Extraction detection metrics - F1: 0.718, Precision: 0.763, Recall: 0.708, Detected-Cells: 9346
[37m2024-08-11 09:38:17,159 [INFO] - Training epoch stats:     Loss: 0.2171 - F1-Score: 0.9126 - Accuracy-Score: 0.9126 - AUROC: 0.9875 - AP: 0.9557
[37m2024-08-11 09:38:17,222 [INFO] - Validation epoch stats:   Loss: 0.6867 - F1-Score: 0.8581 - Accuracy-Score: 0.8581 - AUROC: 0.9346 - AP: 0.7455
[37m2024-08-11 09:38:17,281 [INFO] - Epoch: 11/50
[37m2024-08-11 09:38:17,283 [INFO] - Extracting training cells
[37m2024-08-11 09:38:39,512 [INFO] - Extraction detection metrics - F1: 0.712, Precision: 0.760, Recall: 0.704, Detected-Cells: 9182
[37m2024-08-11 09:38:39,829 [INFO] - Training epoch stats:     Loss: 0.2258 - F1-Score: 0.9156 - Accuracy-Score: 0.9156 - AUROC: 0.9839 - AP: 0.9554
[37m2024-08-11 09:38:39,899 [INFO] - Validation epoch stats:   Loss: 0.9283 - F1-Score: 0.8439 - Accuracy-Score: 0.8439 - AUROC: 0.9109 - AP: 0.7131
[37m2024-08-11 09:38:39,964 [INFO] - Epoch: 12/50
[37m2024-08-11 09:38:39,965 [INFO] - Extracting training cells
[37m2024-08-11 09:39:00,764 [INFO] - Extraction detection metrics - F1: 0.712, Precision: 0.759, Recall: 0.701, Detected-Cells: 8875
[37m2024-08-11 09:39:01,051 [INFO] - Training epoch stats:     Loss: 0.2461 - F1-Score: 0.9054 - Accuracy-Score: 0.9054 - AUROC: 0.9835 - AP: 0.9502
[37m2024-08-11 09:39:01,113 [INFO] - Validation epoch stats:   Loss: 0.7188 - F1-Score: 0.8106 - Accuracy-Score: 0.8106 - AUROC: 0.9249 - AP: 0.7509
[37m2024-08-11 09:39:01,178 [INFO] - Epoch: 13/50
[37m2024-08-11 09:39:01,179 [INFO] - Extracting training cells
[37m2024-08-11 09:39:21,530 [INFO] - Extraction detection metrics - F1: 0.709, Precision: 0.771, Recall: 0.694, Detected-Cells: 8855
[37m2024-08-11 09:39:22,149 [INFO] - Training epoch stats:     Loss: 0.2531 - F1-Score: 0.8882 - Accuracy-Score: 0.8882 - AUROC: 0.9849 - AP: 0.9655
[37m2024-08-11 09:39:22,243 [INFO] - Validation epoch stats:   Loss: 0.8772 - F1-Score: 0.8234 - Accuracy-Score: 0.8234 - AUROC: 0.9103 - AP: 0.7213
[37m2024-08-11 09:39:22,316 [INFO] - Epoch: 14/50
[37m2024-08-11 09:39:22,316 [INFO] - Extracting training cells
[37m2024-08-11 09:39:43,321 [INFO] - Extraction detection metrics - F1: 0.722, Precision: 0.756, Recall: 0.722, Detected-Cells: 8656
[37m2024-08-11 09:39:43,684 [INFO] - Training epoch stats:     Loss: 0.3459 - F1-Score: 0.8562 - Accuracy-Score: 0.8562 - AUROC: 0.9717 - AP: 0.9259
[37m2024-08-11 09:39:43,776 [INFO] - Validation epoch stats:   Loss: 0.8823 - F1-Score: 0.8178 - Accuracy-Score: 0.8178 - AUROC: 0.9067 - AP: 0.7157
[37m2024-08-11 09:39:43,839 [INFO] - Epoch: 15/50
[37m2024-08-11 09:39:43,839 [INFO] - Extracting training cells
[37m2024-08-11 09:40:03,871 [INFO] - Extraction detection metrics - F1: 0.689, Precision: 0.727, Recall: 0.690, Detected-Cells: 8456
[37m2024-08-11 09:40:04,236 [INFO] - Training epoch stats:     Loss: 0.2258 - F1-Score: 0.9094 - Accuracy-Score: 0.9094 - AUROC: 0.9838 - AP: 0.9441
[37m2024-08-11 09:40:04,333 [INFO] - Validation epoch stats:   Loss: 0.9698 - F1-Score: 0.8206 - Accuracy-Score: 0.8206 - AUROC: 0.9019 - AP: 0.7196
[37m2024-08-11 09:40:04,413 [INFO] - Epoch: 16/50
[37m2024-08-11 09:40:04,414 [INFO] - Extracting training cells
[37m2024-08-11 09:40:25,088 [INFO] - Extraction detection metrics - F1: 0.706, Precision: 0.745, Recall: 0.706, Detected-Cells: 7918
[37m2024-08-11 09:40:25,393 [INFO] - Training epoch stats:     Loss: 0.2508 - F1-Score: 0.8978 - Accuracy-Score: 0.8978 - AUROC: 0.9839 - AP: 0.9407
[37m2024-08-11 09:40:25,482 [INFO] - Validation epoch stats:   Loss: 1.2902 - F1-Score: 0.7485 - Accuracy-Score: 0.7485 - AUROC: 0.8790 - AP: 0.6912
[37m2024-08-11 09:40:25,552 [INFO] - Epoch: 17/50
[37m2024-08-11 09:40:25,553 [INFO] - Extracting training cells
[37m2024-08-11 09:40:45,880 [INFO] - Extraction detection metrics - F1: 0.718, Precision: 0.780, Recall: 0.693, Detected-Cells: 9310
[37m2024-08-11 09:40:46,208 [INFO] - Training epoch stats:     Loss: 0.1964 - F1-Score: 0.9205 - Accuracy-Score: 0.9205 - AUROC: 0.9891 - AP: 0.9708
[37m2024-08-11 09:40:46,291 [INFO] - Validation epoch stats:   Loss: 0.8715 - F1-Score: 0.8410 - Accuracy-Score: 0.8410 - AUROC: 0.9142 - AP: 0.7393
[37m2024-08-11 09:40:46,363 [INFO] - Epoch: 18/50
[37m2024-08-11 09:40:46,363 [INFO] - Extracting training cells
[37m2024-08-11 09:41:07,483 [INFO] - Extraction detection metrics - F1: 0.723, Precision: 0.770, Recall: 0.712, Detected-Cells: 9439
[37m2024-08-11 09:41:07,867 [INFO] - Training epoch stats:     Loss: 0.1948 - F1-Score: 0.9202 - Accuracy-Score: 0.9202 - AUROC: 0.9897 - AP: 0.9639
[37m2024-08-11 09:41:07,964 [INFO] - Validation epoch stats:   Loss: 1.0544 - F1-Score: 0.8382 - Accuracy-Score: 0.8382 - AUROC: 0.9133 - AP: 0.7406
[37m2024-08-11 09:41:08,030 [INFO] - Epoch: 19/50
[37m2024-08-11 09:41:08,030 [INFO] - Extracting training cells
[37m2024-08-11 09:41:29,837 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.742, Recall: 0.706, Detected-Cells: 9080
[37m2024-08-11 09:41:30,191 [INFO] - Training epoch stats:     Loss: 0.1813 - F1-Score: 0.9244 - Accuracy-Score: 0.9244 - AUROC: 0.9909 - AP: 0.9756
[37m2024-08-11 09:41:30,267 [INFO] - Validation epoch stats:   Loss: 0.8482 - F1-Score: 0.8382 - Accuracy-Score: 0.8382 - AUROC: 0.9165 - AP: 0.7508
[37m2024-08-11 09:41:30,333 [INFO] - Epoch: 20/50
[37m2024-08-11 09:41:30,334 [INFO] - Extracting training cells
[37m2024-08-11 09:41:50,891 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.774, Recall: 0.704, Detected-Cells: 9108
[37m2024-08-11 09:41:51,211 [INFO] - Training epoch stats:     Loss: 0.2927 - F1-Score: 0.8723 - Accuracy-Score: 0.8723 - AUROC: 0.9801 - AP: 0.9414
[37m2024-08-11 09:41:51,285 [INFO] - Validation epoch stats:   Loss: 1.0976 - F1-Score: 0.8258 - Accuracy-Score: 0.8258 - AUROC: 0.9012 - AP: 0.6781
[37m2024-08-11 09:41:51,350 [INFO] - Epoch: 21/50
[37m2024-08-11 09:41:51,351 [INFO] - Extracting training cells
[37m2024-08-11 09:42:11,751 [INFO] - Extraction detection metrics - F1: 0.690, Precision: 0.719, Recall: 0.720, Detected-Cells: 7831
[37m2024-08-11 09:42:11,997 [INFO] - Training epoch stats:     Loss: 0.2936 - F1-Score: 0.8765 - Accuracy-Score: 0.8765 - AUROC: 0.9790 - AP: 0.9397
[37m2024-08-11 09:42:12,059 [INFO] - Validation epoch stats:   Loss: 1.0494 - F1-Score: 0.7769 - Accuracy-Score: 0.7769 - AUROC: 0.8855 - AP: 0.6568
[37m2024-08-11 09:42:12,124 [INFO] - Epoch: 22/50
[37m2024-08-11 09:42:12,125 [INFO] - Extracting training cells
[37m2024-08-11 09:42:34,328 [INFO] - Extraction detection metrics - F1: 0.706, Precision: 0.758, Recall: 0.699, Detected-Cells: 8857
[37m2024-08-11 09:42:34,672 [INFO] - Training epoch stats:     Loss: 0.2053 - F1-Score: 0.9150 - Accuracy-Score: 0.9150 - AUROC: 0.9893 - AP: 0.9687
[37m2024-08-11 09:42:34,764 [INFO] - Validation epoch stats:   Loss: 1.0958 - F1-Score: 0.8263 - Accuracy-Score: 0.8263 - AUROC: 0.9124 - AP: 0.7226
[37m2024-08-11 09:42:34,833 [INFO] - Epoch: 23/50
[37m2024-08-11 09:42:34,834 [INFO] - Extracting training cells
[37m2024-08-11 09:42:57,239 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.763, Recall: 0.695, Detected-Cells: 9223
[37m2024-08-11 09:42:57,624 [INFO] - Training epoch stats:     Loss: 0.1873 - F1-Score: 0.9315 - Accuracy-Score: 0.9315 - AUROC: 0.9908 - AP: 0.9767
[37m2024-08-11 09:42:57,715 [INFO] - Validation epoch stats:   Loss: 1.1652 - F1-Score: 0.7973 - Accuracy-Score: 0.7973 - AUROC: 0.9095 - AP: 0.7388
[37m2024-08-11 09:42:57,782 [INFO] - Epoch: 24/50
[37m2024-08-11 09:42:57,783 [INFO] - Extracting training cells
[37m2024-08-11 09:43:17,961 [INFO] - Extraction detection metrics - F1: 0.691, Precision: 0.735, Recall: 0.686, Detected-Cells: 8080
[37m2024-08-11 09:43:18,272 [INFO] - Training epoch stats:     Loss: 0.2738 - F1-Score: 0.8908 - Accuracy-Score: 0.8908 - AUROC: 0.9798 - AP: 0.9409
[37m2024-08-11 09:43:18,360 [INFO] - Validation epoch stats:   Loss: 1.2708 - F1-Score: 0.7988 - Accuracy-Score: 0.7988 - AUROC: 0.8921 - AP: 0.7092
[37m2024-08-11 09:43:18,438 [INFO] - Epoch: 25/50
[37m2024-08-11 09:43:18,439 [INFO] - Extracting training cells
[37m2024-08-11 09:43:38,439 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.759, Recall: 0.723, Detected-Cells: 8193
[37m2024-08-11 09:43:39,108 [INFO] - Training epoch stats:     Loss: 0.2259 - F1-Score: 0.9017 - Accuracy-Score: 0.9017 - AUROC: 0.9867 - AP: 0.9652
[37m2024-08-11 09:43:39,222 [INFO] - Validation epoch stats:   Loss: 1.2855 - F1-Score: 0.8045 - Accuracy-Score: 0.8045 - AUROC: 0.8943 - AP: 0.7129
[37m2024-08-11 09:43:39,223 [INFO] - Performing early stopping!
[37m2024-08-11 09:43:39,231 [INFO] - Finished run txis3pd2
