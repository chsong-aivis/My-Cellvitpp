[37m2024-08-11 10:12:45,652 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-11 10:12:45,653 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow/Setting-2-Aug/2024-08-11T101235_Fold-4
[37m2024-08-11 10:12:45,723 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f2de0750040>]
[37m2024-08-11 10:12:45,724 [INFO] - Using GPU: cuda:0
[37m2024-08-11 10:12:45,730 [INFO] - Using device: cuda:0
[37m2024-08-11 10:12:45,735 [INFO] - Loss function:
[37m2024-08-11 10:12:45,741 [INFO] - CrossEntropyLoss()
[37m2024-08-11 10:12:53,678 [INFO] - <All keys matched successfully>
[37m2024-08-11 10:12:55,157 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-11 10:12:55,159 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-11 10:12:55,164 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00568059820179996, 'weight_decay': 0.0004714549691487939}
[37m2024-08-11 10:12:55,169 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-11 10:12:55,189 [INFO] - Caching datasets
[37m2024-08-11 10:12:56,419 [INFO] - Instantiate Trainer
[37m2024-08-11 10:12:56,427 [INFO] - Calling Trainer Fit
[37m2024-08-11 10:12:56,427 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-11 10:12:56,435 [INFO] - Epoch: 1/50
[37m2024-08-11 10:12:56,441 [INFO] - Extracting training cells
[37m2024-08-11 10:13:26,372 [INFO] - Extraction detection metrics - F1: 0.700, Precision: 0.771, Recall: 0.677, Detected-Cells: 8941
[37m2024-08-11 10:13:26,865 [INFO] - Training epoch stats:     Loss: 0.3774 - F1-Score: 0.8531 - Accuracy-Score: 0.8531 - AUROC: 0.9494 - AP: 0.8276
[37m2024-08-11 10:13:27,345 [INFO] - Loaded dataset from cache: /Consep/cache/ab0a242d1dc6ba3fdf98c4b5ef3fef67fb5bf40dd6aceb942b2dad88179f4dd8.h5
[37m2024-08-11 10:13:27,384 [INFO] - Validation epoch stats:   Loss: 0.3195 - F1-Score: 0.8817 - Accuracy-Score: 0.8817 - AUROC: 0.9682 - AP: 0.8008
[37m2024-08-11 10:13:27,384 [INFO] - New best model - save checkpoint
[37m2024-08-11 10:13:27,567 [INFO] - Epoch: 2/50
[37m2024-08-11 10:13:27,569 [INFO] - Extracting training cells
[37m2024-08-11 10:13:50,025 [INFO] - Extraction detection metrics - F1: 0.698, Precision: 0.758, Recall: 0.685, Detected-Cells: 8898
[37m2024-08-11 10:13:50,359 [INFO] - Training epoch stats:     Loss: 0.3904 - F1-Score: 0.8458 - Accuracy-Score: 0.8458 - AUROC: 0.9603 - AP: 0.8221
[37m2024-08-11 10:13:50,447 [INFO] - Validation epoch stats:   Loss: 0.3847 - F1-Score: 0.8598 - Accuracy-Score: 0.8598 - AUROC: 0.9657 - AP: 0.8026
[37m2024-08-11 10:13:50,514 [INFO] - Epoch: 3/50
[37m2024-08-11 10:13:50,515 [INFO] - Extracting training cells
[37m2024-08-11 10:14:11,997 [INFO] - Extraction detection metrics - F1: 0.733, Precision: 0.769, Recall: 0.737, Detected-Cells: 9131
[37m2024-08-11 10:14:12,368 [INFO] - Training epoch stats:     Loss: 0.3084 - F1-Score: 0.8769 - Accuracy-Score: 0.8769 - AUROC: 0.9768 - AP: 0.9189
[37m2024-08-11 10:14:12,464 [INFO] - Validation epoch stats:   Loss: 0.3225 - F1-Score: 0.8872 - Accuracy-Score: 0.8872 - AUROC: 0.9693 - AP: 0.8174
[37m2024-08-11 10:14:12,465 [INFO] - New best model - save checkpoint
[37m2024-08-11 10:14:12,641 [INFO] - Epoch: 4/50
[37m2024-08-11 10:14:12,642 [INFO] - Extracting training cells
[37m2024-08-11 10:14:34,218 [INFO] - Extraction detection metrics - F1: 0.690, Precision: 0.739, Recall: 0.689, Detected-Cells: 8597
[37m2024-08-11 10:14:34,503 [INFO] - Training epoch stats:     Loss: 0.2778 - F1-Score: 0.8853 - Accuracy-Score: 0.8853 - AUROC: 0.9776 - AP: 0.9198
[37m2024-08-11 10:14:34,571 [INFO] - Validation epoch stats:   Loss: 0.3765 - F1-Score: 0.8743 - Accuracy-Score: 0.8743 - AUROC: 0.9585 - AP: 0.7753
[37m2024-08-11 10:14:34,641 [INFO] - Epoch: 5/50
[37m2024-08-11 10:14:34,641 [INFO] - Extracting training cells
[37m2024-08-11 10:14:56,402 [INFO] - Extraction detection metrics - F1: 0.687, Precision: 0.744, Recall: 0.677, Detected-Cells: 8442
[37m2024-08-11 10:14:56,731 [INFO] - Training epoch stats:     Loss: 0.3491 - F1-Score: 0.8688 - Accuracy-Score: 0.8688 - AUROC: 0.9658 - AP: 0.8868
[37m2024-08-11 10:14:56,832 [INFO] - Validation epoch stats:   Loss: 0.4719 - F1-Score: 0.8533 - Accuracy-Score: 0.8533 - AUROC: 0.9468 - AP: 0.7501
[37m2024-08-11 10:14:56,902 [INFO] - Epoch: 6/50
[37m2024-08-11 10:14:56,903 [INFO] - Extracting training cells
[37m2024-08-11 10:15:18,621 [INFO] - Extraction detection metrics - F1: 0.712, Precision: 0.766, Recall: 0.693, Detected-Cells: 9538
[37m2024-08-11 10:15:18,991 [INFO] - Training epoch stats:     Loss: 0.2538 - F1-Score: 0.8967 - Accuracy-Score: 0.8967 - AUROC: 0.9826 - AP: 0.9398
[37m2024-08-11 10:15:19,076 [INFO] - Validation epoch stats:   Loss: 0.3536 - F1-Score: 0.8688 - Accuracy-Score: 0.8688 - AUROC: 0.9573 - AP: 0.7811
[37m2024-08-11 10:15:19,146 [INFO] - Epoch: 7/50
[37m2024-08-11 10:15:19,147 [INFO] - Extracting training cells
[37m2024-08-11 10:15:40,766 [INFO] - Extraction detection metrics - F1: 0.722, Precision: 0.766, Recall: 0.718, Detected-Cells: 9364
[37m2024-08-11 10:15:41,418 [INFO] - Training epoch stats:     Loss: 0.3221 - F1-Score: 0.8661 - Accuracy-Score: 0.8661 - AUROC: 0.9744 - AP: 0.9307
[37m2024-08-11 10:15:41,509 [INFO] - Validation epoch stats:   Loss: 0.5190 - F1-Score: 0.8239 - Accuracy-Score: 0.8239 - AUROC: 0.9466 - AP: 0.7737
[37m2024-08-11 10:15:41,578 [INFO] - Epoch: 8/50
[37m2024-08-11 10:15:41,579 [INFO] - Extracting training cells
[37m2024-08-11 10:16:02,769 [INFO] - Extraction detection metrics - F1: 0.684, Precision: 0.749, Recall: 0.662, Detected-Cells: 8418
[37m2024-08-11 10:16:03,099 [INFO] - Training epoch stats:     Loss: 0.2283 - F1-Score: 0.8994 - Accuracy-Score: 0.8994 - AUROC: 0.9860 - AP: 0.9597
[37m2024-08-11 10:16:03,175 [INFO] - Validation epoch stats:   Loss: 0.4638 - F1-Score: 0.8403 - Accuracy-Score: 0.8403 - AUROC: 0.9460 - AP: 0.7515
[37m2024-08-11 10:16:03,242 [INFO] - Epoch: 9/50
[37m2024-08-11 10:16:03,242 [INFO] - Extracting training cells
[37m2024-08-11 10:16:25,978 [INFO] - Extraction detection metrics - F1: 0.715, Precision: 0.753, Recall: 0.700, Detected-Cells: 9032
[37m2024-08-11 10:16:26,340 [INFO] - Training epoch stats:     Loss: 0.3356 - F1-Score: 0.8661 - Accuracy-Score: 0.8661 - AUROC: 0.9701 - AP: 0.9176
[37m2024-08-11 10:16:26,426 [INFO] - Validation epoch stats:   Loss: 0.4871 - F1-Score: 0.8493 - Accuracy-Score: 0.8493 - AUROC: 0.9382 - AP: 0.7398
[37m2024-08-11 10:16:26,489 [INFO] - Epoch: 10/50
[37m2024-08-11 10:16:26,490 [INFO] - Extracting training cells
[37m2024-08-11 10:16:47,977 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.774, Recall: 0.703, Detected-Cells: 9336
[37m2024-08-11 10:16:48,361 [INFO] - Training epoch stats:     Loss: 0.2283 - F1-Score: 0.9051 - Accuracy-Score: 0.9051 - AUROC: 0.9853 - AP: 0.9585
[37m2024-08-11 10:16:48,452 [INFO] - Validation epoch stats:   Loss: 0.4684 - F1-Score: 0.8438 - Accuracy-Score: 0.8438 - AUROC: 0.9376 - AP: 0.7465
[37m2024-08-11 10:16:48,530 [INFO] - Epoch: 11/50
[37m2024-08-11 10:16:48,530 [INFO] - Extracting training cells
[37m2024-08-11 10:17:11,392 [INFO] - Extraction detection metrics - F1: 0.710, Precision: 0.763, Recall: 0.696, Detected-Cells: 9124
[37m2024-08-11 10:17:11,758 [INFO] - Training epoch stats:     Loss: 0.2698 - F1-Score: 0.8966 - Accuracy-Score: 0.8966 - AUROC: 0.9779 - AP: 0.9425
[37m2024-08-11 10:17:11,849 [INFO] - Validation epoch stats:   Loss: 0.4941 - F1-Score: 0.8418 - Accuracy-Score: 0.8418 - AUROC: 0.9384 - AP: 0.7552
[37m2024-08-11 10:17:11,920 [INFO] - Epoch: 12/50
[37m2024-08-11 10:17:11,921 [INFO] - Extracting training cells
[37m2024-08-11 10:17:33,895 [INFO] - Extraction detection metrics - F1: 0.708, Precision: 0.772, Recall: 0.686, Detected-Cells: 9056
[37m2024-08-11 10:17:34,213 [INFO] - Training epoch stats:     Loss: 0.2306 - F1-Score: 0.9089 - Accuracy-Score: 0.9089 - AUROC: 0.9855 - AP: 0.9525
[37m2024-08-11 10:17:34,287 [INFO] - Validation epoch stats:   Loss: 0.4528 - F1-Score: 0.8528 - Accuracy-Score: 0.8528 - AUROC: 0.9387 - AP: 0.7611
[37m2024-08-11 10:17:34,358 [INFO] - Epoch: 13/50
[37m2024-08-11 10:17:34,359 [INFO] - Extracting training cells
[37m2024-08-11 10:17:55,404 [INFO] - Extraction detection metrics - F1: 0.706, Precision: 0.782, Recall: 0.681, Detected-Cells: 8923
[37m2024-08-11 10:17:55,678 [INFO] - Training epoch stats:     Loss: 0.2536 - F1-Score: 0.8925 - Accuracy-Score: 0.8925 - AUROC: 0.9842 - AP: 0.9618
[37m2024-08-11 10:17:55,738 [INFO] - Validation epoch stats:   Loss: 0.5525 - F1-Score: 0.8204 - Accuracy-Score: 0.8204 - AUROC: 0.9225 - AP: 0.7443
[37m2024-08-11 10:17:55,807 [INFO] - Epoch: 14/50
[37m2024-08-11 10:17:55,808 [INFO] - Extracting training cells
[37m2024-08-11 10:18:16,625 [INFO] - Extraction detection metrics - F1: 0.703, Precision: 0.762, Recall: 0.697, Detected-Cells: 8722
[37m2024-08-11 10:18:17,013 [INFO] - Training epoch stats:     Loss: 0.3143 - F1-Score: 0.8848 - Accuracy-Score: 0.8848 - AUROC: 0.9769 - AP: 0.8722
[37m2024-08-11 10:18:17,106 [INFO] - Validation epoch stats:   Loss: 0.6130 - F1-Score: 0.8229 - Accuracy-Score: 0.8229 - AUROC: 0.9067 - AP: 0.6854
[37m2024-08-11 10:18:17,175 [INFO] - Epoch: 15/50
[37m2024-08-11 10:18:17,175 [INFO] - Extracting training cells
[37m2024-08-11 10:18:39,771 [INFO] - Extraction detection metrics - F1: 0.694, Precision: 0.740, Recall: 0.686, Detected-Cells: 8613
[37m2024-08-11 10:18:40,032 [INFO] - Training epoch stats:     Loss: 0.2188 - F1-Score: 0.9130 - Accuracy-Score: 0.9130 - AUROC: 0.9875 - AP: 0.9605
[37m2024-08-11 10:18:40,098 [INFO] - Validation epoch stats:   Loss: 0.4305 - F1-Score: 0.8598 - Accuracy-Score: 0.8598 - AUROC: 0.9482 - AP: 0.7715
[37m2024-08-11 10:18:40,160 [INFO] - Epoch: 16/50
[37m2024-08-11 10:18:40,160 [INFO] - Extracting training cells
[37m2024-08-11 10:19:01,206 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.752, Recall: 0.701, Detected-Cells: 7949
[37m2024-08-11 10:19:01,522 [INFO] - Training epoch stats:     Loss: 0.2765 - F1-Score: 0.8893 - Accuracy-Score: 0.8893 - AUROC: 0.9773 - AP: 0.9212
[37m2024-08-11 10:19:01,603 [INFO] - Validation epoch stats:   Loss: 0.4435 - F1-Score: 0.8558 - Accuracy-Score: 0.8558 - AUROC: 0.9368 - AP: 0.7465
[37m2024-08-11 10:19:01,672 [INFO] - Epoch: 17/50
[37m2024-08-11 10:19:01,673 [INFO] - Extracting training cells
[37m2024-08-11 10:19:23,252 [INFO] - Extraction detection metrics - F1: 0.693, Precision: 0.767, Recall: 0.661, Detected-Cells: 9044
[37m2024-08-11 10:19:23,542 [INFO] - Training epoch stats:     Loss: 0.2093 - F1-Score: 0.9198 - Accuracy-Score: 0.9198 - AUROC: 0.9880 - AP: 0.9572
[37m2024-08-11 10:19:23,604 [INFO] - Validation epoch stats:   Loss: 0.4941 - F1-Score: 0.8603 - Accuracy-Score: 0.8603 - AUROC: 0.9403 - AP: 0.7639
[37m2024-08-11 10:19:23,666 [INFO] - Epoch: 18/50
[37m2024-08-11 10:19:23,666 [INFO] - Extracting training cells
[37m2024-08-11 10:19:45,272 [INFO] - Extraction detection metrics - F1: 0.721, Precision: 0.778, Recall: 0.704, Detected-Cells: 9639
[37m2024-08-11 10:19:45,579 [INFO] - Training epoch stats:     Loss: 0.2155 - F1-Score: 0.9078 - Accuracy-Score: 0.9078 - AUROC: 0.9873 - AP: 0.9506
[37m2024-08-11 10:19:45,641 [INFO] - Validation epoch stats:   Loss: 0.4953 - F1-Score: 0.8638 - Accuracy-Score: 0.8638 - AUROC: 0.9351 - AP: 0.7804
[37m2024-08-11 10:19:45,706 [INFO] - Epoch: 19/50
[37m2024-08-11 10:19:45,707 [INFO] - Extracting training cells
[37m2024-08-11 10:20:07,648 [INFO] - Extraction detection metrics - F1: 0.714, Precision: 0.762, Recall: 0.698, Detected-Cells: 9631
[37m2024-08-11 10:20:08,028 [INFO] - Training epoch stats:     Loss: 0.1753 - F1-Score: 0.9273 - Accuracy-Score: 0.9273 - AUROC: 0.9916 - AP: 0.9748
[37m2024-08-11 10:20:08,129 [INFO] - Validation epoch stats:   Loss: 0.5522 - F1-Score: 0.8433 - Accuracy-Score: 0.8433 - AUROC: 0.9334 - AP: 0.7612
[37m2024-08-11 10:20:08,197 [INFO] - Epoch: 20/50
[37m2024-08-11 10:20:08,197 [INFO] - Extracting training cells
[37m2024-08-11 10:20:29,644 [INFO] - Extraction detection metrics - F1: 0.699, Precision: 0.754, Recall: 0.682, Detected-Cells: 8767
[37m2024-08-11 10:20:29,922 [INFO] - Training epoch stats:     Loss: 0.2999 - F1-Score: 0.8773 - Accuracy-Score: 0.8773 - AUROC: 0.9771 - AP: 0.9248
[37m2024-08-11 10:20:29,994 [INFO] - Validation epoch stats:   Loss: 0.5653 - F1-Score: 0.8483 - Accuracy-Score: 0.8483 - AUROC: 0.9105 - AP: 0.7220
[37m2024-08-11 10:20:30,063 [INFO] - Epoch: 21/50
[37m2024-08-11 10:20:30,063 [INFO] - Extracting training cells
[37m2024-08-11 10:20:50,411 [INFO] - Extraction detection metrics - F1: 0.716, Precision: 0.747, Recall: 0.723, Detected-Cells: 8172
[37m2024-08-11 10:20:50,741 [INFO] - Training epoch stats:     Loss: 0.2919 - F1-Score: 0.8849 - Accuracy-Score: 0.8849 - AUROC: 0.9799 - AP: 0.9449
[37m2024-08-11 10:20:50,844 [INFO] - Validation epoch stats:   Loss: 0.5411 - F1-Score: 0.8503 - Accuracy-Score: 0.8503 - AUROC: 0.9096 - AP: 0.7395
[37m2024-08-11 10:20:50,916 [INFO] - Epoch: 22/50
[37m2024-08-11 10:20:50,916 [INFO] - Extracting training cells
[37m2024-08-11 10:21:13,911 [INFO] - Extraction detection metrics - F1: 0.689, Precision: 0.758, Recall: 0.674, Detected-Cells: 8960
[37m2024-08-11 10:21:14,276 [INFO] - Training epoch stats:     Loss: 0.2383 - F1-Score: 0.9019 - Accuracy-Score: 0.9019 - AUROC: 0.9856 - AP: 0.9396
[37m2024-08-11 10:21:14,366 [INFO] - Validation epoch stats:   Loss: 0.7213 - F1-Score: 0.8179 - Accuracy-Score: 0.8179 - AUROC: 0.9083 - AP: 0.7210
[37m2024-08-11 10:21:14,436 [INFO] - Epoch: 23/50
[37m2024-08-11 10:21:14,436 [INFO] - Extracting training cells
[37m2024-08-11 10:21:36,703 [INFO] - Extraction detection metrics - F1: 0.699, Precision: 0.764, Recall: 0.678, Detected-Cells: 9209
[37m2024-08-11 10:21:37,071 [INFO] - Training epoch stats:     Loss: 0.1803 - F1-Score: 0.9300 - Accuracy-Score: 0.9300 - AUROC: 0.9909 - AP: 0.9728
[37m2024-08-11 10:21:37,162 [INFO] - Validation epoch stats:   Loss: 0.6685 - F1-Score: 0.8303 - Accuracy-Score: 0.8303 - AUROC: 0.9198 - AP: 0.7502
[37m2024-08-11 10:21:37,163 [INFO] - Performing early stopping!
[37m2024-08-11 10:21:37,169 [INFO] - Finished run q0qc7w22
