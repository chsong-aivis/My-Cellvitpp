[37m2024-08-10 12:04:26,982 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-10 12:04:26,983 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow/Setting-2/2024-08-10T120419_Fold-3
[37m2024-08-10 12:04:27,041 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f13de430070>]
[37m2024-08-10 12:04:27,042 [INFO] - Using GPU: cuda:0
[37m2024-08-10 12:04:27,046 [INFO] - Using device: cuda:0
[37m2024-08-10 12:04:27,050 [INFO] - Loss function:
[37m2024-08-10 12:04:27,055 [INFO] - CrossEntropyLoss()
[37m2024-08-10 12:04:36,070 [INFO] - <All keys matched successfully>
[37m2024-08-10 12:04:38,231 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-10 12:04:38,233 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-10 12:04:38,237 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00568059820179996, 'weight_decay': 0.0004714549691487939}
[37m2024-08-10 12:04:38,242 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-10 12:04:38,254 [INFO] - Caching datasets
[37m2024-08-10 12:04:39,416 [INFO] - Instantiate Trainer
[37m2024-08-10 12:04:39,421 [INFO] - Calling Trainer Fit
[37m2024-08-10 12:04:39,423 [INFO] - Dataset is cached after first epoch
[37m2024-08-10 12:04:39,428 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-10 12:04:39,433 [INFO] - Epoch: 1/50
[37m2024-08-10 12:04:39,440 [INFO] - Extracting training cells
[37m2024-08-10 12:05:13,921 [INFO] - Extraction detection metrics - F1: 0.719, Precision: 0.786, Recall: 0.696, Detected-Cells: 8408
[37m2024-08-10 12:05:13,922 [INFO] - Caching dataset 0efbd2b54195e5146e9564ab93421111b2169f9f5337c213822e34dd828c23fd to disk...
[37m2024-08-10 12:05:20,081 [INFO] - Training epoch stats:     Loss: 0.3526 - F1-Score: 0.8593 - Accuracy-Score: 0.8593 - AUROC: 0.9596 - AP: 0.8303
[37m2024-08-10 12:05:20,103 [INFO] - Extracting validation cells
[37m2024-08-10 12:05:29,103 [INFO] - Extraction detection metrics - F1: 0.737, Precision: 0.737, Recall: 0.749, Detected-Cells: 3266
[37m2024-08-10 12:05:29,104 [INFO] - Caching dataset 9791311761326234490ab8c48c2c524af9470472c837eadab609878360cc5465 to disk...
[37m2024-08-10 12:05:31,844 [INFO] - Validation epoch stats:   Loss: 0.6668 - F1-Score: 0.7511 - Accuracy-Score: 0.7511 - AUROC: 0.9205 - AP: 0.7123
[37m2024-08-10 12:05:31,845 [INFO] - New best model - save checkpoint
[37m2024-08-10 12:05:32,014 [INFO] - Epoch: 2/50
[37m2024-08-10 12:05:32,566 [INFO] - Training epoch stats:     Loss: 0.2200 - F1-Score: 0.9115 - Accuracy-Score: 0.9115 - AUROC: 0.9850 - AP: 0.9372
[37m2024-08-10 12:05:32,660 [INFO] - Validation epoch stats:   Loss: 0.7448 - F1-Score: 0.7018 - Accuracy-Score: 0.7018 - AUROC: 0.9426 - AP: 0.7327
[37m2024-08-10 12:05:32,661 [INFO] - New best model - save checkpoint
[37m2024-08-10 12:05:32,806 [INFO] - Epoch: 3/50
[37m2024-08-10 12:05:33,146 [INFO] - Training epoch stats:     Loss: 0.1910 - F1-Score: 0.9201 - Accuracy-Score: 0.9201 - AUROC: 0.9891 - AP: 0.9545
[37m2024-08-10 12:05:33,225 [INFO] - Validation epoch stats:   Loss: 0.7513 - F1-Score: 0.7296 - Accuracy-Score: 0.7296 - AUROC: 0.9459 - AP: 0.7290
[37m2024-08-10 12:05:33,226 [INFO] - New best model - save checkpoint
[37m2024-08-10 12:05:33,378 [INFO] - Epoch: 4/50
[37m2024-08-10 12:05:33,771 [INFO] - Training epoch stats:     Loss: 0.1651 - F1-Score: 0.9324 - Accuracy-Score: 0.9324 - AUROC: 0.9916 - AP: 0.9640
[37m2024-08-10 12:05:33,884 [INFO] - Validation epoch stats:   Loss: 1.0541 - F1-Score: 0.6494 - Accuracy-Score: 0.6494 - AUROC: 0.9407 - AP: 0.7270
[37m2024-08-10 12:05:33,941 [INFO] - Epoch: 5/50
[37m2024-08-10 12:05:34,356 [INFO] - Training epoch stats:     Loss: 0.1502 - F1-Score: 0.9341 - Accuracy-Score: 0.9341 - AUROC: 0.9930 - AP: 0.9713
[37m2024-08-10 12:05:34,425 [INFO] - Validation epoch stats:   Loss: 0.8206 - F1-Score: 0.7287 - Accuracy-Score: 0.7287 - AUROC: 0.9434 - AP: 0.7189
[37m2024-08-10 12:05:34,477 [INFO] - Epoch: 6/50
[37m2024-08-10 12:05:34,785 [INFO] - Training epoch stats:     Loss: 0.1289 - F1-Score: 0.9484 - Accuracy-Score: 0.9484 - AUROC: 0.9947 - AP: 0.9789
[37m2024-08-10 12:05:34,869 [INFO] - Validation epoch stats:   Loss: 1.1151 - F1-Score: 0.6528 - Accuracy-Score: 0.6528 - AUROC: 0.9282 - AP: 0.6891
[37m2024-08-10 12:05:34,925 [INFO] - Epoch: 7/50
[37m2024-08-10 12:05:35,268 [INFO] - Training epoch stats:     Loss: 0.1193 - F1-Score: 0.9478 - Accuracy-Score: 0.9478 - AUROC: 0.9954 - AP: 0.9812
[37m2024-08-10 12:05:35,375 [INFO] - Validation epoch stats:   Loss: 1.1999 - F1-Score: 0.6721 - Accuracy-Score: 0.6721 - AUROC: 0.9310 - AP: 0.6906
[37m2024-08-10 12:05:35,430 [INFO] - Epoch: 8/50
[37m2024-08-10 12:05:35,964 [INFO] - Training epoch stats:     Loss: 0.1093 - F1-Score: 0.9521 - Accuracy-Score: 0.9521 - AUROC: 0.9961 - AP: 0.9850
[37m2024-08-10 12:05:36,099 [INFO] - Validation epoch stats:   Loss: 1.6034 - F1-Score: 0.6010 - Accuracy-Score: 0.6010 - AUROC: 0.9318 - AP: 0.7064
[37m2024-08-10 12:05:36,153 [INFO] - Epoch: 9/50
[37m2024-08-10 12:05:36,485 [INFO] - Training epoch stats:     Loss: 0.0960 - F1-Score: 0.9609 - Accuracy-Score: 0.9609 - AUROC: 0.9970 - AP: 0.9860
[37m2024-08-10 12:05:36,567 [INFO] - Validation epoch stats:   Loss: 1.6297 - F1-Score: 0.6118 - Accuracy-Score: 0.6118 - AUROC: 0.9204 - AP: 0.6881
[37m2024-08-10 12:05:36,619 [INFO] - Epoch: 10/50
[37m2024-08-10 12:05:37,017 [INFO] - Training epoch stats:     Loss: 0.0848 - F1-Score: 0.9648 - Accuracy-Score: 0.9648 - AUROC: 0.9975 - AP: 0.9894
[37m2024-08-10 12:05:37,085 [INFO] - Validation epoch stats:   Loss: 1.5882 - F1-Score: 0.6568 - Accuracy-Score: 0.6568 - AUROC: 0.9275 - AP: 0.6872
[37m2024-08-10 12:05:37,139 [INFO] - Epoch: 11/50
[37m2024-08-10 12:05:37,667 [INFO] - Training epoch stats:     Loss: 0.0802 - F1-Score: 0.9652 - Accuracy-Score: 0.9652 - AUROC: 0.9977 - AP: 0.9914
[37m2024-08-10 12:05:37,815 [INFO] - Validation epoch stats:   Loss: 1.8391 - F1-Score: 0.6402 - Accuracy-Score: 0.6402 - AUROC: 0.9223 - AP: 0.6715
[37m2024-08-10 12:05:37,869 [INFO] - Epoch: 12/50
[37m2024-08-10 12:05:38,265 [INFO] - Training epoch stats:     Loss: 0.0774 - F1-Score: 0.9671 - Accuracy-Score: 0.9671 - AUROC: 0.9980 - AP: 0.9923
[37m2024-08-10 12:05:38,358 [INFO] - Validation epoch stats:   Loss: 2.3178 - F1-Score: 0.5787 - Accuracy-Score: 0.5787 - AUROC: 0.9082 - AP: 0.6656
[37m2024-08-10 12:05:38,411 [INFO] - Epoch: 13/50
[37m2024-08-10 12:05:38,778 [INFO] - Training epoch stats:     Loss: 0.0726 - F1-Score: 0.9688 - Accuracy-Score: 0.9688 - AUROC: 0.9982 - AP: 0.9932
[37m2024-08-10 12:05:38,897 [INFO] - Validation epoch stats:   Loss: 2.0265 - F1-Score: 0.6430 - Accuracy-Score: 0.6430 - AUROC: 0.9214 - AP: 0.6802
[37m2024-08-10 12:05:38,955 [INFO] - Epoch: 14/50
[37m2024-08-10 12:05:39,544 [INFO] - Training epoch stats:     Loss: 0.0671 - F1-Score: 0.9705 - Accuracy-Score: 0.9705 - AUROC: 0.9984 - AP: 0.9941
[37m2024-08-10 12:05:39,713 [INFO] - Validation epoch stats:   Loss: 2.5111 - F1-Score: 0.6075 - Accuracy-Score: 0.6075 - AUROC: 0.9174 - AP: 0.6616
[37m2024-08-10 12:05:39,766 [INFO] - Epoch: 15/50
[37m2024-08-10 12:05:40,129 [INFO] - Training epoch stats:     Loss: 0.0593 - F1-Score: 0.9757 - Accuracy-Score: 0.9757 - AUROC: 0.9988 - AP: 0.9956
[37m2024-08-10 12:05:40,220 [INFO] - Validation epoch stats:   Loss: 2.3061 - F1-Score: 0.6356 - Accuracy-Score: 0.6356 - AUROC: 0.9173 - AP: 0.6630
[37m2024-08-10 12:05:40,274 [INFO] - Epoch: 16/50
[37m2024-08-10 12:05:40,621 [INFO] - Training epoch stats:     Loss: 0.0616 - F1-Score: 0.9766 - Accuracy-Score: 0.9766 - AUROC: 0.9986 - AP: 0.9939
[37m2024-08-10 12:05:40,744 [INFO] - Validation epoch stats:   Loss: 2.7268 - F1-Score: 0.5958 - Accuracy-Score: 0.5958 - AUROC: 0.9234 - AP: 0.6429
[37m2024-08-10 12:05:40,795 [INFO] - Epoch: 17/50
[37m2024-08-10 12:05:41,327 [INFO] - Training epoch stats:     Loss: 0.0532 - F1-Score: 0.9780 - Accuracy-Score: 0.9780 - AUROC: 0.9990 - AP: 0.9950
[37m2024-08-10 12:05:41,467 [INFO] - Validation epoch stats:   Loss: 2.7672 - F1-Score: 0.6059 - Accuracy-Score: 0.6059 - AUROC: 0.9121 - AP: 0.6516
[37m2024-08-10 12:05:41,525 [INFO] - Epoch: 18/50
[37m2024-08-10 12:05:41,885 [INFO] - Training epoch stats:     Loss: 0.0548 - F1-Score: 0.9780 - Accuracy-Score: 0.9780 - AUROC: 0.9989 - AP: 0.9950
[37m2024-08-10 12:05:41,968 [INFO] - Validation epoch stats:   Loss: 3.1912 - F1-Score: 0.5934 - Accuracy-Score: 0.5934 - AUROC: 0.9048 - AP: 0.6430
[37m2024-08-10 12:05:42,021 [INFO] - Epoch: 19/50
[37m2024-08-10 12:05:42,378 [INFO] - Training epoch stats:     Loss: 0.0487 - F1-Score: 0.9806 - Accuracy-Score: 0.9806 - AUROC: 0.9992 - AP: 0.9957
[37m2024-08-10 12:05:42,461 [INFO] - Validation epoch stats:   Loss: 3.5724 - F1-Score: 0.5934 - Accuracy-Score: 0.5934 - AUROC: 0.9075 - AP: 0.6418
[37m2024-08-10 12:05:42,518 [INFO] - Epoch: 20/50
[37m2024-08-10 12:05:42,911 [INFO] - Training epoch stats:     Loss: 0.0496 - F1-Score: 0.9816 - Accuracy-Score: 0.9816 - AUROC: 0.9992 - AP: 0.9965
[37m2024-08-10 12:05:43,092 [INFO] - Validation epoch stats:   Loss: 3.2453 - F1-Score: 0.6246 - Accuracy-Score: 0.6246 - AUROC: 0.9032 - AP: 0.6423
[37m2024-08-10 12:05:43,146 [INFO] - Epoch: 21/50
[37m2024-08-10 12:05:43,645 [INFO] - Training epoch stats:     Loss: 0.0457 - F1-Score: 0.9833 - Accuracy-Score: 0.9833 - AUROC: 0.9993 - AP: 0.9962
[37m2024-08-10 12:05:43,722 [INFO] - Validation epoch stats:   Loss: 4.0207 - F1-Score: 0.5707 - Accuracy-Score: 0.5707 - AUROC: 0.8881 - AP: 0.6050
[37m2024-08-10 12:05:43,778 [INFO] - Epoch: 22/50
[37m2024-08-10 12:05:44,128 [INFO] - Training epoch stats:     Loss: 0.0397 - F1-Score: 0.9845 - Accuracy-Score: 0.9845 - AUROC: 0.9994 - AP: 0.9977
[37m2024-08-10 12:05:44,207 [INFO] - Validation epoch stats:   Loss: 3.7997 - F1-Score: 0.5707 - Accuracy-Score: 0.5707 - AUROC: 0.8856 - AP: 0.6224
[37m2024-08-10 12:05:44,268 [INFO] - Epoch: 23/50
[37m2024-08-10 12:05:44,620 [INFO] - Training epoch stats:     Loss: 0.0397 - F1-Score: 0.9850 - Accuracy-Score: 0.9850 - AUROC: 0.9994 - AP: 0.9977
[37m2024-08-10 12:05:44,697 [INFO] - Validation epoch stats:   Loss: 3.7595 - F1-Score: 0.5964 - Accuracy-Score: 0.5964 - AUROC: 0.8850 - AP: 0.6186
[37m2024-08-10 12:05:44,697 [INFO] - Performing early stopping!
[37m2024-08-10 12:05:44,703 [INFO] - Finished run wt3vb8ek
