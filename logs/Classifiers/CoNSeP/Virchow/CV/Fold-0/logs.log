[37m2024-08-10 11:59:53,755 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-08-10 11:59:53,756 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/Virchow/Setting-2/2024-08-10T115945_Fold-0
[37m2024-08-10 11:59:53,824 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f7e167f6e90>]
[37m2024-08-10 11:59:53,825 [INFO] - Using GPU: cuda:0
[37m2024-08-10 11:59:53,829 [INFO] - Using device: cuda:0
[37m2024-08-10 11:59:53,834 [INFO] - Loss function:
[37m2024-08-10 11:59:53,838 [INFO] - CrossEntropyLoss()
[37m2024-08-10 12:00:02,778 [INFO] - <All keys matched successfully>
[37m2024-08-10 12:00:04,388 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-08-10 12:00:04,389 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-08-10 12:00:04,394 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00568059820179996, 'weight_decay': 0.0004714549691487939}
[37m2024-08-10 12:00:04,400 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-08-10 12:00:04,413 [INFO] - Caching datasets
[37m2024-08-10 12:00:05,532 [INFO] - Instantiate Trainer
[37m2024-08-10 12:00:05,538 [INFO] - Calling Trainer Fit
[37m2024-08-10 12:00:05,538 [INFO] - Dataset is cached after first epoch
[37m2024-08-10 12:00:05,543 [INFO] - Starting training, total number of epochs: 50
[37m2024-08-10 12:00:05,548 [INFO] - Epoch: 1/50
[37m2024-08-10 12:00:07,701 [INFO] - Loaded dataset from cache: /Consep/cache/9f818c1430a91b4ae4d99060d8e62376ec759c6d22b6558121a47bc4268ef0ed.h5
[37m2024-08-10 12:00:08,631 [INFO] - Training epoch stats:     Loss: 0.3544 - F1-Score: 0.8619 - Accuracy-Score: 0.8619 - AUROC: 0.9525 - AP: 0.8181
[37m2024-08-10 12:00:09,034 [INFO] - Loaded dataset from cache: /Consep/cache/215a658570081ed1f44bf19fe9b39f35e989676a454fa7fe1efb192edbd6db24.h5
[37m2024-08-10 12:00:09,081 [INFO] - Validation epoch stats:   Loss: 0.5563 - F1-Score: 0.8268 - Accuracy-Score: 0.8268 - AUROC: 0.9524 - AP: 0.8358
[37m2024-08-10 12:00:09,082 [INFO] - New best model - save checkpoint
[37m2024-08-10 12:00:09,236 [INFO] - Epoch: 2/50
[37m2024-08-10 12:00:09,630 [INFO] - Training epoch stats:     Loss: 0.2351 - F1-Score: 0.9053 - Accuracy-Score: 0.9053 - AUROC: 0.9845 - AP: 0.9344
[37m2024-08-10 12:00:09,738 [INFO] - Validation epoch stats:   Loss: 0.5293 - F1-Score: 0.8363 - Accuracy-Score: 0.8363 - AUROC: 0.9552 - AP: 0.8130
[37m2024-08-10 12:00:09,738 [INFO] - New best model - save checkpoint
[37m2024-08-10 12:00:09,881 [INFO] - Epoch: 3/50
[37m2024-08-10 12:00:10,384 [INFO] - Training epoch stats:     Loss: 0.2039 - F1-Score: 0.9149 - Accuracy-Score: 0.9149 - AUROC: 0.9887 - AP: 0.9605
[37m2024-08-10 12:00:10,436 [INFO] - Validation epoch stats:   Loss: 0.6594 - F1-Score: 0.7831 - Accuracy-Score: 0.7831 - AUROC: 0.9536 - AP: 0.7994
[37m2024-08-10 12:00:10,486 [INFO] - Epoch: 4/50
[37m2024-08-10 12:00:10,842 [INFO] - Training epoch stats:     Loss: 0.1851 - F1-Score: 0.9236 - Accuracy-Score: 0.9236 - AUROC: 0.9909 - AP: 0.9653
[37m2024-08-10 12:00:10,894 [INFO] - Validation epoch stats:   Loss: 0.7822 - F1-Score: 0.7674 - Accuracy-Score: 0.7674 - AUROC: 0.9442 - AP: 0.7935
[37m2024-08-10 12:00:10,967 [INFO] - Epoch: 5/50
[37m2024-08-10 12:00:11,317 [INFO] - Training epoch stats:     Loss: 0.1657 - F1-Score: 0.9323 - Accuracy-Score: 0.9323 - AUROC: 0.9925 - AP: 0.9811
[37m2024-08-10 12:00:11,365 [INFO] - Validation epoch stats:   Loss: 0.8660 - F1-Score: 0.7916 - Accuracy-Score: 0.7916 - AUROC: 0.9457 - AP: 0.7821
[37m2024-08-10 12:00:11,406 [INFO] - Epoch: 6/50
[37m2024-08-10 12:00:11,803 [INFO] - Training epoch stats:     Loss: 0.1501 - F1-Score: 0.9358 - Accuracy-Score: 0.9358 - AUROC: 0.9937 - AP: 0.9843
[37m2024-08-10 12:00:11,883 [INFO] - Validation epoch stats:   Loss: 0.6476 - F1-Score: 0.8481 - Accuracy-Score: 0.8481 - AUROC: 0.9485 - AP: 0.7864
[37m2024-08-10 12:00:11,936 [INFO] - Epoch: 7/50
[37m2024-08-10 12:00:12,517 [INFO] - Training epoch stats:     Loss: 0.1310 - F1-Score: 0.9440 - Accuracy-Score: 0.9440 - AUROC: 0.9951 - AP: 0.9886
[37m2024-08-10 12:00:12,574 [INFO] - Validation epoch stats:   Loss: 0.8765 - F1-Score: 0.8125 - Accuracy-Score: 0.8125 - AUROC: 0.9389 - AP: 0.7636
[37m2024-08-10 12:00:12,626 [INFO] - Epoch: 8/50
[37m2024-08-10 12:00:13,001 [INFO] - Training epoch stats:     Loss: 0.1149 - F1-Score: 0.9496 - Accuracy-Score: 0.9496 - AUROC: 0.9961 - AP: 0.9919
[37m2024-08-10 12:00:13,050 [INFO] - Validation epoch stats:   Loss: 1.0937 - F1-Score: 0.7950 - Accuracy-Score: 0.7950 - AUROC: 0.9317 - AP: 0.7548
[37m2024-08-10 12:00:13,092 [INFO] - Epoch: 9/50
[37m2024-08-10 12:00:13,443 [INFO] - Training epoch stats:     Loss: 0.1099 - F1-Score: 0.9521 - Accuracy-Score: 0.9521 - AUROC: 0.9965 - AP: 0.9930
[37m2024-08-10 12:00:13,491 [INFO] - Validation epoch stats:   Loss: 1.0532 - F1-Score: 0.8215 - Accuracy-Score: 0.8215 - AUROC: 0.9327 - AP: 0.7603
[37m2024-08-10 12:00:13,538 [INFO] - Epoch: 10/50
[37m2024-08-10 12:00:13,902 [INFO] - Training epoch stats:     Loss: 0.1030 - F1-Score: 0.9559 - Accuracy-Score: 0.9559 - AUROC: 0.9969 - AP: 0.9933
[37m2024-08-10 12:00:13,985 [INFO] - Validation epoch stats:   Loss: 1.4414 - F1-Score: 0.7788 - Accuracy-Score: 0.7788 - AUROC: 0.9257 - AP: 0.7365
[37m2024-08-10 12:00:14,027 [INFO] - Epoch: 11/50
[37m2024-08-10 12:00:14,615 [INFO] - Training epoch stats:     Loss: 0.0963 - F1-Score: 0.9595 - Accuracy-Score: 0.9595 - AUROC: 0.9972 - AP: 0.9948
[37m2024-08-10 12:00:14,671 [INFO] - Validation epoch stats:   Loss: 1.5706 - F1-Score: 0.7722 - Accuracy-Score: 0.7722 - AUROC: 0.9096 - AP: 0.7150
[37m2024-08-10 12:00:14,730 [INFO] - Epoch: 12/50
[37m2024-08-10 12:00:15,154 [INFO] - Training epoch stats:     Loss: 0.0850 - F1-Score: 0.9655 - Accuracy-Score: 0.9655 - AUROC: 0.9978 - AP: 0.9955
[37m2024-08-10 12:00:15,207 [INFO] - Validation epoch stats:   Loss: 1.4955 - F1-Score: 0.8087 - Accuracy-Score: 0.8087 - AUROC: 0.9134 - AP: 0.7190
[37m2024-08-10 12:00:15,247 [INFO] - Epoch: 13/50
[37m2024-08-10 12:00:15,604 [INFO] - Training epoch stats:     Loss: 0.0839 - F1-Score: 0.9653 - Accuracy-Score: 0.9653 - AUROC: 0.9979 - AP: 0.9913
[37m2024-08-10 12:00:15,653 [INFO] - Validation epoch stats:   Loss: 1.8898 - F1-Score: 0.7594 - Accuracy-Score: 0.7594 - AUROC: 0.9072 - AP: 0.6904
[37m2024-08-10 12:00:15,692 [INFO] - Epoch: 14/50
[37m2024-08-10 12:00:16,080 [INFO] - Training epoch stats:     Loss: 0.0745 - F1-Score: 0.9720 - Accuracy-Score: 0.9720 - AUROC: 0.9984 - AP: 0.9966
[37m2024-08-10 12:00:16,158 [INFO] - Validation epoch stats:   Loss: 1.3239 - F1-Score: 0.8144 - Accuracy-Score: 0.8144 - AUROC: 0.9268 - AP: 0.7492
[37m2024-08-10 12:00:16,230 [INFO] - Epoch: 15/50
[37m2024-08-10 12:00:16,826 [INFO] - Training epoch stats:     Loss: 0.0753 - F1-Score: 0.9676 - Accuracy-Score: 0.9676 - AUROC: 0.9983 - AP: 0.9963
[37m2024-08-10 12:00:16,903 [INFO] - Validation epoch stats:   Loss: 1.5226 - F1-Score: 0.8130 - Accuracy-Score: 0.8130 - AUROC: 0.9208 - AP: 0.7420
[37m2024-08-10 12:00:16,959 [INFO] - Epoch: 16/50
[37m2024-08-10 12:00:17,369 [INFO] - Training epoch stats:     Loss: 0.0634 - F1-Score: 0.9740 - Accuracy-Score: 0.9740 - AUROC: 0.9988 - AP: 0.9973
[37m2024-08-10 12:00:17,425 [INFO] - Validation epoch stats:   Loss: 1.9215 - F1-Score: 0.7689 - Accuracy-Score: 0.7689 - AUROC: 0.9069 - AP: 0.7055
[37m2024-08-10 12:00:17,480 [INFO] - Epoch: 17/50
[37m2024-08-10 12:00:17,872 [INFO] - Training epoch stats:     Loss: 0.0657 - F1-Score: 0.9717 - Accuracy-Score: 0.9717 - AUROC: 0.9987 - AP: 0.9959
[37m2024-08-10 12:00:17,921 [INFO] - Validation epoch stats:   Loss: 2.3526 - F1-Score: 0.7679 - Accuracy-Score: 0.7679 - AUROC: 0.9077 - AP: 0.6895
[37m2024-08-10 12:00:17,960 [INFO] - Epoch: 18/50
[37m2024-08-10 12:00:18,365 [INFO] - Training epoch stats:     Loss: 0.0551 - F1-Score: 0.9783 - Accuracy-Score: 0.9783 - AUROC: 0.9990 - AP: 0.9955
[37m2024-08-10 12:00:18,421 [INFO] - Validation epoch stats:   Loss: 2.5511 - F1-Score: 0.7299 - Accuracy-Score: 0.7299 - AUROC: 0.9004 - AP: 0.6862
[37m2024-08-10 12:00:18,462 [INFO] - Epoch: 19/50
[37m2024-08-10 12:00:19,062 [INFO] - Training epoch stats:     Loss: 0.0563 - F1-Score: 0.9775 - Accuracy-Score: 0.9775 - AUROC: 0.9991 - AP: 0.9982
[37m2024-08-10 12:00:19,160 [INFO] - Validation epoch stats:   Loss: 1.6570 - F1-Score: 0.8187 - Accuracy-Score: 0.8187 - AUROC: 0.9154 - AP: 0.7201
[37m2024-08-10 12:00:19,210 [INFO] - Epoch: 20/50
[37m2024-08-10 12:00:19,598 [INFO] - Training epoch stats:     Loss: 0.0480 - F1-Score: 0.9811 - Accuracy-Score: 0.9811 - AUROC: 0.9993 - AP: 0.9984
[37m2024-08-10 12:00:19,650 [INFO] - Validation epoch stats:   Loss: 2.0233 - F1-Score: 0.7822 - Accuracy-Score: 0.7822 - AUROC: 0.9098 - AP: 0.7043
[37m2024-08-10 12:00:19,736 [INFO] - Epoch: 21/50
[37m2024-08-10 12:00:20,122 [INFO] - Training epoch stats:     Loss: 0.0446 - F1-Score: 0.9823 - Accuracy-Score: 0.9823 - AUROC: 0.9994 - AP: 0.9987
[37m2024-08-10 12:00:20,169 [INFO] - Validation epoch stats:   Loss: 2.0371 - F1-Score: 0.8026 - Accuracy-Score: 0.8026 - AUROC: 0.9075 - AP: 0.7098
[37m2024-08-10 12:00:20,217 [INFO] - Epoch: 22/50
[37m2024-08-10 12:00:20,598 [INFO] - Training epoch stats:     Loss: 0.0455 - F1-Score: 0.9816 - Accuracy-Score: 0.9816 - AUROC: 0.9994 - AP: 0.9986
[37m2024-08-10 12:00:20,679 [INFO] - Validation epoch stats:   Loss: 1.7804 - F1-Score: 0.8263 - Accuracy-Score: 0.8263 - AUROC: 0.9139 - AP: 0.7324
[37m2024-08-10 12:00:20,680 [INFO] - Performing early stopping!
[37m2024-08-10 12:00:20,687 [INFO] - Finished run j4ozmcy0
