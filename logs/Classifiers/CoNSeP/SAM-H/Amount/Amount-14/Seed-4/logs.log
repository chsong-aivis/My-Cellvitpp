[37m2024-06-28 06:53:26,762 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 06:53:26,764 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-06-28T065317_Amount-14-Seed-4
[37m2024-06-28 06:53:26,831 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fe10d9886a0>]
[37m2024-06-28 06:53:26,832 [INFO] - Using GPU: cuda:0
[37m2024-06-28 06:53:26,837 [INFO] - Using device: cuda:0
[37m2024-06-28 06:53:26,843 [INFO] - Loss function:
[37m2024-06-28 06:53:26,847 [INFO] - CrossEntropyLoss()
[37m2024-06-28 06:55:06,963 [INFO] - <All keys matched successfully>
[37m2024-06-28 06:55:08,525 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 06:55:08,528 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 06:55:08,531 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 06:55:08,537 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 06:55:08,555 [INFO] - Caching datasets
[37m2024-06-28 06:55:09,719 [INFO] - Instantiate Trainer
[37m2024-06-28 06:55:09,723 [INFO] - Calling Trainer Fit
[37m2024-06-28 06:55:09,726 [INFO] - Dataset is cached after first epoch
[37m2024-06-28 06:55:09,732 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 06:55:09,737 [INFO] - Epoch: 1/50
[37m2024-06-28 06:55:11,878 [INFO] - Loaded dataset from cache: /Consep/cache/7e423674e9cfc9ef0ae62bca70d372e405cc5e9663c8d45ed63da4a764d93017.h5
[37m2024-06-28 06:55:13,065 [INFO] - Training epoch stats:     Loss: 0.3940 - F1-Score: 0.8514 - Accuracy-Score: 0.8514 - AUROC: 0.9406 - AP: 0.7794
[37m2024-06-28 06:55:14,606 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 06:55:16,157 [INFO] - Validation epoch stats:   Loss: 0.3865 - F1-Score: 0.8673 - Accuracy-Score: 0.8673 - AUROC: 0.9593 - AP: 0.8467
[37m2024-06-28 06:55:16,163 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:55:16,974 [INFO] - Epoch: 2/50
[37m2024-06-28 06:55:17,372 [INFO] - Training epoch stats:     Loss: 0.1924 - F1-Score: 0.9277 - Accuracy-Score: 0.9277 - AUROC: 0.9862 - AP: 0.9279
[37m2024-06-28 06:55:17,569 [INFO] - Validation epoch stats:   Loss: 0.3629 - F1-Score: 0.8692 - Accuracy-Score: 0.8692 - AUROC: 0.9619 - AP: 0.8506
[37m2024-06-28 06:55:17,571 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:55:17,768 [INFO] - Epoch: 3/50
[37m2024-06-28 06:55:18,406 [INFO] - Training epoch stats:     Loss: 0.1491 - F1-Score: 0.9428 - Accuracy-Score: 0.9428 - AUROC: 0.9920 - AP: 0.9620
[37m2024-06-28 06:55:18,677 [INFO] - Validation epoch stats:   Loss: 0.3273 - F1-Score: 0.8776 - Accuracy-Score: 0.8776 - AUROC: 0.9662 - AP: 0.8621
[37m2024-06-28 06:55:18,678 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:55:18,925 [INFO] - Epoch: 4/50
[37m2024-06-28 06:55:19,568 [INFO] - Training epoch stats:     Loss: 0.1064 - F1-Score: 0.9606 - Accuracy-Score: 0.9606 - AUROC: 0.9965 - AP: 0.9795
[37m2024-06-28 06:55:19,793 [INFO] - Validation epoch stats:   Loss: 0.3399 - F1-Score: 0.8764 - Accuracy-Score: 0.8764 - AUROC: 0.9675 - AP: 0.8653
[37m2024-06-28 06:55:19,795 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:55:20,043 [INFO] - Epoch: 5/50
[37m2024-06-28 06:55:20,313 [INFO] - Training epoch stats:     Loss: 0.0848 - F1-Score: 0.9691 - Accuracy-Score: 0.9691 - AUROC: 0.9980 - AP: 0.9885
[37m2024-06-28 06:55:20,564 [INFO] - Validation epoch stats:   Loss: 0.3463 - F1-Score: 0.8809 - Accuracy-Score: 0.8809 - AUROC: 0.9647 - AP: 0.8641
[37m2024-06-28 06:55:20,632 [INFO] - Epoch: 6/50
[37m2024-06-28 06:55:20,964 [INFO] - Training epoch stats:     Loss: 0.0649 - F1-Score: 0.9795 - Accuracy-Score: 0.9795 - AUROC: 0.9988 - AP: 0.9941
[37m2024-06-28 06:55:21,171 [INFO] - Validation epoch stats:   Loss: 0.3834 - F1-Score: 0.8735 - Accuracy-Score: 0.8735 - AUROC: 0.9646 - AP: 0.8669
[37m2024-06-28 06:55:21,259 [INFO] - Epoch: 7/50
[37m2024-06-28 06:55:21,966 [INFO] - Training epoch stats:     Loss: 0.0559 - F1-Score: 0.9816 - Accuracy-Score: 0.9816 - AUROC: 0.9992 - AP: 0.9954
[37m2024-06-28 06:55:22,113 [INFO] - Validation epoch stats:   Loss: 0.3796 - F1-Score: 0.8817 - Accuracy-Score: 0.8817 - AUROC: 0.9653 - AP: 0.8674
[37m2024-06-28 06:55:22,168 [INFO] - Epoch: 8/50
[37m2024-06-28 06:55:22,514 [INFO] - Training epoch stats:     Loss: 0.0448 - F1-Score: 0.9839 - Accuracy-Score: 0.9839 - AUROC: 0.9995 - AP: 0.9972
[37m2024-06-28 06:55:22,726 [INFO] - Validation epoch stats:   Loss: 0.3711 - F1-Score: 0.8872 - Accuracy-Score: 0.8872 - AUROC: 0.9628 - AP: 0.8642
[37m2024-06-28 06:55:22,854 [INFO] - Epoch: 9/50
[37m2024-06-28 06:55:23,189 [INFO] - Training epoch stats:     Loss: 0.0345 - F1-Score: 0.9894 - Accuracy-Score: 0.9894 - AUROC: 0.9998 - AP: 0.9989
[37m2024-06-28 06:55:23,770 [INFO] - Validation epoch stats:   Loss: 0.3855 - F1-Score: 0.8876 - Accuracy-Score: 0.8876 - AUROC: 0.9648 - AP: 0.8663
[37m2024-06-28 06:55:23,838 [INFO] - Epoch: 10/50
[37m2024-06-28 06:55:24,266 [INFO] - Training epoch stats:     Loss: 0.0282 - F1-Score: 0.9927 - Accuracy-Score: 0.9927 - AUROC: 0.9999 - AP: 0.9995
[37m2024-06-28 06:55:24,463 [INFO] - Validation epoch stats:   Loss: 0.4377 - F1-Score: 0.8761 - Accuracy-Score: 0.8761 - AUROC: 0.9625 - AP: 0.8630
[37m2024-06-28 06:55:24,518 [INFO] - Epoch: 11/50
[37m2024-06-28 06:55:24,917 [INFO] - Training epoch stats:     Loss: 0.0227 - F1-Score: 0.9953 - Accuracy-Score: 0.9953 - AUROC: 0.9999 - AP: 0.9994
[37m2024-06-28 06:55:25,247 [INFO] - Validation epoch stats:   Loss: 0.4666 - F1-Score: 0.8774 - Accuracy-Score: 0.8774 - AUROC: 0.9618 - AP: 0.8613
[37m2024-06-28 06:55:25,327 [INFO] - Epoch: 12/50
[37m2024-06-28 06:55:25,770 [INFO] - Training epoch stats:     Loss: 0.0182 - F1-Score: 0.9969 - Accuracy-Score: 0.9969 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:55:25,959 [INFO] - Validation epoch stats:   Loss: 0.4557 - F1-Score: 0.8821 - Accuracy-Score: 0.8821 - AUROC: 0.9619 - AP: 0.8586
[37m2024-06-28 06:55:26,036 [INFO] - Epoch: 13/50
[37m2024-06-28 06:55:26,347 [INFO] - Training epoch stats:     Loss: 0.0159 - F1-Score: 0.9974 - Accuracy-Score: 0.9974 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:55:26,504 [INFO] - Validation epoch stats:   Loss: 0.4738 - F1-Score: 0.8816 - Accuracy-Score: 0.8816 - AUROC: 0.9607 - AP: 0.8581
[37m2024-06-28 06:55:26,566 [INFO] - Epoch: 14/50
[37m2024-06-28 06:55:26,859 [INFO] - Training epoch stats:     Loss: 0.0161 - F1-Score: 0.9962 - Accuracy-Score: 0.9962 - AUROC: 0.9999 - AP: 0.9995
[37m2024-06-28 06:55:27,068 [INFO] - Validation epoch stats:   Loss: 0.4814 - F1-Score: 0.8807 - Accuracy-Score: 0.8807 - AUROC: 0.9604 - AP: 0.8588
[37m2024-06-28 06:55:27,210 [INFO] - Epoch: 15/50
[37m2024-06-28 06:55:27,441 [INFO] - Training epoch stats:     Loss: 0.0121 - F1-Score: 0.9976 - Accuracy-Score: 0.9976 - AUROC: 1.0000 - AP: 0.9998
[37m2024-06-28 06:55:27,572 [INFO] - Validation epoch stats:   Loss: 0.5761 - F1-Score: 0.8723 - Accuracy-Score: 0.8723 - AUROC: 0.9610 - AP: 0.8551
[37m2024-06-28 06:55:27,655 [INFO] - Epoch: 16/50
[37m2024-06-28 06:55:27,890 [INFO] - Training epoch stats:     Loss: 0.0121 - F1-Score: 0.9977 - Accuracy-Score: 0.9977 - AUROC: 0.9999 - AP: 0.9997
[37m2024-06-28 06:55:28,162 [INFO] - Validation epoch stats:   Loss: 0.5061 - F1-Score: 0.8800 - Accuracy-Score: 0.8800 - AUROC: 0.9594 - AP: 0.8571
[37m2024-06-28 06:55:28,221 [INFO] - Epoch: 17/50
[37m2024-06-28 06:55:28,527 [INFO] - Training epoch stats:     Loss: 0.0082 - F1-Score: 0.9988 - Accuracy-Score: 0.9988 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:55:29,271 [INFO] - Validation epoch stats:   Loss: 0.5269 - F1-Score: 0.8786 - Accuracy-Score: 0.8786 - AUROC: 0.9611 - AP: 0.8572
[37m2024-06-28 06:55:29,348 [INFO] - Epoch: 18/50
[37m2024-06-28 06:55:30,568 [INFO] - Training epoch stats:     Loss: 0.0084 - F1-Score: 0.9984 - Accuracy-Score: 0.9984 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:55:30,801 [INFO] - Validation epoch stats:   Loss: 0.5372 - F1-Score: 0.8831 - Accuracy-Score: 0.8831 - AUROC: 0.9606 - AP: 0.8569
[37m2024-06-28 06:55:30,849 [INFO] - Epoch: 19/50
[37m2024-06-28 06:55:31,157 [INFO] - Training epoch stats:     Loss: 0.0091 - F1-Score: 0.9981 - Accuracy-Score: 0.9981 - AUROC: 0.9999 - AP: 0.9996
[37m2024-06-28 06:55:31,302 [INFO] - Validation epoch stats:   Loss: 0.5692 - F1-Score: 0.8804 - Accuracy-Score: 0.8804 - AUROC: 0.9608 - AP: 0.8552
[37m2024-06-28 06:55:31,355 [INFO] - Epoch: 20/50
[37m2024-06-28 06:55:31,668 [INFO] - Training epoch stats:     Loss: 0.0076 - F1-Score: 0.9988 - Accuracy-Score: 0.9988 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:55:31,811 [INFO] - Validation epoch stats:   Loss: 0.5645 - F1-Score: 0.8797 - Accuracy-Score: 0.8797 - AUROC: 0.9585 - AP: 0.8570
[37m2024-06-28 06:55:31,852 [INFO] - Epoch: 21/50
[37m2024-06-28 06:55:32,107 [INFO] - Training epoch stats:     Loss: 0.0085 - F1-Score: 0.9986 - Accuracy-Score: 0.9986 - AUROC: 1.0000 - AP: 0.9998
[37m2024-06-28 06:55:32,296 [INFO] - Validation epoch stats:   Loss: 0.5837 - F1-Score: 0.8817 - Accuracy-Score: 0.8817 - AUROC: 0.9601 - AP: 0.8579
[37m2024-06-28 06:55:32,384 [INFO] - Epoch: 22/50
[37m2024-06-28 06:55:32,723 [INFO] - Training epoch stats:     Loss: 0.0062 - F1-Score: 0.9991 - Accuracy-Score: 0.9991 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:55:32,869 [INFO] - Validation epoch stats:   Loss: 0.6091 - F1-Score: 0.8840 - Accuracy-Score: 0.8840 - AUROC: 0.9591 - AP: 0.8550
[37m2024-06-28 06:55:32,925 [INFO] - Epoch: 23/50
[37m2024-06-28 06:55:33,179 [INFO] - Training epoch stats:     Loss: 0.0058 - F1-Score: 0.9986 - Accuracy-Score: 0.9986 - AUROC: 1.0000 - AP: 0.9998
[37m2024-06-28 06:55:33,335 [INFO] - Validation epoch stats:   Loss: 0.6265 - F1-Score: 0.8804 - Accuracy-Score: 0.8804 - AUROC: 0.9589 - AP: 0.8530
[37m2024-06-28 06:55:33,409 [INFO] - Epoch: 24/50
[37m2024-06-28 06:55:33,764 [INFO] - Training epoch stats:     Loss: 0.0060 - F1-Score: 0.9986 - Accuracy-Score: 0.9986 - AUROC: 1.0000 - AP: 0.9998
[37m2024-06-28 06:55:33,897 [INFO] - Validation epoch stats:   Loss: 0.5901 - F1-Score: 0.8840 - Accuracy-Score: 0.8840 - AUROC: 0.9564 - AP: 0.8540
[37m2024-06-28 06:55:33,897 [INFO] - Performing early stopping!
[37m2024-06-28 06:55:33,903 [INFO] - Finished run v1ukwmge
