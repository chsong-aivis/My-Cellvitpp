[37m2024-05-16 12:55:51,453 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-05-16 12:55:51,456 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-05-16T125536_Amount-1
[37m2024-05-16 12:55:51,542 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f0f2dd4a560>]
[37m2024-05-16 12:55:51,555 [INFO] - Using GPU: cuda:0
[37m2024-05-16 12:55:51,566 [INFO] - Using device: cuda:0
[37m2024-05-16 12:55:51,578 [INFO] - Loss function:
[37m2024-05-16 12:55:51,590 [INFO] - CrossEntropyLoss()
[37m2024-05-16 12:56:03,083 [INFO] - <All keys matched successfully>
[37m2024-05-16 12:56:03,926 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-05-16 12:56:03,928 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-05-16 12:56:03,938 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-05-16 12:56:03,949 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-05-16 12:56:03,979 [INFO] - Caching datasets
[37m2024-05-16 12:56:04,668 [INFO] - Instantiate Trainer
[37m2024-05-16 12:56:04,685 [INFO] - Calling Trainer Fit
[37m2024-05-16 12:56:04,696 [INFO] - Dataset is cached after first epoch
[37m2024-05-16 12:56:04,707 [INFO] - Starting training, total number of epochs: 50
[37m2024-05-16 12:56:04,718 [INFO] - Epoch: 1/50
[37m2024-05-16 12:56:04,732 [INFO] - Extracting training cells
[37m2024-05-16 12:56:07,660 [INFO] - Extraction detection metrics - F1: 0.806, Precision: 0.765, Recall: 0.851, Detected-Cells: 653
[37m2024-05-16 12:56:07,663 [INFO] - Caching dataset e75dc1661d1f9fb390a61638462c7ebbc796f669bec8a7202d15b01fd762cee7 to disk...
[37m2024-05-16 12:56:08,433 [INFO] - Training epoch stats:     Loss: 1.1967 - F1-Score: 0.3890 - Accuracy-Score: 0.3890 - AUROC: 0.5990 - AP: 0.3594
[37m2024-05-16 12:56:08,449 [INFO] - Extracting validation cells
[37m2024-05-16 12:56:20,229 [INFO] - Extraction detection metrics - F1: 0.754, Precision: 0.818, Recall: 0.738, Detected-Cells: 5826
[37m2024-05-16 12:56:20,232 [INFO] - Caching dataset 1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2 to disk...
[37m2024-05-16 12:56:24,267 [INFO] - Validation epoch stats:   Loss: 1.3368 - F1-Score: 0.6498 - Accuracy-Score: 0.6498 - AUROC: 0.6607 - AP: 0.4346
[37m2024-05-16 12:56:24,281 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:24,502 [INFO] - Epoch: 2/50
[37m2024-05-16 12:56:24,569 [INFO] - Training epoch stats:     Loss: 0.4903 - F1-Score: 0.8637 - Accuracy-Score: 0.8637 - AUROC: 0.8584 - AP: 0.6797
[37m2024-05-16 12:56:24,698 [INFO] - Validation epoch stats:   Loss: 1.4656 - F1-Score: 0.6825 - Accuracy-Score: 0.6825 - AUROC: 0.7197 - AP: 0.5092
[37m2024-05-16 12:56:24,711 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:24,919 [INFO] - Epoch: 3/50
[37m2024-05-16 12:56:24,971 [INFO] - Training epoch stats:     Loss: 0.3229 - F1-Score: 0.9311 - Accuracy-Score: 0.9311 - AUROC: 0.9362 - AP: 0.7742
[37m2024-05-16 12:56:25,090 [INFO] - Validation epoch stats:   Loss: 1.3300 - F1-Score: 0.6107 - Accuracy-Score: 0.6107 - AUROC: 0.7732 - AP: 0.5607
[37m2024-05-16 12:56:25,102 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:25,304 [INFO] - Epoch: 4/50
[37m2024-05-16 12:56:25,355 [INFO] - Training epoch stats:     Loss: 0.2362 - F1-Score: 0.9372 - Accuracy-Score: 0.9372 - AUROC: 0.9594 - AP: 0.8367
[37m2024-05-16 12:56:25,474 [INFO] - Validation epoch stats:   Loss: 0.8970 - F1-Score: 0.6504 - Accuracy-Score: 0.6504 - AUROC: 0.8120 - AP: 0.6097
[37m2024-05-16 12:56:25,486 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:25,680 [INFO] - Epoch: 5/50
[37m2024-05-16 12:56:25,728 [INFO] - Training epoch stats:     Loss: 0.1744 - F1-Score: 0.9495 - Accuracy-Score: 0.9495 - AUROC: 0.9780 - AP: 0.8739
[37m2024-05-16 12:56:25,889 [INFO] - Validation epoch stats:   Loss: 0.6796 - F1-Score: 0.7266 - Accuracy-Score: 0.7266 - AUROC: 0.8231 - AP: 0.6211
[37m2024-05-16 12:56:25,900 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:26,110 [INFO] - Epoch: 6/50
[37m2024-05-16 12:56:26,165 [INFO] - Training epoch stats:     Loss: 0.1656 - F1-Score: 0.9433 - Accuracy-Score: 0.9433 - AUROC: 0.9823 - AP: 0.8822
[37m2024-05-16 12:56:26,320 [INFO] - Validation epoch stats:   Loss: 0.7845 - F1-Score: 0.6718 - Accuracy-Score: 0.6718 - AUROC: 0.8346 - AP: 0.6188
[37m2024-05-16 12:56:26,332 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:26,534 [INFO] - Epoch: 7/50
[37m2024-05-16 12:56:26,588 [INFO] - Training epoch stats:     Loss: 0.1136 - F1-Score: 0.9602 - Accuracy-Score: 0.9602 - AUROC: 0.9913 - AP: 0.9118
[37m2024-05-16 12:56:26,744 [INFO] - Validation epoch stats:   Loss: 0.9623 - F1-Score: 0.6231 - Accuracy-Score: 0.6231 - AUROC: 0.8407 - AP: 0.6187
[37m2024-05-16 12:56:26,756 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:26,963 [INFO] - Epoch: 8/50
[37m2024-05-16 12:56:27,016 [INFO] - Training epoch stats:     Loss: 0.1026 - F1-Score: 0.9648 - Accuracy-Score: 0.9648 - AUROC: 0.9955 - AP: 0.9514
[37m2024-05-16 12:56:27,137 [INFO] - Validation epoch stats:   Loss: 0.9550 - F1-Score: 0.6445 - Accuracy-Score: 0.6445 - AUROC: 0.8412 - AP: 0.6200
[37m2024-05-16 12:56:27,148 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:27,347 [INFO] - Epoch: 9/50
[37m2024-05-16 12:56:27,395 [INFO] - Training epoch stats:     Loss: 0.0807 - F1-Score: 0.9740 - Accuracy-Score: 0.9740 - AUROC: 0.9972 - AP: 0.9694
[37m2024-05-16 12:56:27,510 [INFO] - Validation epoch stats:   Loss: 0.8631 - F1-Score: 0.6892 - Accuracy-Score: 0.6892 - AUROC: 0.8434 - AP: 0.6228
[37m2024-05-16 12:56:27,522 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:27,719 [INFO] - Epoch: 10/50
[37m2024-05-16 12:56:27,766 [INFO] - Training epoch stats:     Loss: 0.0700 - F1-Score: 0.9786 - Accuracy-Score: 0.9786 - AUROC: 0.9987 - AP: 0.9819
[37m2024-05-16 12:56:27,880 [INFO] - Validation epoch stats:   Loss: 0.8510 - F1-Score: 0.6876 - Accuracy-Score: 0.6876 - AUROC: 0.8548 - AP: 0.6272
[37m2024-05-16 12:56:27,892 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:28,092 [INFO] - Epoch: 11/50
[37m2024-05-16 12:56:28,138 [INFO] - Training epoch stats:     Loss: 0.0518 - F1-Score: 0.9847 - Accuracy-Score: 0.9847 - AUROC: 0.9992 - AP: 0.9861
[37m2024-05-16 12:56:28,251 [INFO] - Validation epoch stats:   Loss: 0.9057 - F1-Score: 0.6742 - Accuracy-Score: 0.6742 - AUROC: 0.8594 - AP: 0.6256
[37m2024-05-16 12:56:28,263 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:28,466 [INFO] - Epoch: 12/50
[37m2024-05-16 12:56:28,514 [INFO] - Training epoch stats:     Loss: 0.0445 - F1-Score: 0.9847 - Accuracy-Score: 0.9847 - AUROC: 0.9996 - AP: 0.9918
[37m2024-05-16 12:56:28,629 [INFO] - Validation epoch stats:   Loss: 0.8996 - F1-Score: 0.7019 - Accuracy-Score: 0.7019 - AUROC: 0.8580 - AP: 0.6275
[37m2024-05-16 12:56:28,702 [INFO] - Epoch: 13/50
[37m2024-05-16 12:56:28,749 [INFO] - Training epoch stats:     Loss: 0.0340 - F1-Score: 0.9923 - Accuracy-Score: 0.9923 - AUROC: 0.9999 - AP: 0.9991
[37m2024-05-16 12:56:28,859 [INFO] - Validation epoch stats:   Loss: 0.8912 - F1-Score: 0.7135 - Accuracy-Score: 0.7135 - AUROC: 0.8595 - AP: 0.6289
[37m2024-05-16 12:56:28,871 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:29,073 [INFO] - Epoch: 14/50
[37m2024-05-16 12:56:29,117 [INFO] - Training epoch stats:     Loss: 0.0304 - F1-Score: 0.9877 - Accuracy-Score: 0.9877 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:29,231 [INFO] - Validation epoch stats:   Loss: 0.9002 - F1-Score: 0.7055 - Accuracy-Score: 0.7055 - AUROC: 0.8660 - AP: 0.6308
[37m2024-05-16 12:56:29,242 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:29,443 [INFO] - Epoch: 15/50
[37m2024-05-16 12:56:29,493 [INFO] - Training epoch stats:     Loss: 0.0221 - F1-Score: 0.9969 - Accuracy-Score: 0.9969 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:29,609 [INFO] - Validation epoch stats:   Loss: 0.9193 - F1-Score: 0.7085 - Accuracy-Score: 0.7085 - AUROC: 0.8676 - AP: 0.6316
[37m2024-05-16 12:56:29,621 [INFO] - New best model - save checkpoint
[37m2024-05-16 12:56:29,811 [INFO] - Epoch: 16/50
[37m2024-05-16 12:56:29,861 [INFO] - Training epoch stats:     Loss: 0.0175 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:29,979 [INFO] - Validation epoch stats:   Loss: 0.9609 - F1-Score: 0.7034 - Accuracy-Score: 0.7034 - AUROC: 0.8670 - AP: 0.6284
[37m2024-05-16 12:56:30,050 [INFO] - Epoch: 17/50
[37m2024-05-16 12:56:30,094 [INFO] - Training epoch stats:     Loss: 0.0160 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:30,205 [INFO] - Validation epoch stats:   Loss: 0.9968 - F1-Score: 0.7008 - Accuracy-Score: 0.7008 - AUROC: 0.8641 - AP: 0.6264
[37m2024-05-16 12:56:30,268 [INFO] - Epoch: 18/50
[37m2024-05-16 12:56:30,313 [INFO] - Training epoch stats:     Loss: 0.0117 - F1-Score: 1.0000 - Accuracy-Score: 1.0000 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:30,629 [INFO] - Validation epoch stats:   Loss: 1.0518 - F1-Score: 0.6976 - Accuracy-Score: 0.6976 - AUROC: 0.8605 - AP: 0.6231
[37m2024-05-16 12:56:30,702 [INFO] - Epoch: 19/50
[37m2024-05-16 12:56:30,746 [INFO] - Training epoch stats:     Loss: 0.0130 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:30,854 [INFO] - Validation epoch stats:   Loss: 1.0241 - F1-Score: 0.7120 - Accuracy-Score: 0.7120 - AUROC: 0.8578 - AP: 0.6237
[37m2024-05-16 12:56:30,919 [INFO] - Epoch: 20/50
[37m2024-05-16 12:56:30,965 [INFO] - Training epoch stats:     Loss: 0.0124 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:31,071 [INFO] - Validation epoch stats:   Loss: 1.0636 - F1-Score: 0.7051 - Accuracy-Score: 0.7051 - AUROC: 0.8612 - AP: 0.6249
[37m2024-05-16 12:56:31,134 [INFO] - Epoch: 21/50
[37m2024-05-16 12:56:31,179 [INFO] - Training epoch stats:     Loss: 0.0094 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:31,288 [INFO] - Validation epoch stats:   Loss: 1.0577 - F1-Score: 0.7091 - Accuracy-Score: 0.7091 - AUROC: 0.8623 - AP: 0.6248
[37m2024-05-16 12:56:31,367 [INFO] - Epoch: 22/50
[37m2024-05-16 12:56:31,409 [INFO] - Training epoch stats:     Loss: 0.0121 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:31,518 [INFO] - Validation epoch stats:   Loss: 1.1749 - F1-Score: 0.6910 - Accuracy-Score: 0.6910 - AUROC: 0.8647 - AP: 0.6243
[37m2024-05-16 12:56:31,582 [INFO] - Epoch: 23/50
[37m2024-05-16 12:56:31,628 [INFO] - Training epoch stats:     Loss: 0.0062 - F1-Score: 1.0000 - Accuracy-Score: 1.0000 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:31,737 [INFO] - Validation epoch stats:   Loss: 1.1487 - F1-Score: 0.6931 - Accuracy-Score: 0.6931 - AUROC: 0.8649 - AP: 0.6236
[37m2024-05-16 12:56:31,803 [INFO] - Epoch: 24/50
[37m2024-05-16 12:56:31,849 [INFO] - Training epoch stats:     Loss: 0.0117 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:31,956 [INFO] - Validation epoch stats:   Loss: 1.0100 - F1-Score: 0.7278 - Accuracy-Score: 0.7278 - AUROC: 0.8631 - AP: 0.6280
[37m2024-05-16 12:56:32,031 [INFO] - Epoch: 25/50
[37m2024-05-16 12:56:32,075 [INFO] - Training epoch stats:     Loss: 0.0103 - F1-Score: 0.9969 - Accuracy-Score: 0.9969 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:32,184 [INFO] - Validation epoch stats:   Loss: 1.0153 - F1-Score: 0.7288 - Accuracy-Score: 0.7288 - AUROC: 0.8629 - AP: 0.6283
[37m2024-05-16 12:56:32,255 [INFO] - Epoch: 26/50
[37m2024-05-16 12:56:32,301 [INFO] - Training epoch stats:     Loss: 0.0064 - F1-Score: 0.9969 - Accuracy-Score: 0.9969 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:32,408 [INFO] - Validation epoch stats:   Loss: 1.0349 - F1-Score: 0.7254 - Accuracy-Score: 0.7254 - AUROC: 0.8636 - AP: 0.6268
[37m2024-05-16 12:56:32,480 [INFO] - Epoch: 27/50
[37m2024-05-16 12:56:32,524 [INFO] - Training epoch stats:     Loss: 0.0063 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:32,632 [INFO] - Validation epoch stats:   Loss: 1.0603 - F1-Score: 0.7200 - Accuracy-Score: 0.7200 - AUROC: 0.8642 - AP: 0.6266
[37m2024-05-16 12:56:32,701 [INFO] - Epoch: 28/50
[37m2024-05-16 12:56:32,745 [INFO] - Training epoch stats:     Loss: 0.0051 - F1-Score: 1.0000 - Accuracy-Score: 1.0000 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:32,858 [INFO] - Validation epoch stats:   Loss: 1.0836 - F1-Score: 0.7161 - Accuracy-Score: 0.7161 - AUROC: 0.8649 - AP: 0.6268
[37m2024-05-16 12:56:32,930 [INFO] - Epoch: 29/50
[37m2024-05-16 12:56:32,976 [INFO] - Training epoch stats:     Loss: 0.0070 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:33,088 [INFO] - Validation epoch stats:   Loss: 1.0991 - F1-Score: 0.7130 - Accuracy-Score: 0.7130 - AUROC: 0.8655 - AP: 0.6270
[37m2024-05-16 12:56:33,154 [INFO] - Epoch: 30/50
[37m2024-05-16 12:56:33,199 [INFO] - Training epoch stats:     Loss: 0.0080 - F1-Score: 0.9969 - Accuracy-Score: 0.9969 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:33,308 [INFO] - Validation epoch stats:   Loss: 1.1107 - F1-Score: 0.7122 - Accuracy-Score: 0.7122 - AUROC: 0.8654 - AP: 0.6269
[37m2024-05-16 12:56:33,382 [INFO] - Epoch: 31/50
[37m2024-05-16 12:56:33,427 [INFO] - Training epoch stats:     Loss: 0.0052 - F1-Score: 1.0000 - Accuracy-Score: 1.0000 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:33,538 [INFO] - Validation epoch stats:   Loss: 1.1106 - F1-Score: 0.7115 - Accuracy-Score: 0.7115 - AUROC: 0.8651 - AP: 0.6265
[37m2024-05-16 12:56:33,603 [INFO] - Epoch: 32/50
[37m2024-05-16 12:56:33,649 [INFO] - Training epoch stats:     Loss: 0.0050 - F1-Score: 0.9969 - Accuracy-Score: 0.9969 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:33,763 [INFO] - Validation epoch stats:   Loss: 1.1102 - F1-Score: 0.7123 - Accuracy-Score: 0.7123 - AUROC: 0.8646 - AP: 0.6261
[37m2024-05-16 12:56:33,830 [INFO] - Epoch: 33/50
[37m2024-05-16 12:56:33,876 [INFO] - Training epoch stats:     Loss: 0.0048 - F1-Score: 0.9969 - Accuracy-Score: 0.9969 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:33,984 [INFO] - Validation epoch stats:   Loss: 1.1134 - F1-Score: 0.7123 - Accuracy-Score: 0.7123 - AUROC: 0.8640 - AP: 0.6260
[37m2024-05-16 12:56:34,058 [INFO] - Epoch: 34/50
[37m2024-05-16 12:56:34,103 [INFO] - Training epoch stats:     Loss: 0.0054 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:34,212 [INFO] - Validation epoch stats:   Loss: 1.1209 - F1-Score: 0.7128 - Accuracy-Score: 0.7128 - AUROC: 0.8638 - AP: 0.6259
[37m2024-05-16 12:56:34,287 [INFO] - Epoch: 35/50
[37m2024-05-16 12:56:34,331 [INFO] - Training epoch stats:     Loss: 0.0052 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 12:56:34,439 [INFO] - Validation epoch stats:   Loss: 1.1380 - F1-Score: 0.7101 - Accuracy-Score: 0.7101 - AUROC: 0.8642 - AP: 0.6259
[37m2024-05-16 12:56:34,450 [INFO] - Performing early stopping!
[37m2024-05-16 12:56:34,462 [INFO] - Finished run rikzioz7
