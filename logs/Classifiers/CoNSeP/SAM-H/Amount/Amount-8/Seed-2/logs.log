[37m2024-06-28 06:23:14,363 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 06:23:14,365 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-06-28T062230_Amount-8-Seed-2
[37m2024-06-28 06:23:14,570 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f2f4bf7c5e0>]
[37m2024-06-28 06:23:14,571 [INFO] - Using GPU: cuda:0
[37m2024-06-28 06:23:14,655 [INFO] - Using device: cuda:0
[37m2024-06-28 06:23:14,665 [INFO] - Loss function:
[37m2024-06-28 06:23:14,757 [INFO] - CrossEntropyLoss()
[37m2024-06-28 06:24:27,678 [INFO] - <All keys matched successfully>
[37m2024-06-28 06:24:30,953 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 06:24:30,955 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 06:24:30,958 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 06:24:30,963 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 06:24:30,976 [INFO] - Caching datasets
[37m2024-06-28 06:24:31,967 [INFO] - Instantiate Trainer
[37m2024-06-28 06:24:31,972 [INFO] - Calling Trainer Fit
[37m2024-06-28 06:24:31,977 [INFO] - Dataset is cached after first epoch
[37m2024-06-28 06:24:31,986 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 06:24:31,992 [INFO] - Epoch: 1/50
[37m2024-06-28 06:24:31,998 [INFO] - Extracting training cells
[37m2024-06-28 06:24:42,884 [INFO] - Extraction detection metrics - F1: 0.785, Precision: 0.844, Recall: 0.754, Detected-Cells: 3827
[37m2024-06-28 06:24:42,886 [INFO] - Caching dataset 1325164cab005ae26d0c24b56c05f0caedfb200d324af36dac545831e010d206 to disk...
[37m2024-06-28 06:24:46,563 [INFO] - Training epoch stats:     Loss: 0.5553 - F1-Score: 0.7933 - Accuracy-Score: 0.7933 - AUROC: 0.8969 - AP: 0.7028
[37m2024-06-28 06:24:47,954 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 06:24:48,100 [INFO] - Validation epoch stats:   Loss: 0.4289 - F1-Score: 0.8478 - Accuracy-Score: 0.8478 - AUROC: 0.9444 - AP: 0.8233
[37m2024-06-28 06:24:48,101 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:24:48,249 [INFO] - Epoch: 2/50
[37m2024-06-28 06:24:48,443 [INFO] - Training epoch stats:     Loss: 0.2428 - F1-Score: 0.9130 - Accuracy-Score: 0.9130 - AUROC: 0.9774 - AP: 0.8959
[37m2024-06-28 06:24:48,602 [INFO] - Validation epoch stats:   Loss: 0.3988 - F1-Score: 0.8539 - Accuracy-Score: 0.8539 - AUROC: 0.9486 - AP: 0.8332
[37m2024-06-28 06:24:48,603 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:24:48,757 [INFO] - Epoch: 3/50
[37m2024-06-28 06:24:48,929 [INFO] - Training epoch stats:     Loss: 0.1723 - F1-Score: 0.9383 - Accuracy-Score: 0.9383 - AUROC: 0.9901 - AP: 0.9485
[37m2024-06-28 06:24:49,073 [INFO] - Validation epoch stats:   Loss: 0.3711 - F1-Score: 0.8637 - Accuracy-Score: 0.8637 - AUROC: 0.9511 - AP: 0.8346
[37m2024-06-28 06:24:49,074 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:24:49,233 [INFO] - Epoch: 4/50
[37m2024-06-28 06:24:49,407 [INFO] - Training epoch stats:     Loss: 0.1297 - F1-Score: 0.9517 - Accuracy-Score: 0.9517 - AUROC: 0.9947 - AP: 0.9710
[37m2024-06-28 06:24:49,551 [INFO] - Validation epoch stats:   Loss: 0.3900 - F1-Score: 0.8646 - Accuracy-Score: 0.8646 - AUROC: 0.9455 - AP: 0.8301
[37m2024-06-28 06:24:49,610 [INFO] - Epoch: 5/50
[37m2024-06-28 06:24:49,798 [INFO] - Training epoch stats:     Loss: 0.0992 - F1-Score: 0.9676 - Accuracy-Score: 0.9676 - AUROC: 0.9972 - AP: 0.9857
[37m2024-06-28 06:24:49,960 [INFO] - Validation epoch stats:   Loss: 0.4094 - F1-Score: 0.8613 - Accuracy-Score: 0.8613 - AUROC: 0.9458 - AP: 0.8313
[37m2024-06-28 06:24:49,999 [INFO] - Epoch: 6/50
[37m2024-06-28 06:24:50,183 [INFO] - Training epoch stats:     Loss: 0.0797 - F1-Score: 0.9707 - Accuracy-Score: 0.9707 - AUROC: 0.9983 - AP: 0.9900
[37m2024-06-28 06:24:50,360 [INFO] - Validation epoch stats:   Loss: 0.3996 - F1-Score: 0.8635 - Accuracy-Score: 0.8635 - AUROC: 0.9465 - AP: 0.8297
[37m2024-06-28 06:24:50,427 [INFO] - Epoch: 7/50
[37m2024-06-28 06:24:50,612 [INFO] - Training epoch stats:     Loss: 0.0614 - F1-Score: 0.9804 - Accuracy-Score: 0.9804 - AUROC: 0.9992 - AP: 0.9954
[37m2024-06-28 06:24:50,770 [INFO] - Validation epoch stats:   Loss: 0.4221 - F1-Score: 0.8647 - Accuracy-Score: 0.8647 - AUROC: 0.9465 - AP: 0.8300
[37m2024-06-28 06:24:50,826 [INFO] - Epoch: 8/50
[37m2024-06-28 06:24:51,005 [INFO] - Training epoch stats:     Loss: 0.0485 - F1-Score: 0.9869 - Accuracy-Score: 0.9869 - AUROC: 0.9995 - AP: 0.9971
[37m2024-06-28 06:24:51,509 [INFO] - Validation epoch stats:   Loss: 0.4799 - F1-Score: 0.8469 - Accuracy-Score: 0.8469 - AUROC: 0.9384 - AP: 0.8237
[37m2024-06-28 06:24:51,573 [INFO] - Epoch: 9/50
[37m2024-06-28 06:24:51,750 [INFO] - Training epoch stats:     Loss: 0.0356 - F1-Score: 0.9929 - Accuracy-Score: 0.9929 - AUROC: 0.9998 - AP: 0.9991
[37m2024-06-28 06:24:52,019 [INFO] - Validation epoch stats:   Loss: 0.4846 - F1-Score: 0.8546 - Accuracy-Score: 0.8546 - AUROC: 0.9410 - AP: 0.8222
[37m2024-06-28 06:24:52,076 [INFO] - Epoch: 10/50
[37m2024-06-28 06:24:52,249 [INFO] - Training epoch stats:     Loss: 0.0330 - F1-Score: 0.9935 - Accuracy-Score: 0.9935 - AUROC: 0.9998 - AP: 0.9993
[37m2024-06-28 06:24:52,392 [INFO] - Validation epoch stats:   Loss: 0.5203 - F1-Score: 0.8526 - Accuracy-Score: 0.8526 - AUROC: 0.9401 - AP: 0.8208
[37m2024-06-28 06:24:52,445 [INFO] - Epoch: 11/50
[37m2024-06-28 06:24:52,614 [INFO] - Training epoch stats:     Loss: 0.0247 - F1-Score: 0.9945 - Accuracy-Score: 0.9945 - AUROC: 0.9999 - AP: 0.9997
[37m2024-06-28 06:24:52,864 [INFO] - Validation epoch stats:   Loss: 0.5182 - F1-Score: 0.8606 - Accuracy-Score: 0.8606 - AUROC: 0.9372 - AP: 0.8254
[37m2024-06-28 06:24:52,920 [INFO] - Epoch: 12/50
[37m2024-06-28 06:24:53,089 [INFO] - Training epoch stats:     Loss: 0.0190 - F1-Score: 0.9961 - Accuracy-Score: 0.9961 - AUROC: 1.0000 - AP: 0.9998
[37m2024-06-28 06:24:53,228 [INFO] - Validation epoch stats:   Loss: 0.5227 - F1-Score: 0.8623 - Accuracy-Score: 0.8623 - AUROC: 0.9423 - AP: 0.8227
[37m2024-06-28 06:24:53,285 [INFO] - Epoch: 13/50
[37m2024-06-28 06:24:53,452 [INFO] - Training epoch stats:     Loss: 0.0159 - F1-Score: 0.9979 - Accuracy-Score: 0.9979 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:24:53,592 [INFO] - Validation epoch stats:   Loss: 0.5583 - F1-Score: 0.8555 - Accuracy-Score: 0.8555 - AUROC: 0.9386 - AP: 0.8174
[37m2024-06-28 06:24:53,647 [INFO] - Epoch: 14/50
[37m2024-06-28 06:24:53,817 [INFO] - Training epoch stats:     Loss: 0.0128 - F1-Score: 0.9987 - Accuracy-Score: 0.9987 - AUROC: 1.0000 - AP: 0.9998
[37m2024-06-28 06:24:53,956 [INFO] - Validation epoch stats:   Loss: 0.5939 - F1-Score: 0.8605 - Accuracy-Score: 0.8605 - AUROC: 0.9356 - AP: 0.8160
[37m2024-06-28 06:24:54,014 [INFO] - Epoch: 15/50
[37m2024-06-28 06:24:54,187 [INFO] - Training epoch stats:     Loss: 0.0117 - F1-Score: 0.9984 - Accuracy-Score: 0.9984 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:24:54,336 [INFO] - Validation epoch stats:   Loss: 0.5768 - F1-Score: 0.8560 - Accuracy-Score: 0.8560 - AUROC: 0.9372 - AP: 0.8152
[37m2024-06-28 06:24:54,394 [INFO] - Epoch: 16/50
[37m2024-06-28 06:24:54,567 [INFO] - Training epoch stats:     Loss: 0.0109 - F1-Score: 0.9982 - Accuracy-Score: 0.9982 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:24:54,706 [INFO] - Validation epoch stats:   Loss: 0.6535 - F1-Score: 0.8556 - Accuracy-Score: 0.8556 - AUROC: 0.9352 - AP: 0.8133
[37m2024-06-28 06:24:54,772 [INFO] - Epoch: 17/50
[37m2024-06-28 06:24:54,970 [INFO] - Training epoch stats:     Loss: 0.0070 - F1-Score: 0.9992 - Accuracy-Score: 0.9992 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:24:55,115 [INFO] - Validation epoch stats:   Loss: 0.6935 - F1-Score: 0.8526 - Accuracy-Score: 0.8526 - AUROC: 0.9369 - AP: 0.8171
[37m2024-06-28 06:24:55,181 [INFO] - Epoch: 18/50
[37m2024-06-28 06:24:55,324 [INFO] - Training epoch stats:     Loss: 0.0089 - F1-Score: 0.9990 - Accuracy-Score: 0.9990 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:24:55,466 [INFO] - Validation epoch stats:   Loss: 0.7000 - F1-Score: 0.8493 - Accuracy-Score: 0.8493 - AUROC: 0.9378 - AP: 0.8123
[37m2024-06-28 06:24:55,520 [INFO] - Epoch: 19/50
[37m2024-06-28 06:24:55,681 [INFO] - Training epoch stats:     Loss: 0.0085 - F1-Score: 0.9979 - Accuracy-Score: 0.9979 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:24:55,823 [INFO] - Validation epoch stats:   Loss: 0.6702 - F1-Score: 0.8574 - Accuracy-Score: 0.8574 - AUROC: 0.9349 - AP: 0.8110
[37m2024-06-28 06:24:55,879 [INFO] - Epoch: 20/50
[37m2024-06-28 06:24:56,050 [INFO] - Training epoch stats:     Loss: 0.0073 - F1-Score: 0.9987 - Accuracy-Score: 0.9987 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:24:56,192 [INFO] - Validation epoch stats:   Loss: 0.6946 - F1-Score: 0.8539 - Accuracy-Score: 0.8539 - AUROC: 0.9358 - AP: 0.8098
[37m2024-06-28 06:24:56,246 [INFO] - Epoch: 21/50
[37m2024-06-28 06:24:56,380 [INFO] - Training epoch stats:     Loss: 0.0050 - F1-Score: 0.9995 - Accuracy-Score: 0.9995 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:24:56,504 [INFO] - Validation epoch stats:   Loss: 0.7589 - F1-Score: 0.8486 - Accuracy-Score: 0.8486 - AUROC: 0.9338 - AP: 0.8072
[37m2024-06-28 06:24:56,555 [INFO] - Epoch: 22/50
[37m2024-06-28 06:24:56,669 [INFO] - Training epoch stats:     Loss: 0.0053 - F1-Score: 0.9992 - Accuracy-Score: 0.9992 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:24:56,793 [INFO] - Validation epoch stats:   Loss: 0.7556 - F1-Score: 0.8527 - Accuracy-Score: 0.8527 - AUROC: 0.9336 - AP: 0.8086
[37m2024-06-28 06:24:56,849 [INFO] - Epoch: 23/50
[37m2024-06-28 06:24:56,975 [INFO] - Training epoch stats:     Loss: 0.0046 - F1-Score: 0.9987 - Accuracy-Score: 0.9987 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:24:57,106 [INFO] - Validation epoch stats:   Loss: 0.6985 - F1-Score: 0.8623 - Accuracy-Score: 0.8623 - AUROC: 0.9370 - AP: 0.8134
[37m2024-06-28 06:24:57,107 [INFO] - Performing early stopping!
[37m2024-06-28 06:24:57,113 [INFO] - Finished run rwnw0pjd
