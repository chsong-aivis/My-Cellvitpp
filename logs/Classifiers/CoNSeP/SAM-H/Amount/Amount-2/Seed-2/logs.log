[37m2024-06-28 06:09:05,493 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 06:09:05,495 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-06-28T060856_Amount-2-Seed-2
[37m2024-06-28 06:09:05,555 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fe4aedac6d0>]
[37m2024-06-28 06:09:05,556 [INFO] - Using GPU: cuda:0
[37m2024-06-28 06:09:05,560 [INFO] - Using device: cuda:0
[37m2024-06-28 06:09:05,565 [INFO] - Loss function:
[37m2024-06-28 06:09:05,569 [INFO] - CrossEntropyLoss()
[37m2024-06-28 06:09:23,775 [INFO] - <All keys matched successfully>
[37m2024-06-28 06:09:24,838 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 06:09:24,840 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 06:09:24,844 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 06:09:24,849 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 06:09:24,862 [INFO] - Caching datasets
[37m2024-06-28 06:09:25,486 [INFO] - Instantiate Trainer
[37m2024-06-28 06:09:25,490 [INFO] - Calling Trainer Fit
[37m2024-06-28 06:09:25,492 [INFO] - Dataset is cached after first epoch
[37m2024-06-28 06:09:25,497 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 06:09:25,502 [INFO] - Epoch: 1/50
[37m2024-06-28 06:09:25,507 [INFO] - Extracting training cells
[37m2024-06-28 06:09:29,583 [INFO] - Extraction detection metrics - F1: 0.770, Precision: 0.813, Recall: 0.745, Detected-Cells: 1189
[37m2024-06-28 06:09:29,585 [INFO] - Caching dataset 95403c99e2d66df09ddc1f3562cec036042fe4eaecb3e8e3cca0e7c15647bd1f to disk...
[37m2024-06-28 06:09:30,764 [INFO] - Training epoch stats:     Loss: 0.8429 - F1-Score: 0.6611 - Accuracy-Score: 0.6611 - AUROC: 0.7209 - AP: 0.4550
[37m2024-06-28 06:09:32,095 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 06:09:32,237 [INFO] - Validation epoch stats:   Loss: 1.2860 - F1-Score: 0.7060 - Accuracy-Score: 0.7060 - AUROC: 0.8494 - AP: 0.6850
[37m2024-06-28 06:09:32,238 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:09:32,415 [INFO] - Epoch: 2/50
[37m2024-06-28 06:09:32,491 [INFO] - Training epoch stats:     Loss: 0.3245 - F1-Score: 0.9066 - Accuracy-Score: 0.9066 - AUROC: 0.9144 - AP: 0.7318
[37m2024-06-28 06:09:32,641 [INFO] - Validation epoch stats:   Loss: 0.9685 - F1-Score: 0.6674 - Accuracy-Score: 0.6674 - AUROC: 0.8893 - AP: 0.7515
[37m2024-06-28 06:09:32,642 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:09:32,796 [INFO] - Epoch: 3/50
[37m2024-06-28 06:09:32,860 [INFO] - Training epoch stats:     Loss: 0.2130 - F1-Score: 0.9327 - Accuracy-Score: 0.9327 - AUROC: 0.9765 - AP: 0.8359
[37m2024-06-28 06:09:32,994 [INFO] - Validation epoch stats:   Loss: 0.6538 - F1-Score: 0.7297 - Accuracy-Score: 0.7297 - AUROC: 0.9100 - AP: 0.7807
[37m2024-06-28 06:09:32,995 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:09:33,149 [INFO] - Epoch: 4/50
[37m2024-06-28 06:09:33,212 [INFO] - Training epoch stats:     Loss: 0.1654 - F1-Score: 0.9504 - Accuracy-Score: 0.9504 - AUROC: 0.9863 - AP: 0.8757
[37m2024-06-28 06:09:33,346 [INFO] - Validation epoch stats:   Loss: 0.8286 - F1-Score: 0.6789 - Accuracy-Score: 0.6789 - AUROC: 0.9043 - AP: 0.7692
[37m2024-06-28 06:09:33,411 [INFO] - Epoch: 5/50
[37m2024-06-28 06:09:33,474 [INFO] - Training epoch stats:     Loss: 0.1171 - F1-Score: 0.9613 - Accuracy-Score: 0.9613 - AUROC: 0.9946 - AP: 0.9423
[37m2024-06-28 06:09:33,608 [INFO] - Validation epoch stats:   Loss: 0.9185 - F1-Score: 0.6560 - Accuracy-Score: 0.6560 - AUROC: 0.8980 - AP: 0.7622
[37m2024-06-28 06:09:33,662 [INFO] - Epoch: 6/50
[37m2024-06-28 06:09:33,725 [INFO] - Training epoch stats:     Loss: 0.0884 - F1-Score: 0.9697 - Accuracy-Score: 0.9697 - AUROC: 0.9971 - AP: 0.9725
[37m2024-06-28 06:09:33,860 [INFO] - Validation epoch stats:   Loss: 0.7888 - F1-Score: 0.7070 - Accuracy-Score: 0.7070 - AUROC: 0.9036 - AP: 0.7690
[37m2024-06-28 06:09:33,923 [INFO] - Epoch: 7/50
[37m2024-06-28 06:09:33,984 [INFO] - Training epoch stats:     Loss: 0.0635 - F1-Score: 0.9832 - Accuracy-Score: 0.9832 - AUROC: 0.9988 - AP: 0.9875
[37m2024-06-28 06:09:34,117 [INFO] - Validation epoch stats:   Loss: 0.9440 - F1-Score: 0.6756 - Accuracy-Score: 0.6756 - AUROC: 0.8988 - AP: 0.7654
[37m2024-06-28 06:09:34,179 [INFO] - Epoch: 8/50
[37m2024-06-28 06:09:34,245 [INFO] - Training epoch stats:     Loss: 0.0486 - F1-Score: 0.9891 - Accuracy-Score: 0.9891 - AUROC: 0.9990 - AP: 0.9929
[37m2024-06-28 06:09:34,385 [INFO] - Validation epoch stats:   Loss: 0.8506 - F1-Score: 0.7127 - Accuracy-Score: 0.7127 - AUROC: 0.8996 - AP: 0.7646
[37m2024-06-28 06:09:34,443 [INFO] - Epoch: 9/50
[37m2024-06-28 06:09:34,505 [INFO] - Training epoch stats:     Loss: 0.0409 - F1-Score: 0.9891 - Accuracy-Score: 0.9891 - AUROC: 0.9995 - AP: 0.9923
[37m2024-06-28 06:09:34,644 [INFO] - Validation epoch stats:   Loss: 1.0119 - F1-Score: 0.6862 - Accuracy-Score: 0.6862 - AUROC: 0.8997 - AP: 0.7654
[37m2024-06-28 06:09:34,700 [INFO] - Epoch: 10/50
[37m2024-06-28 06:09:34,765 [INFO] - Training epoch stats:     Loss: 0.0292 - F1-Score: 0.9958 - Accuracy-Score: 0.9958 - AUROC: 0.9998 - AP: 0.9983
[37m2024-06-28 06:09:34,904 [INFO] - Validation epoch stats:   Loss: 0.9169 - F1-Score: 0.7097 - Accuracy-Score: 0.7097 - AUROC: 0.9031 - AP: 0.7702
[37m2024-06-28 06:09:34,967 [INFO] - Epoch: 11/50
[37m2024-06-28 06:09:35,029 [INFO] - Training epoch stats:     Loss: 0.0245 - F1-Score: 0.9966 - Accuracy-Score: 0.9966 - AUROC: 0.9999 - AP: 0.9989
[37m2024-06-28 06:09:35,171 [INFO] - Validation epoch stats:   Loss: 0.9296 - F1-Score: 0.7273 - Accuracy-Score: 0.7273 - AUROC: 0.9046 - AP: 0.7696
[37m2024-06-28 06:09:35,230 [INFO] - Epoch: 12/50
[37m2024-06-28 06:09:35,293 [INFO] - Training epoch stats:     Loss: 0.0182 - F1-Score: 0.9975 - Accuracy-Score: 0.9975 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:35,431 [INFO] - Validation epoch stats:   Loss: 1.1754 - F1-Score: 0.6711 - Accuracy-Score: 0.6711 - AUROC: 0.9000 - AP: 0.7654
[37m2024-06-28 06:09:35,490 [INFO] - Epoch: 13/50
[37m2024-06-28 06:09:35,554 [INFO] - Training epoch stats:     Loss: 0.0149 - F1-Score: 0.9992 - Accuracy-Score: 0.9992 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:35,692 [INFO] - Validation epoch stats:   Loss: 1.0085 - F1-Score: 0.7231 - Accuracy-Score: 0.7231 - AUROC: 0.9012 - AP: 0.7616
[37m2024-06-28 06:09:35,749 [INFO] - Epoch: 14/50
[37m2024-06-28 06:09:35,811 [INFO] - Training epoch stats:     Loss: 0.0106 - F1-Score: 0.9992 - Accuracy-Score: 0.9992 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:35,949 [INFO] - Validation epoch stats:   Loss: 1.1668 - F1-Score: 0.6921 - Accuracy-Score: 0.6921 - AUROC: 0.8974 - AP: 0.7593
[37m2024-06-28 06:09:36,012 [INFO] - Epoch: 15/50
[37m2024-06-28 06:09:36,074 [INFO] - Training epoch stats:     Loss: 0.0135 - F1-Score: 0.9992 - Accuracy-Score: 0.9992 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:36,212 [INFO] - Validation epoch stats:   Loss: 1.0830 - F1-Score: 0.7255 - Accuracy-Score: 0.7255 - AUROC: 0.8979 - AP: 0.7563
[37m2024-06-28 06:09:36,266 [INFO] - Epoch: 16/50
[37m2024-06-28 06:09:36,328 [INFO] - Training epoch stats:     Loss: 0.0098 - F1-Score: 0.9975 - Accuracy-Score: 0.9975 - AUROC: 1.0000 - AP: 0.9997
[37m2024-06-28 06:09:36,492 [INFO] - Validation epoch stats:   Loss: 1.3508 - F1-Score: 0.6943 - Accuracy-Score: 0.6943 - AUROC: 0.9024 - AP: 0.7626
[37m2024-06-28 06:09:36,551 [INFO] - Epoch: 17/50
[37m2024-06-28 06:09:36,615 [INFO] - Training epoch stats:     Loss: 0.0077 - F1-Score: 0.9983 - Accuracy-Score: 0.9983 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:37,105 [INFO] - Validation epoch stats:   Loss: 0.9349 - F1-Score: 0.7326 - Accuracy-Score: 0.7326 - AUROC: 0.9031 - AP: 0.7661
[37m2024-06-28 06:09:37,166 [INFO] - Epoch: 18/50
[37m2024-06-28 06:09:37,229 [INFO] - Training epoch stats:     Loss: 0.0093 - F1-Score: 0.9966 - Accuracy-Score: 0.9966 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:37,371 [INFO] - Validation epoch stats:   Loss: 1.2506 - F1-Score: 0.7168 - Accuracy-Score: 0.7168 - AUROC: 0.9059 - AP: 0.7666
[37m2024-06-28 06:09:37,424 [INFO] - Epoch: 19/50
[37m2024-06-28 06:09:37,490 [INFO] - Training epoch stats:     Loss: 0.0051 - F1-Score: 0.9992 - Accuracy-Score: 0.9992 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:37,628 [INFO] - Validation epoch stats:   Loss: 1.1011 - F1-Score: 0.7322 - Accuracy-Score: 0.7322 - AUROC: 0.9032 - AP: 0.7575
[37m2024-06-28 06:09:37,687 [INFO] - Epoch: 20/50
[37m2024-06-28 06:09:37,748 [INFO] - Training epoch stats:     Loss: 0.0068 - F1-Score: 0.9983 - Accuracy-Score: 0.9983 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:37,890 [INFO] - Validation epoch stats:   Loss: 1.3146 - F1-Score: 0.7209 - Accuracy-Score: 0.7209 - AUROC: 0.9067 - AP: 0.7654
[37m2024-06-28 06:09:37,939 [INFO] - Epoch: 21/50
[37m2024-06-28 06:09:37,999 [INFO] - Training epoch stats:     Loss: 0.0054 - F1-Score: 0.9992 - Accuracy-Score: 0.9992 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:38,132 [INFO] - Validation epoch stats:   Loss: 1.1728 - F1-Score: 0.7238 - Accuracy-Score: 0.7238 - AUROC: 0.9038 - AP: 0.7594
[37m2024-06-28 06:09:38,182 [INFO] - Epoch: 22/50
[37m2024-06-28 06:09:38,242 [INFO] - Training epoch stats:     Loss: 0.0054 - F1-Score: 0.9983 - Accuracy-Score: 0.9983 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:38,373 [INFO] - Validation epoch stats:   Loss: 0.9892 - F1-Score: 0.7485 - Accuracy-Score: 0.7485 - AUROC: 0.9089 - AP: 0.7726
[37m2024-06-28 06:09:38,428 [INFO] - Epoch: 23/50
[37m2024-06-28 06:09:38,489 [INFO] - Training epoch stats:     Loss: 0.0039 - F1-Score: 0.9983 - Accuracy-Score: 0.9983 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:09:38,622 [INFO] - Validation epoch stats:   Loss: 1.2614 - F1-Score: 0.7255 - Accuracy-Score: 0.7255 - AUROC: 0.9042 - AP: 0.7558
[37m2024-06-28 06:09:38,623 [INFO] - Performing early stopping!
[37m2024-06-28 06:09:38,628 [INFO] - Finished run a8zf4wev
