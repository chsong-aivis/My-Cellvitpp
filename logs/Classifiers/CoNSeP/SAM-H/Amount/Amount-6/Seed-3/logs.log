[37m2024-06-28 06:27:29,615 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 06:27:29,616 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-06-28T062721_Amount-6-Seed-3
[37m2024-06-28 06:27:29,689 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fa2e89a06a0>]
[37m2024-06-28 06:27:29,698 [INFO] - Using GPU: cuda:0
[37m2024-06-28 06:27:29,704 [INFO] - Using device: cuda:0
[37m2024-06-28 06:27:29,713 [INFO] - Loss function:
[37m2024-06-28 06:27:29,721 [INFO] - CrossEntropyLoss()
[37m2024-06-28 06:29:35,769 [INFO] - <All keys matched successfully>
[37m2024-06-28 06:29:40,325 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 06:29:40,328 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 06:29:40,332 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 06:29:40,337 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 06:29:40,353 [INFO] - Caching datasets
[37m2024-06-28 06:29:41,183 [INFO] - Instantiate Trainer
[37m2024-06-28 06:29:41,188 [INFO] - Calling Trainer Fit
[37m2024-06-28 06:29:41,189 [INFO] - Dataset is cached after first epoch
[37m2024-06-28 06:29:41,194 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 06:29:41,199 [INFO] - Epoch: 1/50
[37m2024-06-28 06:29:42,327 [INFO] - Loaded dataset from cache: /Consep/cache/d12cc227790daf8a5c97b45d80a5ac7ad91f279a6ba9d6905b48569a632bc2c2.h5
[37m2024-06-28 06:29:42,819 [INFO] - Training epoch stats:     Loss: 0.5983 - F1-Score: 0.7827 - Accuracy-Score: 0.7827 - AUROC: 0.8952 - AP: 0.6975
[37m2024-06-28 06:29:44,313 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 06:29:44,655 [INFO] - Validation epoch stats:   Loss: 0.4605 - F1-Score: 0.8431 - Accuracy-Score: 0.8431 - AUROC: 0.9356 - AP: 0.8152
[37m2024-06-28 06:29:44,658 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:29:44,998 [INFO] - Epoch: 2/50
[37m2024-06-28 06:29:45,134 [INFO] - Training epoch stats:     Loss: 0.2755 - F1-Score: 0.9059 - Accuracy-Score: 0.9059 - AUROC: 0.9726 - AP: 0.9103
[37m2024-06-28 06:29:45,379 [INFO] - Validation epoch stats:   Loss: 0.4613 - F1-Score: 0.8433 - Accuracy-Score: 0.8433 - AUROC: 0.9387 - AP: 0.8234
[37m2024-06-28 06:29:45,381 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:29:45,621 [INFO] - Epoch: 3/50
[37m2024-06-28 06:29:45,742 [INFO] - Training epoch stats:     Loss: 0.1963 - F1-Score: 0.9266 - Accuracy-Score: 0.9266 - AUROC: 0.9869 - AP: 0.9506
[37m2024-06-28 06:29:45,890 [INFO] - Validation epoch stats:   Loss: 0.4264 - F1-Score: 0.8459 - Accuracy-Score: 0.8459 - AUROC: 0.9448 - AP: 0.8307
[37m2024-06-28 06:29:45,891 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:29:46,121 [INFO] - Epoch: 4/50
[37m2024-06-28 06:29:46,255 [INFO] - Training epoch stats:     Loss: 0.1492 - F1-Score: 0.9503 - Accuracy-Score: 0.9503 - AUROC: 0.9932 - AP: 0.9701
[37m2024-06-28 06:29:46,408 [INFO] - Validation epoch stats:   Loss: 0.4675 - F1-Score: 0.8313 - Accuracy-Score: 0.8313 - AUROC: 0.9453 - AP: 0.8331
[37m2024-06-28 06:29:46,409 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:29:46,695 [INFO] - Epoch: 5/50
[37m2024-06-28 06:29:46,858 [INFO] - Training epoch stats:     Loss: 0.1181 - F1-Score: 0.9603 - Accuracy-Score: 0.9603 - AUROC: 0.9950 - AP: 0.9815
[37m2024-06-28 06:29:47,065 [INFO] - Validation epoch stats:   Loss: 0.4610 - F1-Score: 0.8369 - Accuracy-Score: 0.8369 - AUROC: 0.9418 - AP: 0.8300
[37m2024-06-28 06:29:47,122 [INFO] - Epoch: 6/50
[37m2024-06-28 06:29:47,253 [INFO] - Training epoch stats:     Loss: 0.0948 - F1-Score: 0.9699 - Accuracy-Score: 0.9699 - AUROC: 0.9978 - AP: 0.9893
[37m2024-06-28 06:29:47,472 [INFO] - Validation epoch stats:   Loss: 0.4913 - F1-Score: 0.8314 - Accuracy-Score: 0.8314 - AUROC: 0.9421 - AP: 0.8310
[37m2024-06-28 06:29:47,530 [INFO] - Epoch: 7/50
[37m2024-06-28 06:29:47,665 [INFO] - Training epoch stats:     Loss: 0.0754 - F1-Score: 0.9742 - Accuracy-Score: 0.9742 - AUROC: 0.9986 - AP: 0.9937
[37m2024-06-28 06:29:47,812 [INFO] - Validation epoch stats:   Loss: 0.5060 - F1-Score: 0.8287 - Accuracy-Score: 0.8287 - AUROC: 0.9407 - AP: 0.8258
[37m2024-06-28 06:29:47,861 [INFO] - Epoch: 8/50
[37m2024-06-28 06:29:47,998 [INFO] - Training epoch stats:     Loss: 0.0580 - F1-Score: 0.9853 - Accuracy-Score: 0.9853 - AUROC: 0.9995 - AP: 0.9972
[37m2024-06-28 06:29:48,166 [INFO] - Validation epoch stats:   Loss: 0.5297 - F1-Score: 0.8302 - Accuracy-Score: 0.8302 - AUROC: 0.9396 - AP: 0.8262
[37m2024-06-28 06:29:48,225 [INFO] - Epoch: 9/50
[37m2024-06-28 06:29:48,356 [INFO] - Training epoch stats:     Loss: 0.0438 - F1-Score: 0.9900 - Accuracy-Score: 0.9900 - AUROC: 0.9997 - AP: 0.9984
[37m2024-06-28 06:29:48,503 [INFO] - Validation epoch stats:   Loss: 0.5793 - F1-Score: 0.8213 - Accuracy-Score: 0.8213 - AUROC: 0.9368 - AP: 0.8231
[37m2024-06-28 06:29:48,558 [INFO] - Epoch: 10/50
[37m2024-06-28 06:29:48,728 [INFO] - Training epoch stats:     Loss: 0.0355 - F1-Score: 0.9914 - Accuracy-Score: 0.9914 - AUROC: 0.9999 - AP: 0.9995
[37m2024-06-28 06:29:48,875 [INFO] - Validation epoch stats:   Loss: 0.5222 - F1-Score: 0.8428 - Accuracy-Score: 0.8428 - AUROC: 0.9408 - AP: 0.8264
[37m2024-06-28 06:29:48,936 [INFO] - Epoch: 11/50
[37m2024-06-28 06:29:49,402 [INFO] - Training epoch stats:     Loss: 0.0298 - F1-Score: 0.9939 - Accuracy-Score: 0.9939 - AUROC: 0.9999 - AP: 0.9993
[37m2024-06-28 06:29:49,547 [INFO] - Validation epoch stats:   Loss: 0.5738 - F1-Score: 0.8345 - Accuracy-Score: 0.8345 - AUROC: 0.9406 - AP: 0.8233
[37m2024-06-28 06:29:49,604 [INFO] - Epoch: 12/50
[37m2024-06-28 06:29:49,732 [INFO] - Training epoch stats:     Loss: 0.0264 - F1-Score: 0.9936 - Accuracy-Score: 0.9936 - AUROC: 0.9999 - AP: 0.9996
[37m2024-06-28 06:29:49,878 [INFO] - Validation epoch stats:   Loss: 0.5877 - F1-Score: 0.8265 - Accuracy-Score: 0.8265 - AUROC: 0.9388 - AP: 0.8213
[37m2024-06-28 06:29:49,956 [INFO] - Epoch: 13/50
[37m2024-06-28 06:29:50,082 [INFO] - Training epoch stats:     Loss: 0.0213 - F1-Score: 0.9971 - Accuracy-Score: 0.9971 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:29:50,370 [INFO] - Validation epoch stats:   Loss: 0.6305 - F1-Score: 0.8282 - Accuracy-Score: 0.8282 - AUROC: 0.9382 - AP: 0.8232
[37m2024-06-28 06:29:50,421 [INFO] - Epoch: 14/50
[37m2024-06-28 06:29:50,596 [INFO] - Training epoch stats:     Loss: 0.0168 - F1-Score: 0.9986 - Accuracy-Score: 0.9986 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:29:50,765 [INFO] - Validation epoch stats:   Loss: 0.6745 - F1-Score: 0.8198 - Accuracy-Score: 0.8198 - AUROC: 0.9345 - AP: 0.8157
[37m2024-06-28 06:29:50,827 [INFO] - Epoch: 15/50
[37m2024-06-28 06:29:50,974 [INFO] - Training epoch stats:     Loss: 0.0157 - F1-Score: 0.9975 - Accuracy-Score: 0.9975 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:29:51,172 [INFO] - Validation epoch stats:   Loss: 0.6182 - F1-Score: 0.8421 - Accuracy-Score: 0.8421 - AUROC: 0.9377 - AP: 0.8198
[37m2024-06-28 06:29:51,231 [INFO] - Epoch: 16/50
[37m2024-06-28 06:29:51,399 [INFO] - Training epoch stats:     Loss: 0.0162 - F1-Score: 0.9968 - Accuracy-Score: 0.9968 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:29:51,571 [INFO] - Validation epoch stats:   Loss: 0.6509 - F1-Score: 0.8404 - Accuracy-Score: 0.8404 - AUROC: 0.9384 - AP: 0.8203
[37m2024-06-28 06:29:51,628 [INFO] - Epoch: 17/50
[37m2024-06-28 06:29:51,767 [INFO] - Training epoch stats:     Loss: 0.0103 - F1-Score: 0.9982 - Accuracy-Score: 0.9982 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:29:52,462 [INFO] - Validation epoch stats:   Loss: 0.7246 - F1-Score: 0.8210 - Accuracy-Score: 0.8210 - AUROC: 0.9379 - AP: 0.8190
[37m2024-06-28 06:29:52,583 [INFO] - Epoch: 18/50
[37m2024-06-28 06:29:52,716 [INFO] - Training epoch stats:     Loss: 0.0111 - F1-Score: 0.9975 - Accuracy-Score: 0.9975 - AUROC: 0.9999 - AP: 0.9997
[37m2024-06-28 06:29:52,880 [INFO] - Validation epoch stats:   Loss: 0.6559 - F1-Score: 0.8436 - Accuracy-Score: 0.8436 - AUROC: 0.9383 - AP: 0.8193
[37m2024-06-28 06:29:52,939 [INFO] - Epoch: 19/50
[37m2024-06-28 06:29:53,085 [INFO] - Training epoch stats:     Loss: 0.0098 - F1-Score: 0.9986 - Accuracy-Score: 0.9986 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:29:53,368 [INFO] - Validation epoch stats:   Loss: 0.7646 - F1-Score: 0.8251 - Accuracy-Score: 0.8251 - AUROC: 0.9384 - AP: 0.8226
[37m2024-06-28 06:29:53,527 [INFO] - Epoch: 20/50
[37m2024-06-28 06:29:53,659 [INFO] - Training epoch stats:     Loss: 0.0088 - F1-Score: 0.9982 - Accuracy-Score: 0.9982 - AUROC: 0.9999 - AP: 0.9997
[37m2024-06-28 06:29:55,958 [INFO] - Validation epoch stats:   Loss: 0.7291 - F1-Score: 0.8366 - Accuracy-Score: 0.8366 - AUROC: 0.9370 - AP: 0.8198
[37m2024-06-28 06:29:56,329 [INFO] - Epoch: 21/50
[37m2024-06-28 06:29:56,460 [INFO] - Training epoch stats:     Loss: 0.0068 - F1-Score: 0.9989 - Accuracy-Score: 0.9989 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:29:57,860 [INFO] - Validation epoch stats:   Loss: 0.7969 - F1-Score: 0.8244 - Accuracy-Score: 0.8244 - AUROC: 0.9369 - AP: 0.8152
[37m2024-06-28 06:29:58,155 [INFO] - Epoch: 22/50
[37m2024-06-28 06:29:58,384 [INFO] - Training epoch stats:     Loss: 0.0094 - F1-Score: 0.9989 - Accuracy-Score: 0.9989 - AUROC: 0.9999 - AP: 0.9997
[37m2024-06-28 06:29:58,529 [INFO] - Validation epoch stats:   Loss: 0.7709 - F1-Score: 0.8285 - Accuracy-Score: 0.8285 - AUROC: 0.9369 - AP: 0.8151
[37m2024-06-28 06:29:58,587 [INFO] - Epoch: 23/50
[37m2024-06-28 06:29:58,717 [INFO] - Training epoch stats:     Loss: 0.0124 - F1-Score: 0.9982 - Accuracy-Score: 0.9982 - AUROC: 0.9998 - AP: 0.9995
[37m2024-06-28 06:29:58,877 [INFO] - Validation epoch stats:   Loss: 0.8192 - F1-Score: 0.8225 - Accuracy-Score: 0.8225 - AUROC: 0.9341 - AP: 0.8152
[37m2024-06-28 06:29:58,938 [INFO] - Epoch: 24/50
[37m2024-06-28 06:29:59,072 [INFO] - Training epoch stats:     Loss: 0.0062 - F1-Score: 0.9986 - Accuracy-Score: 0.9986 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:29:59,234 [INFO] - Validation epoch stats:   Loss: 0.8849 - F1-Score: 0.8153 - Accuracy-Score: 0.8153 - AUROC: 0.9323 - AP: 0.8110
[37m2024-06-28 06:29:59,235 [INFO] - Performing early stopping!
[37m2024-06-28 06:29:59,239 [INFO] - Finished run zy1jhmm4
