[37m2024-06-28 06:19:03,835 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 06:19:03,837 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-06-28T061854_Amount-3-Seed-3
[37m2024-06-28 06:19:03,902 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7ff9ab9a4640>]
[37m2024-06-28 06:19:03,903 [INFO] - Using GPU: cuda:0
[37m2024-06-28 06:19:03,908 [INFO] - Using device: cuda:0
[37m2024-06-28 06:19:03,913 [INFO] - Loss function:
[37m2024-06-28 06:19:03,918 [INFO] - CrossEntropyLoss()
[37m2024-06-28 06:21:01,759 [INFO] - <All keys matched successfully>
[37m2024-06-28 06:21:12,173 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 06:21:12,260 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 06:21:12,262 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 06:21:12,268 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 06:21:12,368 [INFO] - Caching datasets
[37m2024-06-28 06:21:15,599 [INFO] - Instantiate Trainer
[37m2024-06-28 06:21:15,663 [INFO] - Calling Trainer Fit
[37m2024-06-28 06:21:15,665 [INFO] - Dataset is cached after first epoch
[37m2024-06-28 06:21:15,670 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 06:21:15,755 [INFO] - Epoch: 1/50
[37m2024-06-28 06:21:17,273 [INFO] - Loaded dataset from cache: /Consep/cache/014abd4c94a2ee6df5f9efea9297a32830526b3f89683fb3938effe92ed118eb.h5
[37m2024-06-28 06:21:21,861 [INFO] - Training epoch stats:     Loss: 0.7074 - F1-Score: 0.7264 - Accuracy-Score: 0.7264 - AUROC: 0.8594 - AP: 0.6444
[37m2024-06-28 06:21:32,366 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 06:21:37,659 [INFO] - Validation epoch stats:   Loss: 0.5199 - F1-Score: 0.8263 - Accuracy-Score: 0.8263 - AUROC: 0.9282 - AP: 0.8051
[37m2024-06-28 06:21:37,662 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:21:38,082 [INFO] - Epoch: 2/50
[37m2024-06-28 06:21:38,570 [INFO] - Training epoch stats:     Loss: 0.2758 - F1-Score: 0.9019 - Accuracy-Score: 0.9019 - AUROC: 0.9745 - AP: 0.9204
[37m2024-06-28 06:21:39,275 [INFO] - Validation epoch stats:   Loss: 0.5049 - F1-Score: 0.8294 - Accuracy-Score: 0.8294 - AUROC: 0.9321 - AP: 0.8136
[37m2024-06-28 06:21:39,276 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:21:39,488 [INFO] - Epoch: 3/50
[37m2024-06-28 06:21:39,588 [INFO] - Training epoch stats:     Loss: 0.2083 - F1-Score: 0.9301 - Accuracy-Score: 0.9301 - AUROC: 0.9862 - AP: 0.9486
[37m2024-06-28 06:21:39,731 [INFO] - Validation epoch stats:   Loss: 0.5123 - F1-Score: 0.8182 - Accuracy-Score: 0.8182 - AUROC: 0.9334 - AP: 0.8153
[37m2024-06-28 06:21:39,732 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:21:39,896 [INFO] - Epoch: 4/50
[37m2024-06-28 06:21:39,996 [INFO] - Training epoch stats:     Loss: 0.1518 - F1-Score: 0.9447 - Accuracy-Score: 0.9447 - AUROC: 0.9933 - AP: 0.9722
[37m2024-06-28 06:21:40,137 [INFO] - Validation epoch stats:   Loss: 0.4724 - F1-Score: 0.8326 - Accuracy-Score: 0.8326 - AUROC: 0.9364 - AP: 0.8199
[37m2024-06-28 06:21:40,138 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:21:40,286 [INFO] - Epoch: 5/50
[37m2024-06-28 06:21:40,387 [INFO] - Training epoch stats:     Loss: 0.1199 - F1-Score: 0.9593 - Accuracy-Score: 0.9593 - AUROC: 0.9966 - AP: 0.9843
[37m2024-06-28 06:21:40,527 [INFO] - Validation epoch stats:   Loss: 0.5340 - F1-Score: 0.8060 - Accuracy-Score: 0.8060 - AUROC: 0.9327 - AP: 0.8131
[37m2024-06-28 06:21:40,583 [INFO] - Epoch: 6/50
[37m2024-06-28 06:21:40,680 [INFO] - Training epoch stats:     Loss: 0.0869 - F1-Score: 0.9733 - Accuracy-Score: 0.9733 - AUROC: 0.9984 - AP: 0.9921
[37m2024-06-28 06:21:40,822 [INFO] - Validation epoch stats:   Loss: 0.5809 - F1-Score: 0.7894 - Accuracy-Score: 0.7894 - AUROC: 0.9321 - AP: 0.8127
[37m2024-06-28 06:21:40,882 [INFO] - Epoch: 7/50
[37m2024-06-28 06:21:40,984 [INFO] - Training epoch stats:     Loss: 0.0690 - F1-Score: 0.9799 - Accuracy-Score: 0.9799 - AUROC: 0.9992 - AP: 0.9964
[37m2024-06-28 06:21:41,132 [INFO] - Validation epoch stats:   Loss: 0.6040 - F1-Score: 0.7968 - Accuracy-Score: 0.7968 - AUROC: 0.9330 - AP: 0.8112
[37m2024-06-28 06:21:41,204 [INFO] - Epoch: 8/50
[37m2024-06-28 06:21:41,313 [INFO] - Training epoch stats:     Loss: 0.0535 - F1-Score: 0.9859 - Accuracy-Score: 0.9859 - AUROC: 0.9996 - AP: 0.9982
[37m2024-06-28 06:21:41,568 [INFO] - Validation epoch stats:   Loss: 0.5403 - F1-Score: 0.8235 - Accuracy-Score: 0.8235 - AUROC: 0.9346 - AP: 0.8129
[37m2024-06-28 06:21:41,620 [INFO] - Epoch: 9/50
[37m2024-06-28 06:21:41,719 [INFO] - Training epoch stats:     Loss: 0.0457 - F1-Score: 0.9884 - Accuracy-Score: 0.9884 - AUROC: 0.9996 - AP: 0.9984
[37m2024-06-28 06:21:41,860 [INFO] - Validation epoch stats:   Loss: 0.6914 - F1-Score: 0.7770 - Accuracy-Score: 0.7770 - AUROC: 0.9267 - AP: 0.8013
[37m2024-06-28 06:21:41,931 [INFO] - Epoch: 10/50
[37m2024-06-28 06:21:42,027 [INFO] - Training epoch stats:     Loss: 0.0332 - F1-Score: 0.9930 - Accuracy-Score: 0.9930 - AUROC: 0.9999 - AP: 0.9996
[37m2024-06-28 06:21:42,165 [INFO] - Validation epoch stats:   Loss: 0.6792 - F1-Score: 0.7978 - Accuracy-Score: 0.7978 - AUROC: 0.9329 - AP: 0.8093
[37m2024-06-28 06:21:42,224 [INFO] - Epoch: 11/50
[37m2024-06-28 06:21:42,321 [INFO] - Training epoch stats:     Loss: 0.0251 - F1-Score: 0.9965 - Accuracy-Score: 0.9965 - AUROC: 1.0000 - AP: 0.9998
[37m2024-06-28 06:21:42,461 [INFO] - Validation epoch stats:   Loss: 0.7484 - F1-Score: 0.7877 - Accuracy-Score: 0.7877 - AUROC: 0.9300 - AP: 0.8052
[37m2024-06-28 06:21:42,531 [INFO] - Epoch: 12/50
[37m2024-06-28 06:21:42,635 [INFO] - Training epoch stats:     Loss: 0.0187 - F1-Score: 0.9975 - Accuracy-Score: 0.9975 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:21:42,811 [INFO] - Validation epoch stats:   Loss: 0.7209 - F1-Score: 0.7957 - Accuracy-Score: 0.7957 - AUROC: 0.9310 - AP: 0.8056
[37m2024-06-28 06:21:42,889 [INFO] - Epoch: 13/50
[37m2024-06-28 06:21:43,019 [INFO] - Training epoch stats:     Loss: 0.0175 - F1-Score: 0.9970 - Accuracy-Score: 0.9970 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:21:43,161 [INFO] - Validation epoch stats:   Loss: 0.8145 - F1-Score: 0.7839 - Accuracy-Score: 0.7839 - AUROC: 0.9295 - AP: 0.8016
[37m2024-06-28 06:21:43,231 [INFO] - Epoch: 14/50
[37m2024-06-28 06:21:43,331 [INFO] - Training epoch stats:     Loss: 0.0149 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:21:43,789 [INFO] - Validation epoch stats:   Loss: 0.7998 - F1-Score: 0.7916 - Accuracy-Score: 0.7916 - AUROC: 0.9295 - AP: 0.8023
[37m2024-06-28 06:21:43,872 [INFO] - Epoch: 15/50
[37m2024-06-28 06:21:43,969 [INFO] - Training epoch stats:     Loss: 0.0150 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:21:44,121 [INFO] - Validation epoch stats:   Loss: 0.8512 - F1-Score: 0.7937 - Accuracy-Score: 0.7937 - AUROC: 0.9295 - AP: 0.8045
[37m2024-06-28 06:21:44,222 [INFO] - Epoch: 16/50
[37m2024-06-28 06:21:44,320 [INFO] - Training epoch stats:     Loss: 0.0125 - F1-Score: 0.9980 - Accuracy-Score: 0.9980 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:21:44,458 [INFO] - Validation epoch stats:   Loss: 1.0513 - F1-Score: 0.7607 - Accuracy-Score: 0.7607 - AUROC: 0.9244 - AP: 0.7925
[37m2024-06-28 06:21:44,516 [INFO] - Epoch: 17/50
[37m2024-06-28 06:21:44,653 [INFO] - Training epoch stats:     Loss: 0.0104 - F1-Score: 0.9980 - Accuracy-Score: 0.9980 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:21:44,880 [INFO] - Validation epoch stats:   Loss: 0.8479 - F1-Score: 0.8018 - Accuracy-Score: 0.8018 - AUROC: 0.9293 - AP: 0.8037
[37m2024-06-28 06:21:44,936 [INFO] - Epoch: 18/50
[37m2024-06-28 06:21:45,094 [INFO] - Training epoch stats:     Loss: 0.0106 - F1-Score: 0.9970 - Accuracy-Score: 0.9970 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:21:45,318 [INFO] - Validation epoch stats:   Loss: 0.9393 - F1-Score: 0.7805 - Accuracy-Score: 0.7805 - AUROC: 0.9277 - AP: 0.7942
[37m2024-06-28 06:21:45,382 [INFO] - Epoch: 19/50
[37m2024-06-28 06:21:45,504 [INFO] - Training epoch stats:     Loss: 0.0079 - F1-Score: 0.9980 - Accuracy-Score: 0.9980 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:21:45,670 [INFO] - Validation epoch stats:   Loss: 0.9351 - F1-Score: 0.7927 - Accuracy-Score: 0.7927 - AUROC: 0.9282 - AP: 0.8004
[37m2024-06-28 06:21:45,739 [INFO] - Epoch: 20/50
[37m2024-06-28 06:21:45,913 [INFO] - Training epoch stats:     Loss: 0.0114 - F1-Score: 0.9980 - Accuracy-Score: 0.9980 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:21:46,171 [INFO] - Validation epoch stats:   Loss: 1.2153 - F1-Score: 0.7528 - Accuracy-Score: 0.7528 - AUROC: 0.9208 - AP: 0.7929
[37m2024-06-28 06:21:46,241 [INFO] - Epoch: 21/50
[37m2024-06-28 06:21:46,376 [INFO] - Training epoch stats:     Loss: 0.0063 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:21:46,669 [INFO] - Validation epoch stats:   Loss: 0.9025 - F1-Score: 0.8057 - Accuracy-Score: 0.8057 - AUROC: 0.9307 - AP: 0.8044
[37m2024-06-28 06:21:46,738 [INFO] - Epoch: 22/50
[37m2024-06-28 06:21:46,870 [INFO] - Training epoch stats:     Loss: 0.0077 - F1-Score: 0.9990 - Accuracy-Score: 0.9990 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:21:47,073 [INFO] - Validation epoch stats:   Loss: 1.0747 - F1-Score: 0.7822 - Accuracy-Score: 0.7822 - AUROC: 0.9281 - AP: 0.7926
[37m2024-06-28 06:21:47,134 [INFO] - Epoch: 23/50
[37m2024-06-28 06:21:47,289 [INFO] - Training epoch stats:     Loss: 0.0063 - F1-Score: 0.9990 - Accuracy-Score: 0.9990 - AUROC: 1.0000 - AP: 0.9997
[37m2024-06-28 06:21:47,525 [INFO] - Validation epoch stats:   Loss: 0.9161 - F1-Score: 0.7999 - Accuracy-Score: 0.7999 - AUROC: 0.9296 - AP: 0.8022
[37m2024-06-28 06:21:47,576 [INFO] - Epoch: 24/50
[37m2024-06-28 06:21:47,706 [INFO] - Training epoch stats:     Loss: 0.0062 - F1-Score: 0.9990 - Accuracy-Score: 0.9990 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:21:47,912 [INFO] - Validation epoch stats:   Loss: 0.9297 - F1-Score: 0.8036 - Accuracy-Score: 0.8036 - AUROC: 0.9292 - AP: 0.7963
[37m2024-06-28 06:21:47,913 [INFO] - Performing early stopping!
[37m2024-06-28 06:21:47,918 [INFO] - Finished run 1ust519x
