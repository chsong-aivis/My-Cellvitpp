[37m2024-06-28 06:30:35,148 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 06:30:35,149 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-06-28T063022_Amount-7-Seed-4
[37m2024-06-28 06:30:35,210 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fd56e968610>]
[37m2024-06-28 06:30:35,211 [INFO] - Using GPU: cuda:0
[37m2024-06-28 06:30:35,216 [INFO] - Using device: cuda:0
[37m2024-06-28 06:30:35,221 [INFO] - Loss function:
[37m2024-06-28 06:30:35,225 [INFO] - CrossEntropyLoss()
[37m2024-06-28 06:32:19,255 [INFO] - <All keys matched successfully>
[37m2024-06-28 06:32:21,311 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 06:32:21,313 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 06:32:21,319 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 06:32:21,326 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 06:32:21,368 [INFO] - Caching datasets
[37m2024-06-28 06:32:22,353 [INFO] - Instantiate Trainer
[37m2024-06-28 06:32:22,359 [INFO] - Calling Trainer Fit
[37m2024-06-28 06:32:22,360 [INFO] - Dataset is cached after first epoch
[37m2024-06-28 06:32:22,365 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 06:32:22,370 [INFO] - Epoch: 1/50
[37m2024-06-28 06:32:23,601 [INFO] - Loaded dataset from cache: /Consep/cache/1ec2c61f126530d0775be8cb0e78e21faa755307cc270da81d991eff4d52b8e4.h5
[37m2024-06-28 06:32:24,109 [INFO] - Training epoch stats:     Loss: 0.5177 - F1-Score: 0.8091 - Accuracy-Score: 0.8091 - AUROC: 0.9163 - AP: 0.7425
[37m2024-06-28 06:32:25,672 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 06:32:26,669 [INFO] - Validation epoch stats:   Loss: 0.4399 - F1-Score: 0.8520 - Accuracy-Score: 0.8520 - AUROC: 0.9342 - AP: 0.8142
[37m2024-06-28 06:32:26,670 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:32:26,959 [INFO] - Epoch: 2/50
[37m2024-06-28 06:32:27,370 [INFO] - Training epoch stats:     Loss: 0.2320 - F1-Score: 0.9182 - Accuracy-Score: 0.9182 - AUROC: 0.9803 - AP: 0.9183
[37m2024-06-28 06:32:27,662 [INFO] - Validation epoch stats:   Loss: 0.4012 - F1-Score: 0.8586 - Accuracy-Score: 0.8586 - AUROC: 0.9448 - AP: 0.8260
[37m2024-06-28 06:32:27,664 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:32:27,938 [INFO] - Epoch: 3/50
[37m2024-06-28 06:32:28,260 [INFO] - Training epoch stats:     Loss: 0.1718 - F1-Score: 0.9365 - Accuracy-Score: 0.9365 - AUROC: 0.9897 - AP: 0.9540
[37m2024-06-28 06:32:28,655 [INFO] - Validation epoch stats:   Loss: 0.4041 - F1-Score: 0.8579 - Accuracy-Score: 0.8579 - AUROC: 0.9463 - AP: 0.8243
[37m2024-06-28 06:32:28,657 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:32:28,876 [INFO] - Epoch: 4/50
[37m2024-06-28 06:32:29,037 [INFO] - Training epoch stats:     Loss: 0.1222 - F1-Score: 0.9535 - Accuracy-Score: 0.9535 - AUROC: 0.9949 - AP: 0.9759
[37m2024-06-28 06:32:29,271 [INFO] - Validation epoch stats:   Loss: 0.4194 - F1-Score: 0.8536 - Accuracy-Score: 0.8536 - AUROC: 0.9446 - AP: 0.8252
[37m2024-06-28 06:32:29,422 [INFO] - Epoch: 5/50
[37m2024-06-28 06:32:29,585 [INFO] - Training epoch stats:     Loss: 0.0992 - F1-Score: 0.9634 - Accuracy-Score: 0.9634 - AUROC: 0.9973 - AP: 0.9850
[37m2024-06-28 06:32:30,058 [INFO] - Validation epoch stats:   Loss: 0.4240 - F1-Score: 0.8594 - Accuracy-Score: 0.8594 - AUROC: 0.9445 - AP: 0.8258
[37m2024-06-28 06:32:30,157 [INFO] - Epoch: 6/50
[37m2024-06-28 06:32:30,303 [INFO] - Training epoch stats:     Loss: 0.0724 - F1-Score: 0.9777 - Accuracy-Score: 0.9777 - AUROC: 0.9986 - AP: 0.9926
[37m2024-06-28 06:32:30,567 [INFO] - Validation epoch stats:   Loss: 0.4889 - F1-Score: 0.8364 - Accuracy-Score: 0.8364 - AUROC: 0.9406 - AP: 0.8216
[37m2024-06-28 06:32:30,628 [INFO] - Epoch: 7/50
[37m2024-06-28 06:32:30,859 [INFO] - Training epoch stats:     Loss: 0.0547 - F1-Score: 0.9845 - Accuracy-Score: 0.9845 - AUROC: 0.9995 - AP: 0.9973
[37m2024-06-28 06:32:31,370 [INFO] - Validation epoch stats:   Loss: 0.4683 - F1-Score: 0.8550 - Accuracy-Score: 0.8550 - AUROC: 0.9408 - AP: 0.8189
[37m2024-06-28 06:32:31,423 [INFO] - Epoch: 8/50
[37m2024-06-28 06:32:31,615 [INFO] - Training epoch stats:     Loss: 0.0400 - F1-Score: 0.9910 - Accuracy-Score: 0.9910 - AUROC: 0.9997 - AP: 0.9984
[37m2024-06-28 06:32:31,806 [INFO] - Validation epoch stats:   Loss: 0.4869 - F1-Score: 0.8522 - Accuracy-Score: 0.8522 - AUROC: 0.9425 - AP: 0.8216
[37m2024-06-28 06:32:31,864 [INFO] - Epoch: 9/50
[37m2024-06-28 06:32:32,022 [INFO] - Training epoch stats:     Loss: 0.0345 - F1-Score: 0.9913 - Accuracy-Score: 0.9913 - AUROC: 0.9998 - AP: 0.9993
[37m2024-06-28 06:32:38,970 [INFO] - Validation epoch stats:   Loss: 0.4964 - F1-Score: 0.8610 - Accuracy-Score: 0.8610 - AUROC: 0.9424 - AP: 0.8221
[37m2024-06-28 06:32:39,158 [INFO] - Epoch: 10/50
[37m2024-06-28 06:32:39,321 [INFO] - Training epoch stats:     Loss: 0.0322 - F1-Score: 0.9929 - Accuracy-Score: 0.9929 - AUROC: 0.9998 - AP: 0.9992
[37m2024-06-28 06:32:39,557 [INFO] - Validation epoch stats:   Loss: 0.5748 - F1-Score: 0.8397 - Accuracy-Score: 0.8397 - AUROC: 0.9398 - AP: 0.8206
[37m2024-06-28 06:32:39,637 [INFO] - Epoch: 11/50
[37m2024-06-28 06:32:39,815 [INFO] - Training epoch stats:     Loss: 0.0289 - F1-Score: 0.9935 - Accuracy-Score: 0.9935 - AUROC: 0.9999 - AP: 0.9995
[37m2024-06-28 06:32:39,962 [INFO] - Validation epoch stats:   Loss: 0.5521 - F1-Score: 0.8584 - Accuracy-Score: 0.8584 - AUROC: 0.9387 - AP: 0.8161
[37m2024-06-28 06:32:40,026 [INFO] - Epoch: 12/50
[37m2024-06-28 06:32:40,208 [INFO] - Training epoch stats:     Loss: 0.0239 - F1-Score: 0.9935 - Accuracy-Score: 0.9935 - AUROC: 0.9999 - AP: 0.9995
[37m2024-06-28 06:32:40,391 [INFO] - Validation epoch stats:   Loss: 0.5383 - F1-Score: 0.8524 - Accuracy-Score: 0.8524 - AUROC: 0.9384 - AP: 0.8179
[37m2024-06-28 06:32:40,469 [INFO] - Epoch: 13/50
[37m2024-06-28 06:32:40,652 [INFO] - Training epoch stats:     Loss: 0.0158 - F1-Score: 0.9975 - Accuracy-Score: 0.9975 - AUROC: 0.9999 - AP: 0.9997
[37m2024-06-28 06:32:40,857 [INFO] - Validation epoch stats:   Loss: 0.5635 - F1-Score: 0.8577 - Accuracy-Score: 0.8577 - AUROC: 0.9393 - AP: 0.8180
[37m2024-06-28 06:32:40,948 [INFO] - Epoch: 14/50
[37m2024-06-28 06:32:41,101 [INFO] - Training epoch stats:     Loss: 0.0123 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:32:41,302 [INFO] - Validation epoch stats:   Loss: 0.6117 - F1-Score: 0.8465 - Accuracy-Score: 0.8465 - AUROC: 0.9372 - AP: 0.8124
[37m2024-06-28 06:32:41,455 [INFO] - Epoch: 15/50
[37m2024-06-28 06:32:41,688 [INFO] - Training epoch stats:     Loss: 0.0130 - F1-Score: 0.9978 - Accuracy-Score: 0.9978 - AUROC: 1.0000 - AP: 0.9998
[37m2024-06-28 06:32:41,885 [INFO] - Validation epoch stats:   Loss: 0.6326 - F1-Score: 0.8478 - Accuracy-Score: 0.8478 - AUROC: 0.9374 - AP: 0.8071
[37m2024-06-28 06:32:41,945 [INFO] - Epoch: 16/50
[37m2024-06-28 06:32:42,149 [INFO] - Training epoch stats:     Loss: 0.0093 - F1-Score: 0.9994 - Accuracy-Score: 0.9994 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:32:42,364 [INFO] - Validation epoch stats:   Loss: 0.6376 - F1-Score: 0.8529 - Accuracy-Score: 0.8529 - AUROC: 0.9361 - AP: 0.8083
[37m2024-06-28 06:32:42,417 [INFO] - Epoch: 17/50
[37m2024-06-28 06:32:42,640 [INFO] - Training epoch stats:     Loss: 0.0108 - F1-Score: 0.9981 - Accuracy-Score: 0.9981 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:32:42,781 [INFO] - Validation epoch stats:   Loss: 0.6692 - F1-Score: 0.8606 - Accuracy-Score: 0.8606 - AUROC: 0.9372 - AP: 0.8117
[37m2024-06-28 06:32:42,843 [INFO] - Epoch: 18/50
[37m2024-06-28 06:32:43,043 [INFO] - Training epoch stats:     Loss: 0.0091 - F1-Score: 0.9988 - Accuracy-Score: 0.9988 - AUROC: 0.9999 - AP: 0.9997
[37m2024-06-28 06:32:43,362 [INFO] - Validation epoch stats:   Loss: 0.6892 - F1-Score: 0.8520 - Accuracy-Score: 0.8520 - AUROC: 0.9369 - AP: 0.8114
[37m2024-06-28 06:32:43,537 [INFO] - Epoch: 19/50
[37m2024-06-28 06:32:43,702 [INFO] - Training epoch stats:     Loss: 0.0084 - F1-Score: 0.9991 - Accuracy-Score: 0.9991 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:32:43,887 [INFO] - Validation epoch stats:   Loss: 0.6881 - F1-Score: 0.8520 - Accuracy-Score: 0.8520 - AUROC: 0.9389 - AP: 0.8152
[37m2024-06-28 06:32:43,936 [INFO] - Epoch: 20/50
[37m2024-06-28 06:32:44,158 [INFO] - Training epoch stats:     Loss: 0.0067 - F1-Score: 0.9988 - Accuracy-Score: 0.9988 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:32:44,397 [INFO] - Validation epoch stats:   Loss: 0.7139 - F1-Score: 0.8543 - Accuracy-Score: 0.8543 - AUROC: 0.9353 - AP: 0.8120
[37m2024-06-28 06:32:44,502 [INFO] - Epoch: 21/50
[37m2024-06-28 06:32:44,660 [INFO] - Training epoch stats:     Loss: 0.0060 - F1-Score: 0.9991 - Accuracy-Score: 0.9991 - AUROC: 1.0000 - AP: 1.0000
[37m2024-06-28 06:32:44,966 [INFO] - Validation epoch stats:   Loss: 0.7744 - F1-Score: 0.8505 - Accuracy-Score: 0.8505 - AUROC: 0.9358 - AP: 0.8056
[37m2024-06-28 06:32:45,031 [INFO] - Epoch: 22/50
[37m2024-06-28 06:32:45,363 [INFO] - Training epoch stats:     Loss: 0.0074 - F1-Score: 0.9985 - Accuracy-Score: 0.9985 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:32:45,672 [INFO] - Validation epoch stats:   Loss: 0.7509 - F1-Score: 0.8517 - Accuracy-Score: 0.8517 - AUROC: 0.9370 - AP: 0.8095
[37m2024-06-28 06:32:45,772 [INFO] - Epoch: 23/50
[37m2024-06-28 06:32:45,917 [INFO] - Training epoch stats:     Loss: 0.0077 - F1-Score: 0.9988 - Accuracy-Score: 0.9988 - AUROC: 0.9999 - AP: 0.9994
[37m2024-06-28 06:32:46,087 [INFO] - Validation epoch stats:   Loss: 0.7556 - F1-Score: 0.8512 - Accuracy-Score: 0.8512 - AUROC: 0.9358 - AP: 0.8091
[37m2024-06-28 06:32:46,088 [INFO] - Performing early stopping!
[37m2024-06-28 06:32:46,094 [INFO] - Finished run vcffi5s4
