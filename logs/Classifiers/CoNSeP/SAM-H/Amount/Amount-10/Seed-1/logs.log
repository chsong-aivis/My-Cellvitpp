[37m2024-05-16 13:14:12,497 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-05-16 13:14:12,500 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-05-16T131357_Amount-10
[37m2024-05-16 13:14:12,584 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fcbc79da5f0>]
[37m2024-05-16 13:14:12,585 [INFO] - Using GPU: cuda:0
[37m2024-05-16 13:14:12,595 [INFO] - Using device: cuda:0
[37m2024-05-16 13:14:12,606 [INFO] - Loss function:
[37m2024-05-16 13:14:12,617 [INFO] - CrossEntropyLoss()
[37m2024-05-16 13:14:26,882 [INFO] - <All keys matched successfully>
[37m2024-05-16 13:14:27,761 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-05-16 13:14:27,763 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-05-16 13:14:27,773 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-05-16 13:14:27,784 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-05-16 13:14:27,815 [INFO] - Caching datasets
[37m2024-05-16 13:14:28,662 [INFO] - Instantiate Trainer
[37m2024-05-16 13:14:28,665 [INFO] - Calling Trainer Fit
[37m2024-05-16 13:14:28,676 [INFO] - Dataset is cached after first epoch
[37m2024-05-16 13:14:28,687 [INFO] - Starting training, total number of epochs: 50
[37m2024-05-16 13:14:28,697 [INFO] - Epoch: 1/50
[37m2024-05-16 13:14:28,709 [INFO] - Extracting training cells
[37m2024-05-16 13:14:38,387 [INFO] - Extraction detection metrics - F1: 0.790, Precision: 0.849, Recall: 0.757, Detected-Cells: 4383
[37m2024-05-16 13:14:38,393 [INFO] - Caching dataset 2d6c5476f56a1ccefff58935139cea867744e8569d9ffcdf2a9eb7e88d5d12ce to disk...
[37m2024-05-16 13:14:42,223 [INFO] - Training epoch stats:     Loss: 0.4586 - F1-Score: 0.8245 - Accuracy-Score: 0.8245 - AUROC: 0.9324 - AP: 0.7589
[37m2024-05-16 13:14:42,907 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-05-16 13:14:43,000 [INFO] - Validation epoch stats:   Loss: 0.3919 - F1-Score: 0.8635 - Accuracy-Score: 0.8635 - AUROC: 0.9541 - AP: 0.8362
[37m2024-05-16 13:14:43,000 [INFO] - New best model - save checkpoint
[37m2024-05-16 13:14:43,246 [INFO] - Epoch: 2/50
[37m2024-05-16 13:14:43,425 [INFO] - Training epoch stats:     Loss: 0.2186 - F1-Score: 0.9201 - Accuracy-Score: 0.9201 - AUROC: 0.9818 - AP: 0.9240
[37m2024-05-16 13:14:43,538 [INFO] - Validation epoch stats:   Loss: 0.3882 - F1-Score: 0.8572 - Accuracy-Score: 0.8572 - AUROC: 0.9582 - AP: 0.8452
[37m2024-05-16 13:14:43,539 [INFO] - New best model - save checkpoint
[37m2024-05-16 13:14:43,771 [INFO] - Epoch: 3/50
[37m2024-05-16 13:14:43,920 [INFO] - Training epoch stats:     Loss: 0.1687 - F1-Score: 0.9377 - Accuracy-Score: 0.9377 - AUROC: 0.9912 - AP: 0.9610
[37m2024-05-16 13:14:44,013 [INFO] - Validation epoch stats:   Loss: 0.4011 - F1-Score: 0.8605 - Accuracy-Score: 0.8605 - AUROC: 0.9566 - AP: 0.8370
[37m2024-05-16 13:14:44,069 [INFO] - Epoch: 4/50
[37m2024-05-16 13:14:44,211 [INFO] - Training epoch stats:     Loss: 0.1351 - F1-Score: 0.9505 - Accuracy-Score: 0.9505 - AUROC: 0.9942 - AP: 0.9737
[37m2024-05-16 13:14:44,304 [INFO] - Validation epoch stats:   Loss: 0.3675 - F1-Score: 0.8697 - Accuracy-Score: 0.8697 - AUROC: 0.9580 - AP: 0.8459
[37m2024-05-16 13:14:44,366 [INFO] - Epoch: 5/50
[37m2024-05-16 13:14:44,512 [INFO] - Training epoch stats:     Loss: 0.1090 - F1-Score: 0.9614 - Accuracy-Score: 0.9614 - AUROC: 0.9964 - AP: 0.9841
[37m2024-05-16 13:14:44,604 [INFO] - Validation epoch stats:   Loss: 0.4028 - F1-Score: 0.8605 - Accuracy-Score: 0.8605 - AUROC: 0.9527 - AP: 0.8411
[37m2024-05-16 13:14:44,663 [INFO] - Epoch: 6/50
[37m2024-05-16 13:14:44,808 [INFO] - Training epoch stats:     Loss: 0.0907 - F1-Score: 0.9685 - Accuracy-Score: 0.9685 - AUROC: 0.9976 - AP: 0.9900
[37m2024-05-16 13:14:44,907 [INFO] - Validation epoch stats:   Loss: 0.4099 - F1-Score: 0.8606 - Accuracy-Score: 0.8606 - AUROC: 0.9570 - AP: 0.8482
[37m2024-05-16 13:14:44,969 [INFO] - Epoch: 7/50
[37m2024-05-16 13:14:45,113 [INFO] - Training epoch stats:     Loss: 0.0773 - F1-Score: 0.9735 - Accuracy-Score: 0.9735 - AUROC: 0.9982 - AP: 0.9925
[37m2024-05-16 13:14:45,400 [INFO] - Validation epoch stats:   Loss: 0.4464 - F1-Score: 0.8599 - Accuracy-Score: 0.8599 - AUROC: 0.9521 - AP: 0.8398
[37m2024-05-16 13:14:45,461 [INFO] - Epoch: 8/50
[37m2024-05-16 13:14:45,604 [INFO] - Training epoch stats:     Loss: 0.0581 - F1-Score: 0.9813 - Accuracy-Score: 0.9813 - AUROC: 0.9992 - AP: 0.9964
[37m2024-05-16 13:14:45,697 [INFO] - Validation epoch stats:   Loss: 0.5006 - F1-Score: 0.8465 - Accuracy-Score: 0.8465 - AUROC: 0.9516 - AP: 0.8425
[37m2024-05-16 13:14:45,753 [INFO] - Epoch: 9/50
[37m2024-05-16 13:14:45,896 [INFO] - Training epoch stats:     Loss: 0.0574 - F1-Score: 0.9813 - Accuracy-Score: 0.9813 - AUROC: 0.9992 - AP: 0.9964
[37m2024-05-16 13:14:45,990 [INFO] - Validation epoch stats:   Loss: 0.4347 - F1-Score: 0.8687 - Accuracy-Score: 0.8687 - AUROC: 0.9544 - AP: 0.8451
[37m2024-05-16 13:14:46,051 [INFO] - Epoch: 10/50
[37m2024-05-16 13:14:46,198 [INFO] - Training epoch stats:     Loss: 0.0419 - F1-Score: 0.9895 - Accuracy-Score: 0.9895 - AUROC: 0.9996 - AP: 0.9987
[37m2024-05-16 13:14:46,291 [INFO] - Validation epoch stats:   Loss: 0.4427 - F1-Score: 0.8685 - Accuracy-Score: 0.8685 - AUROC: 0.9528 - AP: 0.8420
[37m2024-05-16 13:14:46,348 [INFO] - Epoch: 11/50
[37m2024-05-16 13:14:46,490 [INFO] - Training epoch stats:     Loss: 0.0357 - F1-Score: 0.9913 - Accuracy-Score: 0.9913 - AUROC: 0.9998 - AP: 0.9990
[37m2024-05-16 13:14:46,581 [INFO] - Validation epoch stats:   Loss: 0.4857 - F1-Score: 0.8682 - Accuracy-Score: 0.8682 - AUROC: 0.9502 - AP: 0.8378
[37m2024-05-16 13:14:46,637 [INFO] - Epoch: 12/50
[37m2024-05-16 13:14:46,778 [INFO] - Training epoch stats:     Loss: 0.0308 - F1-Score: 0.9920 - Accuracy-Score: 0.9920 - AUROC: 0.9998 - AP: 0.9992
[37m2024-05-16 13:14:46,869 [INFO] - Validation epoch stats:   Loss: 0.5071 - F1-Score: 0.8656 - Accuracy-Score: 0.8656 - AUROC: 0.9506 - AP: 0.8389
[37m2024-05-16 13:14:46,924 [INFO] - Epoch: 13/50
[37m2024-05-16 13:14:47,066 [INFO] - Training epoch stats:     Loss: 0.0225 - F1-Score: 0.9952 - Accuracy-Score: 0.9952 - AUROC: 0.9999 - AP: 0.9997
[37m2024-05-16 13:14:47,157 [INFO] - Validation epoch stats:   Loss: 0.5170 - F1-Score: 0.8653 - Accuracy-Score: 0.8653 - AUROC: 0.9475 - AP: 0.8343
[37m2024-05-16 13:14:47,216 [INFO] - Epoch: 14/50
[37m2024-05-16 13:14:47,361 [INFO] - Training epoch stats:     Loss: 0.0195 - F1-Score: 0.9968 - Accuracy-Score: 0.9968 - AUROC: 0.9999 - AP: 0.9996
[37m2024-05-16 13:14:47,452 [INFO] - Validation epoch stats:   Loss: 0.5298 - F1-Score: 0.8673 - Accuracy-Score: 0.8673 - AUROC: 0.9497 - AP: 0.8344
[37m2024-05-16 13:14:47,511 [INFO] - Epoch: 15/50
[37m2024-05-16 13:14:47,654 [INFO] - Training epoch stats:     Loss: 0.0195 - F1-Score: 0.9959 - Accuracy-Score: 0.9959 - AUROC: 0.9999 - AP: 0.9996
[37m2024-05-16 13:14:47,746 [INFO] - Validation epoch stats:   Loss: 0.5811 - F1-Score: 0.8635 - Accuracy-Score: 0.8635 - AUROC: 0.9469 - AP: 0.8341
[37m2024-05-16 13:14:47,800 [INFO] - Epoch: 16/50
[37m2024-05-16 13:14:47,942 [INFO] - Training epoch stats:     Loss: 0.0208 - F1-Score: 0.9959 - Accuracy-Score: 0.9959 - AUROC: 0.9999 - AP: 0.9997
[37m2024-05-16 13:14:48,033 [INFO] - Validation epoch stats:   Loss: 0.5377 - F1-Score: 0.8725 - Accuracy-Score: 0.8725 - AUROC: 0.9488 - AP: 0.8333
[37m2024-05-16 13:14:48,088 [INFO] - Epoch: 17/50
[37m2024-05-16 13:14:48,229 [INFO] - Training epoch stats:     Loss: 0.0185 - F1-Score: 0.9959 - Accuracy-Score: 0.9959 - AUROC: 0.9999 - AP: 0.9996
[37m2024-05-16 13:14:48,320 [INFO] - Validation epoch stats:   Loss: 0.5624 - F1-Score: 0.8666 - Accuracy-Score: 0.8666 - AUROC: 0.9477 - AP: 0.8400
[37m2024-05-16 13:14:48,383 [INFO] - Epoch: 18/50
[37m2024-05-16 13:14:48,527 [INFO] - Training epoch stats:     Loss: 0.0127 - F1-Score: 0.9975 - Accuracy-Score: 0.9975 - AUROC: 1.0000 - AP: 1.0000
[37m2024-05-16 13:14:48,625 [INFO] - Validation epoch stats:   Loss: 0.5818 - F1-Score: 0.8680 - Accuracy-Score: 0.8680 - AUROC: 0.9468 - AP: 0.8372
[37m2024-05-16 13:14:48,679 [INFO] - Epoch: 19/50
[37m2024-05-16 13:14:48,824 [INFO] - Training epoch stats:     Loss: 0.0095 - F1-Score: 0.9989 - Accuracy-Score: 0.9989 - AUROC: 0.9999 - AP: 0.9997
[37m2024-05-16 13:14:48,918 [INFO] - Validation epoch stats:   Loss: 0.6667 - F1-Score: 0.8587 - Accuracy-Score: 0.8587 - AUROC: 0.9481 - AP: 0.8309
[37m2024-05-16 13:14:48,978 [INFO] - Epoch: 20/50
[37m2024-05-16 13:14:49,152 [INFO] - Training epoch stats:     Loss: 0.0214 - F1-Score: 0.9979 - Accuracy-Score: 0.9979 - AUROC: 0.9999 - AP: 0.9998
[37m2024-05-16 13:14:49,289 [INFO] - Validation epoch stats:   Loss: 0.6195 - F1-Score: 0.8654 - Accuracy-Score: 0.8654 - AUROC: 0.9458 - AP: 0.8325
[37m2024-05-16 13:14:49,364 [INFO] - Epoch: 21/50
[37m2024-05-16 13:14:49,555 [INFO] - Training epoch stats:     Loss: 0.0092 - F1-Score: 0.9986 - Accuracy-Score: 0.9986 - AUROC: 0.9999 - AP: 0.9992
[37m2024-05-16 13:14:49,698 [INFO] - Validation epoch stats:   Loss: 0.6131 - F1-Score: 0.8697 - Accuracy-Score: 0.8697 - AUROC: 0.9476 - AP: 0.8319
[37m2024-05-16 13:14:49,768 [INFO] - Epoch: 22/50
[37m2024-05-16 13:14:49,962 [INFO] - Training epoch stats:     Loss: 0.0189 - F1-Score: 0.9977 - Accuracy-Score: 0.9977 - AUROC: 0.9999 - AP: 0.9992
[37m2024-05-16 13:14:50,101 [INFO] - Validation epoch stats:   Loss: 0.6656 - F1-Score: 0.8654 - Accuracy-Score: 0.8654 - AUROC: 0.9451 - AP: 0.8287
[37m2024-05-16 13:14:50,102 [INFO] - Performing early stopping!
[37m2024-05-16 13:14:50,115 [INFO] - Finished run mo568n5u
