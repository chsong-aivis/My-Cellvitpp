[37m2024-06-28 06:39:46,511 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 06:39:46,512 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount/2024-06-28T063936_Amount-10-Seed-5
[37m2024-06-28 06:39:46,577 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fa1d0b3c670>]
[37m2024-06-28 06:39:46,578 [INFO] - Using GPU: cuda:0
[37m2024-06-28 06:39:46,582 [INFO] - Using device: cuda:0
[37m2024-06-28 06:39:46,587 [INFO] - Loss function:
[37m2024-06-28 06:39:46,591 [INFO] - CrossEntropyLoss()
[37m2024-06-28 06:41:09,475 [INFO] - <All keys matched successfully>
[37m2024-06-28 06:41:11,521 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 06:41:11,525 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 06:41:11,533 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 06:41:11,543 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 06:41:11,574 [INFO] - Caching datasets
[37m2024-06-28 06:41:12,831 [INFO] - Instantiate Trainer
[37m2024-06-28 06:41:12,837 [INFO] - Calling Trainer Fit
[37m2024-06-28 06:41:12,844 [INFO] - Dataset is cached after first epoch
[37m2024-06-28 06:41:12,853 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 06:41:12,862 [INFO] - Epoch: 1/50
[37m2024-06-28 06:41:13,875 [INFO] - Loaded dataset from cache: /Consep/cache/2d6c5476f56a1ccefff58935139cea867744e8569d9ffcdf2a9eb7e88d5d12ce.h5
[37m2024-06-28 06:41:14,507 [INFO] - Training epoch stats:     Loss: 0.6400 - F1-Score: 0.7452 - Accuracy-Score: 0.7452 - AUROC: 0.8777 - AP: 0.6700
[37m2024-06-28 06:41:15,977 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 06:41:16,124 [INFO] - Validation epoch stats:   Loss: 0.3689 - F1-Score: 0.8639 - Accuracy-Score: 0.8639 - AUROC: 0.9579 - AP: 0.8462
[37m2024-06-28 06:41:16,125 [INFO] - New best model - save checkpoint
[37m2024-06-28 06:41:16,307 [INFO] - Epoch: 2/50
[37m2024-06-28 06:41:16,513 [INFO] - Training epoch stats:     Loss: 0.2383 - F1-Score: 0.9106 - Accuracy-Score: 0.9106 - AUROC: 0.9777 - AP: 0.8977
[37m2024-06-28 06:41:16,770 [INFO] - Validation epoch stats:   Loss: 0.3813 - F1-Score: 0.8563 - Accuracy-Score: 0.8563 - AUROC: 0.9561 - AP: 0.8435
[37m2024-06-28 06:41:16,831 [INFO] - Epoch: 3/50
[37m2024-06-28 06:41:17,104 [INFO] - Training epoch stats:     Loss: 0.1864 - F1-Score: 0.9297 - Accuracy-Score: 0.9297 - AUROC: 0.9871 - AP: 0.9462
[37m2024-06-28 06:41:17,265 [INFO] - Validation epoch stats:   Loss: 0.3525 - F1-Score: 0.8709 - Accuracy-Score: 0.8709 - AUROC: 0.9569 - AP: 0.8493
[37m2024-06-28 06:41:17,312 [INFO] - Epoch: 4/50
[37m2024-06-28 06:41:18,293 [INFO] - Training epoch stats:     Loss: 0.1505 - F1-Score: 0.9450 - Accuracy-Score: 0.9450 - AUROC: 0.9928 - AP: 0.9667
[37m2024-06-28 06:41:18,790 [INFO] - Validation epoch stats:   Loss: 0.4090 - F1-Score: 0.8551 - Accuracy-Score: 0.8551 - AUROC: 0.9555 - AP: 0.8473
[37m2024-06-28 06:41:18,913 [INFO] - Epoch: 5/50
[37m2024-06-28 06:41:19,567 [INFO] - Training epoch stats:     Loss: 0.1240 - F1-Score: 0.9521 - Accuracy-Score: 0.9521 - AUROC: 0.9954 - AP: 0.9787
[37m2024-06-28 06:41:19,965 [INFO] - Validation epoch stats:   Loss: 0.3839 - F1-Score: 0.8570 - Accuracy-Score: 0.8570 - AUROC: 0.9562 - AP: 0.8510
[37m2024-06-28 06:41:20,076 [INFO] - Epoch: 6/50
[37m2024-06-28 06:41:20,673 [INFO] - Training epoch stats:     Loss: 0.0947 - F1-Score: 0.9646 - Accuracy-Score: 0.9646 - AUROC: 0.9974 - AP: 0.9881
[37m2024-06-28 06:41:21,168 [INFO] - Validation epoch stats:   Loss: 0.3855 - F1-Score: 0.8630 - Accuracy-Score: 0.8630 - AUROC: 0.9553 - AP: 0.8466
[37m2024-06-28 06:41:21,324 [INFO] - Epoch: 7/50
[37m2024-06-28 06:41:22,962 [INFO] - Training epoch stats:     Loss: 0.0792 - F1-Score: 0.9731 - Accuracy-Score: 0.9731 - AUROC: 0.9983 - AP: 0.9919
[37m2024-06-28 06:41:23,372 [INFO] - Validation epoch stats:   Loss: 0.3938 - F1-Score: 0.8683 - Accuracy-Score: 0.8683 - AUROC: 0.9511 - AP: 0.8453
[37m2024-06-28 06:41:23,455 [INFO] - Epoch: 8/50
[37m2024-06-28 06:41:23,978 [INFO] - Training epoch stats:     Loss: 0.0686 - F1-Score: 0.9763 - Accuracy-Score: 0.9763 - AUROC: 0.9990 - AP: 0.9954
[37m2024-06-28 06:41:24,754 [INFO] - Validation epoch stats:   Loss: 0.3984 - F1-Score: 0.8735 - Accuracy-Score: 0.8735 - AUROC: 0.9516 - AP: 0.8454
[37m2024-06-28 06:41:24,862 [INFO] - Epoch: 9/50
[37m2024-06-28 06:41:26,067 [INFO] - Training epoch stats:     Loss: 0.0519 - F1-Score: 0.9863 - Accuracy-Score: 0.9863 - AUROC: 0.9994 - AP: 0.9971
[37m2024-06-28 06:41:26,763 [INFO] - Validation epoch stats:   Loss: 0.4220 - F1-Score: 0.8718 - Accuracy-Score: 0.8718 - AUROC: 0.9528 - AP: 0.8465
[37m2024-06-28 06:41:26,827 [INFO] - Epoch: 10/50
[37m2024-06-28 06:41:27,391 [INFO] - Training epoch stats:     Loss: 0.0430 - F1-Score: 0.9879 - Accuracy-Score: 0.9879 - AUROC: 0.9996 - AP: 0.9985
[37m2024-06-28 06:41:28,060 [INFO] - Validation epoch stats:   Loss: 0.4380 - F1-Score: 0.8711 - Accuracy-Score: 0.8711 - AUROC: 0.9504 - AP: 0.8455
[37m2024-06-28 06:41:28,116 [INFO] - Epoch: 11/50
[37m2024-06-28 06:41:28,611 [INFO] - Training epoch stats:     Loss: 0.0367 - F1-Score: 0.9900 - Accuracy-Score: 0.9900 - AUROC: 0.9998 - AP: 0.9991
[37m2024-06-28 06:41:28,972 [INFO] - Validation epoch stats:   Loss: 0.4476 - F1-Score: 0.8711 - Accuracy-Score: 0.8711 - AUROC: 0.9516 - AP: 0.8433
[37m2024-06-28 06:41:29,055 [INFO] - Epoch: 12/50
[37m2024-06-28 06:41:29,468 [INFO] - Training epoch stats:     Loss: 0.0281 - F1-Score: 0.9929 - Accuracy-Score: 0.9929 - AUROC: 0.9999 - AP: 0.9995
[37m2024-06-28 06:41:29,978 [INFO] - Validation epoch stats:   Loss: 0.4822 - F1-Score: 0.8725 - Accuracy-Score: 0.8725 - AUROC: 0.9505 - AP: 0.8447
[37m2024-06-28 06:41:30,031 [INFO] - Epoch: 13/50
[37m2024-06-28 06:41:31,160 [INFO] - Training epoch stats:     Loss: 0.0225 - F1-Score: 0.9959 - Accuracy-Score: 0.9959 - AUROC: 0.9999 - AP: 0.9996
[37m2024-06-28 06:41:31,765 [INFO] - Validation epoch stats:   Loss: 0.4813 - F1-Score: 0.8720 - Accuracy-Score: 0.8720 - AUROC: 0.9535 - AP: 0.8498
[37m2024-06-28 06:41:31,825 [INFO] - Epoch: 14/50
[37m2024-06-28 06:41:32,365 [INFO] - Training epoch stats:     Loss: 0.0184 - F1-Score: 0.9970 - Accuracy-Score: 0.9970 - AUROC: 0.9999 - AP: 0.9997
[37m2024-06-28 06:41:33,367 [INFO] - Validation epoch stats:   Loss: 0.4992 - F1-Score: 0.8726 - Accuracy-Score: 0.8726 - AUROC: 0.9534 - AP: 0.8495
[37m2024-06-28 06:41:33,455 [INFO] - Epoch: 15/50
[37m2024-06-28 06:41:33,968 [INFO] - Training epoch stats:     Loss: 0.0179 - F1-Score: 0.9963 - Accuracy-Score: 0.9963 - AUROC: 0.9999 - AP: 0.9994
[37m2024-06-28 06:41:35,460 [INFO] - Validation epoch stats:   Loss: 0.5074 - F1-Score: 0.8756 - Accuracy-Score: 0.8756 - AUROC: 0.9519 - AP: 0.8452
[37m2024-06-28 06:41:35,523 [INFO] - Epoch: 16/50
[37m2024-06-28 06:41:35,866 [INFO] - Training epoch stats:     Loss: 0.0188 - F1-Score: 0.9957 - Accuracy-Score: 0.9957 - AUROC: 0.9999 - AP: 0.9996
[37m2024-06-28 06:41:36,304 [INFO] - Validation epoch stats:   Loss: 0.5569 - F1-Score: 0.8646 - Accuracy-Score: 0.8646 - AUROC: 0.9512 - AP: 0.8457
[37m2024-06-28 06:41:36,409 [INFO] - Epoch: 17/50
[37m2024-06-28 06:41:36,963 [INFO] - Training epoch stats:     Loss: 0.0134 - F1-Score: 0.9982 - Accuracy-Score: 0.9982 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:41:37,265 [INFO] - Validation epoch stats:   Loss: 0.5607 - F1-Score: 0.8690 - Accuracy-Score: 0.8690 - AUROC: 0.9498 - AP: 0.8415
[37m2024-06-28 06:41:37,398 [INFO] - Epoch: 18/50
[37m2024-06-28 06:41:37,867 [INFO] - Training epoch stats:     Loss: 0.0112 - F1-Score: 0.9984 - Accuracy-Score: 0.9984 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:41:38,188 [INFO] - Validation epoch stats:   Loss: 0.6025 - F1-Score: 0.8622 - Accuracy-Score: 0.8622 - AUROC: 0.9503 - AP: 0.8456
[37m2024-06-28 06:41:38,236 [INFO] - Epoch: 19/50
[37m2024-06-28 06:41:38,586 [INFO] - Training epoch stats:     Loss: 0.0120 - F1-Score: 0.9984 - Accuracy-Score: 0.9984 - AUROC: 0.9999 - AP: 0.9998
[37m2024-06-28 06:41:39,065 [INFO] - Validation epoch stats:   Loss: 0.5968 - F1-Score: 0.8677 - Accuracy-Score: 0.8677 - AUROC: 0.9491 - AP: 0.8390
[37m2024-06-28 06:41:39,159 [INFO] - Epoch: 20/50
[37m2024-06-28 06:41:39,469 [INFO] - Training epoch stats:     Loss: 0.0099 - F1-Score: 0.9982 - Accuracy-Score: 0.9982 - AUROC: 1.0000 - AP: 0.9999
[37m2024-06-28 06:41:40,771 [INFO] - Validation epoch stats:   Loss: 0.5906 - F1-Score: 0.8665 - Accuracy-Score: 0.8665 - AUROC: 0.9503 - AP: 0.8445
[37m2024-06-28 06:41:40,926 [INFO] - Epoch: 21/50
[37m2024-06-28 06:41:41,270 [INFO] - Training epoch stats:     Loss: 0.0100 - F1-Score: 0.9984 - Accuracy-Score: 0.9984 - AUROC: 0.9999 - AP: 0.9996
[37m2024-06-28 06:41:41,670 [INFO] - Validation epoch stats:   Loss: 0.6041 - F1-Score: 0.8730 - Accuracy-Score: 0.8730 - AUROC: 0.9520 - AP: 0.8428
[37m2024-06-28 06:41:41,670 [INFO] - Performing early stopping!
[37m2024-06-28 06:41:41,677 [INFO] - Finished run 884a01if
