[37m2024-06-28 08:25:45,729 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 08:25:45,729 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount-DA/2024-06-28T082537_Amount-2-Seed-3
[37m2024-06-28 08:25:45,793 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f6a77958880>]
[37m2024-06-28 08:25:45,798 [INFO] - Using GPU: cuda:0
[37m2024-06-28 08:25:45,802 [INFO] - Using device: cuda:0
[37m2024-06-28 08:25:45,806 [INFO] - Loss function:
[37m2024-06-28 08:25:45,811 [INFO] - CrossEntropyLoss()
[37m2024-06-28 08:26:03,082 [INFO] - <All keys matched successfully>
[37m2024-06-28 08:26:04,674 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 08:26:04,676 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 08:26:04,682 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 08:26:04,688 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 08:26:04,703 [INFO] - Caching datasets
[37m2024-06-28 08:26:05,360 [INFO] - Instantiate Trainer
[37m2024-06-28 08:26:05,364 [INFO] - Calling Trainer Fit
[37m2024-06-28 08:26:05,366 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 08:26:05,371 [INFO] - Epoch: 1/50
[37m2024-06-28 08:26:05,377 [INFO] - Extracting training cells
[37m2024-06-28 08:26:08,976 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.805, Recall: 0.640, Detected-Cells: 825
[37m2024-06-28 08:26:09,122 [INFO] - Training epoch stats:     Loss: 1.1482 - F1-Score: 0.4339 - Accuracy-Score: 0.4339 - AUROC: 0.6245 - AP: 0.3715
[37m2024-06-28 08:26:10,390 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 08:26:10,513 [INFO] - Validation epoch stats:   Loss: 1.7191 - F1-Score: 0.6694 - Accuracy-Score: 0.6694 - AUROC: 0.7457 - AP: 0.5676
[37m2024-06-28 08:26:10,514 [INFO] - New best model - save checkpoint
[37m2024-06-28 08:26:10,739 [INFO] - Epoch: 2/50
[37m2024-06-28 08:26:10,741 [INFO] - Extracting training cells
[37m2024-06-28 08:26:12,905 [INFO] - Extraction detection metrics - F1: 0.741, Precision: 0.823, Recall: 0.677, Detected-Cells: 1084
[37m2024-06-28 08:26:12,959 [INFO] - Training epoch stats:     Loss: 0.5789 - F1-Score: 0.8459 - Accuracy-Score: 0.8459 - AUROC: 0.7979 - AP: 0.6017
[37m2024-06-28 08:26:13,086 [INFO] - Validation epoch stats:   Loss: 1.8269 - F1-Score: 0.6615 - Accuracy-Score: 0.6615 - AUROC: 0.8401 - AP: 0.6822
[37m2024-06-28 08:26:13,087 [INFO] - New best model - save checkpoint
[37m2024-06-28 08:26:13,243 [INFO] - Epoch: 3/50
[37m2024-06-28 08:26:13,243 [INFO] - Extracting training cells
[37m2024-06-28 08:26:15,435 [INFO] - Extraction detection metrics - F1: 0.767, Precision: 0.813, Recall: 0.742, Detected-Cells: 1183
[37m2024-06-28 08:26:15,500 [INFO] - Training epoch stats:     Loss: 0.4397 - F1-Score: 0.8791 - Accuracy-Score: 0.8791 - AUROC: 0.9249 - AP: 0.6917
[37m2024-06-28 08:26:15,626 [INFO] - Validation epoch stats:   Loss: 1.3471 - F1-Score: 0.6850 - Accuracy-Score: 0.6850 - AUROC: 0.9006 - AP: 0.7623
[37m2024-06-28 08:26:15,627 [INFO] - New best model - save checkpoint
[37m2024-06-28 08:26:15,803 [INFO] - Epoch: 4/50
[37m2024-06-28 08:26:15,804 [INFO] - Extracting training cells
[37m2024-06-28 08:26:18,522 [INFO] - Extraction detection metrics - F1: 0.660, Precision: 0.727, Recall: 0.611, Detected-Cells: 983
[37m2024-06-28 08:26:18,583 [INFO] - Training epoch stats:     Loss: 0.3154 - F1-Score: 0.9156 - Accuracy-Score: 0.9156 - AUROC: 0.9494 - AP: 0.7264
[37m2024-06-28 08:26:18,707 [INFO] - Validation epoch stats:   Loss: 0.8234 - F1-Score: 0.7058 - Accuracy-Score: 0.7058 - AUROC: 0.9177 - AP: 0.7908
[37m2024-06-28 08:26:18,708 [INFO] - New best model - save checkpoint
[37m2024-06-28 08:26:18,875 [INFO] - Epoch: 5/50
[37m2024-06-28 08:26:18,876 [INFO] - Extracting training cells
[37m2024-06-28 08:26:21,150 [INFO] - Extraction detection metrics - F1: 0.762, Precision: 0.819, Recall: 0.730, Detected-Cells: 1164
[37m2024-06-28 08:26:21,204 [INFO] - Training epoch stats:     Loss: 0.2614 - F1-Score: 0.9201 - Accuracy-Score: 0.9201 - AUROC: 0.9674 - AP: 0.8064
[37m2024-06-28 08:26:21,332 [INFO] - Validation epoch stats:   Loss: 0.7031 - F1-Score: 0.7063 - Accuracy-Score: 0.7063 - AUROC: 0.9162 - AP: 0.7869
[37m2024-06-28 08:26:21,404 [INFO] - Epoch: 6/50
[37m2024-06-28 08:26:21,405 [INFO] - Extracting training cells
[37m2024-06-28 08:26:23,530 [INFO] - Extraction detection metrics - F1: 0.754, Precision: 0.838, Recall: 0.706, Detected-Cells: 1126
[37m2024-06-28 08:26:23,588 [INFO] - Training epoch stats:     Loss: 0.2172 - F1-Score: 0.9290 - Accuracy-Score: 0.9290 - AUROC: 0.9785 - AP: 0.8303
[37m2024-06-28 08:26:23,716 [INFO] - Validation epoch stats:   Loss: 0.7147 - F1-Score: 0.7037 - Accuracy-Score: 0.7037 - AUROC: 0.9236 - AP: 0.7985
[37m2024-06-28 08:26:23,717 [INFO] - New best model - save checkpoint
[37m2024-06-28 08:26:23,908 [INFO] - Epoch: 7/50
[37m2024-06-28 08:26:23,909 [INFO] - Extracting training cells
[37m2024-06-28 08:26:25,738 [INFO] - Extraction detection metrics - F1: 0.735, Precision: 0.774, Recall: 0.717, Detected-Cells: 781
[37m2024-06-28 08:26:25,789 [INFO] - Training epoch stats:     Loss: 0.6277 - F1-Score: 0.8028 - Accuracy-Score: 0.8028 - AUROC: 0.9335 - AP: 0.6567
[37m2024-06-28 08:26:25,920 [INFO] - Validation epoch stats:   Loss: 0.7580 - F1-Score: 0.6789 - Accuracy-Score: 0.6789 - AUROC: 0.9316 - AP: 0.8083
[37m2024-06-28 08:26:25,921 [INFO] - New best model - save checkpoint
[37m2024-06-28 08:26:26,109 [INFO] - Epoch: 8/50
[37m2024-06-28 08:26:26,110 [INFO] - Extracting training cells
[37m2024-06-28 08:26:28,124 [INFO] - Extraction detection metrics - F1: 0.707, Precision: 0.799, Recall: 0.641, Detected-Cells: 1027
[37m2024-06-28 08:26:28,176 [INFO] - Training epoch stats:     Loss: 0.2066 - F1-Score: 0.9241 - Accuracy-Score: 0.9241 - AUROC: 0.9788 - AP: 0.8282
[37m2024-06-28 08:26:28,297 [INFO] - Validation epoch stats:   Loss: 0.6734 - F1-Score: 0.7441 - Accuracy-Score: 0.7441 - AUROC: 0.9299 - AP: 0.8019
[37m2024-06-28 08:26:28,361 [INFO] - Epoch: 9/50
[37m2024-06-28 08:26:28,361 [INFO] - Extracting training cells
[37m2024-06-28 08:26:30,549 [INFO] - Extraction detection metrics - F1: 0.656, Precision: 0.667, Recall: 0.651, Detected-Cells: 726
[37m2024-06-28 08:26:30,588 [INFO] - Training epoch stats:     Loss: 0.3007 - F1-Score: 0.9036 - Accuracy-Score: 0.9036 - AUROC: 0.9634 - AP: 0.7953
[37m2024-06-28 08:26:30,709 [INFO] - Validation epoch stats:   Loss: 0.8510 - F1-Score: 0.7037 - Accuracy-Score: 0.7037 - AUROC: 0.9167 - AP: 0.7896
[37m2024-06-28 08:26:30,772 [INFO] - Epoch: 10/50
[37m2024-06-28 08:26:30,773 [INFO] - Extracting training cells
[37m2024-06-28 08:26:32,815 [INFO] - Extraction detection metrics - F1: 0.771, Precision: 0.796, Recall: 0.755, Detected-Cells: 1062
[37m2024-06-28 08:26:32,866 [INFO] - Training epoch stats:     Loss: 0.7056 - F1-Score: 0.8249 - Accuracy-Score: 0.8249 - AUROC: 0.8951 - AP: 0.6672
[37m2024-06-28 08:26:32,990 [INFO] - Validation epoch stats:   Loss: 0.8436 - F1-Score: 0.6883 - Accuracy-Score: 0.6883 - AUROC: 0.9145 - AP: 0.7132
[37m2024-06-28 08:26:33,043 [INFO] - Epoch: 11/50
[37m2024-06-28 08:26:33,043 [INFO] - Extracting training cells
[37m2024-06-28 08:26:35,188 [INFO] - Extraction detection metrics - F1: 0.713, Precision: 0.805, Recall: 0.649, Detected-Cells: 1039
[37m2024-06-28 08:26:35,237 [INFO] - Training epoch stats:     Loss: 0.2826 - F1-Score: 0.8980 - Accuracy-Score: 0.8980 - AUROC: 0.9705 - AP: 0.8384
[37m2024-06-28 08:26:35,360 [INFO] - Validation epoch stats:   Loss: 0.6697 - F1-Score: 0.7324 - Accuracy-Score: 0.7324 - AUROC: 0.8972 - AP: 0.6651
[37m2024-06-28 08:26:35,415 [INFO] - Epoch: 12/50
[37m2024-06-28 08:26:35,415 [INFO] - Extracting training cells
[37m2024-06-28 08:26:37,853 [INFO] - Extraction detection metrics - F1: 0.735, Precision: 0.826, Recall: 0.667, Detected-Cells: 1068
[37m2024-06-28 08:26:37,911 [INFO] - Training epoch stats:     Loss: 0.2119 - F1-Score: 0.9326 - Accuracy-Score: 0.9326 - AUROC: 0.9821 - AP: 0.8807
[37m2024-06-28 08:26:38,275 [INFO] - Validation epoch stats:   Loss: 0.7195 - F1-Score: 0.7194 - Accuracy-Score: 0.7194 - AUROC: 0.9252 - AP: 0.8021
[37m2024-06-28 08:26:38,334 [INFO] - Epoch: 13/50
[37m2024-06-28 08:26:38,335 [INFO] - Extracting training cells
[37m2024-06-28 08:26:40,465 [INFO] - Extraction detection metrics - F1: 0.767, Precision: 0.810, Recall: 0.743, Detected-Cells: 1185
[37m2024-06-28 08:26:40,527 [INFO] - Training epoch stats:     Loss: 0.1861 - F1-Score: 0.9460 - Accuracy-Score: 0.9460 - AUROC: 0.9816 - AP: 0.8657
[37m2024-06-28 08:26:40,659 [INFO] - Validation epoch stats:   Loss: 0.7528 - F1-Score: 0.7321 - Accuracy-Score: 0.7321 - AUROC: 0.9302 - AP: 0.8094
[37m2024-06-28 08:26:40,724 [INFO] - Epoch: 14/50
[37m2024-06-28 08:26:40,725 [INFO] - Extracting training cells
[37m2024-06-28 08:26:43,066 [INFO] - Extraction detection metrics - F1: 0.695, Precision: 0.760, Recall: 0.650, Detected-Cells: 990
[37m2024-06-28 08:26:43,117 [INFO] - Training epoch stats:     Loss: 1.0663 - F1-Score: 0.7495 - Accuracy-Score: 0.7495 - AUROC: 0.8236 - AP: 0.5651
[37m2024-06-28 08:26:43,244 [INFO] - Validation epoch stats:   Loss: 0.6521 - F1-Score: 0.7003 - Accuracy-Score: 0.7003 - AUROC: 0.9282 - AP: 0.8033
[37m2024-06-28 08:26:43,301 [INFO] - Epoch: 15/50
[37m2024-06-28 08:26:43,301 [INFO] - Extracting training cells
[37m2024-06-28 08:26:45,643 [INFO] - Extraction detection metrics - F1: 0.733, Precision: 0.798, Recall: 0.695, Detected-Cells: 1110
[37m2024-06-28 08:26:45,702 [INFO] - Training epoch stats:     Loss: 0.2258 - F1-Score: 0.9342 - Accuracy-Score: 0.9342 - AUROC: 0.9894 - AP: 0.9036
[37m2024-06-28 08:26:45,834 [INFO] - Validation epoch stats:   Loss: 0.6844 - F1-Score: 0.7238 - Accuracy-Score: 0.7238 - AUROC: 0.9106 - AP: 0.7763
[37m2024-06-28 08:26:45,899 [INFO] - Epoch: 16/50
[37m2024-06-28 08:26:45,899 [INFO] - Extracting training cells
[37m2024-06-28 08:26:48,258 [INFO] - Extraction detection metrics - F1: 0.729, Precision: 0.816, Recall: 0.664, Detected-Cells: 1063
[37m2024-06-28 08:26:48,317 [INFO] - Training epoch stats:     Loss: 0.1867 - F1-Score: 0.9473 - Accuracy-Score: 0.9473 - AUROC: 0.9853 - AP: 0.8630
[37m2024-06-28 08:26:48,449 [INFO] - Validation epoch stats:   Loss: 0.9208 - F1-Score: 0.6904 - Accuracy-Score: 0.6904 - AUROC: 0.8984 - AP: 0.7649
[37m2024-06-28 08:26:48,504 [INFO] - Epoch: 17/50
[37m2024-06-28 08:26:48,505 [INFO] - Extracting training cells
[37m2024-06-28 08:26:50,918 [INFO] - Extraction detection metrics - F1: 0.685, Precision: 0.775, Recall: 0.622, Detected-Cells: 999
[37m2024-06-28 08:26:50,966 [INFO] - Training epoch stats:     Loss: 0.2081 - F1-Score: 0.9409 - Accuracy-Score: 0.9409 - AUROC: 0.9881 - AP: 0.8945
[37m2024-06-28 08:26:51,096 [INFO] - Validation epoch stats:   Loss: 0.9021 - F1-Score: 0.7120 - Accuracy-Score: 0.7120 - AUROC: 0.9050 - AP: 0.7728
[37m2024-06-28 08:26:51,157 [INFO] - Epoch: 18/50
[37m2024-06-28 08:26:51,158 [INFO] - Extracting training cells
[37m2024-06-28 08:26:53,064 [INFO] - Extraction detection metrics - F1: 0.698, Precision: 0.763, Recall: 0.652, Detected-Cells: 737
[37m2024-06-28 08:26:53,101 [INFO] - Training epoch stats:     Loss: 0.5037 - F1-Score: 0.8141 - Accuracy-Score: 0.8141 - AUROC: 0.9424 - AP: 0.7355
[37m2024-06-28 08:26:53,222 [INFO] - Validation epoch stats:   Loss: 0.8081 - F1-Score: 0.7211 - Accuracy-Score: 0.7211 - AUROC: 0.9155 - AP: 0.7819
[37m2024-06-28 08:26:53,271 [INFO] - Epoch: 19/50
[37m2024-06-28 08:26:53,271 [INFO] - Extracting training cells
[37m2024-06-28 08:26:55,702 [INFO] - Extraction detection metrics - F1: 0.711, Precision: 0.782, Recall: 0.661, Detected-Cells: 1059
[37m2024-06-28 08:26:55,757 [INFO] - Training epoch stats:     Loss: 0.2136 - F1-Score: 0.9320 - Accuracy-Score: 0.9320 - AUROC: 0.9843 - AP: 0.8700
[37m2024-06-28 08:26:55,903 [INFO] - Validation epoch stats:   Loss: 0.8351 - F1-Score: 0.6758 - Accuracy-Score: 0.6758 - AUROC: 0.9199 - AP: 0.7892
[37m2024-06-28 08:26:55,955 [INFO] - Epoch: 20/50
[37m2024-06-28 08:26:55,956 [INFO] - Extracting training cells
[37m2024-06-28 08:26:58,149 [INFO] - Extraction detection metrics - F1: 0.774, Precision: 0.820, Recall: 0.746, Detected-Cells: 1190
[37m2024-06-28 08:26:58,220 [INFO] - Training epoch stats:     Loss: 0.1478 - F1-Score: 0.9563 - Accuracy-Score: 0.9563 - AUROC: 0.9928 - AP: 0.9271
[37m2024-06-28 08:26:58,347 [INFO] - Validation epoch stats:   Loss: 0.9170 - F1-Score: 0.6816 - Accuracy-Score: 0.6816 - AUROC: 0.9160 - AP: 0.7905
[37m2024-06-28 08:26:58,401 [INFO] - Epoch: 21/50
[37m2024-06-28 08:26:58,401 [INFO] - Extracting training cells
[37m2024-06-28 08:27:00,425 [INFO] - Extraction detection metrics - F1: 0.677, Precision: 0.725, Recall: 0.638, Detected-Cells: 760
[37m2024-06-28 08:27:00,466 [INFO] - Training epoch stats:     Loss: 0.5740 - F1-Score: 0.8500 - Accuracy-Score: 0.8500 - AUROC: 0.9176 - AP: 0.7142
[37m2024-06-28 08:27:00,622 [INFO] - Validation epoch stats:   Loss: 0.8505 - F1-Score: 0.7285 - Accuracy-Score: 0.7285 - AUROC: 0.9096 - AP: 0.7696
[37m2024-06-28 08:27:00,686 [INFO] - Epoch: 22/50
[37m2024-06-28 08:27:00,686 [INFO] - Extracting training cells
[37m2024-06-28 08:27:03,332 [INFO] - Extraction detection metrics - F1: 0.706, Precision: 0.825, Recall: 0.618, Detected-Cells: 993
[37m2024-06-28 08:27:03,380 [INFO] - Training epoch stats:     Loss: 0.2270 - F1-Score: 0.9245 - Accuracy-Score: 0.9245 - AUROC: 0.9848 - AP: 0.8276
[37m2024-06-28 08:27:03,507 [INFO] - Validation epoch stats:   Loss: 0.7975 - F1-Score: 0.7288 - Accuracy-Score: 0.7288 - AUROC: 0.9147 - AP: 0.7168
[37m2024-06-28 08:27:03,568 [INFO] - Epoch: 23/50
[37m2024-06-28 08:27:03,568 [INFO] - Extracting training cells
[37m2024-06-28 08:27:05,466 [INFO] - Extraction detection metrics - F1: 0.732, Precision: 0.770, Recall: 0.716, Detected-Cells: 797
[37m2024-06-28 08:27:05,513 [INFO] - Training epoch stats:     Loss: 0.5780 - F1-Score: 0.7742 - Accuracy-Score: 0.7742 - AUROC: 0.9232 - AP: 0.7046
[37m2024-06-28 08:27:05,638 [INFO] - Validation epoch stats:   Loss: 0.8893 - F1-Score: 0.6442 - Accuracy-Score: 0.6442 - AUROC: 0.9255 - AP: 0.8021
[37m2024-06-28 08:27:05,700 [INFO] - Epoch: 24/50
[37m2024-06-28 08:27:05,701 [INFO] - Extracting training cells
[37m2024-06-28 08:27:07,856 [INFO] - Extraction detection metrics - F1: 0.697, Precision: 0.766, Recall: 0.649, Detected-Cells: 1040
[37m2024-06-28 08:27:07,911 [INFO] - Training epoch stats:     Loss: 0.2044 - F1-Score: 0.9452 - Accuracy-Score: 0.9452 - AUROC: 0.9908 - AP: 0.9264
[37m2024-06-28 08:27:08,033 [INFO] - Validation epoch stats:   Loss: 0.6196 - F1-Score: 0.7748 - Accuracy-Score: 0.7748 - AUROC: 0.9305 - AP: 0.8013
[37m2024-06-28 08:27:08,104 [INFO] - Epoch: 25/50
[37m2024-06-28 08:27:08,104 [INFO] - Extracting training cells
[37m2024-06-28 08:27:10,410 [INFO] - Extraction detection metrics - F1: 0.749, Precision: 0.814, Recall: 0.713, Detected-Cells: 1137
[37m2024-06-28 08:27:10,470 [INFO] - Training epoch stats:     Loss: 0.1882 - F1-Score: 0.9481 - Accuracy-Score: 0.9481 - AUROC: 0.9923 - AP: 0.9258
[37m2024-06-28 08:27:10,595 [INFO] - Validation epoch stats:   Loss: 0.6205 - F1-Score: 0.7791 - Accuracy-Score: 0.7791 - AUROC: 0.9298 - AP: 0.8004
[37m2024-06-28 08:27:10,652 [INFO] - Epoch: 26/50
[37m2024-06-28 08:27:10,653 [INFO] - Extracting training cells
[37m2024-06-28 08:27:12,682 [INFO] - Extraction detection metrics - F1: 0.731, Precision: 0.824, Recall: 0.660, Detected-Cells: 1057
[37m2024-06-28 08:27:12,740 [INFO] - Training epoch stats:     Loss: 0.1949 - F1-Score: 0.9461 - Accuracy-Score: 0.9461 - AUROC: 0.9792 - AP: 0.8396
[37m2024-06-28 08:27:12,863 [INFO] - Validation epoch stats:   Loss: 0.6213 - F1-Score: 0.7751 - Accuracy-Score: 0.7751 - AUROC: 0.9300 - AP: 0.8010
[37m2024-06-28 08:27:12,917 [INFO] - Epoch: 27/50
[37m2024-06-28 08:27:12,917 [INFO] - Extracting training cells
[37m2024-06-28 08:27:14,903 [INFO] - Extraction detection metrics - F1: 0.726, Precision: 0.843, Recall: 0.639, Detected-Cells: 1025
[37m2024-06-28 08:27:14,983 [INFO] - Training epoch stats:     Loss: 0.1902 - F1-Score: 0.9366 - Accuracy-Score: 0.9366 - AUROC: 0.9739 - AP: 0.8258
[37m2024-06-28 08:27:15,104 [INFO] - Validation epoch stats:   Loss: 0.6145 - F1-Score: 0.7683 - Accuracy-Score: 0.7683 - AUROC: 0.9306 - AP: 0.8023
[37m2024-06-28 08:27:15,104 [INFO] - Performing early stopping!
[37m2024-06-28 08:27:15,115 [INFO] - Finished run njtvitel
