[37m2024-06-28 09:00:14,207 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 09:00:14,208 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount-DA/2024-06-28T090005_Amount-11-Seed-3
[37m2024-06-28 09:00:14,262 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f456a39c880>]
[37m2024-06-28 09:00:14,267 [INFO] - Using GPU: cuda:0
[37m2024-06-28 09:00:14,271 [INFO] - Using device: cuda:0
[37m2024-06-28 09:00:14,276 [INFO] - Loss function:
[37m2024-06-28 09:00:14,280 [INFO] - CrossEntropyLoss()
[37m2024-06-28 09:00:32,363 [INFO] - <All keys matched successfully>
[37m2024-06-28 09:00:33,822 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 09:00:33,824 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 09:00:33,828 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 09:00:33,832 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 09:00:33,849 [INFO] - Caching datasets
[37m2024-06-28 09:00:34,861 [INFO] - Instantiate Trainer
[37m2024-06-28 09:00:34,865 [INFO] - Calling Trainer Fit
[37m2024-06-28 09:00:34,867 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 09:00:34,872 [INFO] - Epoch: 1/50
[37m2024-06-28 09:00:34,877 [INFO] - Extracting training cells
[37m2024-06-28 09:00:47,669 [INFO] - Extraction detection metrics - F1: 0.788, Precision: 0.853, Recall: 0.746, Detected-Cells: 4054
[37m2024-06-28 09:00:47,911 [INFO] - Training epoch stats:     Loss: 0.5304 - F1-Score: 0.8120 - Accuracy-Score: 0.8120 - AUROC: 0.9158 - AP: 0.7284
[37m2024-06-28 09:00:49,047 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 09:00:49,170 [INFO] - Validation epoch stats:   Loss: 0.3930 - F1-Score: 0.8629 - Accuracy-Score: 0.8629 - AUROC: 0.9520 - AP: 0.8320
[37m2024-06-28 09:00:49,170 [INFO] - New best model - save checkpoint
[37m2024-06-28 09:00:49,317 [INFO] - Epoch: 2/50
[37m2024-06-28 09:00:49,318 [INFO] - Extracting training cells
[37m2024-06-28 09:00:57,772 [INFO] - Extraction detection metrics - F1: 0.750, Precision: 0.831, Recall: 0.703, Detected-Cells: 4276
[37m2024-06-28 09:00:57,919 [INFO] - Training epoch stats:     Loss: 0.3504 - F1-Score: 0.8845 - Accuracy-Score: 0.8845 - AUROC: 0.9509 - AP: 0.8150
[37m2024-06-28 09:00:58,049 [INFO] - Validation epoch stats:   Loss: 0.4163 - F1-Score: 0.8555 - Accuracy-Score: 0.8555 - AUROC: 0.8832 - AP: 0.6941
[37m2024-06-28 09:00:58,109 [INFO] - Epoch: 3/50
[37m2024-06-28 09:00:58,110 [INFO] - Extracting training cells
[37m2024-06-28 09:01:05,684 [INFO] - Extraction detection metrics - F1: 0.757, Precision: 0.835, Recall: 0.712, Detected-Cells: 4162
[37m2024-06-28 09:01:06,050 [INFO] - Training epoch stats:     Loss: 0.2796 - F1-Score: 0.8943 - Accuracy-Score: 0.8943 - AUROC: 0.9736 - AP: 0.8709
[37m2024-06-28 09:01:06,186 [INFO] - Validation epoch stats:   Loss: 0.3447 - F1-Score: 0.8682 - Accuracy-Score: 0.8682 - AUROC: 0.9655 - AP: 0.8534
[37m2024-06-28 09:01:06,187 [INFO] - New best model - save checkpoint
[37m2024-06-28 09:01:06,341 [INFO] - Epoch: 4/50
[37m2024-06-28 09:01:06,342 [INFO] - Extracting training cells
[37m2024-06-28 09:01:15,456 [INFO] - Extraction detection metrics - F1: 0.736, Precision: 0.835, Recall: 0.682, Detected-Cells: 4305
[37m2024-06-28 09:01:15,627 [INFO] - Training epoch stats:     Loss: 0.4406 - F1-Score: 0.8502 - Accuracy-Score: 0.8502 - AUROC: 0.9513 - AP: 0.8384
[37m2024-06-28 09:01:15,773 [INFO] - Validation epoch stats:   Loss: 0.3845 - F1-Score: 0.8611 - Accuracy-Score: 0.8611 - AUROC: 0.9599 - AP: 0.8522
[37m2024-06-28 09:01:15,829 [INFO] - Epoch: 5/50
[37m2024-06-28 09:01:15,830 [INFO] - Extracting training cells
[37m2024-06-28 09:01:23,791 [INFO] - Extraction detection metrics - F1: 0.774, Precision: 0.850, Recall: 0.732, Detected-Cells: 4604
[37m2024-06-28 09:01:23,954 [INFO] - Training epoch stats:     Loss: 0.2881 - F1-Score: 0.8960 - Accuracy-Score: 0.8960 - AUROC: 0.9739 - AP: 0.9064
[37m2024-06-28 09:01:24,102 [INFO] - Validation epoch stats:   Loss: 0.3642 - F1-Score: 0.8603 - Accuracy-Score: 0.8603 - AUROC: 0.9677 - AP: 0.8611
[37m2024-06-28 09:01:24,103 [INFO] - New best model - save checkpoint
[37m2024-06-28 09:01:24,276 [INFO] - Epoch: 6/50
[37m2024-06-28 09:01:24,277 [INFO] - Extracting training cells
[37m2024-06-28 09:01:31,805 [INFO] - Extraction detection metrics - F1: 0.796, Precision: 0.855, Recall: 0.763, Detected-Cells: 4788
[37m2024-06-28 09:01:31,959 [INFO] - Training epoch stats:     Loss: 0.2155 - F1-Score: 0.9167 - Accuracy-Score: 0.9167 - AUROC: 0.9842 - AP: 0.9274
[37m2024-06-28 09:01:32,081 [INFO] - Validation epoch stats:   Loss: 0.3350 - F1-Score: 0.8658 - Accuracy-Score: 0.8658 - AUROC: 0.9689 - AP: 0.8688
[37m2024-06-28 09:01:32,082 [INFO] - New best model - save checkpoint
[37m2024-06-28 09:01:32,241 [INFO] - Epoch: 7/50
[37m2024-06-28 09:01:32,242 [INFO] - Extracting training cells
[37m2024-06-28 09:01:40,574 [INFO] - Extraction detection metrics - F1: 0.788, Precision: 0.839, Recall: 0.755, Detected-Cells: 4449
[37m2024-06-28 09:01:40,745 [INFO] - Training epoch stats:     Loss: 0.2453 - F1-Score: 0.9146 - Accuracy-Score: 0.9146 - AUROC: 0.9835 - AP: 0.9374
[37m2024-06-28 09:01:40,868 [INFO] - Validation epoch stats:   Loss: 0.3795 - F1-Score: 0.8539 - Accuracy-Score: 0.8539 - AUROC: 0.9618 - AP: 0.8537
[37m2024-06-28 09:01:40,948 [INFO] - Epoch: 8/50
[37m2024-06-28 09:01:40,948 [INFO] - Extracting training cells
[37m2024-06-28 09:01:48,661 [INFO] - Extraction detection metrics - F1: 0.783, Precision: 0.859, Recall: 0.734, Detected-Cells: 4574
[37m2024-06-28 09:01:48,792 [INFO] - Training epoch stats:     Loss: 0.2497 - F1-Score: 0.9213 - Accuracy-Score: 0.9213 - AUROC: 0.9826 - AP: 0.9368
[37m2024-06-28 09:01:48,912 [INFO] - Validation epoch stats:   Loss: 0.3410 - F1-Score: 0.8725 - Accuracy-Score: 0.8725 - AUROC: 0.9682 - AP: 0.8684
[37m2024-06-28 09:01:48,979 [INFO] - Epoch: 9/50
[37m2024-06-28 09:01:48,980 [INFO] - Extracting training cells
[37m2024-06-28 09:01:57,328 [INFO] - Extraction detection metrics - F1: 0.745, Precision: 0.835, Recall: 0.695, Detected-Cells: 4074
[37m2024-06-28 09:01:57,484 [INFO] - Training epoch stats:     Loss: 0.2309 - F1-Score: 0.9129 - Accuracy-Score: 0.9129 - AUROC: 0.9859 - AP: 0.9479
[37m2024-06-28 09:01:57,633 [INFO] - Validation epoch stats:   Loss: 0.3337 - F1-Score: 0.8690 - Accuracy-Score: 0.8690 - AUROC: 0.9656 - AP: 0.8635
[37m2024-06-28 09:01:57,695 [INFO] - Epoch: 10/50
[37m2024-06-28 09:01:57,696 [INFO] - Extracting training cells
[37m2024-06-28 09:02:05,180 [INFO] - Extraction detection metrics - F1: 0.732, Precision: 0.805, Recall: 0.689, Detected-Cells: 3983
[37m2024-06-28 09:02:05,349 [INFO] - Training epoch stats:     Loss: 0.4367 - F1-Score: 0.8411 - Accuracy-Score: 0.8411 - AUROC: 0.9564 - AP: 0.8922
[37m2024-06-28 09:02:05,500 [INFO] - Validation epoch stats:   Loss: 0.3780 - F1-Score: 0.8543 - Accuracy-Score: 0.8543 - AUROC: 0.9590 - AP: 0.8509
[37m2024-06-28 09:02:05,545 [INFO] - Epoch: 11/50
[37m2024-06-28 09:02:05,546 [INFO] - Extracting training cells
[37m2024-06-28 09:02:13,591 [INFO] - Extraction detection metrics - F1: 0.783, Precision: 0.849, Recall: 0.739, Detected-Cells: 4592
[37m2024-06-28 09:02:13,786 [INFO] - Training epoch stats:     Loss: 0.2251 - F1-Score: 0.9140 - Accuracy-Score: 0.9140 - AUROC: 0.9840 - AP: 0.9416
[37m2024-06-28 09:02:13,949 [INFO] - Validation epoch stats:   Loss: 0.3428 - F1-Score: 0.8713 - Accuracy-Score: 0.8713 - AUROC: 0.9653 - AP: 0.8618
[37m2024-06-28 09:02:14,006 [INFO] - Epoch: 12/50
[37m2024-06-28 09:02:14,007 [INFO] - Extracting training cells
[37m2024-06-28 09:02:23,032 [INFO] - Extraction detection metrics - F1: 0.735, Precision: 0.849, Recall: 0.673, Detected-Cells: 4418
[37m2024-06-28 09:02:23,180 [INFO] - Training epoch stats:     Loss: 0.1912 - F1-Score: 0.9255 - Accuracy-Score: 0.9255 - AUROC: 0.9884 - AP: 0.9555
[37m2024-06-28 09:02:23,308 [INFO] - Validation epoch stats:   Loss: 0.3796 - F1-Score: 0.8570 - Accuracy-Score: 0.8570 - AUROC: 0.9651 - AP: 0.8631
[37m2024-06-28 09:02:23,359 [INFO] - Epoch: 13/50
[37m2024-06-28 09:02:23,359 [INFO] - Extracting training cells
[37m2024-06-28 09:02:31,725 [INFO] - Extraction detection metrics - F1: 0.768, Precision: 0.837, Recall: 0.723, Detected-Cells: 4221
[37m2024-06-28 09:02:31,898 [INFO] - Training epoch stats:     Loss: 0.1932 - F1-Score: 0.9247 - Accuracy-Score: 0.9247 - AUROC: 0.9883 - AP: 0.9449
[37m2024-06-28 09:02:32,047 [INFO] - Validation epoch stats:   Loss: 0.3513 - F1-Score: 0.8637 - Accuracy-Score: 0.8637 - AUROC: 0.9667 - AP: 0.8504
[37m2024-06-28 09:02:32,106 [INFO] - Epoch: 14/50
[37m2024-06-28 09:02:32,107 [INFO] - Extracting training cells
[37m2024-06-28 09:02:39,969 [INFO] - Extraction detection metrics - F1: 0.783, Precision: 0.852, Recall: 0.746, Detected-Cells: 4551
[37m2024-06-28 09:02:40,345 [INFO] - Training epoch stats:     Loss: 0.1860 - F1-Score: 0.9356 - Accuracy-Score: 0.9356 - AUROC: 0.9889 - AP: 0.9595
[37m2024-06-28 09:02:40,496 [INFO] - Validation epoch stats:   Loss: 0.3626 - F1-Score: 0.8694 - Accuracy-Score: 0.8694 - AUROC: 0.9674 - AP: 0.8640
[37m2024-06-28 09:02:40,574 [INFO] - Epoch: 15/50
[37m2024-06-28 09:02:40,575 [INFO] - Extracting training cells
[37m2024-06-28 09:02:49,202 [INFO] - Extraction detection metrics - F1: 0.768, Precision: 0.853, Recall: 0.730, Detected-Cells: 4745
[37m2024-06-28 09:02:49,380 [INFO] - Training epoch stats:     Loss: 0.1813 - F1-Score: 0.9286 - Accuracy-Score: 0.9286 - AUROC: 0.9899 - AP: 0.9571
[37m2024-06-28 09:02:49,529 [INFO] - Validation epoch stats:   Loss: 0.3463 - F1-Score: 0.8708 - Accuracy-Score: 0.8708 - AUROC: 0.9682 - AP: 0.8665
[37m2024-06-28 09:02:49,602 [INFO] - Epoch: 16/50
[37m2024-06-28 09:02:49,602 [INFO] - Extracting training cells
[37m2024-06-28 09:02:57,448 [INFO] - Extraction detection metrics - F1: 0.773, Precision: 0.839, Recall: 0.737, Detected-Cells: 4550
[37m2024-06-28 09:02:57,617 [INFO] - Training epoch stats:     Loss: 0.2275 - F1-Score: 0.9187 - Accuracy-Score: 0.9187 - AUROC: 0.9794 - AP: 0.9178
[37m2024-06-28 09:02:57,764 [INFO] - Validation epoch stats:   Loss: 0.3505 - F1-Score: 0.8642 - Accuracy-Score: 0.8642 - AUROC: 0.9653 - AP: 0.8234
[37m2024-06-28 09:02:57,813 [INFO] - Epoch: 17/50
[37m2024-06-28 09:02:57,814 [INFO] - Extracting training cells
[37m2024-06-28 09:03:06,241 [INFO] - Extraction detection metrics - F1: 0.763, Precision: 0.856, Recall: 0.715, Detected-Cells: 4455
[37m2024-06-28 09:03:06,389 [INFO] - Training epoch stats:     Loss: 0.3278 - F1-Score: 0.8772 - Accuracy-Score: 0.8772 - AUROC: 0.9733 - AP: 0.9207
[37m2024-06-28 09:03:06,510 [INFO] - Validation epoch stats:   Loss: 0.3600 - F1-Score: 0.8623 - Accuracy-Score: 0.8623 - AUROC: 0.9641 - AP: 0.8614
[37m2024-06-28 09:03:06,574 [INFO] - Epoch: 18/50
[37m2024-06-28 09:03:06,574 [INFO] - Extracting training cells
[37m2024-06-28 09:03:14,697 [INFO] - Extraction detection metrics - F1: 0.751, Precision: 0.815, Recall: 0.719, Detected-Cells: 4319
[37m2024-06-28 09:03:14,864 [INFO] - Training epoch stats:     Loss: 0.1920 - F1-Score: 0.9220 - Accuracy-Score: 0.9220 - AUROC: 0.9901 - AP: 0.9620
[37m2024-06-28 09:03:15,016 [INFO] - Validation epoch stats:   Loss: 0.3577 - F1-Score: 0.8647 - Accuracy-Score: 0.8647 - AUROC: 0.9658 - AP: 0.8628
[37m2024-06-28 09:03:15,077 [INFO] - Epoch: 19/50
[37m2024-06-28 09:03:15,078 [INFO] - Extracting training cells
[37m2024-06-28 09:03:23,057 [INFO] - Extraction detection metrics - F1: 0.778, Precision: 0.854, Recall: 0.733, Detected-Cells: 4649
[37m2024-06-28 09:03:23,263 [INFO] - Training epoch stats:     Loss: 0.1606 - F1-Score: 0.9421 - Accuracy-Score: 0.9421 - AUROC: 0.9924 - AP: 0.9707
[37m2024-06-28 09:03:23,408 [INFO] - Validation epoch stats:   Loss: 0.3654 - F1-Score: 0.8699 - Accuracy-Score: 0.8699 - AUROC: 0.9667 - AP: 0.8638
[37m2024-06-28 09:03:23,463 [INFO] - Epoch: 20/50
[37m2024-06-28 09:03:23,464 [INFO] - Extracting training cells
[37m2024-06-28 09:03:32,003 [INFO] - Extraction detection metrics - F1: 0.784, Precision: 0.842, Recall: 0.749, Detected-Cells: 4658
[37m2024-06-28 09:03:32,157 [INFO] - Training epoch stats:     Loss: 0.1422 - F1-Score: 0.9435 - Accuracy-Score: 0.9435 - AUROC: 0.9932 - AP: 0.9698
[37m2024-06-28 09:03:32,285 [INFO] - Validation epoch stats:   Loss: 0.4072 - F1-Score: 0.8493 - Accuracy-Score: 0.8493 - AUROC: 0.9631 - AP: 0.8576
[37m2024-06-28 09:03:32,345 [INFO] - Epoch: 21/50
[37m2024-06-28 09:03:32,346 [INFO] - Extracting training cells
[37m2024-06-28 09:03:40,511 [INFO] - Extraction detection metrics - F1: 0.771, Precision: 0.821, Recall: 0.743, Detected-Cells: 4353
[37m2024-06-28 09:03:40,695 [INFO] - Training epoch stats:     Loss: 0.2944 - F1-Score: 0.8964 - Accuracy-Score: 0.8964 - AUROC: 0.9769 - AP: 0.9310
[37m2024-06-28 09:03:40,818 [INFO] - Validation epoch stats:   Loss: 0.3377 - F1-Score: 0.8728 - Accuracy-Score: 0.8728 - AUROC: 0.9649 - AP: 0.8635
[37m2024-06-28 09:03:40,872 [INFO] - Epoch: 22/50
[37m2024-06-28 09:03:40,873 [INFO] - Extracting training cells
[37m2024-06-28 09:03:48,844 [INFO] - Extraction detection metrics - F1: 0.764, Precision: 0.840, Recall: 0.719, Detected-Cells: 4251
[37m2024-06-28 09:03:49,000 [INFO] - Training epoch stats:     Loss: 0.2942 - F1-Score: 0.8854 - Accuracy-Score: 0.8854 - AUROC: 0.9734 - AP: 0.9139
[37m2024-06-28 09:03:49,155 [INFO] - Validation epoch stats:   Loss: 0.3656 - F1-Score: 0.8584 - Accuracy-Score: 0.8584 - AUROC: 0.9604 - AP: 0.8473
[37m2024-06-28 09:03:49,212 [INFO] - Epoch: 23/50
[37m2024-06-28 09:03:49,214 [INFO] - Extracting training cells
[37m2024-06-28 09:03:56,889 [INFO] - Extraction detection metrics - F1: 0.800, Precision: 0.861, Recall: 0.766, Detected-Cells: 4802
[37m2024-06-28 09:03:57,061 [INFO] - Training epoch stats:     Loss: 0.1354 - F1-Score: 0.9488 - Accuracy-Score: 0.9488 - AUROC: 0.9944 - AP: 0.9764
[37m2024-06-28 09:03:57,204 [INFO] - Validation epoch stats:   Loss: 0.3697 - F1-Score: 0.8708 - Accuracy-Score: 0.8708 - AUROC: 0.9655 - AP: 0.8611
[37m2024-06-28 09:03:57,257 [INFO] - Epoch: 24/50
[37m2024-06-28 09:03:57,258 [INFO] - Extracting training cells
[37m2024-06-28 09:04:06,077 [INFO] - Extraction detection metrics - F1: 0.744, Precision: 0.826, Recall: 0.703, Detected-Cells: 4389
[37m2024-06-28 09:04:06,223 [INFO] - Training epoch stats:     Loss: 0.1490 - F1-Score: 0.9414 - Accuracy-Score: 0.9414 - AUROC: 0.9928 - AP: 0.9742
[37m2024-06-28 09:04:06,371 [INFO] - Validation epoch stats:   Loss: 0.3831 - F1-Score: 0.8596 - Accuracy-Score: 0.8596 - AUROC: 0.9604 - AP: 0.8527
[37m2024-06-28 09:04:06,426 [INFO] - Epoch: 25/50
[37m2024-06-28 09:04:06,426 [INFO] - Extracting training cells
[37m2024-06-28 09:04:14,867 [INFO] - Extraction detection metrics - F1: 0.746, Precision: 0.831, Recall: 0.696, Detected-Cells: 4010
[37m2024-06-28 09:04:15,026 [INFO] - Training epoch stats:     Loss: 0.2829 - F1-Score: 0.9097 - Accuracy-Score: 0.9097 - AUROC: 0.9846 - AP: 0.9538
[37m2024-06-28 09:04:15,200 [INFO] - Validation epoch stats:   Loss: 0.3570 - F1-Score: 0.8675 - Accuracy-Score: 0.8675 - AUROC: 0.9622 - AP: 0.8557
[37m2024-06-28 09:04:15,259 [INFO] - Epoch: 26/50
[37m2024-06-28 09:04:15,260 [INFO] - Extracting training cells
[37m2024-06-28 09:04:23,425 [INFO] - Extraction detection metrics - F1: 0.767, Precision: 0.844, Recall: 0.728, Detected-Cells: 4713
[37m2024-06-28 09:04:23,618 [INFO] - Training epoch stats:     Loss: 0.1355 - F1-Score: 0.9501 - Accuracy-Score: 0.9501 - AUROC: 0.9947 - AP: 0.9797
[37m2024-06-28 09:04:23,770 [INFO] - Validation epoch stats:   Loss: 0.3490 - F1-Score: 0.8730 - Accuracy-Score: 0.8730 - AUROC: 0.9634 - AP: 0.8580
[37m2024-06-28 09:04:23,771 [INFO] - Performing early stopping!
[37m2024-06-28 09:04:23,776 [INFO] - Finished run i4g109yf
