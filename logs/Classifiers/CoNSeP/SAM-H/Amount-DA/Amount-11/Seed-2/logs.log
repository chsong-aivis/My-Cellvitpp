[37m2024-06-28 07:36:19,305 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-06-28 07:36:19,306 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount-DA/2024-06-28T073610_Amount-11-Seed-2
[37m2024-06-28 07:36:19,374 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fa9d8f5c7f0>]
[37m2024-06-28 07:36:19,375 [INFO] - Using GPU: cuda:0
[37m2024-06-28 07:36:19,380 [INFO] - Using device: cuda:0
[37m2024-06-28 07:36:19,385 [INFO] - Loss function:
[37m2024-06-28 07:36:19,390 [INFO] - CrossEntropyLoss()
[37m2024-06-28 07:36:37,175 [INFO] - <All keys matched successfully>
[37m2024-06-28 07:36:38,739 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-06-28 07:36:38,741 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-06-28 07:36:38,746 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-06-28 07:36:38,752 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-06-28 07:36:38,769 [INFO] - Caching datasets
[37m2024-06-28 07:36:39,833 [INFO] - Instantiate Trainer
[37m2024-06-28 07:36:39,837 [INFO] - Calling Trainer Fit
[37m2024-06-28 07:36:39,839 [INFO] - Starting training, total number of epochs: 50
[37m2024-06-28 07:36:39,844 [INFO] - Epoch: 1/50
[37m2024-06-28 07:36:39,849 [INFO] - Extracting training cells
[37m2024-06-28 07:36:52,088 [INFO] - Extraction detection metrics - F1: 0.768, Precision: 0.842, Recall: 0.719, Detected-Cells: 4465
[37m2024-06-28 07:36:52,338 [INFO] - Training epoch stats:     Loss: 0.5213 - F1-Score: 0.8060 - Accuracy-Score: 0.8060 - AUROC: 0.9050 - AP: 0.7142
[37m2024-06-28 07:36:53,606 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-06-28 07:36:53,725 [INFO] - Validation epoch stats:   Loss: 0.3699 - F1-Score: 0.8678 - Accuracy-Score: 0.8678 - AUROC: 0.9552 - AP: 0.8345
[37m2024-06-28 07:36:53,726 [INFO] - New best model - save checkpoint
[37m2024-06-28 07:36:53,867 [INFO] - Epoch: 2/50
[37m2024-06-28 07:36:53,868 [INFO] - Extracting training cells
[37m2024-06-28 07:37:01,380 [INFO] - Extraction detection metrics - F1: 0.779, Precision: 0.847, Recall: 0.737, Detected-Cells: 4497
[37m2024-06-28 07:37:01,561 [INFO] - Training epoch stats:     Loss: 0.3333 - F1-Score: 0.8922 - Accuracy-Score: 0.8922 - AUROC: 0.9528 - AP: 0.7988
[37m2024-06-28 07:37:01,707 [INFO] - Validation epoch stats:   Loss: 0.3615 - F1-Score: 0.8613 - Accuracy-Score: 0.8613 - AUROC: 0.9562 - AP: 0.7403
[37m2024-06-28 07:37:01,708 [INFO] - New best model - save checkpoint
[37m2024-06-28 07:37:01,876 [INFO] - Epoch: 3/50
[37m2024-06-28 07:37:01,877 [INFO] - Extracting training cells
[37m2024-06-28 07:37:10,298 [INFO] - Extraction detection metrics - F1: 0.786, Precision: 0.849, Recall: 0.755, Detected-Cells: 4553
[37m2024-06-28 07:37:10,465 [INFO] - Training epoch stats:     Loss: 0.3226 - F1-Score: 0.8785 - Accuracy-Score: 0.8785 - AUROC: 0.9666 - AP: 0.8578
[37m2024-06-28 07:37:10,613 [INFO] - Validation epoch stats:   Loss: 0.3685 - F1-Score: 0.8491 - Accuracy-Score: 0.8491 - AUROC: 0.9616 - AP: 0.8450
[37m2024-06-28 07:37:10,614 [INFO] - New best model - save checkpoint
[37m2024-06-28 07:37:10,804 [INFO] - Epoch: 4/50
[37m2024-06-28 07:37:10,805 [INFO] - Extracting training cells
[37m2024-06-28 07:37:19,287 [INFO] - Extraction detection metrics - F1: 0.766, Precision: 0.841, Recall: 0.728, Detected-Cells: 4178
[37m2024-06-28 07:37:19,428 [INFO] - Training epoch stats:     Loss: 0.2936 - F1-Score: 0.8935 - Accuracy-Score: 0.8935 - AUROC: 0.9742 - AP: 0.9054
[37m2024-06-28 07:37:19,549 [INFO] - Validation epoch stats:   Loss: 0.3512 - F1-Score: 0.8678 - Accuracy-Score: 0.8678 - AUROC: 0.9591 - AP: 0.8447
[37m2024-06-28 07:37:19,603 [INFO] - Epoch: 5/50
[37m2024-06-28 07:37:19,604 [INFO] - Extracting training cells
[37m2024-06-28 07:37:28,222 [INFO] - Extraction detection metrics - F1: 0.761, Precision: 0.831, Recall: 0.720, Detected-Cells: 4508
[37m2024-06-28 07:37:28,362 [INFO] - Training epoch stats:     Loss: 0.3374 - F1-Score: 0.8824 - Accuracy-Score: 0.8824 - AUROC: 0.9642 - AP: 0.8221
[37m2024-06-28 07:37:28,508 [INFO] - Validation epoch stats:   Loss: 0.3658 - F1-Score: 0.8594 - Accuracy-Score: 0.8594 - AUROC: 0.9562 - AP: 0.7259
[37m2024-06-28 07:37:28,563 [INFO] - Epoch: 6/50
[37m2024-06-28 07:37:28,564 [INFO] - Extracting training cells
[37m2024-06-28 07:37:37,139 [INFO] - Extraction detection metrics - F1: 0.769, Precision: 0.841, Recall: 0.728, Detected-Cells: 4609
[37m2024-06-28 07:37:37,341 [INFO] - Training epoch stats:     Loss: 0.2231 - F1-Score: 0.9110 - Accuracy-Score: 0.9110 - AUROC: 0.9837 - AP: 0.9180
[37m2024-06-28 07:37:37,488 [INFO] - Validation epoch stats:   Loss: 0.3337 - F1-Score: 0.8728 - Accuracy-Score: 0.8728 - AUROC: 0.9666 - AP: 0.8558
[37m2024-06-28 07:37:37,489 [INFO] - New best model - save checkpoint
[37m2024-06-28 07:37:37,660 [INFO] - Epoch: 7/50
[37m2024-06-28 07:37:37,661 [INFO] - Extracting training cells
[37m2024-06-28 07:37:45,680 [INFO] - Extraction detection metrics - F1: 0.775, Precision: 0.841, Recall: 0.732, Detected-Cells: 4594
[37m2024-06-28 07:37:45,845 [INFO] - Training epoch stats:     Loss: 0.2127 - F1-Score: 0.9149 - Accuracy-Score: 0.9149 - AUROC: 0.9871 - AP: 0.9421
[37m2024-06-28 07:37:45,966 [INFO] - Validation epoch stats:   Loss: 0.3186 - F1-Score: 0.8740 - Accuracy-Score: 0.8740 - AUROC: 0.9705 - AP: 0.8678
[37m2024-06-28 07:37:45,967 [INFO] - New best model - save checkpoint
[37m2024-06-28 07:37:46,146 [INFO] - Epoch: 8/50
[37m2024-06-28 07:37:46,147 [INFO] - Extracting training cells
[37m2024-06-28 07:37:54,203 [INFO] - Extraction detection metrics - F1: 0.782, Precision: 0.848, Recall: 0.749, Detected-Cells: 4497
[37m2024-06-28 07:37:54,380 [INFO] - Training epoch stats:     Loss: 0.3772 - F1-Score: 0.8710 - Accuracy-Score: 0.8710 - AUROC: 0.9641 - AP: 0.8858
[37m2024-06-28 07:37:54,525 [INFO] - Validation epoch stats:   Loss: 0.3480 - F1-Score: 0.8651 - Accuracy-Score: 0.8651 - AUROC: 0.9664 - AP: 0.8597
[37m2024-06-28 07:37:54,585 [INFO] - Epoch: 9/50
[37m2024-06-28 07:37:54,586 [INFO] - Extracting training cells
[37m2024-06-28 07:38:02,554 [INFO] - Extraction detection metrics - F1: 0.779, Precision: 0.853, Recall: 0.731, Detected-Cells: 4660
[37m2024-06-28 07:38:02,753 [INFO] - Training epoch stats:     Loss: 0.2326 - F1-Score: 0.9197 - Accuracy-Score: 0.9197 - AUROC: 0.9839 - AP: 0.9322
[37m2024-06-28 07:38:02,911 [INFO] - Validation epoch stats:   Loss: 0.3400 - F1-Score: 0.8713 - Accuracy-Score: 0.8713 - AUROC: 0.9697 - AP: 0.8683
[37m2024-06-28 07:38:02,979 [INFO] - Epoch: 10/50
[37m2024-06-28 07:38:02,980 [INFO] - Extracting training cells
[37m2024-06-28 07:38:11,153 [INFO] - Extraction detection metrics - F1: 0.771, Precision: 0.837, Recall: 0.737, Detected-Cells: 4069
[37m2024-06-28 07:38:11,323 [INFO] - Training epoch stats:     Loss: 0.3535 - F1-Score: 0.8756 - Accuracy-Score: 0.8756 - AUROC: 0.9691 - AP: 0.9201
[37m2024-06-28 07:38:11,479 [INFO] - Validation epoch stats:   Loss: 0.3716 - F1-Score: 0.8555 - Accuracy-Score: 0.8555 - AUROC: 0.9642 - AP: 0.8584
[37m2024-06-28 07:38:11,537 [INFO] - Epoch: 11/50
[37m2024-06-28 07:38:11,537 [INFO] - Extracting training cells
[37m2024-06-28 07:38:19,740 [INFO] - Extraction detection metrics - F1: 0.745, Precision: 0.815, Recall: 0.702, Detected-Cells: 4239
[37m2024-06-28 07:38:19,884 [INFO] - Training epoch stats:     Loss: 0.3575 - F1-Score: 0.8627 - Accuracy-Score: 0.8627 - AUROC: 0.9679 - AP: 0.8953
[37m2024-06-28 07:38:20,014 [INFO] - Validation epoch stats:   Loss: 0.3538 - F1-Score: 0.8706 - Accuracy-Score: 0.8706 - AUROC: 0.9670 - AP: 0.8621
[37m2024-06-28 07:38:20,087 [INFO] - Epoch: 12/50
[37m2024-06-28 07:38:20,087 [INFO] - Extracting training cells
[37m2024-06-28 07:38:27,033 [INFO] - Extraction detection metrics - F1: 0.793, Precision: 0.842, Recall: 0.765, Detected-Cells: 3836
[37m2024-06-28 07:38:27,186 [INFO] - Training epoch stats:     Loss: 0.2767 - F1-Score: 0.9020 - Accuracy-Score: 0.9020 - AUROC: 0.9791 - AP: 0.9296
[37m2024-06-28 07:38:27,337 [INFO] - Validation epoch stats:   Loss: 0.3615 - F1-Score: 0.8608 - Accuracy-Score: 0.8608 - AUROC: 0.9625 - AP: 0.8573
[37m2024-06-28 07:38:27,396 [INFO] - Epoch: 13/50
[37m2024-06-28 07:38:27,397 [INFO] - Extracting training cells
[37m2024-06-28 07:38:35,683 [INFO] - Extraction detection metrics - F1: 0.787, Precision: 0.825, Recall: 0.765, Detected-Cells: 4726
[37m2024-06-28 07:38:35,903 [INFO] - Training epoch stats:     Loss: 0.2039 - F1-Score: 0.9245 - Accuracy-Score: 0.9245 - AUROC: 0.9880 - AP: 0.9493
[37m2024-06-28 07:38:36,078 [INFO] - Validation epoch stats:   Loss: 0.3278 - F1-Score: 0.8788 - Accuracy-Score: 0.8788 - AUROC: 0.9667 - AP: 0.8637
[37m2024-06-28 07:38:36,140 [INFO] - Epoch: 14/50
[37m2024-06-28 07:38:36,140 [INFO] - Extracting training cells
[37m2024-06-28 07:38:44,167 [INFO] - Extraction detection metrics - F1: 0.763, Precision: 0.837, Recall: 0.724, Detected-Cells: 4663
[37m2024-06-28 07:38:44,358 [INFO] - Training epoch stats:     Loss: 0.3101 - F1-Score: 0.9003 - Accuracy-Score: 0.9003 - AUROC: 0.9652 - AP: 0.8869
[37m2024-06-28 07:38:44,506 [INFO] - Validation epoch stats:   Loss: 0.3460 - F1-Score: 0.8641 - Accuracy-Score: 0.8641 - AUROC: 0.9583 - AP: 0.8464
[37m2024-06-28 07:38:44,590 [INFO] - Epoch: 15/50
[37m2024-06-28 07:38:44,591 [INFO] - Extracting training cells
[37m2024-06-28 07:38:52,797 [INFO] - Extraction detection metrics - F1: 0.776, Precision: 0.849, Recall: 0.733, Detected-Cells: 4016
[37m2024-06-28 07:38:52,940 [INFO] - Training epoch stats:     Loss: 0.3805 - F1-Score: 0.8508 - Accuracy-Score: 0.8508 - AUROC: 0.9664 - AP: 0.8980
[37m2024-06-28 07:38:53,062 [INFO] - Validation epoch stats:   Loss: 0.3474 - F1-Score: 0.8673 - Accuracy-Score: 0.8673 - AUROC: 0.9630 - AP: 0.8581
[37m2024-06-28 07:38:53,133 [INFO] - Epoch: 16/50
[37m2024-06-28 07:38:53,133 [INFO] - Extracting training cells
[37m2024-06-28 07:39:01,006 [INFO] - Extraction detection metrics - F1: 0.766, Precision: 0.835, Recall: 0.727, Detected-Cells: 4135
[37m2024-06-28 07:39:01,167 [INFO] - Training epoch stats:     Loss: 0.2763 - F1-Score: 0.8955 - Accuracy-Score: 0.8955 - AUROC: 0.9811 - AP: 0.9434
[37m2024-06-28 07:39:01,310 [INFO] - Validation epoch stats:   Loss: 0.3172 - F1-Score: 0.8790 - Accuracy-Score: 0.8790 - AUROC: 0.9667 - AP: 0.8640
[37m2024-06-28 07:39:01,395 [INFO] - Epoch: 17/50
[37m2024-06-28 07:39:01,396 [INFO] - Extracting training cells
[37m2024-06-28 07:39:09,923 [INFO] - Extraction detection metrics - F1: 0.766, Precision: 0.836, Recall: 0.727, Detected-Cells: 4656
[37m2024-06-28 07:39:10,107 [INFO] - Training epoch stats:     Loss: 0.1724 - F1-Score: 0.9338 - Accuracy-Score: 0.9338 - AUROC: 0.9911 - AP: 0.9632
[37m2024-06-28 07:39:10,254 [INFO] - Validation epoch stats:   Loss: 0.3155 - F1-Score: 0.8768 - Accuracy-Score: 0.8768 - AUROC: 0.9683 - AP: 0.8663
[37m2024-06-28 07:39:10,357 [INFO] - Epoch: 18/50
[37m2024-06-28 07:39:10,358 [INFO] - Extracting training cells
[37m2024-06-28 07:39:18,603 [INFO] - Extraction detection metrics - F1: 0.773, Precision: 0.844, Recall: 0.731, Detected-Cells: 4684
[37m2024-06-28 07:39:18,778 [INFO] - Training epoch stats:     Loss: 0.1536 - F1-Score: 0.9413 - Accuracy-Score: 0.9413 - AUROC: 0.9924 - AP: 0.9657
[37m2024-06-28 07:39:18,924 [INFO] - Validation epoch stats:   Loss: 0.3230 - F1-Score: 0.8812 - Accuracy-Score: 0.8812 - AUROC: 0.9673 - AP: 0.8662
[37m2024-06-28 07:39:18,981 [INFO] - Epoch: 19/50
[37m2024-06-28 07:39:18,982 [INFO] - Extracting training cells
[37m2024-06-28 07:39:27,550 [INFO] - Extraction detection metrics - F1: 0.776, Precision: 0.827, Recall: 0.743, Detected-Cells: 4627
[37m2024-06-28 07:39:27,706 [INFO] - Training epoch stats:     Loss: 0.1870 - F1-Score: 0.9263 - Accuracy-Score: 0.9263 - AUROC: 0.9895 - AP: 0.9538
[37m2024-06-28 07:39:27,862 [INFO] - Validation epoch stats:   Loss: 0.3269 - F1-Score: 0.8750 - Accuracy-Score: 0.8750 - AUROC: 0.9665 - AP: 0.8668
[37m2024-06-28 07:39:27,927 [INFO] - Epoch: 20/50
[37m2024-06-28 07:39:27,927 [INFO] - Extracting training cells
[37m2024-06-28 07:39:35,610 [INFO] - Extraction detection metrics - F1: 0.768, Precision: 0.851, Recall: 0.729, Detected-Cells: 4770
[37m2024-06-28 07:39:35,802 [INFO] - Training epoch stats:     Loss: 0.1568 - F1-Score: 0.9394 - Accuracy-Score: 0.9394 - AUROC: 0.9926 - AP: 0.9669
[37m2024-06-28 07:39:35,952 [INFO] - Validation epoch stats:   Loss: 0.3350 - F1-Score: 0.8742 - Accuracy-Score: 0.8742 - AUROC: 0.9653 - AP: 0.8699
[37m2024-06-28 07:39:36,015 [INFO] - Epoch: 21/50
[37m2024-06-28 07:39:36,015 [INFO] - Extracting training cells
[37m2024-06-28 07:39:44,354 [INFO] - Extraction detection metrics - F1: 0.784, Precision: 0.837, Recall: 0.754, Detected-Cells: 4487
[37m2024-06-28 07:39:44,507 [INFO] - Training epoch stats:     Loss: 0.3731 - F1-Score: 0.8707 - Accuracy-Score: 0.8707 - AUROC: 0.9704 - AP: 0.9330
[37m2024-06-28 07:39:44,627 [INFO] - Validation epoch stats:   Loss: 0.3535 - F1-Score: 0.8694 - Accuracy-Score: 0.8694 - AUROC: 0.9653 - AP: 0.8665
[37m2024-06-28 07:39:44,688 [INFO] - Epoch: 22/50
[37m2024-06-28 07:39:44,688 [INFO] - Extracting training cells
[37m2024-06-28 07:39:52,082 [INFO] - Extraction detection metrics - F1: 0.791, Precision: 0.856, Recall: 0.753, Detected-Cells: 4436
[37m2024-06-28 07:39:52,240 [INFO] - Training epoch stats:     Loss: 0.2053 - F1-Score: 0.9206 - Accuracy-Score: 0.9206 - AUROC: 0.9870 - AP: 0.9489
[37m2024-06-28 07:39:52,359 [INFO] - Validation epoch stats:   Loss: 0.3485 - F1-Score: 0.8701 - Accuracy-Score: 0.8701 - AUROC: 0.9679 - AP: 0.8661
[37m2024-06-28 07:39:52,420 [INFO] - Epoch: 23/50
[37m2024-06-28 07:39:52,421 [INFO] - Extracting training cells
[37m2024-06-28 07:40:00,104 [INFO] - Extraction detection metrics - F1: 0.749, Precision: 0.842, Recall: 0.693, Detected-Cells: 3914
[37m2024-06-28 07:40:00,268 [INFO] - Training epoch stats:     Loss: 0.1916 - F1-Score: 0.9269 - Accuracy-Score: 0.9269 - AUROC: 0.9891 - AP: 0.9544
[37m2024-06-28 07:40:00,421 [INFO] - Validation epoch stats:   Loss: 0.3521 - F1-Score: 0.8737 - Accuracy-Score: 0.8737 - AUROC: 0.9666 - AP: 0.8681
[37m2024-06-28 07:40:00,490 [INFO] - Epoch: 24/50
[37m2024-06-28 07:40:00,491 [INFO] - Extracting training cells
[37m2024-06-28 07:40:08,815 [INFO] - Extraction detection metrics - F1: 0.773, Precision: 0.858, Recall: 0.720, Detected-Cells: 4596
[37m2024-06-28 07:40:08,972 [INFO] - Training epoch stats:     Loss: 0.1490 - F1-Score: 0.9456 - Accuracy-Score: 0.9456 - AUROC: 0.9932 - AP: 0.9715
[37m2024-06-28 07:40:09,105 [INFO] - Validation epoch stats:   Loss: 0.3368 - F1-Score: 0.8802 - Accuracy-Score: 0.8802 - AUROC: 0.9632 - AP: 0.8646
[37m2024-06-28 07:40:09,164 [INFO] - Epoch: 25/50
[37m2024-06-28 07:40:09,165 [INFO] - Extracting training cells
[37m2024-06-28 07:40:17,057 [INFO] - Extraction detection metrics - F1: 0.791, Precision: 0.844, Recall: 0.762, Detected-Cells: 4801
[37m2024-06-28 07:40:17,244 [INFO] - Training epoch stats:     Loss: 0.1469 - F1-Score: 0.9394 - Accuracy-Score: 0.9394 - AUROC: 0.9936 - AP: 0.9735
[37m2024-06-28 07:40:17,396 [INFO] - Validation epoch stats:   Loss: 0.3403 - F1-Score: 0.8780 - Accuracy-Score: 0.8780 - AUROC: 0.9623 - AP: 0.8649
[37m2024-06-28 07:40:17,465 [INFO] - Epoch: 26/50
[37m2024-06-28 07:40:17,466 [INFO] - Extracting training cells
[37m2024-06-28 07:40:25,388 [INFO] - Extraction detection metrics - F1: 0.783, Precision: 0.853, Recall: 0.743, Detected-Cells: 4718
[37m2024-06-28 07:40:25,538 [INFO] - Training epoch stats:     Loss: 0.1260 - F1-Score: 0.9532 - Accuracy-Score: 0.9532 - AUROC: 0.9954 - AP: 0.9795
[37m2024-06-28 07:40:25,657 [INFO] - Validation epoch stats:   Loss: 0.3323 - F1-Score: 0.8831 - Accuracy-Score: 0.8831 - AUROC: 0.9644 - AP: 0.8667
[37m2024-06-28 07:40:25,725 [INFO] - Epoch: 27/50
[37m2024-06-28 07:40:25,726 [INFO] - Extracting training cells
[37m2024-06-28 07:40:33,365 [INFO] - Extraction detection metrics - F1: 0.772, Precision: 0.843, Recall: 0.733, Detected-Cells: 4634
[37m2024-06-28 07:40:33,542 [INFO] - Training epoch stats:     Loss: 0.1380 - F1-Score: 0.9452 - Accuracy-Score: 0.9452 - AUROC: 0.9945 - AP: 0.9743
[37m2024-06-28 07:40:33,692 [INFO] - Validation epoch stats:   Loss: 0.3388 - F1-Score: 0.8773 - Accuracy-Score: 0.8773 - AUROC: 0.9646 - AP: 0.8680
[37m2024-06-28 07:40:33,693 [INFO] - Performing early stopping!
[37m2024-06-28 07:40:33,698 [INFO] - Finished run v9inx8cg
