[37m2024-05-16 13:37:59,750 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-05-16 13:37:59,753 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/CoNSeP/SAM-H/Amount-DA/2024-05-16T133744_Amount-5
[37m2024-05-16 13:37:59,814 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f614384e770>]
[37m2024-05-16 13:37:59,815 [INFO] - Using GPU: cuda:0
[37m2024-05-16 13:37:59,827 [INFO] - Using device: cuda:0
[37m2024-05-16 13:37:59,839 [INFO] - Loss function:
[37m2024-05-16 13:37:59,850 [INFO] - CrossEntropyLoss()
[37m2024-05-16 13:38:11,458 [INFO] - <All keys matched successfully>
[37m2024-05-16 13:38:12,628 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 164,484
Trainable params: 164,484
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-05-16 13:38:12,630 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-05-16 13:38:12,640 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0005, 'weight_decay': 0.0005}
[37m2024-05-16 13:38:12,651 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-05-16 13:38:12,682 [INFO] - Caching datasets
[37m2024-05-16 13:38:13,538 [INFO] - Instantiate Trainer
[37m2024-05-16 13:38:13,543 [INFO] - Calling Trainer Fit
[37m2024-05-16 13:38:13,551 [INFO] - Starting training, total number of epochs: 50
[37m2024-05-16 13:38:13,562 [INFO] - Epoch: 1/50
[37m2024-05-16 13:38:13,572 [INFO] - Extracting training cells
[37m2024-05-16 13:38:20,291 [INFO] - Extraction detection metrics - F1: 0.742, Precision: 0.875, Recall: 0.666, Detected-Cells: 2038
[37m2024-05-16 13:38:20,468 [INFO] - Training epoch stats:     Loss: 0.6505 - F1-Score: 0.7537 - Accuracy-Score: 0.7537 - AUROC: 0.8877 - AP: 0.6938
[37m2024-05-16 13:38:21,205 [INFO] - Loaded dataset from cache: /Consep/cache/1f728da27af6daed7b166ce5447f5dec18916e3679cb7b74ddaefb4a67df10d2.h5
[37m2024-05-16 13:38:21,299 [INFO] - Validation epoch stats:   Loss: 0.5608 - F1-Score: 0.7896 - Accuracy-Score: 0.7896 - AUROC: 0.9303 - AP: 0.8022
[37m2024-05-16 13:38:21,300 [INFO] - New best model - save checkpoint
[37m2024-05-16 13:38:21,550 [INFO] - Epoch: 2/50
[37m2024-05-16 13:38:21,552 [INFO] - Extracting training cells
[37m2024-05-16 13:38:25,094 [INFO] - Extraction detection metrics - F1: 0.752, Precision: 0.883, Recall: 0.677, Detected-Cells: 2038
[37m2024-05-16 13:38:25,178 [INFO] - Training epoch stats:     Loss: 0.3288 - F1-Score: 0.8822 - Accuracy-Score: 0.8822 - AUROC: 0.9683 - AP: 0.8868
[37m2024-05-16 13:38:25,315 [INFO] - Validation epoch stats:   Loss: 0.4561 - F1-Score: 0.8376 - Accuracy-Score: 0.8376 - AUROC: 0.9460 - AP: 0.8295
[37m2024-05-16 13:38:25,316 [INFO] - New best model - save checkpoint
[37m2024-05-16 13:38:25,551 [INFO] - Epoch: 3/50
[37m2024-05-16 13:38:25,552 [INFO] - Extracting training cells
[37m2024-05-16 13:38:29,930 [INFO] - Extraction detection metrics - F1: 0.725, Precision: 0.891, Recall: 0.635, Detected-Cells: 2002
[37m2024-05-16 13:38:30,002 [INFO] - Training epoch stats:     Loss: 0.3066 - F1-Score: 0.8996 - Accuracy-Score: 0.8996 - AUROC: 0.9748 - AP: 0.9110
[37m2024-05-16 13:38:30,104 [INFO] - Validation epoch stats:   Loss: 0.4805 - F1-Score: 0.8323 - Accuracy-Score: 0.8323 - AUROC: 0.9438 - AP: 0.8252
[37m2024-05-16 13:38:30,165 [INFO] - Epoch: 4/50
[37m2024-05-16 13:38:30,166 [INFO] - Extracting training cells
[37m2024-05-16 13:38:33,891 [INFO] - Extraction detection metrics - F1: 0.761, Precision: 0.877, Recall: 0.691, Detected-Cells: 2070
[37m2024-05-16 13:38:33,981 [INFO] - Training epoch stats:     Loss: 0.2620 - F1-Score: 0.9053 - Accuracy-Score: 0.9053 - AUROC: 0.9798 - AP: 0.9228
[37m2024-05-16 13:38:34,121 [INFO] - Validation epoch stats:   Loss: 0.4781 - F1-Score: 0.8284 - Accuracy-Score: 0.8284 - AUROC: 0.9397 - AP: 0.8246
[37m2024-05-16 13:38:34,188 [INFO] - Epoch: 5/50
[37m2024-05-16 13:38:34,188 [INFO] - Extracting training cells
[37m2024-05-16 13:38:38,880 [INFO] - Extraction detection metrics - F1: 0.758, Precision: 0.898, Recall: 0.681, Detected-Cells: 2019
[37m2024-05-16 13:38:38,957 [INFO] - Training epoch stats:     Loss: 0.2591 - F1-Score: 0.9074 - Accuracy-Score: 0.9074 - AUROC: 0.9801 - AP: 0.9356
[37m2024-05-16 13:38:39,057 [INFO] - Validation epoch stats:   Loss: 0.5009 - F1-Score: 0.8321 - Accuracy-Score: 0.8321 - AUROC: 0.9413 - AP: 0.8223
[37m2024-05-16 13:38:39,122 [INFO] - Epoch: 6/50
[37m2024-05-16 13:38:39,123 [INFO] - Extracting training cells
[37m2024-05-16 13:38:42,820 [INFO] - Extraction detection metrics - F1: 0.712, Precision: 0.878, Recall: 0.632, Detected-Cells: 1984
[37m2024-05-16 13:38:43,158 [INFO] - Training epoch stats:     Loss: 0.2936 - F1-Score: 0.8891 - Accuracy-Score: 0.8891 - AUROC: 0.9754 - AP: 0.9194
[37m2024-05-16 13:38:43,308 [INFO] - Validation epoch stats:   Loss: 0.4615 - F1-Score: 0.8354 - Accuracy-Score: 0.8354 - AUROC: 0.9465 - AP: 0.8252
[37m2024-05-16 13:38:43,309 [INFO] - New best model - save checkpoint
[37m2024-05-16 13:38:43,574 [INFO] - Epoch: 7/50
[37m2024-05-16 13:38:43,574 [INFO] - Extracting training cells
[37m2024-05-16 13:38:47,653 [INFO] - Extraction detection metrics - F1: 0.740, Precision: 0.867, Recall: 0.661, Detected-Cells: 2001
[37m2024-05-16 13:38:47,726 [INFO] - Training epoch stats:     Loss: 0.2170 - F1-Score: 0.9235 - Accuracy-Score: 0.9235 - AUROC: 0.9864 - AP: 0.9445
[37m2024-05-16 13:38:47,831 [INFO] - Validation epoch stats:   Loss: 0.4588 - F1-Score: 0.8304 - Accuracy-Score: 0.8304 - AUROC: 0.9450 - AP: 0.8332
[37m2024-05-16 13:38:47,889 [INFO] - Epoch: 8/50
[37m2024-05-16 13:38:47,890 [INFO] - Extracting training cells
[37m2024-05-16 13:38:51,808 [INFO] - Extraction detection metrics - F1: 0.753, Precision: 0.876, Recall: 0.680, Detected-Cells: 2058
[37m2024-05-16 13:38:51,891 [INFO] - Training epoch stats:     Loss: 0.2120 - F1-Score: 0.9291 - Accuracy-Score: 0.9291 - AUROC: 0.9895 - AP: 0.9584
[37m2024-05-16 13:38:51,996 [INFO] - Validation epoch stats:   Loss: 0.5089 - F1-Score: 0.8129 - Accuracy-Score: 0.8129 - AUROC: 0.9421 - AP: 0.8278
[37m2024-05-16 13:38:52,065 [INFO] - Epoch: 9/50
[37m2024-05-16 13:38:52,065 [INFO] - Extracting training cells
[37m2024-05-16 13:38:56,409 [INFO] - Extraction detection metrics - F1: 0.718, Precision: 0.846, Recall: 0.634, Detected-Cells: 1721
[37m2024-05-16 13:38:56,470 [INFO] - Training epoch stats:     Loss: 0.9552 - F1-Score: 0.7292 - Accuracy-Score: 0.7292 - AUROC: 0.8702 - AP: 0.7198
[37m2024-05-16 13:38:56,578 [INFO] - Validation epoch stats:   Loss: 0.6287 - F1-Score: 0.7724 - Accuracy-Score: 0.7724 - AUROC: 0.9134 - AP: 0.7841
[37m2024-05-16 13:38:56,640 [INFO] - Epoch: 10/50
[37m2024-05-16 13:38:56,641 [INFO] - Extracting training cells
[37m2024-05-16 13:39:00,065 [INFO] - Extraction detection metrics - F1: 0.726, Precision: 0.864, Recall: 0.642, Detected-Cells: 1919
[37m2024-05-16 13:39:00,154 [INFO] - Training epoch stats:     Loss: 0.4252 - F1-Score: 0.8577 - Accuracy-Score: 0.8577 - AUROC: 0.9670 - AP: 0.9067
[37m2024-05-16 13:39:00,296 [INFO] - Validation epoch stats:   Loss: 0.5427 - F1-Score: 0.7908 - Accuracy-Score: 0.7908 - AUROC: 0.9305 - AP: 0.8074
[37m2024-05-16 13:39:00,364 [INFO] - Epoch: 11/50
[37m2024-05-16 13:39:00,364 [INFO] - Extracting training cells
[37m2024-05-16 13:39:05,506 [INFO] - Extraction detection metrics - F1: 0.730, Precision: 0.869, Recall: 0.643, Detected-Cells: 1873
[37m2024-05-16 13:39:05,596 [INFO] - Training epoch stats:     Loss: 0.2726 - F1-Score: 0.9124 - Accuracy-Score: 0.9124 - AUROC: 0.9828 - AP: 0.9482
[37m2024-05-16 13:39:05,753 [INFO] - Validation epoch stats:   Loss: 0.5112 - F1-Score: 0.8163 - Accuracy-Score: 0.8163 - AUROC: 0.9405 - AP: 0.8196
[37m2024-05-16 13:39:05,821 [INFO] - Epoch: 12/50
[37m2024-05-16 13:39:05,821 [INFO] - Extracting training cells
[37m2024-05-16 13:39:10,350 [INFO] - Extraction detection metrics - F1: 0.745, Precision: 0.872, Recall: 0.681, Detected-Cells: 2100
[37m2024-05-16 13:39:10,446 [INFO] - Training epoch stats:     Loss: 0.1905 - F1-Score: 0.9367 - Accuracy-Score: 0.9367 - AUROC: 0.9920 - AP: 0.9655
[37m2024-05-16 13:39:10,591 [INFO] - Validation epoch stats:   Loss: 0.5200 - F1-Score: 0.8083 - Accuracy-Score: 0.8083 - AUROC: 0.9384 - AP: 0.8150
[37m2024-05-16 13:39:10,658 [INFO] - Epoch: 13/50
[37m2024-05-16 13:39:10,659 [INFO] - Extracting training cells
[37m2024-05-16 13:39:15,027 [INFO] - Extraction detection metrics - F1: 0.780, Precision: 0.862, Recall: 0.722, Detected-Cells: 2072
[37m2024-05-16 13:39:15,103 [INFO] - Training epoch stats:     Loss: 0.2524 - F1-Score: 0.9180 - Accuracy-Score: 0.9180 - AUROC: 0.9868 - AP: 0.9508
[37m2024-05-16 13:39:15,206 [INFO] - Validation epoch stats:   Loss: 0.5352 - F1-Score: 0.7980 - Accuracy-Score: 0.7980 - AUROC: 0.9374 - AP: 0.8193
[37m2024-05-16 13:39:15,271 [INFO] - Epoch: 14/50
[37m2024-05-16 13:39:15,272 [INFO] - Extracting training cells
[37m2024-05-16 13:39:19,101 [INFO] - Extraction detection metrics - F1: 0.750, Precision: 0.888, Recall: 0.669, Detected-Cells: 2032
[37m2024-05-16 13:39:19,174 [INFO] - Training epoch stats:     Loss: 0.2208 - F1-Score: 0.9183 - Accuracy-Score: 0.9183 - AUROC: 0.9884 - AP: 0.9589
[37m2024-05-16 13:39:19,279 [INFO] - Validation epoch stats:   Loss: 0.5129 - F1-Score: 0.7964 - Accuracy-Score: 0.7964 - AUROC: 0.9391 - AP: 0.8153
[37m2024-05-16 13:39:19,338 [INFO] - Epoch: 15/50
[37m2024-05-16 13:39:19,338 [INFO] - Extracting training cells
[37m2024-05-16 13:39:22,869 [INFO] - Extraction detection metrics - F1: 0.757, Precision: 0.906, Recall: 0.660, Detected-Cells: 1946
[37m2024-05-16 13:39:22,941 [INFO] - Training epoch stats:     Loss: 0.2277 - F1-Score: 0.9260 - Accuracy-Score: 0.9260 - AUROC: 0.9851 - AP: 0.9527
[37m2024-05-16 13:39:23,044 [INFO] - Validation epoch stats:   Loss: 0.4476 - F1-Score: 0.8292 - Accuracy-Score: 0.8292 - AUROC: 0.9432 - AP: 0.8260
[37m2024-05-16 13:39:23,113 [INFO] - Epoch: 16/50
[37m2024-05-16 13:39:23,114 [INFO] - Extracting training cells
[37m2024-05-16 13:39:26,549 [INFO] - Extraction detection metrics - F1: 0.777, Precision: 0.881, Recall: 0.714, Detected-Cells: 2131
[37m2024-05-16 13:39:26,643 [INFO] - Training epoch stats:     Loss: 0.1379 - F1-Score: 0.9489 - Accuracy-Score: 0.9489 - AUROC: 0.9952 - AP: 0.9808
[37m2024-05-16 13:39:26,779 [INFO] - Validation epoch stats:   Loss: 0.5064 - F1-Score: 0.8119 - Accuracy-Score: 0.8119 - AUROC: 0.9412 - AP: 0.8214
[37m2024-05-16 13:39:26,847 [INFO] - Epoch: 17/50
[37m2024-05-16 13:39:26,848 [INFO] - Extracting training cells
[37m2024-05-16 13:39:31,076 [INFO] - Extraction detection metrics - F1: 0.762, Precision: 0.886, Recall: 0.693, Detected-Cells: 2113
[37m2024-05-16 13:39:31,152 [INFO] - Training epoch stats:     Loss: 0.1442 - F1-Score: 0.9484 - Accuracy-Score: 0.9484 - AUROC: 0.9946 - AP: 0.9761
[37m2024-05-16 13:39:31,293 [INFO] - Validation epoch stats:   Loss: 0.5227 - F1-Score: 0.8095 - Accuracy-Score: 0.8095 - AUROC: 0.9408 - AP: 0.8165
[37m2024-05-16 13:39:31,356 [INFO] - Epoch: 18/50
[37m2024-05-16 13:39:31,357 [INFO] - Extracting training cells
[37m2024-05-16 13:39:35,762 [INFO] - Extraction detection metrics - F1: 0.754, Precision: 0.891, Recall: 0.673, Detected-Cells: 1942
[37m2024-05-16 13:39:35,834 [INFO] - Training epoch stats:     Loss: 0.1976 - F1-Score: 0.9274 - Accuracy-Score: 0.9274 - AUROC: 0.9887 - AP: 0.9604
[37m2024-05-16 13:39:35,938 [INFO] - Validation epoch stats:   Loss: 0.5609 - F1-Score: 0.7854 - Accuracy-Score: 0.7854 - AUROC: 0.9366 - AP: 0.8135
[37m2024-05-16 13:39:36,003 [INFO] - Epoch: 19/50
[37m2024-05-16 13:39:36,003 [INFO] - Extracting training cells
[37m2024-05-16 13:39:40,024 [INFO] - Extraction detection metrics - F1: 0.765, Precision: 0.882, Recall: 0.693, Detected-Cells: 2066
[37m2024-05-16 13:39:40,102 [INFO] - Training epoch stats:     Loss: 0.1259 - F1-Score: 0.9569 - Accuracy-Score: 0.9569 - AUROC: 0.9956 - AP: 0.9824
[37m2024-05-16 13:39:40,206 [INFO] - Validation epoch stats:   Loss: 0.4916 - F1-Score: 0.8160 - Accuracy-Score: 0.8160 - AUROC: 0.9462 - AP: 0.8249
[37m2024-05-16 13:39:40,264 [INFO] - Epoch: 20/50
[37m2024-05-16 13:39:40,265 [INFO] - Extracting training cells
[37m2024-05-16 13:39:44,122 [INFO] - Extraction detection metrics - F1: 0.757, Precision: 0.885, Recall: 0.680, Detected-Cells: 1883
[37m2024-05-16 13:39:44,205 [INFO] - Training epoch stats:     Loss: 0.8486 - F1-Score: 0.7823 - Accuracy-Score: 0.7823 - AUROC: 0.9017 - AP: 0.7667
[37m2024-05-16 13:39:44,344 [INFO] - Validation epoch stats:   Loss: 0.5824 - F1-Score: 0.7695 - Accuracy-Score: 0.7695 - AUROC: 0.9240 - AP: 0.7982
[37m2024-05-16 13:39:44,410 [INFO] - Epoch: 21/50
[37m2024-05-16 13:39:44,411 [INFO] - Extracting training cells
[37m2024-05-16 13:39:48,283 [INFO] - Extraction detection metrics - F1: 0.749, Precision: 0.890, Recall: 0.672, Detected-Cells: 2059
[37m2024-05-16 13:39:48,352 [INFO] - Training epoch stats:     Loss: 0.3845 - F1-Score: 0.8630 - Accuracy-Score: 0.8630 - AUROC: 0.9784 - AP: 0.9479
[37m2024-05-16 13:39:48,458 [INFO] - Validation epoch stats:   Loss: 0.4865 - F1-Score: 0.8148 - Accuracy-Score: 0.8148 - AUROC: 0.9339 - AP: 0.8080
[37m2024-05-16 13:39:48,520 [INFO] - Epoch: 22/50
[37m2024-05-16 13:39:48,521 [INFO] - Extracting training cells
[37m2024-05-16 13:39:52,342 [INFO] - Extraction detection metrics - F1: 0.754, Precision: 0.894, Recall: 0.680, Detected-Cells: 2063
[37m2024-05-16 13:39:52,436 [INFO] - Training epoch stats:     Loss: 0.2051 - F1-Score: 0.9447 - Accuracy-Score: 0.9447 - AUROC: 0.9876 - AP: 0.9578
[37m2024-05-16 13:39:52,584 [INFO] - Validation epoch stats:   Loss: 0.5190 - F1-Score: 0.8069 - Accuracy-Score: 0.8069 - AUROC: 0.9424 - AP: 0.8241
[37m2024-05-16 13:39:52,650 [INFO] - Epoch: 23/50
[37m2024-05-16 13:39:52,651 [INFO] - Extracting training cells
[37m2024-05-16 13:39:56,683 [INFO] - Extraction detection metrics - F1: 0.730, Precision: 0.880, Recall: 0.650, Detected-Cells: 1987
[37m2024-05-16 13:39:56,767 [INFO] - Training epoch stats:     Loss: 0.2318 - F1-Score: 0.9230 - Accuracy-Score: 0.9230 - AUROC: 0.9839 - AP: 0.9434
[37m2024-05-16 13:39:56,908 [INFO] - Validation epoch stats:   Loss: 0.5117 - F1-Score: 0.8175 - Accuracy-Score: 0.8175 - AUROC: 0.9431 - AP: 0.8261
[37m2024-05-16 13:39:56,976 [INFO] - Epoch: 24/50
[37m2024-05-16 13:39:56,977 [INFO] - Extracting training cells
[37m2024-05-16 13:40:01,620 [INFO] - Extraction detection metrics - F1: 0.751, Precision: 0.889, Recall: 0.678, Detected-Cells: 2035
[37m2024-05-16 13:40:01,706 [INFO] - Training epoch stats:     Loss: 0.1896 - F1-Score: 0.9229 - Accuracy-Score: 0.9229 - AUROC: 0.9911 - AP: 0.9639
[37m2024-05-16 13:40:01,835 [INFO] - Validation epoch stats:   Loss: 0.5341 - F1-Score: 0.8030 - Accuracy-Score: 0.8030 - AUROC: 0.9375 - AP: 0.8113
[37m2024-05-16 13:40:01,907 [INFO] - Epoch: 25/50
[37m2024-05-16 13:40:01,907 [INFO] - Extracting training cells
[37m2024-05-16 13:40:06,186 [INFO] - Extraction detection metrics - F1: 0.788, Precision: 0.886, Recall: 0.725, Detected-Cells: 2084
[37m2024-05-16 13:40:06,283 [INFO] - Training epoch stats:     Loss: 0.1876 - F1-Score: 0.9237 - Accuracy-Score: 0.9237 - AUROC: 0.9906 - AP: 0.9628
[37m2024-05-16 13:40:06,431 [INFO] - Validation epoch stats:   Loss: 0.5153 - F1-Score: 0.8124 - Accuracy-Score: 0.8124 - AUROC: 0.9376 - AP: 0.8108
[37m2024-05-16 13:40:06,504 [INFO] - Epoch: 26/50
[37m2024-05-16 13:40:06,504 [INFO] - Extracting training cells
[37m2024-05-16 13:40:10,806 [INFO] - Extraction detection metrics - F1: 0.743, Precision: 0.878, Recall: 0.673, Detected-Cells: 2061
[37m2024-05-16 13:40:10,880 [INFO] - Training epoch stats:     Loss: 0.2231 - F1-Score: 0.9185 - Accuracy-Score: 0.9185 - AUROC: 0.9891 - AP: 0.9610
[37m2024-05-16 13:40:11,024 [INFO] - Validation epoch stats:   Loss: 0.5466 - F1-Score: 0.8098 - Accuracy-Score: 0.8098 - AUROC: 0.9348 - AP: 0.8065
[37m2024-05-16 13:40:11,025 [INFO] - Performing early stopping!
[37m2024-05-16 13:40:11,037 [INFO] - Finished run ynvmo2kg
