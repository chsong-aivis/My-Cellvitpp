[37m2024-07-10 06:36:06,523 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-07-10 06:36:06,525 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/NuCLS/Clean-Dataset/lymphocytes/ViT256/2024-07-10T063552_CellViT-ViT256-Classifier-Head-Fold-0
[37m2024-07-10 06:36:06,589 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f4da87e6860>]
[37m2024-07-10 06:36:06,594 [INFO] - Using GPU: cuda:0
[37m2024-07-10 06:36:06,598 [INFO] - Using device: cuda:0
[37m2024-07-10 06:36:06,603 [INFO] - Loss function:
[37m2024-07-10 06:36:06,608 [INFO] - CrossEntropyLoss()
[37m2024-07-10 06:36:09,909 [INFO] - <All keys matched successfully>
[37m2024-07-10 06:36:10,296 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  49,280
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 49,538
Trainable params: 49,538
Non-trainable params: 0
Total mult-adds (M): 0.05
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.20
Estimated Total Size (MB): 0.20
==========================================================================================
[37m2024-07-10 06:36:10,301 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-07-10 06:36:10,309 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00010642981851444748, 'weight_decay': 0.00031863357860979216}
[37m2024-07-10 06:36:10,316 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-07-10 06:36:10,384 [INFO] - Caching datasets
[37m2024-07-10 06:36:24,780 [INFO] - Instantiate Trainer
[37m2024-07-10 06:36:24,789 [INFO] - Calling Trainer Fit
[37m2024-07-10 06:36:24,794 [INFO] - Dataset is cached after first epoch
[37m2024-07-10 06:36:24,801 [INFO] - Starting training, total number of epochs: 50
[37m2024-07-10 06:36:24,811 [INFO] - Epoch: 1/50
[37m2024-07-10 06:36:27,688 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/42b6ac2a5525505b102ffaac83ba8e5ed8a243633cf6b91a7bdc4392110a2155.h5
[37m2024-07-10 06:36:29,737 [INFO] - Training epoch stats:     Loss: 0.5175 - F1-Score: 0.5367 - Accuracy-Score: 0.7811 - AUROC: 0.8479 - AP: 0.6891
[37m2024-07-10 06:36:30,209 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/ef58ec88fed6fe8d0ad6ca1c4c96c1f47b8874cbc167b333ecb554ab056126c0.h5
[37m2024-07-10 06:36:30,498 [INFO] - Validation epoch stats:   Loss: 0.3400 - F1-Score: 0.7631 - Accuracy-Score: 0.8903 - AUROC: 0.9395 - AP: 0.8492
[37m2024-07-10 06:36:30,504 [INFO] - New best model - save checkpoint
[37m2024-07-10 06:36:30,609 [INFO] - Epoch: 2/50
[37m2024-07-10 06:36:32,038 [INFO] - Training epoch stats:     Loss: 0.3528 - F1-Score: 0.7308 - Accuracy-Score: 0.8408 - AUROC: 0.9120 - AP: 0.7885
[37m2024-07-10 06:36:32,331 [INFO] - Validation epoch stats:   Loss: 0.2772 - F1-Score: 0.7734 - Accuracy-Score: 0.8901 - AUROC: 0.9412 - AP: 0.8427
[37m2024-07-10 06:36:32,339 [INFO] - New best model - save checkpoint
[37m2024-07-10 06:36:32,448 [INFO] - Epoch: 3/50
[37m2024-07-10 06:36:34,008 [INFO] - Training epoch stats:     Loss: 0.3228 - F1-Score: 0.7510 - Accuracy-Score: 0.8497 - AUROC: 0.9236 - AP: 0.8138
[37m2024-07-10 06:36:34,324 [INFO] - Validation epoch stats:   Loss: 0.2740 - F1-Score: 0.7789 - Accuracy-Score: 0.8891 - AUROC: 0.9405 - AP: 0.8346
[37m2024-07-10 06:36:34,358 [INFO] - Epoch: 4/50
[37m2024-07-10 06:36:36,104 [INFO] - Training epoch stats:     Loss: 0.3082 - F1-Score: 0.7636 - Accuracy-Score: 0.8556 - AUROC: 0.9299 - AP: 0.8287
[37m2024-07-10 06:36:36,405 [INFO] - Validation epoch stats:   Loss: 0.2745 - F1-Score: 0.7684 - Accuracy-Score: 0.8842 - AUROC: 0.9386 - AP: 0.8252
[37m2024-07-10 06:36:36,522 [INFO] - Epoch: 5/50
[37m2024-07-10 06:36:38,007 [INFO] - Training epoch stats:     Loss: 0.2985 - F1-Score: 0.7751 - Accuracy-Score: 0.8621 - AUROC: 0.9343 - AP: 0.8397
[37m2024-07-10 06:36:38,393 [INFO] - Validation epoch stats:   Loss: 0.2768 - F1-Score: 0.7621 - Accuracy-Score: 0.8806 - AUROC: 0.9364 - AP: 0.8163
[37m2024-07-10 06:36:38,520 [INFO] - Epoch: 6/50
[37m2024-07-10 06:36:40,105 [INFO] - Training epoch stats:     Loss: 0.2923 - F1-Score: 0.7824 - Accuracy-Score: 0.8667 - AUROC: 0.9373 - AP: 0.8454
[37m2024-07-10 06:36:40,589 [INFO] - Validation epoch stats:   Loss: 0.2777 - F1-Score: 0.7558 - Accuracy-Score: 0.8753 - AUROC: 0.9359 - AP: 0.8163
[37m2024-07-10 06:36:40,626 [INFO] - Epoch: 7/50
[37m2024-07-10 06:36:42,607 [INFO] - Training epoch stats:     Loss: 0.2873 - F1-Score: 0.7883 - Accuracy-Score: 0.8701 - AUROC: 0.9394 - AP: 0.8515
[37m2024-07-10 06:36:42,848 [INFO] - Validation epoch stats:   Loss: 0.2806 - F1-Score: 0.7490 - Accuracy-Score: 0.8716 - AUROC: 0.9340 - AP: 0.8104
[37m2024-07-10 06:36:42,883 [INFO] - Epoch: 8/50
[37m2024-07-10 06:36:44,361 [INFO] - Training epoch stats:     Loss: 0.2815 - F1-Score: 0.7927 - Accuracy-Score: 0.8730 - AUROC: 0.9419 - AP: 0.8573
[37m2024-07-10 06:36:44,582 [INFO] - Validation epoch stats:   Loss: 0.2804 - F1-Score: 0.7459 - Accuracy-Score: 0.8697 - AUROC: 0.9341 - AP: 0.8141
[37m2024-07-10 06:36:44,617 [INFO] - Epoch: 9/50
[37m2024-07-10 06:36:46,145 [INFO] - Training epoch stats:     Loss: 0.2782 - F1-Score: 0.7965 - Accuracy-Score: 0.8753 - AUROC: 0.9433 - AP: 0.8615
[37m2024-07-10 06:36:46,750 [INFO] - Validation epoch stats:   Loss: 0.2853 - F1-Score: 0.7485 - Accuracy-Score: 0.8685 - AUROC: 0.9327 - AP: 0.8100
[37m2024-07-10 06:36:46,785 [INFO] - Epoch: 10/50
[37m2024-07-10 06:36:48,397 [INFO] - Training epoch stats:     Loss: 0.2742 - F1-Score: 0.7990 - Accuracy-Score: 0.8770 - AUROC: 0.9450 - AP: 0.8661
[37m2024-07-10 06:36:48,839 [INFO] - Validation epoch stats:   Loss: 0.2868 - F1-Score: 0.7359 - Accuracy-Score: 0.8652 - AUROC: 0.9305 - AP: 0.8032
[37m2024-07-10 06:36:48,871 [INFO] - Epoch: 11/50
[37m2024-07-10 06:36:50,597 [INFO] - Training epoch stats:     Loss: 0.2698 - F1-Score: 0.8049 - Accuracy-Score: 0.8806 - AUROC: 0.9468 - AP: 0.8703
[37m2024-07-10 06:36:50,993 [INFO] - Validation epoch stats:   Loss: 0.2913 - F1-Score: 0.7335 - Accuracy-Score: 0.8632 - AUROC: 0.9286 - AP: 0.7979
[37m2024-07-10 06:36:51,029 [INFO] - Epoch: 12/50
[37m2024-07-10 06:36:52,692 [INFO] - Training epoch stats:     Loss: 0.2673 - F1-Score: 0.8072 - Accuracy-Score: 0.8822 - AUROC: 0.9483 - AP: 0.8742
[37m2024-07-10 06:36:52,918 [INFO] - Validation epoch stats:   Loss: 0.2922 - F1-Score: 0.7340 - Accuracy-Score: 0.8624 - AUROC: 0.9287 - AP: 0.8013
[37m2024-07-10 06:36:53,024 [INFO] - Epoch: 13/50
[37m2024-07-10 06:36:54,693 [INFO] - Training epoch stats:     Loss: 0.2629 - F1-Score: 0.8125 - Accuracy-Score: 0.8853 - AUROC: 0.9496 - AP: 0.8780
[37m2024-07-10 06:36:54,874 [INFO] - Validation epoch stats:   Loss: 0.2921 - F1-Score: 0.7337 - Accuracy-Score: 0.8634 - AUROC: 0.9284 - AP: 0.8015
[37m2024-07-10 06:36:54,913 [INFO] - Epoch: 14/50
[37m2024-07-10 06:36:56,406 [INFO] - Training epoch stats:     Loss: 0.2601 - F1-Score: 0.8131 - Accuracy-Score: 0.8856 - AUROC: 0.9509 - AP: 0.8811
[37m2024-07-10 06:36:56,598 [INFO] - Validation epoch stats:   Loss: 0.2940 - F1-Score: 0.7350 - Accuracy-Score: 0.8625 - AUROC: 0.9284 - AP: 0.8041
[37m2024-07-10 06:36:56,640 [INFO] - Epoch: 15/50
[37m2024-07-10 06:36:58,101 [INFO] - Training epoch stats:     Loss: 0.2581 - F1-Score: 0.8171 - Accuracy-Score: 0.8881 - AUROC: 0.9519 - AP: 0.8845
[37m2024-07-10 06:36:58,280 [INFO] - Validation epoch stats:   Loss: 0.2967 - F1-Score: 0.7255 - Accuracy-Score: 0.8596 - AUROC: 0.9263 - AP: 0.7966
[37m2024-07-10 06:36:58,317 [INFO] - Epoch: 16/50
[37m2024-07-10 06:36:59,801 [INFO] - Training epoch stats:     Loss: 0.2551 - F1-Score: 0.8217 - Accuracy-Score: 0.8910 - AUROC: 0.9529 - AP: 0.8873
[37m2024-07-10 06:36:59,988 [INFO] - Validation epoch stats:   Loss: 0.3002 - F1-Score: 0.7225 - Accuracy-Score: 0.8572 - AUROC: 0.9249 - AP: 0.7934
[37m2024-07-10 06:37:00,021 [INFO] - Epoch: 17/50
[37m2024-07-10 06:37:01,521 [INFO] - Training epoch stats:     Loss: 0.2516 - F1-Score: 0.8225 - Accuracy-Score: 0.8917 - AUROC: 0.9541 - AP: 0.8898
[37m2024-07-10 06:37:01,693 [INFO] - Validation epoch stats:   Loss: 0.2987 - F1-Score: 0.7238 - Accuracy-Score: 0.8579 - AUROC: 0.9259 - AP: 0.7984
[37m2024-07-10 06:37:01,734 [INFO] - Epoch: 18/50
[37m2024-07-10 06:37:03,122 [INFO] - Training epoch stats:     Loss: 0.2496 - F1-Score: 0.8259 - Accuracy-Score: 0.8936 - AUROC: 0.9549 - AP: 0.8922
[37m2024-07-10 06:37:03,306 [INFO] - Validation epoch stats:   Loss: 0.3039 - F1-Score: 0.7272 - Accuracy-Score: 0.8576 - AUROC: 0.9245 - AP: 0.7940
[37m2024-07-10 06:37:03,338 [INFO] - Epoch: 19/50
[37m2024-07-10 06:37:04,695 [INFO] - Training epoch stats:     Loss: 0.2477 - F1-Score: 0.8280 - Accuracy-Score: 0.8949 - AUROC: 0.9557 - AP: 0.8944
[37m2024-07-10 06:37:04,860 [INFO] - Validation epoch stats:   Loss: 0.3042 - F1-Score: 0.7157 - Accuracy-Score: 0.8550 - AUROC: 0.9231 - AP: 0.7901
[37m2024-07-10 06:37:04,891 [INFO] - Epoch: 20/50
[37m2024-07-10 06:37:06,131 [INFO] - Training epoch stats:     Loss: 0.2453 - F1-Score: 0.8308 - Accuracy-Score: 0.8967 - AUROC: 0.9570 - AP: 0.8974
[37m2024-07-10 06:37:06,290 [INFO] - Validation epoch stats:   Loss: 0.3049 - F1-Score: 0.7201 - Accuracy-Score: 0.8560 - AUROC: 0.9235 - AP: 0.7930
[37m2024-07-10 06:37:06,324 [INFO] - Epoch: 21/50
[37m2024-07-10 06:37:07,623 [INFO] - Training epoch stats:     Loss: 0.2423 - F1-Score: 0.8324 - Accuracy-Score: 0.8977 - AUROC: 0.9578 - AP: 0.8998
[37m2024-07-10 06:37:07,778 [INFO] - Validation epoch stats:   Loss: 0.3082 - F1-Score: 0.7240 - Accuracy-Score: 0.8545 - AUROC: 0.9244 - AP: 0.7974
[37m2024-07-10 06:37:07,811 [INFO] - Epoch: 22/50
[37m2024-07-10 06:37:09,036 [INFO] - Training epoch stats:     Loss: 0.2405 - F1-Score: 0.8335 - Accuracy-Score: 0.8983 - AUROC: 0.9583 - AP: 0.9008
[37m2024-07-10 06:37:09,199 [INFO] - Validation epoch stats:   Loss: 0.3103 - F1-Score: 0.7189 - Accuracy-Score: 0.8526 - AUROC: 0.9229 - AP: 0.7929
[37m2024-07-10 06:37:09,204 [INFO] - Performing early stopping!
[37m2024-07-10 06:37:09,211 [INFO] - Finished run oisvsa38
