[37m2024-07-10 08:45:17,325 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-07-10 08:45:17,326 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/NuCLS/Clean-Dataset/lymphocytes/SAM-H/2024-07-10T084449_CellViT-SAM-H-Classifier-Head-Fold-3
[37m2024-07-10 08:45:17,512 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f3f057fe830>]
[37m2024-07-10 08:45:17,518 [INFO] - Using GPU: cuda:0
[37m2024-07-10 08:45:17,588 [INFO] - Using device: cuda:0
[37m2024-07-10 08:45:17,594 [INFO] - Loss function:
[37m2024-07-10 08:45:17,599 [INFO] - CrossEntropyLoss()
[37m2024-07-10 08:47:28,799 [INFO] - <All keys matched successfully>
[37m2024-07-10 08:47:31,392 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  163,968
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 164,226
Trainable params: 164,226
Non-trainable params: 0
Total mult-adds (M): 0.16
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.00
Params size (MB): 0.66
Estimated Total Size (MB): 0.66
==========================================================================================
[37m2024-07-10 08:47:31,395 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-07-10 08:47:31,402 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0047192849700088925, 'weight_decay': 0.00015918739130688466}
[37m2024-07-10 08:47:31,411 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-07-10 08:47:31,480 [INFO] - Caching datasets
[37m2024-07-10 08:47:52,580 [INFO] - Instantiate Trainer
[37m2024-07-10 08:47:52,588 [INFO] - Calling Trainer Fit
[37m2024-07-10 08:47:52,590 [INFO] - Dataset is cached after first epoch
[37m2024-07-10 08:47:52,599 [INFO] - Starting training, total number of epochs: 50
[37m2024-07-10 08:47:52,606 [INFO] - Epoch: 1/50
[37m2024-07-10 08:48:02,375 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/120f1e6b8e9ebf6b4d258e82e7e061731e4fb68d839edff0c2337565b00ecb7c.h5
[37m2024-07-10 08:48:04,206 [INFO] - Training epoch stats:     Loss: 0.3505 - F1-Score: 0.7749 - Accuracy-Score: 0.8600 - AUROC: 0.9229 - AP: 0.8387
[37m2024-07-10 08:48:05,681 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/970e19add93d9f2c0e86e7a23224dc0a1bbfa49edd155d98933d7c65c912cd8a.h5
[37m2024-07-10 08:48:06,492 [INFO] - Validation epoch stats:   Loss: 0.3634 - F1-Score: 0.6916 - Accuracy-Score: 0.8144 - AUROC: 0.8903 - AP: 0.6258
[37m2024-07-10 08:48:06,496 [INFO] - New best model - save checkpoint
[37m2024-07-10 08:48:06,762 [INFO] - Epoch: 2/50
[37m2024-07-10 08:48:08,257 [INFO] - Training epoch stats:     Loss: 0.2406 - F1-Score: 0.8321 - Accuracy-Score: 0.8963 - AUROC: 0.9583 - AP: 0.9005
[37m2024-07-10 08:48:08,484 [INFO] - Validation epoch stats:   Loss: 0.3892 - F1-Score: 0.6944 - Accuracy-Score: 0.8208 - AUROC: 0.8881 - AP: 0.6028
[37m2024-07-10 08:48:08,542 [INFO] - Epoch: 3/50
[37m2024-07-10 08:48:10,111 [INFO] - Training epoch stats:     Loss: 0.2125 - F1-Score: 0.8526 - Accuracy-Score: 0.9088 - AUROC: 0.9674 - AP: 0.9230
[37m2024-07-10 08:48:10,496 [INFO] - Validation epoch stats:   Loss: 0.4673 - F1-Score: 0.6727 - Accuracy-Score: 0.8159 - AUROC: 0.8810 - AP: 0.5753
[37m2024-07-10 08:48:10,556 [INFO] - Epoch: 4/50
[37m2024-07-10 08:48:12,050 [INFO] - Training epoch stats:     Loss: 0.1881 - F1-Score: 0.8684 - Accuracy-Score: 0.9185 - AUROC: 0.9743 - AP: 0.9393
[37m2024-07-10 08:48:12,277 [INFO] - Validation epoch stats:   Loss: 0.5729 - F1-Score: 0.6827 - Accuracy-Score: 0.8125 - AUROC: 0.8791 - AP: 0.5813
[37m2024-07-10 08:48:12,337 [INFO] - Epoch: 5/50
[37m2024-07-10 08:48:13,849 [INFO] - Training epoch stats:     Loss: 0.1722 - F1-Score: 0.8814 - Accuracy-Score: 0.9262 - AUROC: 0.9786 - AP: 0.9491
[37m2024-07-10 08:48:14,094 [INFO] - Validation epoch stats:   Loss: 0.6505 - F1-Score: 0.6714 - Accuracy-Score: 0.7988 - AUROC: 0.8736 - AP: 0.5763
[37m2024-07-10 08:48:14,147 [INFO] - Epoch: 6/50
[37m2024-07-10 08:48:15,597 [INFO] - Training epoch stats:     Loss: 0.1540 - F1-Score: 0.8954 - Accuracy-Score: 0.9347 - AUROC: 0.9829 - AP: 0.9590
[37m2024-07-10 08:48:15,992 [INFO] - Validation epoch stats:   Loss: 0.7313 - F1-Score: 0.6799 - Accuracy-Score: 0.8098 - AUROC: 0.8748 - AP: 0.5741
[37m2024-07-10 08:48:16,071 [INFO] - Epoch: 7/50
[37m2024-07-10 08:48:17,562 [INFO] - Training epoch stats:     Loss: 0.1405 - F1-Score: 0.9026 - Accuracy-Score: 0.9393 - AUROC: 0.9857 - AP: 0.9655
[37m2024-07-10 08:48:17,791 [INFO] - Validation epoch stats:   Loss: 0.8807 - F1-Score: 0.6718 - Accuracy-Score: 0.8023 - AUROC: 0.8718 - AP: 0.5711
[37m2024-07-10 08:48:17,853 [INFO] - Epoch: 8/50
[37m2024-07-10 08:48:19,690 [INFO] - Training epoch stats:     Loss: 0.1277 - F1-Score: 0.9132 - Accuracy-Score: 0.9458 - AUROC: 0.9880 - AP: 0.9716
[37m2024-07-10 08:48:19,946 [INFO] - Validation epoch stats:   Loss: 0.8889 - F1-Score: 0.6805 - Accuracy-Score: 0.8088 - AUROC: 0.8758 - AP: 0.5775
[37m2024-07-10 08:48:20,010 [INFO] - Epoch: 9/50
[37m2024-07-10 08:48:21,600 [INFO] - Training epoch stats:     Loss: 0.1231 - F1-Score: 0.9156 - Accuracy-Score: 0.9475 - AUROC: 0.9889 - AP: 0.9736
[37m2024-07-10 08:48:21,796 [INFO] - Validation epoch stats:   Loss: 0.8806 - F1-Score: 0.6764 - Accuracy-Score: 0.8124 - AUROC: 0.8719 - AP: 0.5582
[37m2024-07-10 08:48:21,853 [INFO] - Epoch: 10/50
[37m2024-07-10 08:48:23,316 [INFO] - Training epoch stats:     Loss: 0.1108 - F1-Score: 0.9234 - Accuracy-Score: 0.9523 - AUROC: 0.9909 - AP: 0.9781
[37m2024-07-10 08:48:23,669 [INFO] - Validation epoch stats:   Loss: 1.0032 - F1-Score: 0.6685 - Accuracy-Score: 0.8071 - AUROC: 0.8721 - AP: 0.5698
[37m2024-07-10 08:48:23,760 [INFO] - Epoch: 11/50
[37m2024-07-10 08:48:25,216 [INFO] - Training epoch stats:     Loss: 0.1040 - F1-Score: 0.9275 - Accuracy-Score: 0.9549 - AUROC: 0.9921 - AP: 0.9812
[37m2024-07-10 08:48:25,764 [INFO] - Validation epoch stats:   Loss: 0.9271 - F1-Score: 0.6628 - Accuracy-Score: 0.8064 - AUROC: 0.8694 - AP: 0.5601
[37m2024-07-10 08:48:25,824 [INFO] - Epoch: 12/50
[37m2024-07-10 08:48:27,297 [INFO] - Training epoch stats:     Loss: 0.0951 - F1-Score: 0.9346 - Accuracy-Score: 0.9593 - AUROC: 0.9933 - AP: 0.9842
[37m2024-07-10 08:48:27,497 [INFO] - Validation epoch stats:   Loss: 1.0434 - F1-Score: 0.6740 - Accuracy-Score: 0.8120 - AUROC: 0.8766 - AP: 0.5882
[37m2024-07-10 08:48:27,560 [INFO] - Epoch: 13/50
[37m2024-07-10 08:48:29,227 [INFO] - Training epoch stats:     Loss: 0.0939 - F1-Score: 0.9351 - Accuracy-Score: 0.9596 - AUROC: 0.9935 - AP: 0.9841
[37m2024-07-10 08:48:29,419 [INFO] - Validation epoch stats:   Loss: 1.1096 - F1-Score: 0.6695 - Accuracy-Score: 0.8108 - AUROC: 0.8736 - AP: 0.5701
[37m2024-07-10 08:48:29,480 [INFO] - Epoch: 14/50
[37m2024-07-10 08:48:30,853 [INFO] - Training epoch stats:     Loss: 0.0864 - F1-Score: 0.9404 - Accuracy-Score: 0.9629 - AUROC: 0.9944 - AP: 0.9867
[37m2024-07-10 08:48:31,042 [INFO] - Validation epoch stats:   Loss: 1.1726 - F1-Score: 0.6703 - Accuracy-Score: 0.8052 - AUROC: 0.8701 - AP: 0.5703
[37m2024-07-10 08:48:31,100 [INFO] - Epoch: 15/50
[37m2024-07-10 08:48:32,540 [INFO] - Training epoch stats:     Loss: 0.0837 - F1-Score: 0.9424 - Accuracy-Score: 0.9641 - AUROC: 0.9948 - AP: 0.9877
[37m2024-07-10 08:48:32,685 [INFO] - Validation epoch stats:   Loss: 1.0858 - F1-Score: 0.6676 - Accuracy-Score: 0.8060 - AUROC: 0.8742 - AP: 0.5822
[37m2024-07-10 08:48:32,741 [INFO] - Epoch: 16/50
[37m2024-07-10 08:48:33,810 [INFO] - Training epoch stats:     Loss: 0.0819 - F1-Score: 0.9444 - Accuracy-Score: 0.9654 - AUROC: 0.9950 - AP: 0.9876
[37m2024-07-10 08:48:33,942 [INFO] - Validation epoch stats:   Loss: 1.2268 - F1-Score: 0.6665 - Accuracy-Score: 0.8082 - AUROC: 0.8697 - AP: 0.5623
[37m2024-07-10 08:48:34,004 [INFO] - Epoch: 17/50
[37m2024-07-10 08:48:35,223 [INFO] - Training epoch stats:     Loss: 0.0762 - F1-Score: 0.9447 - Accuracy-Score: 0.9656 - AUROC: 0.9957 - AP: 0.9900
[37m2024-07-10 08:48:35,393 [INFO] - Validation epoch stats:   Loss: 1.1736 - F1-Score: 0.6694 - Accuracy-Score: 0.8101 - AUROC: 0.8731 - AP: 0.5770
[37m2024-07-10 08:48:35,451 [INFO] - Epoch: 18/50
[37m2024-07-10 08:48:36,810 [INFO] - Training epoch stats:     Loss: 0.0771 - F1-Score: 0.9456 - Accuracy-Score: 0.9662 - AUROC: 0.9956 - AP: 0.9892
[37m2024-07-10 08:48:36,975 [INFO] - Validation epoch stats:   Loss: 1.7338 - F1-Score: 0.6586 - Accuracy-Score: 0.7962 - AUROC: 0.8612 - AP: 0.5493
[37m2024-07-10 08:48:37,030 [INFO] - Epoch: 19/50
[37m2024-07-10 08:48:38,398 [INFO] - Training epoch stats:     Loss: 0.0725 - F1-Score: 0.9495 - Accuracy-Score: 0.9686 - AUROC: 0.9962 - AP: 0.9911
[37m2024-07-10 08:48:38,582 [INFO] - Validation epoch stats:   Loss: 1.4535 - F1-Score: 0.6614 - Accuracy-Score: 0.8009 - AUROC: 0.8652 - AP: 0.5610
[37m2024-07-10 08:48:38,642 [INFO] - Epoch: 20/50
[37m2024-07-10 08:48:39,899 [INFO] - Training epoch stats:     Loss: 0.0714 - F1-Score: 0.9518 - Accuracy-Score: 0.9700 - AUROC: 0.9963 - AP: 0.9913
[37m2024-07-10 08:48:40,029 [INFO] - Validation epoch stats:   Loss: 1.3890 - F1-Score: 0.6719 - Accuracy-Score: 0.8064 - AUROC: 0.8671 - AP: 0.5623
[37m2024-07-10 08:48:40,078 [INFO] - Epoch: 21/50
[37m2024-07-10 08:48:41,228 [INFO] - Training epoch stats:     Loss: 0.0667 - F1-Score: 0.9536 - Accuracy-Score: 0.9712 - AUROC: 0.9967 - AP: 0.9920
[37m2024-07-10 08:48:41,467 [INFO] - Validation epoch stats:   Loss: 1.7185 - F1-Score: 0.6595 - Accuracy-Score: 0.8079 - AUROC: 0.8683 - AP: 0.5711
[37m2024-07-10 08:48:41,468 [INFO] - Performing early stopping!
[37m2024-07-10 08:48:41,475 [INFO] - Finished run 9nmm1zuc
