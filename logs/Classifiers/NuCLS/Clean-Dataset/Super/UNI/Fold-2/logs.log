[37m2024-07-10 20:04:05,510 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-07-10 20:04:05,511 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/NuCLS/Clean-Dataset/Super/ViT256/2024-07-10T200358_CellViT-UNI-Classifier-Head-Fold-2
[37m2024-07-10 20:04:05,570 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f900eff7700>]
[37m2024-07-10 20:04:05,571 [INFO] - Using GPU: cuda:0
[37m2024-07-10 20:04:05,575 [INFO] - Using device: cuda:0
[37m2024-07-10 20:04:05,579 [INFO] - Loss function:
[37m2024-07-10 20:04:05,584 [INFO] - CrossEntropyLoss()
[37m2024-07-10 20:04:16,754 [INFO] - <All keys matched successfully>
[37m2024-07-10 20:04:17,429 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 4]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  131,200
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 4]                    516
==========================================================================================
Total params: 131,716
Trainable params: 131,716
Non-trainable params: 0
Total mult-adds (M): 0.13
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.53
Estimated Total Size (MB): 0.53
==========================================================================================
[37m2024-07-10 20:04:17,430 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-07-10 20:04:17,435 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.001443515324386187, 'weight_decay': 0.0007837815817993674}
[37m2024-07-10 20:04:17,440 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-07-10 20:04:17,478 [INFO] - Caching datasets
[37m2024-07-10 20:04:27,409 [INFO] - Instantiate Trainer
[37m2024-07-10 20:04:27,415 [INFO] - Calling Trainer Fit
[37m2024-07-10 20:04:27,415 [INFO] - Dataset is cached after first epoch
[37m2024-07-10 20:04:27,419 [INFO] - Starting training, total number of epochs: 50
[37m2024-07-10 20:04:27,424 [INFO] - Epoch: 1/50
[37m2024-07-10 20:04:33,373 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/44fc5bbb137e120ff6082dac3b526a16b91ab52a70e5ed6a38ecc5d3efe3c1b1.h5
[37m2024-07-10 20:04:35,260 [INFO] - Training epoch stats:     Loss: 0.3543 - F1-Score: 0.8712 - Accuracy-Score: 0.8712 - AUROC: 0.9560 - AP: 0.8010
[37m2024-07-10 20:04:37,355 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/cc520285fbf5a78e9ac8aee746ec1fdd864132fbde292170833e734ea53e5042.h5
[37m2024-07-10 20:04:37,534 [INFO] - Validation epoch stats:   Loss: 0.5405 - F1-Score: 0.8095 - Accuracy-Score: 0.8095 - AUROC: 0.9295 - AP: 0.7504
[37m2024-07-10 20:04:37,535 [INFO] - New best model - save checkpoint
[37m2024-07-10 20:04:37,694 [INFO] - Epoch: 2/50
[37m2024-07-10 20:04:38,671 [INFO] - Training epoch stats:     Loss: 0.2418 - F1-Score: 0.9094 - Accuracy-Score: 0.9094 - AUROC: 0.9816 - AP: 0.9481
[37m2024-07-10 20:04:38,921 [INFO] - Validation epoch stats:   Loss: 0.5678 - F1-Score: 0.8089 - Accuracy-Score: 0.8089 - AUROC: 0.9327 - AP: 0.7518
[37m2024-07-10 20:04:38,922 [INFO] - New best model - save checkpoint
[37m2024-07-10 20:04:39,084 [INFO] - Epoch: 3/50
[37m2024-07-10 20:04:40,157 [INFO] - Training epoch stats:     Loss: 0.2043 - F1-Score: 0.9238 - Accuracy-Score: 0.9238 - AUROC: 0.9869 - AP: 0.9632
[37m2024-07-10 20:04:40,317 [INFO] - Validation epoch stats:   Loss: 0.5855 - F1-Score: 0.8068 - Accuracy-Score: 0.8068 - AUROC: 0.9227 - AP: 0.7280
[37m2024-07-10 20:04:40,370 [INFO] - Epoch: 4/50
[37m2024-07-10 20:04:41,464 [INFO] - Training epoch stats:     Loss: 0.1734 - F1-Score: 0.9351 - Accuracy-Score: 0.9351 - AUROC: 0.9909 - AP: 0.9743
[37m2024-07-10 20:04:41,718 [INFO] - Validation epoch stats:   Loss: 0.6219 - F1-Score: 0.8091 - Accuracy-Score: 0.8091 - AUROC: 0.9164 - AP: 0.7246
[37m2024-07-10 20:04:41,770 [INFO] - Epoch: 5/50
[37m2024-07-10 20:04:42,859 [INFO] - Training epoch stats:     Loss: 0.1446 - F1-Score: 0.9479 - Accuracy-Score: 0.9479 - AUROC: 0.9938 - AP: 0.9821
[37m2024-07-10 20:04:43,023 [INFO] - Validation epoch stats:   Loss: 0.6485 - F1-Score: 0.8037 - Accuracy-Score: 0.8037 - AUROC: 0.9180 - AP: 0.7185
[37m2024-07-10 20:04:43,075 [INFO] - Epoch: 6/50
[37m2024-07-10 20:04:44,158 [INFO] - Training epoch stats:     Loss: 0.1216 - F1-Score: 0.9559 - Accuracy-Score: 0.9559 - AUROC: 0.9956 - AP: 0.9879
[37m2024-07-10 20:04:44,322 [INFO] - Validation epoch stats:   Loss: 0.7249 - F1-Score: 0.7955 - Accuracy-Score: 0.7955 - AUROC: 0.9159 - AP: 0.7131
[37m2024-07-10 20:04:44,367 [INFO] - Epoch: 7/50
[37m2024-07-10 20:04:45,459 [INFO] - Training epoch stats:     Loss: 0.1001 - F1-Score: 0.9632 - Accuracy-Score: 0.9632 - AUROC: 0.9971 - AP: 0.9916
[37m2024-07-10 20:04:45,621 [INFO] - Validation epoch stats:   Loss: 0.7426 - F1-Score: 0.7908 - Accuracy-Score: 0.7908 - AUROC: 0.9136 - AP: 0.6959
[37m2024-07-10 20:04:45,665 [INFO] - Epoch: 8/50
[37m2024-07-10 20:04:47,058 [INFO] - Training epoch stats:     Loss: 0.0830 - F1-Score: 0.9706 - Accuracy-Score: 0.9706 - AUROC: 0.9980 - AP: 0.9940
[37m2024-07-10 20:04:47,230 [INFO] - Validation epoch stats:   Loss: 0.8144 - F1-Score: 0.7859 - Accuracy-Score: 0.7859 - AUROC: 0.9050 - AP: 0.7019
[37m2024-07-10 20:04:47,291 [INFO] - Epoch: 9/50
[37m2024-07-10 20:04:48,354 [INFO] - Training epoch stats:     Loss: 0.0679 - F1-Score: 0.9767 - Accuracy-Score: 0.9767 - AUROC: 0.9987 - AP: 0.9954
[37m2024-07-10 20:04:48,524 [INFO] - Validation epoch stats:   Loss: 0.8747 - F1-Score: 0.7835 - Accuracy-Score: 0.7835 - AUROC: 0.9066 - AP: 0.6763
[37m2024-07-10 20:04:48,585 [INFO] - Epoch: 10/50
[37m2024-07-10 20:04:49,655 [INFO] - Training epoch stats:     Loss: 0.0575 - F1-Score: 0.9801 - Accuracy-Score: 0.9801 - AUROC: 0.9990 - AP: 0.9971
[37m2024-07-10 20:04:49,818 [INFO] - Validation epoch stats:   Loss: 0.9072 - F1-Score: 0.7900 - Accuracy-Score: 0.7900 - AUROC: 0.9160 - AP: 0.7059
[37m2024-07-10 20:04:49,873 [INFO] - Epoch: 11/50
[37m2024-07-10 20:04:50,960 [INFO] - Training epoch stats:     Loss: 0.0497 - F1-Score: 0.9830 - Accuracy-Score: 0.9830 - AUROC: 0.9993 - AP: 0.9976
[37m2024-07-10 20:04:51,132 [INFO] - Validation epoch stats:   Loss: 0.9731 - F1-Score: 0.7852 - Accuracy-Score: 0.7852 - AUROC: 0.9079 - AP: 0.6910
[37m2024-07-10 20:04:51,181 [INFO] - Epoch: 12/50
[37m2024-07-10 20:04:52,257 [INFO] - Training epoch stats:     Loss: 0.0404 - F1-Score: 0.9869 - Accuracy-Score: 0.9869 - AUROC: 0.9995 - AP: 0.9985
[37m2024-07-10 20:04:52,423 [INFO] - Validation epoch stats:   Loss: 1.0215 - F1-Score: 0.7879 - Accuracy-Score: 0.7879 - AUROC: 0.9096 - AP: 0.6971
[37m2024-07-10 20:04:52,476 [INFO] - Epoch: 13/50
[37m2024-07-10 20:04:53,667 [INFO] - Training epoch stats:     Loss: 0.0362 - F1-Score: 0.9881 - Accuracy-Score: 0.9881 - AUROC: 0.9996 - AP: 0.9988
[37m2024-07-10 20:04:53,915 [INFO] - Validation epoch stats:   Loss: 1.1151 - F1-Score: 0.7874 - Accuracy-Score: 0.7874 - AUROC: 0.9099 - AP: 0.6921
[37m2024-07-10 20:04:53,982 [INFO] - Epoch: 14/50
[37m2024-07-10 20:04:56,343 [INFO] - Training epoch stats:     Loss: 0.0331 - F1-Score: 0.9892 - Accuracy-Score: 0.9892 - AUROC: 0.9996 - AP: 0.9988
[37m2024-07-10 20:04:56,628 [INFO] - Validation epoch stats:   Loss: 1.1906 - F1-Score: 0.7879 - Accuracy-Score: 0.7879 - AUROC: 0.9112 - AP: 0.6972
[37m2024-07-10 20:04:56,675 [INFO] - Epoch: 15/50
[37m2024-07-10 20:04:58,265 [INFO] - Training epoch stats:     Loss: 0.0287 - F1-Score: 0.9905 - Accuracy-Score: 0.9905 - AUROC: 0.9998 - AP: 0.9992
[37m2024-07-10 20:04:58,519 [INFO] - Validation epoch stats:   Loss: 1.1941 - F1-Score: 0.7877 - Accuracy-Score: 0.7877 - AUROC: 0.9108 - AP: 0.6869
[37m2024-07-10 20:04:58,562 [INFO] - Epoch: 16/50
[37m2024-07-10 20:04:59,647 [INFO] - Training epoch stats:     Loss: 0.0255 - F1-Score: 0.9917 - Accuracy-Score: 0.9917 - AUROC: 0.9998 - AP: 0.9994
[37m2024-07-10 20:04:59,970 [INFO] - Validation epoch stats:   Loss: 1.1877 - F1-Score: 0.7897 - Accuracy-Score: 0.7897 - AUROC: 0.9060 - AP: 0.6877
[37m2024-07-10 20:05:00,041 [INFO] - Epoch: 17/50
[37m2024-07-10 20:05:01,147 [INFO] - Training epoch stats:     Loss: 0.0225 - F1-Score: 0.9932 - Accuracy-Score: 0.9932 - AUROC: 0.9998 - AP: 0.9995
[37m2024-07-10 20:05:01,535 [INFO] - Validation epoch stats:   Loss: 1.3036 - F1-Score: 0.7816 - Accuracy-Score: 0.7816 - AUROC: 0.9049 - AP: 0.6718
[37m2024-07-10 20:05:01,586 [INFO] - Epoch: 18/50
[37m2024-07-10 20:05:02,950 [INFO] - Training epoch stats:     Loss: 0.0201 - F1-Score: 0.9934 - Accuracy-Score: 0.9934 - AUROC: 0.9999 - AP: 0.9996
[37m2024-07-10 20:05:03,154 [INFO] - Validation epoch stats:   Loss: 1.4260 - F1-Score: 0.7851 - Accuracy-Score: 0.7851 - AUROC: 0.8976 - AP: 0.6817
[37m2024-07-10 20:05:03,197 [INFO] - Epoch: 19/50
[37m2024-07-10 20:05:04,367 [INFO] - Training epoch stats:     Loss: 0.0195 - F1-Score: 0.9940 - Accuracy-Score: 0.9940 - AUROC: 0.9999 - AP: 0.9996
[37m2024-07-10 20:05:04,659 [INFO] - Validation epoch stats:   Loss: 1.3867 - F1-Score: 0.7830 - Accuracy-Score: 0.7830 - AUROC: 0.9014 - AP: 0.6847
[37m2024-07-10 20:05:04,707 [INFO] - Epoch: 20/50
[37m2024-07-10 20:05:05,954 [INFO] - Training epoch stats:     Loss: 0.0181 - F1-Score: 0.9941 - Accuracy-Score: 0.9941 - AUROC: 0.9999 - AP: 0.9996
[37m2024-07-10 20:05:06,132 [INFO] - Validation epoch stats:   Loss: 1.5074 - F1-Score: 0.7746 - Accuracy-Score: 0.7746 - AUROC: 0.8952 - AP: 0.6711
[37m2024-07-10 20:05:06,187 [INFO] - Epoch: 21/50
[37m2024-07-10 20:05:07,358 [INFO] - Training epoch stats:     Loss: 0.0183 - F1-Score: 0.9943 - Accuracy-Score: 0.9943 - AUROC: 0.9999 - AP: 0.9995
[37m2024-07-10 20:05:07,548 [INFO] - Validation epoch stats:   Loss: 1.4265 - F1-Score: 0.7840 - Accuracy-Score: 0.7840 - AUROC: 0.8936 - AP: 0.6782
[37m2024-07-10 20:05:07,599 [INFO] - Epoch: 22/50
[37m2024-07-10 20:05:08,855 [INFO] - Training epoch stats:     Loss: 0.0162 - F1-Score: 0.9951 - Accuracy-Score: 0.9951 - AUROC: 0.9999 - AP: 0.9997
[37m2024-07-10 20:05:09,030 [INFO] - Validation epoch stats:   Loss: 1.5794 - F1-Score: 0.7913 - Accuracy-Score: 0.7913 - AUROC: 0.8914 - AP: 0.6821
[37m2024-07-10 20:05:09,031 [INFO] - Performing early stopping!
[37m2024-07-10 20:05:09,038 [INFO] - Finished run nevp8t4b
