[37m2024-07-10 19:28:13,191 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-07-10 19:28:13,192 [INFO] - Run ist stored here: /cellvit/logs_local/nucls/Clean-Dataset/Main/ViT256/2024-07-10T192805_CellViT-256-Classifier-Head-Fold-0
[37m2024-07-10 19:28:13,249 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7f80baff22c0>]
[37m2024-07-10 19:28:13,253 [INFO] - Using GPU: cuda:0
[37m2024-07-10 19:28:13,257 [INFO] - Using device: cuda:0
[37m2024-07-10 19:28:13,262 [INFO] - Loss function:
[37m2024-07-10 19:28:13,266 [INFO] - CrossEntropyLoss()
[37m2024-07-10 19:28:16,163 [INFO] - <All keys matched successfully>
[37m2024-07-10 19:28:16,648 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 7]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  49,280
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 7]                    903
==========================================================================================
Total params: 50,183
Trainable params: 50,183
Non-trainable params: 0
Total mult-adds (M): 0.05
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.20
Estimated Total Size (MB): 0.20
==========================================================================================
[37m2024-07-10 19:28:16,654 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-07-10 19:28:16,659 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.0002275398514485086, 'weight_decay': 0.0003768061610032464}
[37m2024-07-10 19:28:16,663 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-07-10 19:28:16,787 [INFO] - Caching datasets
[37m2024-07-10 19:28:25,780 [INFO] - Instantiate Trainer
[37m2024-07-10 19:28:25,785 [INFO] - Calling Trainer Fit
[37m2024-07-10 19:28:25,820 [INFO] - Dataset is cached after first epoch
[37m2024-07-10 19:28:25,825 [INFO] - Starting training, total number of epochs: 50
[37m2024-07-10 19:28:25,830 [INFO] - Epoch: 1/50
[37m2024-07-10 19:28:28,406 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/320c97661d5eb0808b00e75d120c52eb33e5c17c24203440412a71f7c6108e19.h5
[37m2024-07-10 19:28:30,258 [INFO] - Training epoch stats:     Loss: 1.2806 - F1-Score: 0.6428 - Accuracy-Score: 0.6428 - AUROC: 0.7134 - AP: 0.3388
[37m2024-07-10 19:28:30,607 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/a28df671ac2db85bf7cab480801352020c62e7542399d88d647f7612547bc044.h5
[37m2024-07-10 19:28:30,736 [INFO] - Validation epoch stats:   Loss: 0.7243 - F1-Score: 0.7853 - Accuracy-Score: 0.7853 - AUROC: 0.8641 - AP: 0.4156
[37m2024-07-10 19:28:30,742 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:30,870 [INFO] - Epoch: 2/50
[37m2024-07-10 19:28:32,356 [INFO] - Training epoch stats:     Loss: 0.7749 - F1-Score: 0.7349 - Accuracy-Score: 0.7349 - AUROC: 0.8478 - AP: 0.4503
[37m2024-07-10 19:28:32,660 [INFO] - Validation epoch stats:   Loss: 0.6438 - F1-Score: 0.7857 - Accuracy-Score: 0.7857 - AUROC: 0.8951 - AP: 0.4390
[37m2024-07-10 19:28:32,665 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:32,788 [INFO] - Epoch: 3/50
[37m2024-07-10 19:28:35,266 [INFO] - Training epoch stats:     Loss: 0.6955 - F1-Score: 0.7537 - Accuracy-Score: 0.7537 - AUROC: 0.8871 - AP: 0.4965
[37m2024-07-10 19:28:35,540 [INFO] - Validation epoch stats:   Loss: 0.6363 - F1-Score: 0.7827 - Accuracy-Score: 0.7827 - AUROC: 0.9022 - AP: 0.4469
[37m2024-07-10 19:28:35,546 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:35,640 [INFO] - Epoch: 4/50
[37m2024-07-10 19:28:36,967 [INFO] - Training epoch stats:     Loss: 0.6624 - F1-Score: 0.7674 - Accuracy-Score: 0.7674 - AUROC: 0.9049 - AP: 0.5270
[37m2024-07-10 19:28:37,153 [INFO] - Validation epoch stats:   Loss: 0.6323 - F1-Score: 0.7829 - Accuracy-Score: 0.7829 - AUROC: 0.9073 - AP: 0.4500
[37m2024-07-10 19:28:37,158 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:37,251 [INFO] - Epoch: 5/50
[37m2024-07-10 19:28:38,651 [INFO] - Training epoch stats:     Loss: 0.6439 - F1-Score: 0.7749 - Accuracy-Score: 0.7749 - AUROC: 0.9157 - AP: 0.5514
[37m2024-07-10 19:28:38,776 [INFO] - Validation epoch stats:   Loss: 0.6308 - F1-Score: 0.7810 - Accuracy-Score: 0.7810 - AUROC: 0.9101 - AP: 0.4553
[37m2024-07-10 19:28:38,781 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:38,867 [INFO] - Epoch: 6/50
[37m2024-07-10 19:28:40,073 [INFO] - Training epoch stats:     Loss: 0.6270 - F1-Score: 0.7803 - Accuracy-Score: 0.7803 - AUROC: 0.9254 - AP: 0.5774
[37m2024-07-10 19:28:40,265 [INFO] - Validation epoch stats:   Loss: 0.6402 - F1-Score: 0.7728 - Accuracy-Score: 0.7728 - AUROC: 0.9125 - AP: 0.4660
[37m2024-07-10 19:28:40,270 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:40,358 [INFO] - Epoch: 7/50
[37m2024-07-10 19:28:41,766 [INFO] - Training epoch stats:     Loss: 0.6164 - F1-Score: 0.7837 - Accuracy-Score: 0.7837 - AUROC: 0.9298 - AP: 0.5930
[37m2024-07-10 19:28:41,962 [INFO] - Validation epoch stats:   Loss: 0.6471 - F1-Score: 0.7654 - Accuracy-Score: 0.7654 - AUROC: 0.9133 - AP: 0.4732
[37m2024-07-10 19:28:41,968 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:42,060 [INFO] - Epoch: 8/50
[37m2024-07-10 19:28:43,551 [INFO] - Training epoch stats:     Loss: 0.6073 - F1-Score: 0.7871 - Accuracy-Score: 0.7871 - AUROC: 0.9339 - AP: 0.6042
[37m2024-07-10 19:28:43,678 [INFO] - Validation epoch stats:   Loss: 0.6316 - F1-Score: 0.7749 - Accuracy-Score: 0.7749 - AUROC: 0.9137 - AP: 0.4819
[37m2024-07-10 19:28:43,683 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:43,772 [INFO] - Epoch: 9/50
[37m2024-07-10 19:28:45,454 [INFO] - Training epoch stats:     Loss: 0.5991 - F1-Score: 0.7904 - Accuracy-Score: 0.7904 - AUROC: 0.9369 - AP: 0.6195
[37m2024-07-10 19:28:45,583 [INFO] - Validation epoch stats:   Loss: 0.6286 - F1-Score: 0.7779 - Accuracy-Score: 0.7779 - AUROC: 0.9142 - AP: 0.4814
[37m2024-07-10 19:28:45,589 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:45,687 [INFO] - Epoch: 10/50
[37m2024-07-10 19:28:46,971 [INFO] - Training epoch stats:     Loss: 0.5917 - F1-Score: 0.7933 - Accuracy-Score: 0.7933 - AUROC: 0.9394 - AP: 0.6264
[37m2024-07-10 19:28:47,170 [INFO] - Validation epoch stats:   Loss: 0.6413 - F1-Score: 0.7684 - Accuracy-Score: 0.7684 - AUROC: 0.9144 - AP: 0.4821
[37m2024-07-10 19:28:47,175 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:47,273 [INFO] - Epoch: 11/50
[37m2024-07-10 19:28:48,558 [INFO] - Training epoch stats:     Loss: 0.5856 - F1-Score: 0.7976 - Accuracy-Score: 0.7976 - AUROC: 0.9413 - AP: 0.6338
[37m2024-07-10 19:28:48,686 [INFO] - Validation epoch stats:   Loss: 0.6384 - F1-Score: 0.7707 - Accuracy-Score: 0.7707 - AUROC: 0.9147 - AP: 0.4815
[37m2024-07-10 19:28:48,691 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:48,784 [INFO] - Epoch: 12/50
[37m2024-07-10 19:28:50,150 [INFO] - Training epoch stats:     Loss: 0.5805 - F1-Score: 0.7986 - Accuracy-Score: 0.7986 - AUROC: 0.9435 - AP: 0.6434
[37m2024-07-10 19:28:50,282 [INFO] - Validation epoch stats:   Loss: 0.6338 - F1-Score: 0.7707 - Accuracy-Score: 0.7707 - AUROC: 0.9145 - AP: 0.4867
[37m2024-07-10 19:28:50,324 [INFO] - Epoch: 13/50
[37m2024-07-10 19:28:51,656 [INFO] - Training epoch stats:     Loss: 0.5765 - F1-Score: 0.7984 - Accuracy-Score: 0.7984 - AUROC: 0.9441 - AP: 0.6481
[37m2024-07-10 19:28:51,784 [INFO] - Validation epoch stats:   Loss: 0.6394 - F1-Score: 0.7679 - Accuracy-Score: 0.7679 - AUROC: 0.9146 - AP: 0.4842
[37m2024-07-10 19:28:51,820 [INFO] - Epoch: 14/50
[37m2024-07-10 19:28:53,248 [INFO] - Training epoch stats:     Loss: 0.5714 - F1-Score: 0.8016 - Accuracy-Score: 0.8016 - AUROC: 0.9455 - AP: 0.6554
[37m2024-07-10 19:28:53,379 [INFO] - Validation epoch stats:   Loss: 0.6481 - F1-Score: 0.7620 - Accuracy-Score: 0.7620 - AUROC: 0.9147 - AP: 0.4822
[37m2024-07-10 19:28:53,384 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:53,481 [INFO] - Epoch: 15/50
[37m2024-07-10 19:28:54,853 [INFO] - Training epoch stats:     Loss: 0.5676 - F1-Score: 0.8024 - Accuracy-Score: 0.8024 - AUROC: 0.9470 - AP: 0.6591
[37m2024-07-10 19:28:54,977 [INFO] - Validation epoch stats:   Loss: 0.6426 - F1-Score: 0.7660 - Accuracy-Score: 0.7660 - AUROC: 0.9148 - AP: 0.4850
[37m2024-07-10 19:28:54,983 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:55,074 [INFO] - Epoch: 16/50
[37m2024-07-10 19:28:56,453 [INFO] - Training epoch stats:     Loss: 0.5634 - F1-Score: 0.8046 - Accuracy-Score: 0.8046 - AUROC: 0.9481 - AP: 0.6650
[37m2024-07-10 19:28:56,590 [INFO] - Validation epoch stats:   Loss: 0.6470 - F1-Score: 0.7616 - Accuracy-Score: 0.7616 - AUROC: 0.9150 - AP: 0.4870
[37m2024-07-10 19:28:56,596 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:28:56,685 [INFO] - Epoch: 17/50
[37m2024-07-10 19:28:58,061 [INFO] - Training epoch stats:     Loss: 0.5600 - F1-Score: 0.8059 - Accuracy-Score: 0.8059 - AUROC: 0.9478 - AP: 0.6673
[37m2024-07-10 19:28:58,188 [INFO] - Validation epoch stats:   Loss: 0.6412 - F1-Score: 0.7648 - Accuracy-Score: 0.7648 - AUROC: 0.9149 - AP: 0.4877
[37m2024-07-10 19:28:58,261 [INFO] - Epoch: 18/50
[37m2024-07-10 19:28:59,666 [INFO] - Training epoch stats:     Loss: 0.5560 - F1-Score: 0.8055 - Accuracy-Score: 0.8055 - AUROC: 0.9497 - AP: 0.6740
[37m2024-07-10 19:28:59,868 [INFO] - Validation epoch stats:   Loss: 0.6390 - F1-Score: 0.7671 - Accuracy-Score: 0.7671 - AUROC: 0.9146 - AP: 0.4862
[37m2024-07-10 19:28:59,902 [INFO] - Epoch: 19/50
[37m2024-07-10 19:29:01,265 [INFO] - Training epoch stats:     Loss: 0.5521 - F1-Score: 0.8067 - Accuracy-Score: 0.8067 - AUROC: 0.9505 - AP: 0.6762
[37m2024-07-10 19:29:01,463 [INFO] - Validation epoch stats:   Loss: 0.6421 - F1-Score: 0.7648 - Accuracy-Score: 0.7648 - AUROC: 0.9145 - AP: 0.4864
[37m2024-07-10 19:29:01,495 [INFO] - Epoch: 20/50
[37m2024-07-10 19:29:04,048 [INFO] - Training epoch stats:     Loss: 0.5493 - F1-Score: 0.8090 - Accuracy-Score: 0.8090 - AUROC: 0.9512 - AP: 0.6800
[37m2024-07-10 19:29:04,466 [INFO] - Validation epoch stats:   Loss: 0.6435 - F1-Score: 0.7637 - Accuracy-Score: 0.7637 - AUROC: 0.9146 - AP: 0.4876
[37m2024-07-10 19:29:04,572 [INFO] - Epoch: 21/50
[37m2024-07-10 19:29:08,450 [INFO] - Training epoch stats:     Loss: 0.5477 - F1-Score: 0.8094 - Accuracy-Score: 0.8094 - AUROC: 0.9519 - AP: 0.6842
[37m2024-07-10 19:29:10,356 [INFO] - Validation epoch stats:   Loss: 0.6426 - F1-Score: 0.7646 - Accuracy-Score: 0.7646 - AUROC: 0.9149 - AP: 0.4859
[37m2024-07-10 19:29:10,441 [INFO] - Epoch: 22/50
[37m2024-07-10 19:29:16,157 [INFO] - Training epoch stats:     Loss: 0.5450 - F1-Score: 0.8098 - Accuracy-Score: 0.8098 - AUROC: 0.9519 - AP: 0.6820
[37m2024-07-10 19:29:18,349 [INFO] - Validation epoch stats:   Loss: 0.6429 - F1-Score: 0.7623 - Accuracy-Score: 0.7623 - AUROC: 0.9149 - AP: 0.4868
[37m2024-07-10 19:29:18,388 [INFO] - Epoch: 23/50
[37m2024-07-10 19:29:22,663 [INFO] - Training epoch stats:     Loss: 0.5432 - F1-Score: 0.8105 - Accuracy-Score: 0.8105 - AUROC: 0.9523 - AP: 0.6883
[37m2024-07-10 19:29:22,856 [INFO] - Validation epoch stats:   Loss: 0.6441 - F1-Score: 0.7612 - Accuracy-Score: 0.7612 - AUROC: 0.9147 - AP: 0.4860
[37m2024-07-10 19:29:22,890 [INFO] - Epoch: 24/50
[37m2024-07-10 19:29:25,543 [INFO] - Training epoch stats:     Loss: 0.5400 - F1-Score: 0.8113 - Accuracy-Score: 0.8113 - AUROC: 0.9532 - AP: 0.6927
[37m2024-07-10 19:29:25,850 [INFO] - Validation epoch stats:   Loss: 0.6430 - F1-Score: 0.7625 - Accuracy-Score: 0.7625 - AUROC: 0.9148 - AP: 0.4859
[37m2024-07-10 19:29:25,883 [INFO] - Epoch: 25/50
[37m2024-07-10 19:29:28,357 [INFO] - Training epoch stats:     Loss: 0.5382 - F1-Score: 0.8118 - Accuracy-Score: 0.8118 - AUROC: 0.9537 - AP: 0.6926
[37m2024-07-10 19:29:28,754 [INFO] - Validation epoch stats:   Loss: 0.6418 - F1-Score: 0.7622 - Accuracy-Score: 0.7622 - AUROC: 0.9147 - AP: 0.4865
[37m2024-07-10 19:29:28,792 [INFO] - Epoch: 26/50
[37m2024-07-10 19:29:31,144 [INFO] - Training epoch stats:     Loss: 0.5372 - F1-Score: 0.8142 - Accuracy-Score: 0.8142 - AUROC: 0.9539 - AP: 0.6916
[37m2024-07-10 19:29:31,656 [INFO] - Validation epoch stats:   Loss: 0.6357 - F1-Score: 0.7667 - Accuracy-Score: 0.7667 - AUROC: 0.9149 - AP: 0.4871
[37m2024-07-10 19:29:31,775 [INFO] - Epoch: 27/50
[37m2024-07-10 19:29:34,151 [INFO] - Training epoch stats:     Loss: 0.5348 - F1-Score: 0.8141 - Accuracy-Score: 0.8141 - AUROC: 0.9542 - AP: 0.6947
[37m2024-07-10 19:29:34,955 [INFO] - Validation epoch stats:   Loss: 0.6473 - F1-Score: 0.7580 - Accuracy-Score: 0.7580 - AUROC: 0.9146 - AP: 0.4853
[37m2024-07-10 19:29:35,073 [INFO] - Epoch: 28/50
[37m2024-07-10 19:29:36,861 [INFO] - Training epoch stats:     Loss: 0.5323 - F1-Score: 0.8151 - Accuracy-Score: 0.8151 - AUROC: 0.9549 - AP: 0.6972
[37m2024-07-10 19:29:37,365 [INFO] - Validation epoch stats:   Loss: 0.6447 - F1-Score: 0.7599 - Accuracy-Score: 0.7599 - AUROC: 0.9147 - AP: 0.4855
[37m2024-07-10 19:29:37,441 [INFO] - Epoch: 29/50
[37m2024-07-10 19:29:39,240 [INFO] - Training epoch stats:     Loss: 0.5313 - F1-Score: 0.8149 - Accuracy-Score: 0.8149 - AUROC: 0.9550 - AP: 0.6996
[37m2024-07-10 19:29:39,455 [INFO] - Validation epoch stats:   Loss: 0.6432 - F1-Score: 0.7603 - Accuracy-Score: 0.7603 - AUROC: 0.9148 - AP: 0.4855
[37m2024-07-10 19:29:39,490 [INFO] - Epoch: 30/50
[37m2024-07-10 19:29:41,448 [INFO] - Training epoch stats:     Loss: 0.5306 - F1-Score: 0.8137 - Accuracy-Score: 0.8137 - AUROC: 0.9557 - AP: 0.6994
[37m2024-07-10 19:29:41,942 [INFO] - Validation epoch stats:   Loss: 0.6436 - F1-Score: 0.7603 - Accuracy-Score: 0.7603 - AUROC: 0.9147 - AP: 0.4853
[37m2024-07-10 19:29:41,983 [INFO] - Epoch: 31/50
[37m2024-07-10 19:29:44,359 [INFO] - Training epoch stats:     Loss: 0.5285 - F1-Score: 0.8172 - Accuracy-Score: 0.8172 - AUROC: 0.9558 - AP: 0.7019
[37m2024-07-10 19:29:44,484 [INFO] - Validation epoch stats:   Loss: 0.6441 - F1-Score: 0.7601 - Accuracy-Score: 0.7601 - AUROC: 0.9148 - AP: 0.4854
[37m2024-07-10 19:29:44,519 [INFO] - Epoch: 32/50
[37m2024-07-10 19:29:45,658 [INFO] - Training epoch stats:     Loss: 0.5266 - F1-Score: 0.8171 - Accuracy-Score: 0.8171 - AUROC: 0.9559 - AP: 0.7057
[37m2024-07-10 19:29:45,785 [INFO] - Validation epoch stats:   Loss: 0.6449 - F1-Score: 0.7591 - Accuracy-Score: 0.7591 - AUROC: 0.9148 - AP: 0.4846
[37m2024-07-10 19:29:45,818 [INFO] - Epoch: 33/50
[37m2024-07-10 19:29:47,060 [INFO] - Training epoch stats:     Loss: 0.5265 - F1-Score: 0.8159 - Accuracy-Score: 0.8159 - AUROC: 0.9556 - AP: 0.7074
[37m2024-07-10 19:29:47,188 [INFO] - Validation epoch stats:   Loss: 0.6425 - F1-Score: 0.7616 - Accuracy-Score: 0.7616 - AUROC: 0.9147 - AP: 0.4855
[37m2024-07-10 19:29:47,223 [INFO] - Epoch: 34/50
[37m2024-07-10 19:29:48,368 [INFO] - Training epoch stats:     Loss: 0.5250 - F1-Score: 0.8170 - Accuracy-Score: 0.8170 - AUROC: 0.9564 - AP: 0.7075
[37m2024-07-10 19:29:48,564 [INFO] - Validation epoch stats:   Loss: 0.6450 - F1-Score: 0.7584 - Accuracy-Score: 0.7584 - AUROC: 0.9146 - AP: 0.4850
[37m2024-07-10 19:29:48,599 [INFO] - Epoch: 35/50
[37m2024-07-10 19:29:49,855 [INFO] - Training epoch stats:     Loss: 0.5249 - F1-Score: 0.8162 - Accuracy-Score: 0.8162 - AUROC: 0.9564 - AP: 0.7067
[37m2024-07-10 19:29:49,979 [INFO] - Validation epoch stats:   Loss: 0.6372 - F1-Score: 0.7652 - Accuracy-Score: 0.7652 - AUROC: 0.9148 - AP: 0.4857
[37m2024-07-10 19:29:50,011 [INFO] - Epoch: 36/50
[37m2024-07-10 19:29:51,347 [INFO] - Training epoch stats:     Loss: 0.5235 - F1-Score: 0.8167 - Accuracy-Score: 0.8167 - AUROC: 0.9567 - AP: 0.7072
[37m2024-07-10 19:29:51,475 [INFO] - Validation epoch stats:   Loss: 0.6443 - F1-Score: 0.7595 - Accuracy-Score: 0.7595 - AUROC: 0.9147 - AP: 0.4853
[37m2024-07-10 19:29:51,480 [INFO] - Performing early stopping!
[37m2024-07-10 19:29:51,487 [INFO] - Finished run bl0j3tlg
