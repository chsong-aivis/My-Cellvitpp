[37m2024-07-10 19:22:43,495 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-07-10 19:22:43,495 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/NuCLS/Clean-Dataset/Main/UNI/2024-07-10T192234_CellViT-UNI-Classifier-Head-Fold-0
[37m2024-07-10 19:22:43,665 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fa757bb7700>]
[37m2024-07-10 19:22:43,670 [INFO] - Using GPU: cuda:0
[37m2024-07-10 19:22:43,675 [INFO] - Using device: cuda:0
[37m2024-07-10 19:22:43,679 [INFO] - Loss function:
[37m2024-07-10 19:22:43,683 [INFO] - CrossEntropyLoss()
[37m2024-07-10 19:23:07,952 [INFO] - <All keys matched successfully>
[37m2024-07-10 19:23:08,591 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 7]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  131,200
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 7]                    903
==========================================================================================
Total params: 132,103
Trainable params: 132,103
Non-trainable params: 0
Total mult-adds (M): 0.13
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.53
Estimated Total Size (MB): 0.53
==========================================================================================
[37m2024-07-10 19:23:08,598 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-07-10 19:23:08,602 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.008618913098557317, 'weight_decay': 0.00018733004167187928}
[37m2024-07-10 19:23:08,607 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-07-10 19:23:08,647 [INFO] - Caching datasets
[37m2024-07-10 19:23:19,622 [INFO] - Instantiate Trainer
[37m2024-07-10 19:23:19,628 [INFO] - Calling Trainer Fit
[37m2024-07-10 19:23:19,633 [INFO] - Dataset is cached after first epoch
[37m2024-07-10 19:23:19,638 [INFO] - Starting training, total number of epochs: 50
[37m2024-07-10 19:23:19,642 [INFO] - Epoch: 1/50
[37m2024-07-10 19:23:25,608 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/de29c6c9e03b86f8e374d1b168151a4cb4d6ac32b2b4d406e43f7680e3d1fbd7.h5
[37m2024-07-10 19:23:27,559 [INFO] - Training epoch stats:     Loss: 0.5485 - F1-Score: 0.8060 - Accuracy-Score: 0.8060 - AUROC: 0.9466 - AP: 0.6782
[37m2024-07-10 19:23:28,679 [INFO] - Loaded dataset from cache: /NuCLS/corrected-dataset-ouf-of-bounds/cache/6bce92beb5d4812fc2a3c5ddcac8fb7beab5f8a104b9e6d3dd3b6171a29bb9b9.h5
[37m2024-07-10 19:23:28,825 [INFO] - Validation epoch stats:   Loss: 0.5894 - F1-Score: 0.7973 - Accuracy-Score: 0.7973 - AUROC: 0.9153 - AP: 0.6370
[37m2024-07-10 19:23:28,831 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:23:28,974 [INFO] - Epoch: 2/50
[37m2024-07-10 19:23:30,655 [INFO] - Training epoch stats:     Loss: 0.3967 - F1-Score: 0.8620 - Accuracy-Score: 0.8620 - AUROC: 0.9748 - AP: 0.8084
[37m2024-07-10 19:23:30,800 [INFO] - Validation epoch stats:   Loss: 0.6553 - F1-Score: 0.8034 - Accuracy-Score: 0.8034 - AUROC: 0.9066 - AP: 0.6377
[37m2024-07-10 19:23:30,853 [INFO] - Epoch: 3/50
[37m2024-07-10 19:23:32,440 [INFO] - Training epoch stats:     Loss: 0.3378 - F1-Score: 0.8814 - Accuracy-Score: 0.8814 - AUROC: 0.9824 - AP: 0.8517
[37m2024-07-10 19:23:32,594 [INFO] - Validation epoch stats:   Loss: 0.7162 - F1-Score: 0.7973 - Accuracy-Score: 0.7973 - AUROC: 0.9174 - AP: 0.6393
[37m2024-07-10 19:23:32,599 [INFO] - New best model - save checkpoint
[37m2024-07-10 19:23:32,729 [INFO] - Epoch: 4/50
[37m2024-07-10 19:23:34,257 [INFO] - Training epoch stats:     Loss: 0.2781 - F1-Score: 0.8998 - Accuracy-Score: 0.8998 - AUROC: 0.9884 - AP: 0.8862
[37m2024-07-10 19:23:34,417 [INFO] - Validation epoch stats:   Loss: 0.7475 - F1-Score: 0.7944 - Accuracy-Score: 0.7944 - AUROC: 0.9063 - AP: 0.6238
[37m2024-07-10 19:23:34,472 [INFO] - Epoch: 5/50
[37m2024-07-10 19:23:35,967 [INFO] - Training epoch stats:     Loss: 0.2434 - F1-Score: 0.9126 - Accuracy-Score: 0.9126 - AUROC: 0.9915 - AP: 0.9117
[37m2024-07-10 19:23:36,184 [INFO] - Validation epoch stats:   Loss: 0.9604 - F1-Score: 0.7732 - Accuracy-Score: 0.7732 - AUROC: 0.9021 - AP: 0.5833
[37m2024-07-10 19:23:36,234 [INFO] - Epoch: 6/50
[37m2024-07-10 19:23:37,759 [INFO] - Training epoch stats:     Loss: 0.2186 - F1-Score: 0.9220 - Accuracy-Score: 0.9220 - AUROC: 0.9933 - AP: 0.9316
[37m2024-07-10 19:23:37,892 [INFO] - Validation epoch stats:   Loss: 1.0284 - F1-Score: 0.7627 - Accuracy-Score: 0.7627 - AUROC: 0.9108 - AP: 0.5821
[37m2024-07-10 19:23:37,941 [INFO] - Epoch: 7/50
[37m2024-07-10 19:23:39,461 [INFO] - Training epoch stats:     Loss: 0.1890 - F1-Score: 0.9311 - Accuracy-Score: 0.9311 - AUROC: 0.9944 - AP: 0.9496
[37m2024-07-10 19:23:39,592 [INFO] - Validation epoch stats:   Loss: 1.1090 - F1-Score: 0.7767 - Accuracy-Score: 0.7767 - AUROC: 0.9016 - AP: 0.5733
[37m2024-07-10 19:23:39,644 [INFO] - Epoch: 8/50
[37m2024-07-10 19:23:41,459 [INFO] - Training epoch stats:     Loss: 0.1784 - F1-Score: 0.9342 - Accuracy-Score: 0.9342 - AUROC: 0.9954 - AP: 0.9525
[37m2024-07-10 19:23:41,596 [INFO] - Validation epoch stats:   Loss: 1.2601 - F1-Score: 0.7588 - Accuracy-Score: 0.7588 - AUROC: 0.8974 - AP: 0.5710
[37m2024-07-10 19:23:41,652 [INFO] - Epoch: 9/50
[37m2024-07-10 19:23:43,151 [INFO] - Training epoch stats:     Loss: 0.1590 - F1-Score: 0.9423 - Accuracy-Score: 0.9423 - AUROC: 0.9964 - AP: 0.9622
[37m2024-07-10 19:23:43,297 [INFO] - Validation epoch stats:   Loss: 1.3005 - F1-Score: 0.7840 - Accuracy-Score: 0.7840 - AUROC: 0.9065 - AP: 0.6070
[37m2024-07-10 19:23:43,345 [INFO] - Epoch: 10/50
[37m2024-07-10 19:23:44,649 [INFO] - Training epoch stats:     Loss: 0.1463 - F1-Score: 0.9484 - Accuracy-Score: 0.9484 - AUROC: 0.9970 - AP: 0.9703
[37m2024-07-10 19:23:44,757 [INFO] - Validation epoch stats:   Loss: 1.3689 - F1-Score: 0.7745 - Accuracy-Score: 0.7745 - AUROC: 0.9004 - AP: 0.6042
[37m2024-07-10 19:23:44,804 [INFO] - Epoch: 11/50
[37m2024-07-10 19:23:46,048 [INFO] - Training epoch stats:     Loss: 0.1365 - F1-Score: 0.9508 - Accuracy-Score: 0.9508 - AUROC: 0.9974 - AP: 0.9747
[37m2024-07-10 19:23:46,159 [INFO] - Validation epoch stats:   Loss: 1.4978 - F1-Score: 0.7669 - Accuracy-Score: 0.7669 - AUROC: 0.8982 - AP: 0.5836
[37m2024-07-10 19:23:46,213 [INFO] - Epoch: 12/50
[37m2024-07-10 19:23:47,558 [INFO] - Training epoch stats:     Loss: 0.1273 - F1-Score: 0.9536 - Accuracy-Score: 0.9536 - AUROC: 0.9974 - AP: 0.9755
[37m2024-07-10 19:23:47,684 [INFO] - Validation epoch stats:   Loss: 1.6450 - F1-Score: 0.7712 - Accuracy-Score: 0.7712 - AUROC: 0.8881 - AP: 0.5539
[37m2024-07-10 19:23:47,735 [INFO] - Epoch: 13/50
[37m2024-07-10 19:23:48,954 [INFO] - Training epoch stats:     Loss: 0.1202 - F1-Score: 0.9571 - Accuracy-Score: 0.9571 - AUROC: 0.9979 - AP: 0.9764
[37m2024-07-10 19:23:49,062 [INFO] - Validation epoch stats:   Loss: 1.6874 - F1-Score: 0.7834 - Accuracy-Score: 0.7834 - AUROC: 0.8856 - AP: 0.5837
[37m2024-07-10 19:23:49,114 [INFO] - Epoch: 14/50
[37m2024-07-10 19:23:50,447 [INFO] - Training epoch stats:     Loss: 0.1152 - F1-Score: 0.9609 - Accuracy-Score: 0.9609 - AUROC: 0.9980 - AP: 0.9764
[37m2024-07-10 19:23:50,579 [INFO] - Validation epoch stats:   Loss: 1.6994 - F1-Score: 0.7881 - Accuracy-Score: 0.7881 - AUROC: 0.8897 - AP: 0.5803
[37m2024-07-10 19:23:50,631 [INFO] - Epoch: 15/50
[37m2024-07-10 19:23:52,152 [INFO] - Training epoch stats:     Loss: 0.1138 - F1-Score: 0.9602 - Accuracy-Score: 0.9602 - AUROC: 0.9982 - AP: 0.9764
[37m2024-07-10 19:23:52,280 [INFO] - Validation epoch stats:   Loss: 1.8385 - F1-Score: 0.7860 - Accuracy-Score: 0.7860 - AUROC: 0.8937 - AP: 0.5904
[37m2024-07-10 19:23:52,335 [INFO] - Epoch: 16/50
[37m2024-07-10 19:23:53,768 [INFO] - Training epoch stats:     Loss: 0.1092 - F1-Score: 0.9629 - Accuracy-Score: 0.9629 - AUROC: 0.9984 - AP: 0.9839
[37m2024-07-10 19:23:53,978 [INFO] - Validation epoch stats:   Loss: 1.9425 - F1-Score: 0.7588 - Accuracy-Score: 0.7588 - AUROC: 0.8872 - AP: 0.5819
[37m2024-07-10 19:23:54,030 [INFO] - Epoch: 17/50
[37m2024-07-10 19:23:55,467 [INFO] - Training epoch stats:     Loss: 0.1009 - F1-Score: 0.9662 - Accuracy-Score: 0.9662 - AUROC: 0.9986 - AP: 0.9833
[37m2024-07-10 19:23:55,677 [INFO] - Validation epoch stats:   Loss: 1.8967 - F1-Score: 0.7847 - Accuracy-Score: 0.7847 - AUROC: 0.8950 - AP: 0.5912
[37m2024-07-10 19:23:55,730 [INFO] - Epoch: 18/50
[37m2024-07-10 19:23:57,260 [INFO] - Training epoch stats:     Loss: 0.1018 - F1-Score: 0.9670 - Accuracy-Score: 0.9670 - AUROC: 0.9986 - AP: 0.9825
[37m2024-07-10 19:23:57,398 [INFO] - Validation epoch stats:   Loss: 2.0411 - F1-Score: 0.7753 - Accuracy-Score: 0.7753 - AUROC: 0.8887 - AP: 0.5884
[37m2024-07-10 19:23:57,453 [INFO] - Epoch: 19/50
[37m2024-07-10 19:23:58,863 [INFO] - Training epoch stats:     Loss: 0.0923 - F1-Score: 0.9677 - Accuracy-Score: 0.9677 - AUROC: 0.9988 - AP: 0.9849
[37m2024-07-10 19:23:59,073 [INFO] - Validation epoch stats:   Loss: 2.3624 - F1-Score: 0.7660 - Accuracy-Score: 0.7660 - AUROC: 0.8706 - AP: 0.5358
[37m2024-07-10 19:23:59,130 [INFO] - Epoch: 20/50
[37m2024-07-10 19:24:00,462 [INFO] - Training epoch stats:     Loss: 0.0931 - F1-Score: 0.9680 - Accuracy-Score: 0.9680 - AUROC: 0.9988 - AP: 0.9889
[37m2024-07-10 19:24:00,594 [INFO] - Validation epoch stats:   Loss: 2.4417 - F1-Score: 0.7534 - Accuracy-Score: 0.7534 - AUROC: 0.8817 - AP: 0.5682
[37m2024-07-10 19:24:00,646 [INFO] - Epoch: 21/50
[37m2024-07-10 19:24:02,362 [INFO] - Training epoch stats:     Loss: 0.0935 - F1-Score: 0.9687 - Accuracy-Score: 0.9687 - AUROC: 0.9986 - AP: 0.9873
[37m2024-07-10 19:24:02,559 [INFO] - Validation epoch stats:   Loss: 2.4372 - F1-Score: 0.7482 - Accuracy-Score: 0.7482 - AUROC: 0.8750 - AP: 0.5632
[37m2024-07-10 19:24:02,626 [INFO] - Epoch: 22/50
[37m2024-07-10 19:24:05,446 [INFO] - Training epoch stats:     Loss: 0.0833 - F1-Score: 0.9726 - Accuracy-Score: 0.9726 - AUROC: 0.9990 - AP: 0.9903
[37m2024-07-10 19:24:05,928 [INFO] - Validation epoch stats:   Loss: 2.3781 - F1-Score: 0.7688 - Accuracy-Score: 0.7688 - AUROC: 0.8762 - AP: 0.5594
[37m2024-07-10 19:24:05,991 [INFO] - Epoch: 23/50
[37m2024-07-10 19:24:07,164 [INFO] - Training epoch stats:     Loss: 0.0832 - F1-Score: 0.9718 - Accuracy-Score: 0.9718 - AUROC: 0.9991 - AP: 0.9907
[37m2024-07-10 19:24:07,361 [INFO] - Validation epoch stats:   Loss: 2.3951 - F1-Score: 0.7675 - Accuracy-Score: 0.7675 - AUROC: 0.8761 - AP: 0.5542
[37m2024-07-10 19:24:07,366 [INFO] - Performing early stopping!
[37m2024-07-10 19:24:07,371 [INFO] - Finished run 6p4axmox
