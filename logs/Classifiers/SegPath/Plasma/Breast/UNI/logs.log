[37m2024-07-09 07:51:20,095 [INFO] - Instantiated Logger. WandB init and config update finished.
[37m2024-07-09 07:51:20,097 [INFO] - Run ist stored here: /cellvit/logs_paper/Head-Evaluation/segpath/Plasma/Breast/UNI/2024-07-09T075111_CellViT-UNI
[37m2024-07-09 07:51:20,162 [INFO] - Cuda devices: [<torch.cuda.device object at 0x7fd6d8be9ea0>]
[37m2024-07-09 07:51:20,168 [INFO] - Using GPU: cuda:0
[37m2024-07-09 07:51:20,173 [INFO] - Using device: cuda:0
[37m2024-07-09 07:51:20,199 [INFO] - Loss function:
[37m2024-07-09 07:51:20,204 [INFO] - CrossEntropyLoss()
[37m2024-07-09 07:51:34,213 [INFO] - <All keys matched successfully>
[37m2024-07-09 07:51:35,536 [INFO] -
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LinearClassifier                         [1, 2]                    --
â”œâ”€Linear: 1-1                            [1, 128]                  131,200
â”œâ”€ReLU: 1-2                              [1, 128]                  --
â”œâ”€Dropout: 1-3                           [1, 128]                  --
â”œâ”€Linear: 1-4                            [1, 2]                    258
==========================================================================================
Total params: 131,458
Trainable params: 131,458
Non-trainable params: 0
Total mult-adds (M): 0.13
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.53
Estimated Total Size (MB): 0.53
==========================================================================================
[37m2024-07-09 07:51:35,543 [INFO] - Loaded AdamW Optimizer with following hyperparameters:
[37m2024-07-09 07:51:35,548 [INFO] - {'betas': [0.85, 0.9], 'lr': 0.00784827628638476, 'weight_decay': 0.0006566288200498966}
[37m2024-07-09 07:51:35,553 [INFO] - Using early stopping with a range of 20 and maximize strategy
[37m2024-07-09 07:51:35,589 [INFO] - Instantiate Trainer
[37m2024-07-09 07:51:35,599 [INFO] - Calling Trainer Fit
[37m2024-07-09 07:51:35,603 [INFO] - Dataset is cached after first epoch
[37m2024-07-09 07:51:35,609 [INFO] - Starting training, total number of epochs: 50
[37m2024-07-09 07:51:35,614 [INFO] - Epoch: 1/50
[37m2024-07-09 07:52:59,891 [INFO] - Loaded dataset from cache: segpath-data-all/Plasma/MIST1_PlasmaCell/cache/60ac12803f3b0e8551ea813779e458d850d027622762293b075e3738e570f255.h5
[37m2024-07-09 07:53:03,705 [INFO] - Performed Resampling
[37m2024-07-09 07:53:03,711 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:53:09,430 [INFO] - Training epoch stats:     Loss: 0.2620 - F1-Score: 0.7555 - Accuracy-Score: 0.8815 - AUROC: 0.9568 - AP: 0.8395
[37m2024-07-09 07:53:12,144 [INFO] - Loaded dataset from cache: segpath-data-all/Plasma/MIST1_PlasmaCell/cache/e6dfb8df278fa403a62a9bbba1e18e5133c680acebc6683df37d74f3312d1fce.h5
[37m2024-07-09 07:53:12,613 [INFO] - Validation epoch stats:   Loss: 0.2276 - F1-Score: 0.1169 - Accuracy-Score: 0.9285 - AUROC: 0.8345 - AP: 0.0810
[37m2024-07-09 07:53:12,618 [INFO] - New best model - save checkpoint
[37m2024-07-09 07:53:12,759 [INFO] - Epoch: 2/50
[37m2024-07-09 07:53:17,329 [INFO] - Performed Resampling
[37m2024-07-09 07:53:17,334 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:53:22,894 [INFO] - Training epoch stats:     Loss: 0.2327 - F1-Score: 0.7756 - Accuracy-Score: 0.8922 - AUROC: 0.9652 - AP: 0.8606
[37m2024-07-09 07:53:23,477 [INFO] - Validation epoch stats:   Loss: 0.2303 - F1-Score: 0.1185 - Accuracy-Score: 0.9195 - AUROC: 0.8297 - AP: 0.0910
[37m2024-07-09 07:53:23,482 [INFO] - New best model - save checkpoint
[37m2024-07-09 07:53:23,623 [INFO] - Epoch: 3/50
[37m2024-07-09 07:53:28,146 [INFO] - Performed Resampling
[37m2024-07-09 07:53:28,151 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:53:33,809 [INFO] - Training epoch stats:     Loss: 0.2205 - F1-Score: 0.7836 - Accuracy-Score: 0.8962 - AUROC: 0.9681 - AP: 0.8693
[37m2024-07-09 07:53:34,312 [INFO] - Validation epoch stats:   Loss: 0.2199 - F1-Score: 0.1316 - Accuracy-Score: 0.9232 - AUROC: 0.8461 - AP: 0.1059
[37m2024-07-09 07:53:34,319 [INFO] - New best model - save checkpoint
[37m2024-07-09 07:53:34,550 [INFO] - Epoch: 4/50
[37m2024-07-09 07:53:38,975 [INFO] - Performed Resampling
[37m2024-07-09 07:53:38,976 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:53:43,726 [INFO] - Training epoch stats:     Loss: 0.2091 - F1-Score: 0.7916 - Accuracy-Score: 0.9004 - AUROC: 0.9709 - AP: 0.8781
[37m2024-07-09 07:53:44,174 [INFO] - Validation epoch stats:   Loss: 0.2272 - F1-Score: 0.1256 - Accuracy-Score: 0.9202 - AUROC: 0.8457 - AP: 0.0973
[37m2024-07-09 07:53:44,227 [INFO] - Epoch: 5/50
[37m2024-07-09 07:53:48,183 [INFO] - Performed Resampling
[37m2024-07-09 07:53:48,184 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:53:53,306 [INFO] - Training epoch stats:     Loss: 0.1999 - F1-Score: 0.7989 - Accuracy-Score: 0.9045 - AUROC: 0.9728 - AP: 0.8847
[37m2024-07-09 07:53:53,701 [INFO] - Validation epoch stats:   Loss: 0.2251 - F1-Score: 0.1385 - Accuracy-Score: 0.9248 - AUROC: 0.8449 - AP: 0.1086
[37m2024-07-09 07:53:53,707 [INFO] - New best model - save checkpoint
[37m2024-07-09 07:53:53,835 [INFO] - Epoch: 6/50
[37m2024-07-09 07:53:57,484 [INFO] - Performed Resampling
[37m2024-07-09 07:53:57,488 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:54:02,722 [INFO] - Training epoch stats:     Loss: 0.1903 - F1-Score: 0.8064 - Accuracy-Score: 0.9085 - AUROC: 0.9745 - AP: 0.8880
[37m2024-07-09 07:54:03,226 [INFO] - Validation epoch stats:   Loss: 0.2147 - F1-Score: 0.1405 - Accuracy-Score: 0.9233 - AUROC: 0.8651 - AP: 0.1226
[37m2024-07-09 07:54:03,231 [INFO] - New best model - save checkpoint
[37m2024-07-09 07:54:03,406 [INFO] - Epoch: 7/50
[37m2024-07-09 07:54:07,117 [INFO] - Performed Resampling
[37m2024-07-09 07:54:07,122 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:54:11,812 [INFO] - Training epoch stats:     Loss: 0.1832 - F1-Score: 0.8127 - Accuracy-Score: 0.9116 - AUROC: 0.9756 - AP: 0.8920
[37m2024-07-09 07:54:12,363 [INFO] - Validation epoch stats:   Loss: 0.2326 - F1-Score: 0.1317 - Accuracy-Score: 0.9120 - AUROC: 0.8609 - AP: 0.1161
[37m2024-07-09 07:54:12,419 [INFO] - Epoch: 8/50
[37m2024-07-09 07:54:16,104 [INFO] - Performed Resampling
[37m2024-07-09 07:54:16,104 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:54:20,823 [INFO] - Training epoch stats:     Loss: 0.1777 - F1-Score: 0.8167 - Accuracy-Score: 0.9138 - AUROC: 0.9766 - AP: 0.8934
[37m2024-07-09 07:54:21,211 [INFO] - Validation epoch stats:   Loss: 0.2443 - F1-Score: 0.1344 - Accuracy-Score: 0.9297 - AUROC: 0.8371 - AP: 0.0953
[37m2024-07-09 07:54:21,262 [INFO] - Epoch: 9/50
[37m2024-07-09 07:54:25,059 [INFO] - Performed Resampling
[37m2024-07-09 07:54:25,063 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:54:30,097 [INFO] - Training epoch stats:     Loss: 0.1719 - F1-Score: 0.8235 - Accuracy-Score: 0.9174 - AUROC: 0.9776 - AP: 0.8976
[37m2024-07-09 07:54:30,599 [INFO] - Validation epoch stats:   Loss: 0.2661 - F1-Score: 0.1247 - Accuracy-Score: 0.9120 - AUROC: 0.8389 - AP: 0.0975
[37m2024-07-09 07:54:30,660 [INFO] - Epoch: 10/50
[37m2024-07-09 07:54:36,078 [INFO] - Performed Resampling
[37m2024-07-09 07:54:36,079 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:54:42,105 [INFO] - Training epoch stats:     Loss: 0.1674 - F1-Score: 0.8265 - Accuracy-Score: 0.9190 - AUROC: 0.9780 - AP: 0.8979
[37m2024-07-09 07:54:42,508 [INFO] - Validation epoch stats:   Loss: 0.2585 - F1-Score: 0.1261 - Accuracy-Score: 0.9143 - AUROC: 0.8445 - AP: 0.0975
[37m2024-07-09 07:54:42,563 [INFO] - Epoch: 11/50
[37m2024-07-09 07:54:46,461 [INFO] - Performed Resampling
[37m2024-07-09 07:54:46,462 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:54:53,201 [INFO] - Training epoch stats:     Loss: 0.1615 - F1-Score: 0.8341 - Accuracy-Score: 0.9230 - AUROC: 0.9794 - AP: 0.9024
[37m2024-07-09 07:54:53,893 [INFO] - Validation epoch stats:   Loss: 0.2604 - F1-Score: 0.1405 - Accuracy-Score: 0.9216 - AUROC: 0.8490 - AP: 0.1112
[37m2024-07-09 07:54:53,949 [INFO] - Epoch: 12/50
[37m2024-07-09 07:54:59,236 [INFO] - Performed Resampling
[37m2024-07-09 07:54:59,242 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:55:04,814 [INFO] - Training epoch stats:     Loss: 0.1562 - F1-Score: 0.8385 - Accuracy-Score: 0.9254 - AUROC: 0.9802 - AP: 0.9057
[37m2024-07-09 07:55:05,270 [INFO] - Validation epoch stats:   Loss: 0.2663 - F1-Score: 0.1352 - Accuracy-Score: 0.9210 - AUROC: 0.8524 - AP: 0.1138
[37m2024-07-09 07:55:05,322 [INFO] - Epoch: 13/50
[37m2024-07-09 07:55:09,482 [INFO] - Performed Resampling
[37m2024-07-09 07:55:09,483 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:55:14,207 [INFO] - Training epoch stats:     Loss: 0.1494 - F1-Score: 0.8464 - Accuracy-Score: 0.9294 - AUROC: 0.9813 - AP: 0.9089
[37m2024-07-09 07:55:14,670 [INFO] - Validation epoch stats:   Loss: 0.2933 - F1-Score: 0.1354 - Accuracy-Score: 0.9199 - AUROC: 0.8491 - AP: 0.1171
[37m2024-07-09 07:55:14,713 [INFO] - Epoch: 14/50
[37m2024-07-09 07:55:18,783 [INFO] - Performed Resampling
[37m2024-07-09 07:55:18,784 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:55:24,408 [INFO] - Training epoch stats:     Loss: 0.1485 - F1-Score: 0.8474 - Accuracy-Score: 0.9299 - AUROC: 0.9810 - AP: 0.9075
[37m2024-07-09 07:55:24,794 [INFO] - Validation epoch stats:   Loss: 0.2777 - F1-Score: 0.1428 - Accuracy-Score: 0.9269 - AUROC: 0.8553 - AP: 0.1190
[37m2024-07-09 07:55:24,849 [INFO] - Epoch: 15/50
[37m2024-07-09 07:55:28,987 [INFO] - Performed Resampling
[37m2024-07-09 07:55:28,988 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:55:34,013 [INFO] - Training epoch stats:     Loss: 0.1436 - F1-Score: 0.8516 - Accuracy-Score: 0.9320 - AUROC: 0.9819 - AP: 0.9116
[37m2024-07-09 07:55:34,536 [INFO] - Validation epoch stats:   Loss: 0.3031 - F1-Score: 0.1364 - Accuracy-Score: 0.9309 - AUROC: 0.8421 - AP: 0.1101
[37m2024-07-09 07:55:34,586 [INFO] - Epoch: 16/50
[37m2024-07-09 07:55:38,719 [INFO] - Performed Resampling
[37m2024-07-09 07:55:38,720 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:55:43,319 [INFO] - Training epoch stats:     Loss: 0.1398 - F1-Score: 0.8568 - Accuracy-Score: 0.9347 - AUROC: 0.9826 - AP: 0.9149
[37m2024-07-09 07:55:43,809 [INFO] - Validation epoch stats:   Loss: 0.3248 - F1-Score: 0.1430 - Accuracy-Score: 0.9416 - AUROC: 0.8358 - AP: 0.1055
[37m2024-07-09 07:55:43,864 [INFO] - Epoch: 17/50
[37m2024-07-09 07:55:47,512 [INFO] - Performed Resampling
[37m2024-07-09 07:55:47,517 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:55:52,422 [INFO] - Training epoch stats:     Loss: 0.1377 - F1-Score: 0.8590 - Accuracy-Score: 0.9358 - AUROC: 0.9827 - AP: 0.9142
[37m2024-07-09 07:55:52,874 [INFO] - Validation epoch stats:   Loss: 0.3357 - F1-Score: 0.1474 - Accuracy-Score: 0.9374 - AUROC: 0.8380 - AP: 0.1104
[37m2024-07-09 07:55:52,922 [INFO] - Epoch: 18/50
[37m2024-07-09 07:55:56,557 [INFO] - Performed Resampling
[37m2024-07-09 07:55:56,566 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:56:01,309 [INFO] - Training epoch stats:     Loss: 0.1324 - F1-Score: 0.8652 - Accuracy-Score: 0.9389 - AUROC: 0.9835 - AP: 0.9168
[37m2024-07-09 07:56:01,737 [INFO] - Validation epoch stats:   Loss: 0.3649 - F1-Score: 0.1436 - Accuracy-Score: 0.9301 - AUROC: 0.8335 - AP: 0.1110
[37m2024-07-09 07:56:01,790 [INFO] - Epoch: 19/50
[37m2024-07-09 07:56:05,925 [INFO] - Performed Resampling
[37m2024-07-09 07:56:05,931 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:56:10,711 [INFO] - Training epoch stats:     Loss: 0.1308 - F1-Score: 0.8667 - Accuracy-Score: 0.9396 - AUROC: 0.9837 - AP: 0.9181
[37m2024-07-09 07:56:11,109 [INFO] - Validation epoch stats:   Loss: 0.3487 - F1-Score: 0.1453 - Accuracy-Score: 0.9358 - AUROC: 0.8371 - AP: 0.1027
[37m2024-07-09 07:56:11,158 [INFO] - Epoch: 20/50
[37m2024-07-09 07:56:14,954 [INFO] - Performed Resampling
[37m2024-07-09 07:56:14,955 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:56:19,921 [INFO] - Training epoch stats:     Loss: 0.1286 - F1-Score: 0.8687 - Accuracy-Score: 0.9407 - AUROC: 0.9839 - AP: 0.9180
[37m2024-07-09 07:56:20,362 [INFO] - Validation epoch stats:   Loss: 0.3776 - F1-Score: 0.1579 - Accuracy-Score: 0.9466 - AUROC: 0.8330 - AP: 0.1100
[37m2024-07-09 07:56:20,416 [INFO] - Epoch: 21/50
[37m2024-07-09 07:56:24,039 [INFO] - Performed Resampling
[37m2024-07-09 07:56:24,040 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:56:29,404 [INFO] - Training epoch stats:     Loss: 0.1257 - F1-Score: 0.8719 - Accuracy-Score: 0.9423 - AUROC: 0.9844 - AP: 0.9203
[37m2024-07-09 07:56:29,943 [INFO] - Validation epoch stats:   Loss: 0.3840 - F1-Score: 0.1494 - Accuracy-Score: 0.9409 - AUROC: 0.8295 - AP: 0.0967
[37m2024-07-09 07:56:29,999 [INFO] - Epoch: 22/50
[37m2024-07-09 07:56:34,320 [INFO] - Performed Resampling
[37m2024-07-09 07:56:34,321 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:56:38,815 [INFO] - Training epoch stats:     Loss: 0.1232 - F1-Score: 0.8752 - Accuracy-Score: 0.9439 - AUROC: 0.9849 - AP: 0.9236
[37m2024-07-09 07:56:39,189 [INFO] - Validation epoch stats:   Loss: 0.4172 - F1-Score: 0.1531 - Accuracy-Score: 0.9451 - AUROC: 0.8264 - AP: 0.1020
[37m2024-07-09 07:56:39,237 [INFO] - Epoch: 23/50
[37m2024-07-09 07:56:43,515 [INFO] - Performed Resampling
[37m2024-07-09 07:56:43,520 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:56:48,616 [INFO] - Training epoch stats:     Loss: 0.1218 - F1-Score: 0.8771 - Accuracy-Score: 0.9448 - AUROC: 0.9849 - AP: 0.9219
[37m2024-07-09 07:56:48,971 [INFO] - Validation epoch stats:   Loss: 0.4169 - F1-Score: 0.1453 - Accuracy-Score: 0.9401 - AUROC: 0.8288 - AP: 0.1093
[37m2024-07-09 07:56:49,029 [INFO] - Epoch: 24/50
[37m2024-07-09 07:56:52,602 [INFO] - Performed Resampling
[37m2024-07-09 07:56:52,603 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:56:57,614 [INFO] - Training epoch stats:     Loss: 0.1178 - F1-Score: 0.8819 - Accuracy-Score: 0.9472 - AUROC: 0.9855 - AP: 0.9252
[37m2024-07-09 07:56:57,963 [INFO] - Validation epoch stats:   Loss: 0.4497 - F1-Score: 0.1464 - Accuracy-Score: 0.9474 - AUROC: 0.8200 - AP: 0.1012
[37m2024-07-09 07:56:58,011 [INFO] - Epoch: 25/50
[37m2024-07-09 07:57:01,567 [INFO] - Performed Resampling
[37m2024-07-09 07:57:01,567 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:57:06,108 [INFO] - Training epoch stats:     Loss: 0.1152 - F1-Score: 0.8844 - Accuracy-Score: 0.9485 - AUROC: 0.9860 - AP: 0.9271
[37m2024-07-09 07:57:06,461 [INFO] - Validation epoch stats:   Loss: 0.4679 - F1-Score: 0.1576 - Accuracy-Score: 0.9489 - AUROC: 0.8137 - AP: 0.1049
[37m2024-07-09 07:57:06,514 [INFO] - Epoch: 26/50
[37m2024-07-09 07:57:10,078 [INFO] - Performed Resampling
[37m2024-07-09 07:57:10,079 [INFO] - Detected cells: 142320 - Positive: 28464 - Negative: 113856
[37m2024-07-09 07:57:14,605 [INFO] - Training epoch stats:     Loss: 0.1158 - F1-Score: 0.8840 - Accuracy-Score: 0.9482 - AUROC: 0.9856 - AP: 0.9257
[37m2024-07-09 07:57:14,960 [INFO] - Validation epoch stats:   Loss: 0.4862 - F1-Score: 0.1562 - Accuracy-Score: 0.9474 - AUROC: 0.8142 - AP: 0.1068
[37m2024-07-09 07:57:14,961 [INFO] - Performing early stopping!
[37m2024-07-09 07:57:14,972 [INFO] - Finished run jj5jg9mp
